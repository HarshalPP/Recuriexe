const {
    success,
    unknownError,
    serverValidation,
    badRequest,
  } = require("../../../../../globalHelper/response.globalHelper");
  const PDFDocument = require("pdfkit");
  const path = require("path");
  const fs = require("fs");
  const moment = require("moment");
const { validationResult } = require("express-validator");
  const stream = require('stream')
  //   const { uploadToSpaces } = require("../../services/spaces.service.js")
  const uploadToSpaces = require("../../services/spaces.service.js");

  
    const { EventEmitter } = require('events');
  const myEmitter = new EventEmitter();

    // const vv = require("../../../../../assets/image/FINCOOPERSLOGO.png")
  const pdfLogo = path.join(
    __dirname,
    "../../../../../assets/image/FINCOOPERSLOGO.png"
  );
  const unCheckedLogo = path.join( __dirname,
    "../../../../../assets/image/checkbox-unchecked.256x256.png");
    const CheckedLogo = path.join( __dirname,
      "../../../../../assets/image/checkbox-checked.png")
  const watermarklogo = path.join(
    __dirname,
    "../../../../assets/image/watermarklogo.png"
  );
  const customerModel = require('../../model/customer.model.js')
const coApplicantModel = require('../../model/co-Applicant.model')
const guarantorModel = require('../../model/guarantorDetail.model')
const applicantModel = require('../../model/applicant.model')
const technicalModel = require('../../model/branchPendency/approverTechnicalFormModel')
const appPdcModel = require('../../model/branchPendency/appPdc.model')
const { initESign } = require('../../services/legality.services.js')
const creditPdModel = require('../../model/credit.Pd.model')
// const fileprocessModel =require('../../model/fileProcess/fileProcess.model.js')
const gtrPdcModel = require('../../model/branchPendency/gtrPdc.model')
const sanctionModel =  require('../../model/finalApproval/sanctionPendency.model')
const finalsanctionModel =  require('../../model/finalSanction/finalSnction.model')
const externalBranchModel = require("../../model/adminMaster/newBranch.model.js");
const bankDeatilsKycs = require('../../model/branchPendency/bankStatementKyc.model');
const newBranchModel = require("../../model/adminMaster/newBranch.model.js");
const disbursementModel =require('../../model/fileProcess/disbursement.model')
const gtrbankModel = require('../../model/branchPendency/gurrantorbankStatment.model')
const endUseOfLoanModeldata = require('../../model/endUseOfLoan.model.js');



  const mongoose = require('mongoose')

  
  // Helper function to capitalize the first letter of each word in a name
  function capitalizeFirstLetter(name) {
    return name
      .split(" ")
      .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
      .join(" ");
  }
  
  async function ratannaFinSanctionLetterPdf(allPerameters,logo,partnerName) {

    const font = "assets/font/Cambria.ttf";
    const fontBold = "assets/font/Cambria-Bold.ttf";
    const fontKerlaTamil = "assets/font/KarlaTamilUpright-Regular.ttf"
    const fontUrdu = "assets/font/IBMPlexSansArabic-Regular.ttf"
    const fontTelugu = "assets/font/TiroTelugu-Regular.ttf"
    const fontPanjabi = "assets/font/BalooPaaji2-VariableFont_wght.ttf"
    const fontMalayam = "assets/font/AnekMalayalam-VariableFont_wdth.ttf"
    const fontKannada = "assets/font/NotoSansKannada-VariableFont_wdth.ttf"
    const fontGujarati = "assets/font/Rasa-VariableFont_wght.ttf"
    const fontHindi = "assets/font/Mukta-Regular.ttf"
    const fontOriya = 'assets/font/BalooBhaina2-VariableFont_wght.ttf'
    const fontMarathi = 'assets/font/Hind-Regular.ttf'
    const fontBengali = 'assets/font/NotoSansBengali-VariableFont_wdth.ttf'
    // const baseDir = path.join("./uploads/");
    // const outputDir = path.join(baseDir, "pdf/");

    const PDFDocument = require('pdfkit');
  const doc = new PDFDocument({ margin: 50, size: "A4" });

  // Buffer to hold the PDF content
  const buffers = [];
  doc.on('data', (chunk) => buffers.push(chunk));
  doc.on('end', () => console.log('PDF generated successfully!'));

  
    // draw a border around the page
    function drawBorder() {
      const pageWidth = doc.page.width;
      const pageHeight = doc.page.height;
      const margin = 30;
      const lineWidth = 2;
  
      // Draw a simple border rectangle
      doc.lineWidth(lineWidth);
      doc
        .rect(margin, margin, pageWidth - 2 * margin, pageHeight - 2 * margin)
        .strokeColor("#324e98") // Set the color of the border
        .stroke();
    }
  
    // add logo to every page
    // function addLogo() {
    //   if (fs.existsSync(logo)) {
    //     doc.image(logo, 400, 50, {
    //       fit: [150, 50],
    //       align: "right",
    //       valign: "bottom",
    //     });
    //   } else {
    //     console.error(`Logo file not found at: ${logo}`);
    //   }
    // }
    const FinpdfLogo = path.join(
        __dirname,
        "../../../../../assets/image/FINCOOPERSLOGO.png"
      );

    function addLogo() {
          if (fs.existsSync(FinpdfLogo)) {
            doc.image(FinpdfLogo, 400, 50, { fit: [150, 50], align: "left", valign: "bottom" });
          } else {
            console.error(`Logo file not found at: ${FinpdfLogo}`);
          }
      
          if (fs.existsSync(logo)) {
                  doc.image(logo, 40, 50, {
                    fit: [150, 50],
                    align: "right",
                    valign: "bottom",
                  });
                } else {
                  console.error(`Left logo file not found at: ${logo}`);
                }
        }
  
    // watermark function
    function addWatermark() {
      if (fs.existsSync(watermarklogo)) {
        doc.save();
        doc.rotate(-45, { origin: [doc.page.width / 2, doc.page.height / 2] });
  
        doc.image(
          watermarklogo,
          doc.page.width / 2 - 200,
          doc.page.height / 2 - 200,
          {
            fit: [450, 400],
            opacity: 0.05,
            align: "center",
            valign: "center",
          }
        );
  
        doc.restore();
      } else {
        console.error(`Logo file not found at: ${watermarklogo}`);
      }
    }
  
    // Footer with border and stylized text
    // Footer with border and stylized text
    function addFooter() {
      if( partnerName == "GROW MONEY CAPITAL PVT LTD"){
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("Grow Money Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }else {
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("FinCoopers Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }
     
    }
  
    // if (!fs.existsSync(outputDir)) {
    //   fs.mkdirSync(outputDir, { recursive: true });
    // }
  
    const timestamp = Date.now();
    // const candidateName = 
    // (`${candidateDetails.name}`); // Capitalize name
    // const pdfFilename = `growLoanAggrement.pdf`;
    // const pdfPath = path.join(outputDir, pdfFilename);
  
    // const doc = new PDFDocument({ margin: 50, size: "A4" });
    // const stream = fs.createWriteStream(pdfPath);
  
    // doc.pipe(stream);
    // //---------------------------------------------------- new page 14-------------------------------------------------------

// addLogo();
// drawBorder();
doc.moveDown(7);


doc
.fontSize(9)
.font('Helvetica-Bold')
.fontSize(9)
.text(`Vernacular Language Form`,  { align: "center",underline: false, width: 500 });
doc.moveDown(2);


function declarationTableFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  const columnWidths = {
    field1: 50,
    field2: 100,
    field3: 330,
  };

  // Define min and max row height to avoid extremes
  const MIN_ROW_HEIGHT = 15;
  const MAX_ROW_HEIGHT = 45;

  // Function to calculate row height based on text content
  const calculateRowHeight = (row) => {
    let maxHeight = 0;
    Object.keys(row).forEach((field) => {
      const text = row[field] || '';
      const columnWidth = columnWidths[field] || 100;

      // Calculate the text height for each field
      const textHeight = doc
        .font(field === 'field3' ? fontKerlaTamil : 'Helvetica')
        .fontSize(7.2)
        .heightOfString(text, { width: columnWidth });

      // Track the highest text height in the row
      maxHeight = Math.max(maxHeight, textHeight);
    });

    // Ensure the row height stays within the defined min and max limits
    return Math.max(MIN_ROW_HEIGHT, Math.min(maxHeight, MAX_ROW_HEIGHT));
  };

  const totalWidth = Object.values(columnWidths).reduce((sum, width) => sum + width, 0);

  tableData.forEach((row, rowIndex) => {
    let currentX = startX;
    const rowHeight = calculateRowHeight(row); // Calculate the row height based on text content

    // Set up the table border at the beginning
    doc
      .lineWidth(0.25)
      .rect(startX, startY, totalWidth, rowHeight)
      .stroke("black");

    Object.keys(columnWidths).forEach((field) => {
      const columnWidth = columnWidths[field];
      const content = row[field] || '';

      doc
        .lineWidth(0.25)
        .rect(currentX, startY, columnWidth, rowHeight)
        .stroke("black");

      const isHeader = rowIndex === 0;
      const paddingTop = 2;  // Adjust padding from the top (increase if needed)
      const textYPosition = startY + paddingTop;

      if (field === 'field1' && content) {
        doc.image(content, currentX + 5, textYPosition + (rowHeight - 8) / 2, { width: 8, height: 8 });
      } else {
        doc
          .font(isHeader ? 'Helvetica-Bold' : 'Helvetica')
          .fillColor("black")
          .fontSize(7.2);

        const text = content || '';
        if (field === 'field3') {
          // Checking for specific languages to apply respective fonts
          if (/[\u0C00-\u0C7F]/.test(text)) {  // Telugu Unicode range
            doc.font(fontTelugu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0D00-\u0D7F]/.test(text)) {  // Malayalam Unicode range
            doc.font(fontMalayam).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0C80-\u0CFF]/.test(text)) {  // Kannada Unicode range
            doc.font(fontKannada).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0A80-\u0AFF]/.test(text)) {  // Gujarati Unicode range
            doc.font(fontGujarati)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0600-\u06FF]/.test(text)) {  // Urdu Unicode range
            doc.font(fontUrdu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'right',
               });
          } else if (/[\u0A00-\u0A7F]/.test(text)) {  // Punjabi Unicode range
            doc.font(fontPanjabi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0B80-\u0BFF]/.test(text)) {  // Tamil Unicode range
            doc.font(fontKerlaTamil).text(text, currentX + 3, textYPosition, {
                baseline: "top",
                width: columnWidth - 6,
                align: 'left',
            });
          } else if (/[\u0900-\u097F]/.test(text)) {  // Hindi Unicode range
            doc.font(fontHindi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else  if (/[\u0B00-\u0B7F]/.test(text)) {  // Odia Unicode range
            doc.font(fontOriya)  // Make sure 'fontOdia' is defined and points to the correct font file
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
           } else if (/[\u0900-\u097F]/.test(text)) {  // Marathi (Devanagari Unicode range)
            doc.font(fontMarathi)  // Ensure you have the Marathi font file available
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
        } else if (/[\u0980-\u09FF]/.test(text)) {  // Bengali Unicode range
          doc.font(fontBengali)  // Ensure you have the Bengali font file available
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }else {
            doc.font('Helvetica')
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          }
        } else {
          doc.font('Helvetica')
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }
      }

      currentX += columnWidth;
    });

    startY += rowHeight; // Adjust to the row's actual height
  });
}

const gujratiFont = [
'આ અરજી/કરાર/પત્ર/નિયમો અને શરતોનો સામગ્રી અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહકને અંગ્રેજીમાં વાંચીને સમજાવી',
'  અને વ્યાખ્યા કરવામાં આવી છે અને અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહક દ્વારા તેને સમજવામાં આવી છે',
]

const declarationTable = [
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "English", 
    field3: "The content of this Application/ Agreement/letter/Terms and Conditions has been read out, explained and interpreted to the applicant(s)/Borrower and to the Co-Borrower(s) in English and understood by the applicant(s)/Borrower and Co-Borrower(s).",  // English text
  },
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "Hindi", 
    field3: "इसआवेदन / समझौ ते / पत्र / नि यमों औमों रशर्तों की सा मग्री को आवेदक (ओं)ओं / उधा रकर्ता औरअंग्रेजीग्रे जीमेंसह-उधा रकर्ता (ओं)ओं को समझा औरसमझा यागयाहैऔहै रआवेदक (ओं)ओं याउधा रकर्ता द्वा रा समझा गया है ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Punjabi", 
    field3: "ਇਸਬਿ ਨੈ-ਪੱਤਰ / ਸਮਝੌਤੇਝੌਤੇ/ ਪੱਤਰ / ਨਿ ਯਮਾਂ ਅਮਾਂ ਤੇਸ਼ਰਤਾਂ ਦੀਤਾਂ ਦੀਸਮੱਗਰੀ ਨੂੰਬਿ ਨੈਕਾ ਰ /ਉਧਾ ਰਲੈਣਵਾ ਲੇਅਤੇਅੰਗ੍ਰੇਜ਼ੀ ਵਿ ਚਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇਨੂੰਸਮਝਾ ਕੇਸਮਝਾ ਇਆਗਿ ਆਹੈਅਤੇਬਿ ਨੈਕਾ ਰਦੁਆਰਾ ਸਮਝੇਗਝੇ ਏਅਤੇਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Kannada", 
    field3: "ಈ ಅಪ್ಲಿಕೇ ಶನ್/ಒಪ್ಪಂ ದ/ಪತ್ರ / ನಿಯಮಗಳುಮತ್ತು ಷರತ್ತು ಗಳವಿಷಯವನ್ನು ಅರ್ಜಿ ದಾ ರ (ರು )/ ಸಾ ಲಗಾರಮತ್ತು ಇಂ ಗ್ಲಿಷ್ನಲ್ಲಿಸಹ-ಸಾ ಲಗಾರ(ಗಳು)ಗೆಓದಿ, ವಿವರಿಸಲಾ ಗಿದೆಮತ್ತು ವ್ಯಾ ಖ್ಯಾ ನಿಸಲಾ ಗಿದೆಮತ್ತು ಅರ್ಜಿ ದಾ ರರು (ಗಳು ) /ಸಾ ಲಗಾರರಿಂ ದಅರ್ಥ ಮಾ ಡಿಕೊ ಳ್ಳಲಾ ಗಿದೆಮತ್ತು ಸಹ-ಸಾ ಲಗಾ ರ (ಗಳು).  ",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Telugu", 
    field3: "ఈ అప్లికేప్లిషన్ / ఒప్పం దం / లేఖ / నిబం ధనలుమరియుషరతులయొక్క కం టెం ట్దరట్ద ఖాస్తుదారు(లు) / రుణగ్ర హీతమరియుఆం గ్లం లోసహ-రుణగ్ర హీత (ల)కుచదవబడిం ది, వివరిం చబడిం దిమరియువివరిం చబడిం దిమరియుదరఖాస్తుదారు(లు) / రుణగ్ర హీతఅర్థం చేసుకున్నా రుమరియుసహ-రుణగ్ర హీత (లు)."
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Tamil", 
    field3: "இந்தவிண்ணப்பம் / ஒப்பந்தம் / கடிதம்வி தி முறைகள்மற்றும்நி பந்தனை களி ன்உள்ளடக்கம்விண்ணப்பதா ரர்(கள்)/கடன்வா ங்குபவர் மற்றும்இணைக்கடன்வா ங்குபவர்(கள்) ஆகி யோ ருக்குஆங்கி லத்தி ல்படித்துவி ளக்கப்பட்டுவி ளக்கம்அளி க்கப்பட்டுள்ளதுமற்றும்விண்ணப் பதா ரர்(கள்)/கடன்வா ங்குபவர்புர",  // Tamil text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Malayalam", 
    field3: 'ഈ ആപ്ലി ക്കേ ഷന്റെ ഉള്ളടക്കം / കരാ ർ / കത്ത് / നി ബന്ധനകളും വ്യ വസ്ഥകളും അപേ ക്ഷകന് / കടം വാ ങ്ങു ന്നയാ ൾക്കും ഇം ഗ്ലീ ഷി ൽ സഹ-കടം വാ ങ്ങു ന്നയാ ൾക്കും വാ യിക്കു കയും വി ശദീ കരിക്കു കയും വ്യാ ഖ്യാ നിക്കു കയും ചെ യ്തു കൂ ടാ തെ അ പേ ക്ഷകൻ (ങ്ങൾ) / കടം വാ ങ്ങു ന്നയാ ൾ മനസ്സി ലാ ക്കു കയും ചെ യ്യു ന്നു . ഒപ്പം സഹ-കടം വാ ങ്ങു ന്നവരും .',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Oriya", 
    field3: 'ଏହିଆହି ବେ ଦନ / ଚୁକ୍ତିନା ମା / ଚିଠିଚି ଠି/ ସର୍ତ୍ତା ବଳୀ ଏବଂ ଚୁକ୍ତିନା ମା ଗୁଡିକଡି ଆବେ ଦନକା ରୀ (()) / orrଣଗ୍ରହୀ ତା ଏବଂ ସହ-orrଣଗ୍ରହୀ ତା ଙ୍କୁଇଂ ରା ଜୀ ରେ ପ read ା ଯା ଇଛି,ଛିବ୍ୟା ଖ୍ୟା କରା ଯା ଇଛିଏବଂ ଆବେ ଦନକା ରୀ (ମା ନେ ) / orrଣଦା ତା ଦ୍ୱା ରା ବୁଝିଛଝିନ୍ତିଏନ୍ତିବଂ ସହ-orrଣଦା ତା (ଗୁଡିକଡି ) |',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Marathi", 
    field3: 'याअर्जा ची / करा रा ची / पत्रा ची / अटी व शर्तीं ची मा हि ती वा चूनका ढली गेली आहे,हेअर्जदा रा ला /कर्जदा रा ला आणि इंग्रजी मध्येसह-कर्जदा रा ला /केली आहे व अर्जदा रा ने /कर्जदा रा नेसमजूनघेतली आहे.हेआणि सह-कर्जदा र',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Gujarati", 
    field3: gujratiFont.join('\n'),  // English text
  },
  {
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Urdu", 
    field3: "درخواست/معاہدہ/خط/شرائط و ضوابط کا مواد درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ کو انگریزی میں پڑھ کر سنایا گیا، وضاحت کی گئی اور اس کی تشریح کی گئی اور درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ نے اسے سمجھ لیا۔",  // Urdu text
  },
];

// // Call the table function to render the data
declarationTableFunction(declarationTable);
doc.moveDown(3);

// doc
// .fontSize(9)
// .font('Helvetica')
// .text(`___________________________`,  doc.y, { align: "left",underline: true, width: 500 });
// doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica-Bold')
// .text(`FOR Borrower,Co-Borrower and Guarantor`,{ align: 'left',lineGap: 5  });
// doc.moveDown(1);

// Reset the starting position
doc
.fontSize(8)
.font('Helvetica-Bold')
.text(
  `FOR Borrower, Co-Borrower and Guarantor`,
  40, // X-coordinate for absolute left alignment
  doc.y, // Y-coordinate: use the current vertical position
  { align: 'left', lineGap: 5 }
);
doc.moveDown(1);

  
// addFooter();
doc.addPage();


    // addLogo();
    // drawBorder();
    doc.moveDown(6);

   doc.font(font).fontSize(11).text('FACILITY AGREEMENT', { align: 'center', underline: true });
   doc.moveDown(2);


doc.font('Helvetica').fontSize(9).text(`THIS FACILITY AGREEMENT`, {
  align: 'left',
  indent: 40,
  lineGap: 5,
  continued: true
})
.font('Helvetica-Bold').text(`(“Agreement”)`, {
  continued: true, // Allows the text to continue on the same line
})
.font('Helvetica').fontSize(9).text(` is made at the place and on the date stated in the Schedule of this Agreement (“Schedule”) by and between:`, {
  align: 'left',
 align:"justify",
  indent: 40,
  lineGap: 5,
})

doc.moveDown(1)

.font('Helvetica').text(`GROW MONEY CAPITAL PVT LTD,`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica').text(` a company incorporated under the Companies Act, 1956 and validly existing under and within the meaning of the Companies Act, with CIN: U74899DL1995PTC069216, registered as a nonbanking financial company`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica-Bold').text(`(“NBFC”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica').text(`under the Reserve Bank of India`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica-Bold').text(`(“RBI”) `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`Act, 1934, having its registered office at 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI-110001 (M.P.), India (hereinafter referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(` “Lender”,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`which expressionshall, unless repugnant to the subject or context thereof, be deemed to include its successors, transferees, novatees and assigns), of the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(`FIRST PART;`) 

  doc.moveDown(1);
  doc.font(font).fontSize(9).text('AND', { align: 'center' });
  doc.moveDown(1);

  doc.font('Helvetica').text(`which expression shall, unless repugnant to the subject or context there of, be deemed to include its successors, transferees, novatees and assigns), of the `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(` SECOND PART`) 

  doc.font('Helvetica').text(`The Borrower and Lender are hereinafter collectively referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(`“ Parties”`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and individually referred to as `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(` “Party”`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`WHEREAS`) 
  doc.moveDown(1);

  doc.font('Helvetica').text(`1. The Borrower is engaged in the business or employment as detailed in the Schedule appended here with`, {
    continued: true, // Allows the text to continue on the same line
  })
  
  doc.font('Helvetica-Bold').text(`(“Business”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and it has requested the Lender to sanction a credit facility for an amount as mentioned in the Schedule `, {
    continued: true, // Allows the text to continue on the same line
  })

  doc.font('Helvetica-Bold').text(`(“Facility”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 2. The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 3. At the Borrower’s request and relying upon the correctness of the information, the representations and the assurances given by the Borrower, the Lender has agreed to grant the Facility to the Borrower, on the terms and conditions contained herein.`)
  doc.moveDown(1);

  doc.font('Helvetica-Bold').text(`NOW, THEREFORE,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`in consideration of the premises and mutual agreements and covenants contained in this Agreement and other good and valuable consideration (the receipt and adequacy of which is hereby mutually acknowledged), each of the Parties hereby agrees as follows:`)

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`DEFINITIONS AND INTERPRETATION`) 
  doc.moveDown(1);

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`1.1 Definitions`) 
  doc.moveDown(1);
  
  doc.font('Helvetica').text(`Wherever used in this Agreement or any Schedule, unless the context otherwise requires, in addition to the terms defined in the Recitals and in the text of this Agreement, the following capitalized terms have the following meanings:`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`“Additional Interest Rate” means the additional interest rate as detailed in the Schedule,`) 
  doc.font('Helvetica-Bold').text(`“Applicable Interest Rate”`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica').text(`means the rate of interest as mentioned in the Schedule payable by the Borrower to the Lender on the outstanding principal amount under the Facility and serviced in a manner as specified in this Agreement.`)
  doc.font('Helvetica-Bold').text(`“Applicable Law”`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`means any statute, national, state, provincial, local, municipal, or other law, treaty, code, regulation, ordinance, rule, judgment, order, decree, bye-law, any act or enactment including but not limited to the Insolvency and Bankruptcy Code, 2016`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica-Bold').text(`( “Code”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`, Securitization and Reconstruction of Financial Assets and Enforcement of Security Interest Act, 2002`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica-Bold').text(`(“SARFAESI Act”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`The Industrial Disputes Act, 1947, Environment Protection Act, 1986, Reserve Bank of India Act, 1934 and other RBI regulations,Companies Act, 2013, Transfer of Property Act, 1882, approval of any Governmental Authority, directive, guideline, policy, requirementor other governmental restriction or any similar form of decision of or determination by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    continued: false, // Allows the text to continue on the same line
  })
   
    // addFooter();
    //------------------------------------------new page ----------------------------------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    // doc.moveDown();


    // doc.font('Helvetica').fontSize(9).text(`by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    //     continued: true, 
    //   })

    doc.font('Helvetica-Bold').fontSize(9).text(`“Application Form”`, {
        continued: true, // Allows the text to continue on the same line
    })  

    doc.font('Helvetica').text(`” means the application form and/or relevant information submitted through any means by the Borrower to the Lender for applying and availing the Loan/Facility, together with all other information particulars, clarifications and declarations, if any, furnished by the Borrower or any other person from time to time in connection with the said Loan/Facility,`)  

    doc.font('Helvetica-Bold').text(`“Business Day”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean a day of the week on which the scheduled commercial banks are open for businessin such state or union territory of India where the office of the Lender, as specified in the Schedule, is located. `)  

    doc.font('Helvetica-Bold').text(`“Borrower/Co-borrower”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`means and includes all the borrower(s) and co-borrower(s) and shall deem to include (i) in case of the individual- his or her heirs, executors and administrators and in case of more than one Borrower their respective heirs executors and administrators, (ii) in case of a company incorporated under the provisions of \n\n Companies Act or a society registered under the applicable laws relating to societies- its successors in interest and permitted assigns, (iii) in case of a partnership firm within the meaning of Indian Partnership Act,1932- any ofor each of the partner or survivor/s of them from time to time (both their personal capacity and as partners of the firm) and their respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the firm, (iv) in the case of proprietary concern- the proprietor(s) (both in his/her personal capacity and as proprietor/proprietress of the concern) and his her respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the concern, (v) in the case of a Hindu Undivided Family` , {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(` (“HUF”),`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`, the Karta of the HUF and any or each of the adult members/coparceners of the HUF and their survivor(s) and their respective heirs, legal representatives, executors, administrators and permitted assigns, (vi) in the case of trust, the trust/trustee/s for the time being its successors.`) 

    doc.font('Helvetica-Bold').text(`“Charges”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean the charges which may be charged by the Lender in relation to the Loan/ Facility, including the charges provided in the Sanction Letter. Any revision to the Charges as per this Agreement as may be communicated or notified to the Borrower shall be the applicable Charges and shall be deemed to have been incorporated in the Sanction Letter, and the Sanction Letter to this effect be deemed to have been modified;`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(`“Companies Act”`, {
        continued: true, // Allows the text to continue on the same line
    })
    
    doc.font('Helvetica').text(`” means individually and collectively, the provisions of the Companies Act, 2013 and such relevant provisions of the Companies Act, 1956, which are still in force and effect including all amendments, enactments, re-enactments or modifications thereof, from time to time, including the rules and regulations prescribed therein`) 
  
    doc.font('Helvetica-Bold').text(`“Conditions Precedent”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means the conditions as specified in Clause 3.5 of this Agreement which are required to be satisfied (unless waived in writing by the Lender) by the Borrower,`)

   doc.font('Helvetica-Bold').text(`“Credit Information Agency”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`” shall mean and include TransUnion CIBIL Limited, CRIF High Mark Credit Information Services Private Limited, Equifax India and Equifax Analytics Private Limited, Experian Credit Information Company of India Private Limited or such other company or any other agency as may be notified or recognized as such by the RBI or any other regulatory authority,`)

    doc.font('Helvetica-Bold').text(`“Designated Account”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means a current bank account of the Lender for receipt of the Outstanding Amounts; “Disbursement” means the disbursement of the Facility or any part thereof, made by the Lender pursuant to the request thereof by the Borrower subject to the terms of this Agreement;`)
  
    doc.font('Helvetica-Bold').text(`“Disbursement Request Form”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“DRF”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means a form (as per format in attached annexure) or a request (in a form and manner acceptable to the Lender) submitted by the Borrower to the Lender requesting that all or a portion of the Facility be disbursed to the Borrower;`)
    doc.font('Helvetica-Bold').text(`“Due Date”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the date(s) on which any amounts in respect of the Facility including the principal, interest or other monies fall due under the terms of this Agreement and/or the other Financing Documents and/or as more particularly described under the Schedule;`)
    doc.font('Helvetica-Bold').text(`“Electronic Clearing Service”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`‘ECS'`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`'NACH',`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the electronic clearing services and electronic payment services, notified by RBI from time to time, being mode(s) of effecting payment transactions using the services of a clearing house or any other platform or mechanism duly authorized in this regard including without limitation the National Electronic Clearing Service;`)
    doc.font('Helvetica-Bold').text(`“Encumbrance”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the creation of charge, lien, security, quasi security, non-disposal arrangement, claim, option, negative lien, power of sale in favor of a third party, retention of title, right of pre-emption, right of first refusal, lock-in of any nature including as may be stipulated by the Securities Exchange Board of India, or other third party right or security interest or an agreement, arrangement or obligation to create any of the foregoing whether presently or in the future. The term`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbrancer”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbered”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall be accordingly construed;`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Event of Default”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall have the meaning prescribed to it under clause 13 herein;`)
    doc.font('Helvetica-Bold')
   .fontSize(9)
   .text(
      `"Account Bank" or "Escrow Agent"`,
      { continued: true }
   )
   .font('Helvetica')
   .text(` means the bank acceptable to the Lender`, { continued: true })
   .font('Helvetica')
   .text(
      ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
    // addFooter();
      //-------------------------------------------------new page ------------------------------------------------------
      doc.addPage();
      // addLogo();
      // drawBorder();

      doc.moveDown(7);

      // doc.moveDown();

  //     doc.font('Helvetica-Bold')
  //  .fontSize(9)
  //  .text(
  //     `"Account Bank" or "Escrow Agent"`,
  //     { continued: true }
  //  )
  //  .font('Helvetica')
  //  .text(` means the bank acceptable to the Lender`, { continued: true })
  //  .font('Helvetica')
  //  .text(
  //     ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
  //     { align: 'justify', indent: 40, lineGap: 5 }
  //  )
  //  .moveDown(1);

doc.font('Helvetica-Bold')
    .fontSize(9)
   .text('"Escrow Account"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the account opened/maybe opened with the Account Bank in accordance with this Agreement and the Escrow Agreement, for the repayment of Outstanding Amounts or any amount payable by Borrower to Lender under this Agreement,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Escrow Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` for the purpose of this Agreement, as the context may require, shall either mean the agreement executed/to be executed/maybe executed at any date as required by Lender and entered into by and between inter alia the Bank (defined below), the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account and the Lender reserves the right to make Borrower a part of Escrow Agreement on such terms and conditions as the Lender may decide in its sole discretion or it shall mean the agreement executed/to be executed/maybe executed at any date as required by Lender, and entered into by and between inter alia the Borrower, the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Facility"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the aggregate amount of credit facility/facilities provided under the terms of this Agreement, and any other outstanding amounts thereunder;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Financing Documents"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Application Form, this Agreement, the Sanction Letter, and all other deeds, instruments, and agreements including security documents of any nature that have been/are to be executed between the Parties, or with any third parties in relation to the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

// addFooter();
// doc.addPage();
// addLogo();
// drawBorder();

// Continue with bold and normal text
doc.font('Helvetica-Bold')
   .text('"Facility Agreement" or "Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` means this agreement, all Schedules and amendments to this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   

doc.font('Helvetica-Bold')
   .text('"Guarantor"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Person(s) as more particularly mentioned in the Schedule, providing guarantee to secure the Outstanding Amount and for the due performance of the terms and conditions of this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Governmental Approval"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean any consent, approval, authorization, waiver, permit, grant, franchise, concession, agreement, license, certificate, exemption, order registration, declaration, filing, report, or notice of, with or to any Governmental Authority,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

   doc.font('Helvetica-Bold')
   .text('"Governmental Authority"', { continued: true })
   .font('Helvetica')
   .text(
      ` means any:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(0.5);

// Point a
doc.text(
   `a) government (central, federal, state or otherwise) or sovereign state and`,
   { indent: 60, align: 'justify', lineGap: 5,  }
)
   .moveDown(0.5);

// Point b
doc.text(
   `b) any governmental agency, semi-governmental or judicial or quasi-judicial or administrative entity,\n department or authority, or any political subdivision thereof, including without limitation, any stock exchange\n or any self-regulatory organization, established under any Applicable Law,`,
   { indent: 60, align: 'justify', lineGap: 5,continued: false }
)
   doc.moveDown(1);

   doc.font('Helvetica-Bold')
.fontSize(9)

   .text('"Instalments"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the amount of payment necessary to amortize the Facility with Interest (rounded off to the next rupee) with in such period as may be determined in the Repayment Schedule,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   doc.font('Helvetica-Bold')
   .text('"Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the interest payable on the Facility at the Applicable Interest Rate, including the Pre-Instalment Interest payable by the Borrower to the Lender at Applicable Interest Rate as specified in the Schedule hereunder,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );


      
      
      // addFooter();

  //-------------------------------------------------new page ------------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();

doc.moveDown(7)
// doc.moveDown()





doc.font('Helvetica-Bold')
.fontSize(9)
   .text('"Market Disruption Event"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean happening of an event which in the opinion of the Lender would make it unviable for the Lender to continue the Loan/Facility,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Outstanding Amounts"', { continued: true })
   .font('Helvetica')
   .text(
      ` means at any time all the amounts payable in relation to the Facility by the Borrower to the Lender, pursuant to the terms of the Financing Documents, including the following amounts:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.text(
   `a) The principal amount of the Facility and Interest there on.`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) All dues payable by the Borrower, as reflected in the books and records maintained by the Lender in its\n normal course of business from time to time.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) All other moneys, debts, and liabilities of the Borrower, including indemnities, liquidated damages, costs,\n Charges, expenses, and fees and interest incurred under, arising out of or in connection with the Financing\n Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) Any and all sums expended by the Lender in order to preserve any Security; and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `e) Any and all costs, expenses, fees, and duties for the enforcement and collection of any amounts due\n under the Financing Documents, including expenses of enforcement and realization of the Security\n and costs and expenses set out in Clause 15 (Costs, Charges, Expenses and Stamp Duty) hereto.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );






doc.font('Helvetica-Bold')
   .text('"Payment Instrument(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the instrument as specified by the Lender in the Schedule hereunder, including but not limited to ECS, NACH, digital or electronic payments, money transfer through mobile applications and PDCs, by which the Borrower shall make the payment of Outstanding Amounts to the Lender.“Person(s)” shall mean any natural person or legal entity whether incorporated or not, limited or unlimitedliability company, body corporate, co-operative society, corporation, partnership (whether limited or unlimited), proprietorship, society, HUF, trust, union, association or association of persons, body of individuals, government or any agency there of, or any other entity that may be treated as a person under the Applicable Law; “Post Date Cheque(s)” or “PDC(s)” shall mean the postdated cheque(s) issued in favor of the Lender to ensure continuity of repayment by the Borrower under the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the interest payable on the disbursed amount, at the Applicable Interest Rate, for the period commencing from the relevant disbursement date to the date immediately prior to the commencement of Repayment, payable by the Borrower on the Pre-Instalment Interest Date(s).`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   
   doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest Payment Date(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the date, if any, which is specified in the Schedule on which the Borrower shall pay the Pre-Instalment Interest;.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   doc.font('Helvetica-Bold')
   .text('"Prepayment Statement"', { continued: true })
   .font('Helvetica' )
   .text(`or`,{ continued: true })
   .font('Helvetica-Bold')
   .text('"PForeclosure Statement"', { continued: true })
   .font('Helvetica' )
   .text(
      `  shall mean the statement which shall be sent by the Lender to the Borrower, on providing the written consent as per Clause 6.3 hereunder, which statement shall contain the terms and conditions of the prepayment of the Outstanding Amount, or any part thereof by the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .font('Helvetica-Bold' )
   .text('"Purpose"',{ continued: true})
   .font('Helvetica' )
   .text(
    `  shall have the meaning as specified in the Schedule.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .font('Helvetica-Bold' )
 .text('"Receivables"',{ continued: true})
 .font('Helvetica' )
 .text(
  ` shall mean the receivables as more particularly described under the Schedule.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)


   

doc.font('Helvetica-Bold')
   .text('"Repayment"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the repayment and/or the prepayment of the principal amount of the Facility, interest thereon, Additional Interest, costs and other charges, premium, fees or other dues payable in accordance with this Agreement. The words “Repay” and “Repaid” shall be construed accordingly.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Repayment Schedule"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the manner in which the Repayment shall be made by the Borrower including details like due dates, installment amount etc. prepared in line with the details specified in the Schedule to this Agreement as may be revised from time to time and communicated to the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );






// addFooter();
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Restricted Party"', { continued: true })
   .font('Helvetica')
   .text(
      `means a person that is: (i) listed on, or owned or controlled by a person listed on, or acting on behalf of a person listed on, any Sanctions List; (ii) located in, incorporated under the laws of, or owned or (directly or indirectly) controlled by, or acting on behalf of, a person located in or organised under the laws of a country or territory that is the target of country-wide or territory-wide Sanctions; or (iii) otherwise a target of Sanctions ("target of Sanctions" signifying a person with whom a US person or other national of a Sanctions Authority would be prohibited or restricted by law from engaging in trade, business or other activities); "Sanctions" means the economic sanctions laws, regulations, embargoes or restrictive measures administered, enacted or enforced by: (i) the United States government; (ii) the United Nations; (iii) the European Union; (iv) the United Kingdom; or (v) the respective governmental institutions and agencies of any of the foregoing, including,without limitation, the Office of Foreign Assets Control of the US Department of Treasury ("OFAC"), the United States Department of State, and Her Majesty's Treasury ("HMT") or (vi) RBI or any other Indian authority (together the
`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions Authorities"');

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Sanction Letter"', { continued: true })
   .font('Helvetica')
   .text(
      `means the sanction letter as mentioned in the Schedule, issued by the Lender and accepted by the Borrower regarding the sanction of the Facility, as may be amended, modified, varied and supplemented including, any subsequent sanction letter(s) issued by the Lender regarding the Facility from time to time;
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions List"',{continued: true })
   .font('Helvetica')
   .text(
      `means the "Specially Designated Nationals and Blocked Persons" list maintained by OFAC, the Consolidated List of Financial Sanctions Targets and the Investment Ban List maintained by HMT, or any similar list maintained by, or public announcement of Sanctions designation made by, any of the Sanctions Authorities.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Security"',{continued: true })
   .font('Helvetica')
   .text(
      `shall have the meaning ascribed to it under clause 8.1 of this Agreement.
`,
      { align: 'justify', indent: 40, lineGap: 5,  }
   )
   .font('Helvetica-Bold')
   .text('"Security Interest"',{continued: true })
   .font('Helvetica')
   .text(
      `means (i) any mortgage, charge (whether fixed or floating), pledge, lien, hypothecation, assignment, deed of trust, security interest or other Encumbrance of any kind securing, or conferring any priority of payment in respect of, any obligation of any Person, including without limitation any right granted by a transaction which, in legal terms, is not the granting of security but which has an economic or financial effect similar to the granting of security under Applicable Law, (ii) any voting agreement, interest, option, right of first offer, refusal or transfer restriction in favour of any Person, and/or (iii) any adverse claim as to title, possession or use;

`,
      { align: 'justify', indent: 40, lineGap: 5, }
   );

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Security Provider"', { continued: true })
   .font('Helvetica')
   .text(
      `means the Person(s) who provide(s) security in respect of the Facility, as more particularly described under the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Taxes"', { continued: true })
   .font('Helvetica')
   .text(
      `means any present or future tax, levy, duty or other charge of a similar nature (including any penalty or interest payable on Escrow Account or any failure to pay or delay in paying the same), now or hereafter imposed by law by any Governmental Authority.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Tenor"', { continued: true })
   .font('Helvetica')
   .text(
      `means the period specified in the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"GROW MONEY CAPITAL PVT LTD Reference Rate"', { continued: true })
   .font('Helvetica')
   .text(
      `shall mean the percentage rate of interest per annum decided by the Lender from time to time and announced/notified by the Lender as the GROW MONEY CAPITAL PVT LTD Reference Rate on its website or otherwise as the case may be.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )


// addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)

   .text('1.2 INTERPRETATION', { align: 'left' })

doc.font('Helvetica')
   .text(
      `In this Agreement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `
      (a) Unless the context otherwise requires reference to a Recital/Clause and/or a Schedule of this Agreement,
       all of which constitute an integral and operative part of this Agreement.
      (b) Headings to parts, clauses and paragraphs are for convenience only and do not affect the interpretation of
       this Agreement.
      (c) Reference to any statute or statutory provision or order or regulation made there under shall include
       references to that statutes, provision, order or regulation as amended, modified, re-enacted or replaced 
       from time to time whether before or after the date hereof.
      (d) Reference to any document includes an amendment to that document, but disregarding any amendment
       made in breach of this Agreement.
      (e) Reference to an “amendment” includes a supplement, modification, novation, replacement or
       re-enactmentand “amended” is to be construed accordingly.
      (f) Unless the context otherwise requires, words denoting the singular shall include the plural and vice
       versa, and words denoting any gender include all genders.
      (g) Reference to the word “include” or “including” shall be construed without limitation.
      (h) References to a “person” or “Person” shall include that Person’s successors in title, executors, permitted
       transferees and permitted assignees and references to a Person’s representatives shall be to its officers,\n employees, legal or other professional advisers, sub-contractors, agents, attorneys and other duly authorised \nrepresentatives.
      `,
      { align: 'justify', indent: 40, }
   );
   doc.font('Helvetica')
   .text(`(i) Words`,{indent: 40,continued:true})
   .font('Helvetica-Bold')
   .text(`"hereof", “herein”, “hereto”, “hereunder”` ,{ continued:true,align: 'justify', indent: 40, });
   doc.font('Helvetica')
   .text(` or similar terms used with reference to a specific clause\n in this Agreement shall refer to such clause in this Agreement and when used otherwise than\n in connection with specific clauses shall refer to this Agreement as a whole.
    ` ,{ align: 'justify', indent: 40, lineGap: 5 });
    doc.font('Helvetica')
   .text(`(j) In the computation of periods of time from a specified date to a later specified date, the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 });

    doc.font('Helvetica-Bold')
    .text(`"from" ` ,{ continued:true,align: 'justify', indent: 40, });
    doc.font('Helvetica')
    .text(` and ` ,{ align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on" ` ,{ continued:true,align: 'justify', indent: 40, })
    .font('Helvetica')
    .text(` mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"from and including" ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on and including”, respectively" ` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`, and the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`“to”, “until” ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`each mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"to but not including", "until but not including"` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on but not including"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` respectively ` ,{align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(k) Unless otherwise specified, whenever any payment to be made or action to be taken under this Agreement,\n is required to be made or taken on a day other than a Business Day, such payment shall be made,\n or action be taken on the\n immediately following Business Day.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(l) Where a wider construction is possible, the words` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"other” and “otherwise"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` shall not be construed ejusdem\n generis with any foregoing words.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(m) A time of day is a reference to India time.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica-Bold')
.fontSize(9)

   .text('2. THE FACILITY AND PURPOSE', { align: 'left' })

doc.font('Helvetica')
   .text(
      `The Borrower hereby agrees to borrow, and the Lender hereby agrees to lend the Facility to the Borrower, subject to the terms and conditions of the Financing Documents. The Borrower hereby confirms that it shall utilize the Facility only for the Purpose as mentioned in the Schedule. If in the opinion of the Lender (which opinion shall be binding and conclusive against the Borrower) the Facility is not used for the Purpose (provided that the Lender shall not be bound to enquire as to, or be responsible for, the use or application of any funds advanced under the Facility), the Lender shall have the right to declare it as an Event of Default.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
    // addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
   .fontSize(9)
   .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.1 Subject to the conditions mentioned in this Agreement, the Lender may, at its sole and absolute discretion,\n disburse the Facility or any part thereof as per disbursement request made by the Borrower to the Lender
       any time during the Tenor of Facility. The Borrower shall ensure the following before making any request 
       for the Disbursement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.text(
   `a) no actual/potential Event of Default has occurred, is in existence and/or is continuing;`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) all the representations and warranties are correct, complete and are in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) all Conditions Precedent have been fulfilled;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
    `d) post disbursal conditions with respect to the previous Disbursement/s have been met (if any);`,
    { indent: 60, align: 'justify', lineGap: 5 }
 )
 .text(
  `e) he Security has been validly created in form and substance acceptable to the Lender as per theterms of
      the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
)
.text(
  `f) he Borrower is in compliance with the terms and conditions of the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
);
 

   // Page 5: Continue with Disbursement and Conditions


// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.2 Not withs tanding any other provision hereof, the Lender, may at its sole discretion, cancel first or any 
      further/subsequent disbursement of the Facility if, in the reasonable opinion of the Lender:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) An Event of Default is likely to occur/has occurred/is continuing/threatened/which may result from
      such disbursement or if it becomes unlawful for the Lender to disburse or continue the Facility;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) Any representation and/or warranty is not correct, complete or is not in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) Any event has occurred/is continuing which has/could result in a material adverse effect or constitute 
       a Market Disruption Event; or`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) An Applicable Law restrains, prevents or imposes adverse conditions upon the transactions contemplated
       by the Financing Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );

// addFooter();

// // Page 6: Continue Disbursement and Conditions
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.3 The fulfilment or satisfaction of any Condition Precedent may be waived or deferred in writing by the
       Lender, at its sole discretion, following a written request from the Borrower setting out:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) the Condition Precedent in respect of which the Borrower seeks a waiver/deferment, and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) the reasons for seeking such waiver/deferment.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.4 The Borrower shall promptly give a written notice to the Lender, of the satisfaction of the Conditions Precedent
       along with documentary evidence of such satisfaction by issuance of a Conditions Precedent satisfaction
       notice and if it becomes aware of any event/circumstance which will/may prevent such 
       satisfaction, it shall forthwith notify the Lender in writing.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

// addFooter();

// // Page 7: Continue with Conditions Precedent and Facility Agreement
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica-Bold')
   .text(
      `3.5 Conditions Precedent`,
      { align: 'left', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica')
   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to them
      respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );
   

// addFooter();

// ---------------------------------------new page-----------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7)

doc.font('Helvetica')
.fontSize(9)

   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to
      them respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
      
   )
   .moveDown(1);
   

doc.font('Helvetica')
   .text(`3.5.1 The Borrower assures to the Lender that it (or in case the of under construction immovable property , the
seller/builder of such immovable property will transfer the marketable title in favour of Borrower by way
ofconveyance) has absolute, clear and marketable title to the immovable property including free from
Encumbrance, any liability, charge/lien or from any litigation/court decree whatsoever, to be mortgaged by
it as Security for the Facility and Lender is free to get the title of the immovable property checked/verified in
the manner it deems fit at the cost and risk of the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 })
.moveDown(1);




doc.font('Helvetica')
   .text(
      `3.5.2 The obligation of Lender to make any Disbursement under the Financing Documents shall also be subject to
       the following Conditions Precedent:.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `The Borrower acknowledges that the Facility is granted subject to the terms and conditions specified in 
       this Agreement and any subsequent amendments or supplements made in writing by the Lender.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1)
   .text(
    `(a) Borrower shall meet the minimum creditworthiness requirements as may be specified by Lender. For this
      purpose, the Borrower will provide all the information and assistance required by the Lender so that the
      Lender may conduct any inquiries, as deemed fit and proper in the Lender’s sole discretion, in this regard. .`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) No Event of Default has occurred or is likely to occur.`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) The Borrower shall have satisfied the Lender about the (i) utilisation of the proceeds of any prior
         disbursement and (ii) proposed utilization of the proceeds of the Disbursement after the sanction 
         of Facility,within the time frame specified by Lender, along with the request for release of part 
         of the funds needed by the Borrower for the Purpose..`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d) No extraordinary or other circumstances shall have occurred which shall make it improbable for 
        the Borrower to fulfill its obligations under the Financing Documents.`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)The Borrower/Security Provider shall prior to the disbursement of the Facility have executed all security
documents and created perfect Security including but not limited to registration of charge with the
concerned registrar of sub-assurances in the form and manner acceptable to the Lender and shall ensure
appropriate filing of charge, if any, along with proper stamp duty being paid on duly executed instruments of
Security.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) The Borrower shall satisfy the Lender to the effect that there is no action, suit, proceeding or investigation
pending or threatened by or against the Borrower, Guarantor or Security Provider, before any court of lawor
Governmental Authority or any other competent authority which might have material adverse effect on the
affairs of the Borrower or the Guarantor or Security Provider.`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `3.5.3 Not with standing anything contained herein, in case any disbursement has been made, the Borrower shall
continue to be under obligation to repay along with interests and costs, the entire amount so disbursed in
terms of the Financing Documents.`,
            { align: 'justify', indent: 40, lineGap: 5 });


// addFooter();

//-------------------------------------New page ------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
   .text(
      `3.5.4 The Borrower, whenever required by the Lender, shall provide the following, in a form and substance
satisfactory to the Lender:
`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   
   .moveDown(1)
   .text(
    `(a)  Evidence that all consents, resolutions, approvals, authorizations and permissions required for availing ofthe
Facility or for creation of Security in favour of the Lender have been obtained;.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) Certified true copies of the audited accounts of the Borrower;`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) Evidence that all compliance under the Companies Act, 2013 or any other law as maybe applicable to the
constitution of Borrower, has been adhered to;
`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d)  Evidence that all duly stamped Financing Documents shall have been properly stamped, executed and have
come into force as per their respective terms duly registered with the sub registrar of assurances or any
other competent authority, in favour of the Borrower and the necessary security can be created in favour of
Lender in the form and manner as acceptable to the Borrower;
`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)Evidence to show insurance cover on the Security has been obtained to the satisfaction of the Lender;.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) Evidence, as may be deemed necessary by Lender, including but not limited to an undertaking and indemnity
that the Facility or any part thereof shall be used only for Purpose as disclosed by the Borrower;
`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `(g) Such other documents as may be required by the Lender.`,
            { align: 'justify', indent: 40, lineGap: 5 })
            .moveDown()
            doc.text(
          `The Borrower also hereby agrees and undertakes to pay the complete stamp duty due on Financing Documents or any other document related thereto and in the event of any deficiency or default thereof, the Borrower shall indemnify and keep the Lender indemnified from and against any actual payment, losses and cost that the Lender has or may have incurred towards the same within `,
              { align: 'justify', indent: 40, lineGap: 5, continued: true }
           );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand. Borrower undertakes to regularize the documents, if required, by the respective courts or collector of stamps, by paying the actual difference in stamp duty and the amount of penalty as may be applicable. In the event, any litigation is initiated under this Agreement, Borrower agrees to indemnify the Lender from any actual and direct loss, cost, expenses that it may incur or suffer in defending the litigation within `,
                 { align: 'justify', indent: 40, lineGap: 5, continued: true }
              );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              );
              doc.moveDown();

              doc.font('Helvetica-Bold')
              .text('3.6 Amortisation', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `3.6.1 The Borrower will amortise the Facility strictly as stipulated in the Schedule, subject to any other changes in
such amortisation as communicated later in writing by Lender to the Borrower. However, in the event of
delay or advancement, for any reason whatsoever, in the disbursement of Facility, the Due Date of payment
of first Instalment shall in such case be the corresponding day of the following months to the day currently
stated in the Schedule.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `3.6.2 The Borrower shall also pay to Lender, the Pre-Instalment Interest as maybe applicable on the Facility under
the terms of this Agreement..`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `3.6.3 The Borrower agrees that the amount shall be remitted to Lender on each and every Due Date of the
Instalments. In the event of any dishonour of Payment Instrument, the Borrower agrees to pay a dishonour
charge as mentioned in the Sanction Letter, in addition to any Additional Interest that may be levied by
Lender as per its discretion`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           



    // addFooter();

    //-----------------new page-----------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica')
     .fontSize(9)
    .text(
      `3.6.4 In the event of any variation in the date of payment of Instalments/the amount of Interest, principal or
Instalments/the numbers thereof, the Borrower undertakes to forthwith issue fresh PDCs/ECS/such other
payment instruments as may be required by Lender`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `3.6.5 Notwithstanding anything herein, Lender shall always have the right to review and reschedule the
repayment terms of the Facility or of the outstanding amount thereof in such manner and to such extent as
Lender may decide. In such event/s the Borrower shall repay the Facility or the Outstanding Amount
thereof as per the revised Schedule as may be determined by Lender in its sole discretion`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `3.6.6 In case any amount is prepaid by the Borrower, unless otherwise decided by the Lender in its discretion, the
same shall be adjusted/appropriated towards the Pre-Instalment Interest, other applicable interest,
principal outstanding and the balance towards other charges under the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.moveDown();

doc.font('Helvetica-Bold')
              .text('4. INTEREST', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `4.1 The Borrower shall pay Interest to the Lender in respect of the principal amount of the Facility outstanding
from time to time, and on all fees, costs, commissions, Charges and other amounts due under or in respect of
this Agreement under the Facility at the Applicable Interest Rate. It is hereby clarified that the Lender may, in
its discretion among other alternatives, require the Borrower to pay upfront the Pre- Instalment Interest at
Applicable Interest Rate or the Pre-Instalment Interest may be deducted from the amount of the Facility
disbursed.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `4.2 Interest shall be payable at Applicable Interest Rate (or such other rate as may be notified by the Lender
from time to time) through such Payment Instruments and in the manner specified and at such intervals
specified under the Schedule.`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `4.3 The Applicable Interest Rate for the Facility provided on floating rate of interest shall be calculated with
reference to the GROW MONEY CAPITAL PVT LTD Reference Rate and shall comprise of GROW MONEY
CAPITAL PVT LTD Reference Rate plus margin (as may be agreed with the Lender from timeto time). It is
hereby clarified that the GROW MONEY CAPITAL PVT LTD Reference Rate and the Applicable Interest Rate
may fluctuate/vary from time to time or as may be determined by the Lender in its absolute discretion.`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           doc.font('Helvetica-Bold')
           .text(
            `4.4 In the event of default on the part of the Borrower in the payment of any sum due hereunder, in any
manner whatsoever or the Borrower committing any breach or default of any condition of this
Agreement or Financing Document, the Borrower shall pay to the Lender, Additional Interest at the
Additional Interest Rate which will be calculated on a daily basis over and above the Applicable
Interest Rate to be charged on the overdue Installment(s). Such interest shall be payable on and from
the date of default to and including the date on which such delay or defaultis rectified (“Additional
Interest”). The Lender’s right to claim such Additional Interest shall be without prejudice and in
addition to the Lender’s right to take any other action available to it under the terms of this
Agreement or at law in respect of such event of default.`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );

         doc.font('Helvetica')
           .text(
            `4.5 In the event of revision of Applicable Interest Rate, the Lender shall notify the same to Borrower, such
notification shall form a part of this Agreement. In the event the Borrower does not agree to such revision,the
Borrower shall forthwith repay the Outstanding Amount within 30 (thirty) days from the date of intimation.
In case if such repayment is not forthcoming within the said period, the Borrower shall be liableto service the
Facility in accordance with the revised interest rate`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );



    // addFooter();
//-------------------new page--------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `4.6 The Borrower acknowledges that any sums, interest, default amount including but not limited to
(i) the Prepayment Charges and (ii) the Additional Interest, are reasonable and that they represent
genuine pre-estimates of the loss which would be incurred by the Lender in the event of nonpayment or 
default by the Borrower in accordance with the Financing Documents. The Borrower waives any right it 
may have to raise any claim/defence in this regard.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `4.7 Interest, Additional Interest and all other charges shall accrue from day to day on the actual number
of days elapsed and shall be calculated on an actual day count basis, i.e., actual number of days
elapsed divided by the actual number of days in the year`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica')
 .text(
  `4.8 The Borrower confirms, agrees and acknowledges that it has perused and understood the Lender’s method
of calculating the Applicable Interest Rate and further agrees and undertakes to abide by the same without
any demur/objection.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `4.9 The Borrower acknowledges that the Facility provided under this Agreement is for a commercial transaction
and the Borrower waives any defences available under usury or other laws relating to the charging of
interest.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

// point 5

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5. DISBURSEMENT`,
      { align: 'left' }
   );
   doc.moveDown();
   doc.font('Helvetica')
   .text(
    `The Facility can be disbursed by the Lender in one or more tranches in its sole and absolute discretion,
subject to the terms contained in the Sanction Letter and this Agreement. The Disbursement can be doneby
the Lender either in favour of/in the bank account of the Borrower or in favour of/in the bank account ofsuch
person/entity who/which is specified by the Borrower in its request for Disbursement to the Lender.
Nothing contained herein shall be deemed to be a guarantee or an assurance on behalf of the Lender
regarding Disbursement of the Facility.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.1 Schedule of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
 .text(
  `Subject to fulfilment of the Conditions Precedent and at the Lender’s discretion, the Facility shall be
disbursed in single or in multiple tranches as more specifically detailed in the Sanction Letter.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.2 Mode of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
.text(
  `All payments to be made by the Lender to the Borrower under this Agreement shall be deposited in the bank
account which is maintained by the Borrower which maybe specified in the disbursement request, by way of
Real Time Gross Settlement (RTGS)/Cheque/s duly crossed and marked “A/c Payee Only” or such other
manner as specified by the Lender in the Schedule and the collection charges, if any, in respect of 
RTGS/cheque(s) and/or such other instruments as specified in the Schedule will have to be borne by the
Borrower. The Interest on the Facility will begin to accrue in favour of the Lender from the date on which the
Disbursement is done by the Lender by way of making/issuance of the RTGS/cheque(s) and/or such other
instruments as specified in the Schedule irrespective of the time taken for transit or for collection/realization
thereof. Without prejudice to anything contained herein, if necessitated by prevailing circumstances, the
Lender shall be at liberty to use any other method or mode for disbursement underthis Agreement and if the
same is not rejected by Borrower, then such disbursement shall be deemed to be accepted disbursement and
have same effect as any other Disbursement under the Agreement.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//------------------------new page-------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.3 Other Charges`,
      { align: 'left' }
   )
   
   .text(
    `The Borrower shall, on or before the date of the first drawdown/disbursal of the Facility, pay to the
Lender the Charges as specified by the Lender from time to time. The Borrower hereby agrees that
any amount outstanding from his/her/its any other loan/facility with the Lender may be, deducted
and/or adjusted from amount disbursed or held with Lender under this Agreement.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 ).moveDown();

 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `6. REPAYMENT / PREPAYMENT
`,
      { align: 'left' }
   ).moveDown();
 doc.font('Helvetica')
 .text(
  `6.1 Except as otherwise agreed by the Lender, the Borrower shall repay the amounts under the Facility
outstanding from time to time on each and every Due Date in an amount equal to the Instalment as specified
in the Repayment Schedule provided that:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `a) The Facility shall be repaid in full by the final repayment date as specified in the Repayment Schedule 
  through such payment instruments as specified in the Schedule;`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `b) The Lender shall be entitled to demand immediate repayment of the entire amount of the Facility
outstanding if any portion of the principal amount of the Facility or any interest due thereon is not paid as
and when it is due to be paid; and`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `c) The Borrower shall repay the principal amount of the Facility along with interest & costs under the
Agreement free from and clear of any deduction and/or set off on any account whether by operation of law or
otherwise and if any such deductions are required by operation of law or otherwise, then same shall be
entirely borne by the Borrower. It is hereby clarified that in case the Borrower has been sanctioned multiple
facilities, there will not be any setoff without the prior written consent of the Lender.`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown()
.text(
  `6.2 The Borrower shall be solely responsible to timely pay all costs, Charges and expenses of the Lender
promptly as and when required to do so by the Lender and the Lender shall be under no obligation to
provide the Borrower with any notice, reminder or other intimation to the Borrower regarding its obligation
to pay the same.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica-Bold')
.text(
  `6.3 The Borrower may become entitled to prepay the Facility through such Payment Instruments as
specified in the Schedule only with the prior written consent of the Lender (extent of which may or
may not be granted by the Lender). If acceptable to Lender, then any prepayment shall be done only
after the expiry of such period as maybe specified in this regard under the Sanction Letter, by giving
not less than 7 (seven) days’ notice to the Lender and provided that any such prepayment shall be
made subject to payment of any prepayment costs (“Prepayment Charges”) as specified herein or in
Sanction Letter. The Lender shall provide to the Borrower a Prepayment Statement and the Borrower
shall prepay the whole or any part of the Facility strictly in accordance with the Prepayment
Statement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.text(
  `6.4 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility, the Lender shall promptly
notify the Borrower upon becoming aware of that event and the Lender shall be at liberty to not make any
further advancement of amount under Facility and it shall be entitled to call in the entire Outstanding
Amounts forthwith and the Borrower shall on such date as the Lender may specify, without demur or dispute
whatsoever, repay the Outstanding Amount owing to the Lender in respect of the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//--------------new page-------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `7. INCREASED COSTS`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `If, by reason of (i) any change in law or in its interpretation or administration and/or (ii) compliance with
any request/requirement of RBI or any other authority, which request/requirement affects the manner in
which the Lender is required to or does maintain capital resources or reserves having regard to Lender’s
obligations hereunder and to amounts owing to it hereunder, the Lender:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `(a) incurs a cost as a result of Lender having entered into/complying with and/or performing
   its obligations under this Agreement; or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(b) becomes liable to make any payment on account of tax or otherwise (not being a tax imposed on
the net income of the Lender) on or calculated by reference to the Facility sanctioned or to be
sanctioned by the Lender hereunder and/or to any sum received or receivable by it hereunder,
then the Borrower shall, from time to time on demand of the Lender, promptly pay to the Lender
amounts sufficient to indemnify the Lender against, as the case may be (1) all such costs as above,
( 2) such reduction in such rate of return (or such proportion of such reduction as is, in the
opinion of the Lender, attributable to its obligations hereunder), 
(3) such increased cost (or such proportion of such increased cost as is, in the opinion of the Lender,
 attributable to its funding or maintaining an advance hereunder) or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(4) such liability. The Lender shall also be entitled to recover such increased cost, reduction in rate of return
and any such liability incurred by the Lender by deducting an amount equivalent to the same from the
subsequent disbursal or drawdown to be made to the Borrower.
`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `8. SECURITY`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `8.1 In consideration of the Lender making available the Facility and to secure the repayment of the Outstanding
Amounts, the Borrower agrees that the Security Interest shall be created in favour of the Lender in the form
and manner satisfactory to the Lender on the asset/s as more specifically mentioned in the Schedule of the
Agreement     `,
  { align: 'justify', indent: 40, lineGap: 5,continued:true }
)
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `            (“Security”).`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.text(
  `8.2 The Borrower hereby agrees that it shall, at all times during the Tenor of the Facility, ensure that the Security
provided by the Borrower or Security Provider (other than Borrower) under this Agreement is of such value
as is sufficient to meet the security cover requirements of the Lender as specified in the Schedule. In the
event either the value of the Security deteriorates and/or the Lender advances further sum(s) to the
Borrower under this Agreement such that the value of the Security provided by the Borrower under this
Agreement does not meet the security margin requirements of the Lender, then the Borrower shall deposit
with the Lender, additional security in the form of cash or such other securities as are acceptable to the
Lender, failing which the Lender may at its discretion sell, dispose of, or realise any or all of the Security
without being liable for any loss or damage or diminution in value of the Security.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `8.3 The Security, if any created/to be created by the Borrower/Security Provider in favour of the Lender shall be
released by the Lender on complete payment of the Outstanding Amounts and/or any other outstanding
dues of the Borrower/s (whether a Borrower or a Guarantor) to any of its affiliates or group companies.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);


// addFooter();

//-----------------------------new page-------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
    .text(
      `9. CO-LENDING ARRANGEMENT`,
      { align: 'left' }
    ).moveDown();
    doc.font('Helvetica')
   .text(
      `9.1 Without prejudice to anything contained in this Agreement, the Lender reserves the right to enter into a co-
      lending arrangement    `,
      { align: 'justify', indent: 45, lineGap: 5, continued: true }
   );

doc.font('Helvetica-Bold')
   .text(
      `              ("Arrangement")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      ` in pursuance to and subject to applicable guidelines/circular`,
      { align: 'justify', indent: 40, lineGap: 5 })

       
      .text(`/notification issued by the RBI, from time to time, with anyone of the banks or financial institutions of 
        its choice with which the Lender has entered into a formal agreement for co-lending of the Facility(ies)        `,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.font('Helvetica-Bold')
   .text(
      ` ("Bank or Lender 2")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      `, therefore whole or a part of the disbursed Facility amount might be taken over by the 
        concerned bank in its books as per the agreed terms of Arrangement by and between Lender and Bank.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `9.2 If Bank and Lender enters into an Arrangement with respect to Facility under this Agreement then
subsequent to Bank taking its share of Facility amount in its books, the Bank for all technical, legal and
operational purposes shall become a co-creditor of the Borrower in form of a co-lending partner of Lender.
The Borrower is aware about the possibility of Arrangement taking place between Lender and Bank. It is
clarified that subject to the terms of the Arrangement all the duties, obligations, rights, benefits and
entitlements of Lender as contained in this Agreement or other Financing Documents, in addition to Lender,
shall also inure to benefit of the Bank, and the extent, manner and form of exercising such duties,obligations,
rights, benefits and entitlements of Bank shall depend upon the understanding between the Lender and Bank
as maybe contained in the Arrangement. The Borrower also has acknowledged all the other probable
implications of such co-lending arrangement on the Facility provided herein and Borrower’s responsibilities
thereof.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   .text(
    `9.3 If the Lender enters into an Arrangement with Bank, then the right to take recovery/legal action or initiate
appropriate legal proceedings against the Borrower on the default by the Borrower under this Agreement or
other Financing Documents and all the remedies available can be exercised jointly or severally by the Lender
and/or Bank, or by the Lender on behalf of the Bank or vice-versa depending upon the terms of Arrangement.
The remedies available to the Lender and Bank under the law, this Agreement or equity shall be in addition to
each other or cumulative. The manner, form and time of exercising the rights or remedies will be as per the
discretion the Lender and/or Bank (as the case maybe).`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )

 .text(
  `9.4 The Borrower unconditionally accepts and acknowledges that it shall abide/comply by/with the instructions
which might be issued by the Lender with respect to the Facility upon Arrangement taking place between
Lender and Bank. The Borrower also unconditionally accepts and acknowledges that Lender may
change/modify any of the terms contained in Schedule I appended hereto by way of an intimation through a
letter or a notice thereof and the Borrower shall duly comply with such letter or notice without any delay or
demur.`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `9. CO-LENDING ARRANGEMENT`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `The Borrower undertakes to make payments of all the amount payable to Lender under the Financing
Documents into the Designated Account of the Lender, however, without prejudice to the aforementioned,the
Lender reserves the right to make Borrower enter into an escrow mechanism for such payments and to which
Borrower agrees to as under:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

    


// addFooter();

//-------------------new page----------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `10.1 The Borrower can be required to open, establish and maintain the Escrow Account during the entire or part
of Tenor of the Facility with the Account Bank as per terms of this Agreement and/or the Escrow Agreement
or just make the payments of Outstanding Amounts into the Escrow Account, as maybe directed by the
Lender`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.2 If opened, Escrow Account shall not be closed without the prior written approval of the Lender. All costs,
Charges, expenses, fees in connection with the Escrow Account shall be borne by the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.3 If required by the Lender, the Borrower shall deposit/transfer all Receivables in the Escrow Account at the
end of the day of receipt of the Receivables`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.4 Subject to the Applicable Law, the Lender shall be the joint signatory in the Escrow Account as per the
Escrow Agreement until the Facility is fully repaid. In the Event of Default and subject to Applicable Law, the
Lender and/or Bank shall become entitled to create charge (by way of lien or otherwise) over the bank
account of Borrower as linked with Escrow Account and utilize the proceeds thereof towards Outstanding
Amounts or any in any other manner as Lender may deem fit.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.6 Provided that nothing contained herein or under any other document/s regarding the Arrangement with the
Bank shall be applicable if the Lender does not formally enter into Arrangement with the Bank, in which case
the Borrower shall continue to discharge all its obligations contained in this Agreement or other Financing
Documents, in favour of the Lender alone and the Facility shall be deemed to be provided by a single entity,
i.e., Lender. Unless the details of Bank are specifically mentioned herein or intimated to Borrower through a
separate letter or notice, the Borrower shall always presume that the Lender has not entered into an
Arrangement regarding the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `11. CANCELLATION`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `Notwithstanding anything contrary contained in this Agreement:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `11.1 The Borrower agrees that the Lender shall at any and all time, during the currency of the Facility have an
unconditional right to terminate and/or cancel the un-utilized or un-disbursed portion of the Facility
(whether in part or in full) at its sole discretion as well as withdraw and/or recall the disbursed Facility or
any part thereof on the occurrence of any actual/potential Event of Default whereupon, forthwith all
Outstanding Amounts under the Facility shall immediately become due and payable by the Borrower to the
Lender. Provided, no notice will be given by the Lender to the Borrower, where an Event of Default has
already been declared.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).text(
  `11.2 The Borrower agrees that the Facility shall be repaid upon the happening of a Market Disruption Event and
the Lender can, at any time, at its sole and absolute discretion, terminate, cancel, withdraw or recall the
Facility or any part thereof without any liability and without any obligation to give any reasons whatsoever,
whereupon all Outstanding Amounts under the Facility shall immediately become due and payable by the
Borrower to the Lender forthwith upon demand made by the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


    // addFooter();

    //------------------------new page---------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12. BORROWER’S REPRESENTATIONS AND COVENANTS`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `12.1 Representations`,
{ align: 'left' }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `12.1.1 The Borrower hereby agrees and represents that for so long as any of the Outstanding Amounts are 
  dueand payable, the Borrower shall ensure and confirm that:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

.text(
  `(i) It is duly organised and validly existing under law and has the requisite legal power and authority to execute
this Agreement and carry out the terms, conditions and provisions hereof and the performanc e by the
Borrower of this Agreement does not and will not violate any Applicable Law, its constitutional documents,
any judgment, order, decree, writ or Governmental Approval or any agreement to which the Borrower is a
party or by which it is bound or any consents, Governmental Approvals or waivers, as the case may be, of any
Person required to give effect to and complete the transactions contemplated hereunder;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ii) The Borrower is carrying out or conducting the Business and shall continue to do so as per Applicable Law
and it will, at all times, comply with and abide by all Applicable Laws;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(iii) The execution, delivery and performance hereof have been duly authorized by all necessary Government
Approvals, permissions, corporate action, consents, etc. under the laws applicable to the Borrower, and the
individual executing this Agreement and other ancillary documents is duly authorized and duty-boundto do
so and other ancillary actions and the agreement so executed and delivered would be legally binding on the
Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) The Borrower and authorized Persons of the Borrower executing this Agreement and other ancillary
documents, confirm that all the representations and warranties made by the Borrower thereunder and all
other Financing Documents and all the information provided to the Lender are true and correct and such
authorized Persons, as the case may be, have checked the correctness of such representations and
warranties;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(v) The Borrower has not taken any action, nor have any steps been taken or legal proceedings of any manner
been initiated or threatened against or notice been received by the Borrower for its incompetency to enter
into a contract, winding-up, dissolution, administration, re-organisation, insolvency, bankruptcy,
appointment of receiver, administrator or other court officer of the Borrower or all of any of its assets,
businesses or undertakings or for the appointment of any provisional liquidator or any interim resolution
professional or resolution professional in terms of the Code;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(vi) There is no restriction, action, suit, proceeding or investigation pending and/or continuing or to the
knowledge of the Borrower threatened by or against the Borrower or the property of the Borrower or its
partners, directors, key managerial personnel, subsidiaries or group companies before any court of law,
Government Authority or other competent authority on account of any due and payable Taxes or other sums
or any other matter which may have a material effect on the affairs of the Borrower, or which may call into
question the validity, enforceability or performance by the Borrower of any or all terms of this Agreement
nor has any of the aforementioned, any knowledge of any existing ground on which any claim, investigation
or proceeding might be commenced;`,
{ align: 'justify', indent: 50, lineGap: 5 }
);



    // addFooter();

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(vii) The Borrower has obtained all Governmental Approvals for availing of the Facility, and creating the Security
and will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(viii) No actual/potential Event of Default has occurred and/or is in existence or continuing;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ix) All factual and other information provided to the Lender are true and accurate as at a date no earlier thanthe
date on which it was provided;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(x) The Borrower will promptly inform the Lender about any litigation, dispute, or any proposal by aregulatory
body to acquire the Security, or any of it;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xi) The Borrower at any time has not received any notice or intimation regarding insolvency proceedings
initiated against it or it being incompetent to enter into a contract;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xii) No proceeding is pending and/or initiated and/or threatened against the Borrower for or on account of any
Taxes or any other sums, which may be due and payable by the Borrower to the Government of India or to
any State Government or Government Agency;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xiii) Neither the Borrower nor any of its Security Assets is entitled to immunity from suit, execution, attachment
or other legal process initiated by Lender. This Agreement and the other Financing Documents constitutes,
and the exercise of its rights and performance of and compliance with its obligations in relation thereto, will
constitute, private and commercial acts done and performed for privateand commercial purposes; perfectly
binding on the Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xiv) There is no circumstance in existence, or which is likely to come into existence, which may affect the
enforceability of the Security or transferability of the Security Assets pursuant to enforcement of the
Security;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xv) The audited annual accounts of the Borrower for the year(s) as may be specified by the Lender, have been
prepared as per the applicable accounting principles/standards in force consistently applied and give, in
conjunction with the notes thereto, a true and fair view of the financial condition and position of the
Borrower during the financial year then ended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvi) There has been no material adverse change in the financial condition of the Borrower, nor has any event,
which is/may be prejudicial to the interest of the Lender and/or which is likely to materially and/or
adversely affect the Borrower/Lender to perform all or any of its obligations hereunder, taken place or in the
Borrower’s estimation, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvii) There are no charges, or liens of whatsoever nature against any of the Borrower’s/Security Provider’s
assets charged and/or agreed to be charged in favour of the Lender;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) No facts, circumstances or events, materially detrimental to the borrowing, the ability of the Borrower to
meet its obligations hereunder and/or in respect of the Facility, and/or the financial condition of the
Borrower, and/or the ability of the Lender to exercise its rights hereunder and/or under the documents
creating the Security and/or to receive due Repayment and payment of the amounts due by the Borrower
under the Facility, has occurred or, in the estimation of the Borrower, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xix) The Borrower/Security Provider has the interest, right, title or ownership over the assets comprising the
Security and such assets are free from any existing or potential encumbrances; In Event of Default underthis
Agreement, the Lender will be able to enforce such Security without any hinderance or objection fromany
person (whether individual/s or body corporate) including the Borrower or its associated.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();


    //new

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xx) Never have the name of the Borrower nor any of Borrower’s directors/associate/partner or key managerial
persons or Guarantor or Security Provider has never appeared in the willful defaulters’ list, orany other list
of defaulters published by competent authorities from time to time;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxi) The Borrower will, at all times, comply with and abide by all Applicable Laws and directions, regulations,
circulars and instructions notified or issued by the concerned regulator from time to time including but not
limited to all labour welfare related and environment protection statutes and provisions. All the
environmental authorisations/permissions required under the Environmental Protection Act 1986 and
other environmental laws in India as applicable in relation to the business and operations of the Borrower
have been obtained and maintained in full force and effect and nothing has occurred or will occur in
future, which might cause such environmental authorization/permission to be revoked, suspended or
amended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxii) The Borrower shall comply with, and shall conduct its business operations, and maintain its assets,
equipment, property, leaseholds, and other facilities in compliance with all Applicable laws relating to the
environment, labour laws and health and safety measures. The Borrower shall maintain all required
approvals relating to: (i) air emissions; (ii) discharge of surface water or ground water; (iii) noise emissions;
(iv) solid or liquid waste disposal; (v) the use, generation, storage, transportation, or disposal of toxic or
hazardous substances or wastes; and (vi) other environmental, health, or safety matters.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxiii) The Borrower shall comply with and shall conduct its business operations as per all the labour laws
applicable in India including but not limited to The Minimum Wages Act, 1948, The Factories Act, 1948, The
Industrial Disputes Act, 1947, The Child Labour (Prohibition and Regulation) Act, 1986 as amended from time
to time. Borrower also represents that it will ensure strict adherence to all the labour laws and implement the
policies as per the rules/guidelines/instructions issued by the governmental authorities therein.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxiv) The Borrower agrees and confirms that , neither the Borrower or Guarantor, and none of their subsidiaries
and, to the knowledge of senior management of each Borrower or Guarantor, none of its affiliates and none
of its respective officers, directors, brokers or agents, acting in their capacity on behalf of such Borrower or
Guarantor or such subsidiary or affiliate (i) has violated or is in violation of or shall violate any applicable
anti-money laundering law; (ii) has engaged or engages in any transaction, investment, undertaking or
activity that conceals the identity, source or destination of the proceeds from any category of offenses
designated in any applicable law; (iii) is a Restricted Party; or has received notice of or is aware of any action
or investigation against it with respect to any Sanctions by any Sanctions Authority; (iv) directly or indirectly
violated applicable anti-corruption laws or made, undertaken, offered to make, promised to make or
authorized the payment or giving of a prohibited payment; (v) used funds or other assets, or made any
promise or undertaking in such regard, for the establishment or maintenance of a secret or unrecorded fund;
or (vi) made any false or fictitious entries inany books or records of the Borrower, Guarantor or any member
of the affiliates relating to any prohibited payment with respect to the transactions contemplated by this
Agreement or the other Financing Documents.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

// addFooter();
//--------------------------------------------new page--------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `(xxv) The Borrower and/or Security Provider will not seek to claim or recover from the Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of the Lender in respect of the Security, taken
or omitted by the Lender in terms hereof and/or pursuant hereto and/or to protect any of its interests and
rights as the lender or a creditor, and the Borrower and/or Security Provider hereby expressly waives any
right to seek or make any such claim or recovery on any grounds whatsoever;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxvi) The Borrower herby acknowledges to maintain a sufficient security cover of such proportion of the amount
financed by the Lender, as specified in the Schedule hereunder during the Tenor or term of the Facility;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxvii) The Borrower herby confirms that the fair value of the assets of the Borrower exceeds all of its aggregate
liabilities whether under this Agreement or under any other agreement or any business arrangement (ii) the
Borrower has the ability to meet all of its obligations as they mature under any business arrangementor any
agreement; and (iii) the Borrower has sufficient capital to carry on its business.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxviii) The Borrower confirms that all insurances coverage, in relation to the assets of the Borrower or security
provider (other than Borrower) [ including immovable property(ies)/plant and machinery /stocks] which
have been provided to the Lender as Security, have been obtained, and are in full force and effect and it has
complied with all its obligations under the respective insurance contracts including payment of regular
insurance premium thereon, and no event or circumstance has occurred nor has there been any omission to
disclose a fact which in any such case would entitle any insurer to avoid or otherwise reduce its liability
thereunder compared to the amount provided in the relevant policy and insurance coverage provided by
such insurance;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxix) Borrower and/or Security Provider has obtained all Governmental Approvals for creating the Security and
will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxx) The execution and delivery of the security agreement and documents to be executed in pursuance hereof,
 in favour of the Lender, and the performance of the Borrower and/or Security Provider’s obligations
thereunder does not and will not (i) contravene any Applicable Law, statute or regulation or any judgment or
decree to which the Borrower and/or Security Provider and/or its assets, businesses and/or undertakings is
subject, (ii) conflict with or result in any breach of, any of the terms of or constitutedefault of any covenants,
conditions and stipulations under any existing agreement or contract or binding to which the Borrower
and/or Security Provider is a party or subject, or (iii) conflict or contravene any provision of the
memorandum and the articles of association and/or any constituting/governing documents of the Borrower
and/or Security Provider;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxxi) The Borrower will not utilize the Facility for any activity other than the Purpose as mentioned in the
Schedule hereunder and that the Security will not be charged or Encumbered in favor of any other
bank/financial institution`,
{ align: 'justify', indent: 50, lineGap: 5 }
);


    // addFooter();

    //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12.2 Covenants and Undertakings`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `A. Affirmative Covenants`,
{ align: 'left',indent: 43, }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `The Borrower hereby agrees and undertakes to the Lender and represents that for so long as any of 
 the Outstanding Amounts are due and payable, the Borrower shall:`,
{ align: 'justify', indent: 41, lineGap: 5 }
)
.text(
  `(i) Allow representative(s) and/or nominee(s) (including agent, investor, financier and any authorized
personnel of the Lender) of the Lender to enter into the premises of the Borrower in order to inspect and
audit the property, books of account and other relevant accounts, documents and records of the Borrower
provided to the Lender for the obligations of the Borrower hereunder, and the Borrower shall fully
facilitate/co-operate in this regard by making its personnel and such information/documents available during
such inspection or audit and the costs incurred thereby shall be borne by the Borrower:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(ii) Execute in favour of the Lender and/or its nominee(s) such further documents, forms and/or papers as the
Lender may in its absolute discretion require in connection with the Facility`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iii) Completely repay the Facility and Interest and costs thereon and all monies owing to Lender hereunder,
according to the terms of this Agreement and comply with any further instruction as maybe issued by the
Lender from time to time in this regard;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) Promptly notify the Lender of any change in the Borrower’s address, phone number, employer name, email
address;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(v) Provide to the Lender all the documents and information as may be requested by the Lender from time to
time in terms of the Know Your Customer (“KYC”) guidelines issued under any applicable laws or by any
regulator/government authorities and keep the same updated at all times during the validity of the Financing
Documents;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(vi) Promptly inform the Lender of any occurrence, event or incident of which it becomes aware which might
adversely affect the Borrower or affect its ability to pay any amount when due or to perform its obligations
under this Agreement and/or in respect of the Facility;
(vii) Promptly inform the Lender of any material deviation or change in any other information submitted by the
Borrower to the Lender at any time before or after entering into this Agreement;
(viii) Pay regularly all taxes, assessments, dues, duties, levies and impositions as may, from time to time, be 
payable to any Governmental Authority;
(ix) Immediately notify Lender upon becoming aware of any actual/potential Event of Default.
(x) Furnish such other documents and/or information as may be required by the Lender.
(xi) At its own cost and expense keep all immovable property(ies)/plant and machinery/stocks of the Borroweror
Security Provider (other than Borrower) which have been provided to the Lender as Security in respect of the
obligations of the Borrower under this Agreement fully insured against such risks, and for such amount(s)
and for such period and in such form(s) as the Lender may from time to time require, either in the joint names
of the Lender and the Borrower, or with the Lender named as loss payee therein, with such reputable
insurer(s) as the Lender shall approve in writing. The Borrower shall deposit with the Lender all such
insurances along with any cover notes and receipts evidencing payment of premia etc.
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

    //next
     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xii) In relation to such insurances as are required to be maintained pursuant to this Agreement, the Borrower
shall make punctual payment of all premia to be paid in relation to such insurances and shall not do or suffer
to be done any act which may invalidate such insurance.
(xiii) In the event the Borrower becomes entitled to make any claims under the above insurances, promptly 
make a claim under such insurances, and apply all monies received either in reinstatement of the property
-(ies)/plantand machinery/stocks insured or towards repayment of the Outstanding Amounts.
(xiv) If the Borrower fails to insure and/or keep insured any of the [property(ies)/plant and machinery/stocks]
provided to the Lender as Security the Lender shall, without prejudice to its rights and liabilities under this
Agreement or at law, be at liberty to insure and keep insured any of the above [property(ies)/plant and
machinery/stocks] and the Borrower shall on demand repay the Lender all fees, costs, commissions and
Charges incurred by the Lender in doing so.
(xv) Promptly inform the Lender about any occurrence, event, incident, litigation, arbitration, investigative,
regulatory or administrative proceeding/action having a material adverse effect on the condition, assets,
operations, prospects or business of the Borrower, its ability to perform and comply with its obligations in
respect of the Facility, the validity, legality or enforceability of, or the rights or remedies of the Lender under
this Agreement or any other document in relation to the Facility and the validity, legality or enforceability of
the Security or on the priority or ranking of the Security.
(xvi) Deliver to the Lender as soon as the same becomes available:
(a) but in any event within 30 (thirty) after the end of each of its financial years, its audited financial
statements for that financial year;
(b) but in any event within 30 (thirty) after the end of each half of each of its financial years, its unaudited
financial statements for that financial half year; and
(c) any other statement or statements or information pertaining to the operations of the Borrower as the
Lender may reasonably require, within such period as required by the Lender.
(xvii) Maintain adequate and proper books, accounts and records in accordance with generally
accepted/applicable accounting principles, standards and practices, consistently applied;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) Perform, on Lender’s request, acts necessary to carry out the intent of this Agreement.
(xix) Promptly inform the Lender of any distress or other process of court being taken against any of the
Borrower’s premises/assets;
(xx) Promptly inform the Lender of any change taking place in the ownership or control of the Borrower
whereby the effective beneficial ownership or control of the Borrower will materially change;
(xxi) Without prejudice to the Borrower’s obligations hereunder, it shall furnish to the Lender:
(a) within six months after the close of each of the Borrower’s fiscal year or such other period as reasonably
required by the Lender, a copy of the annual report of the Borrower, certified by a chartered accountant of
recognized standing, acceptable to the Lender together with financial statement consisting of a balance sheet
and profit and loss account as of the end of such fiscal year;
(b) any other publicly available information and statements respecting the financial condition and operations of
the Borrower as the Lender may from time to time reasonably request.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`(xxii) Comply and shall cause each other Security Provider to comply in all material respects with all applicable
anti-money laundering laws and shall not engage in any transaction, investment, undertaking or activity that
conceals the identity, source or destination of the proceeds from any category of offenses designated in any
applicable law.
(xxiii) Comply with all Conditions Precedent as stated in Clause 3.5 and the Schedule.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`B. Negative Covenants`,
{ align: 'left',indent: 45, }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) For so long as any of the Outstanding Amounts are unpaid, the Borrower shall not change in its constitution
or management without the prior written consent of the Lender and shall not:
`,
{ align: 'justify', indent: 45, lineGap: 5 }
)
.text(
  `(i) Create or permit to subsist any encumbrance or charge over all or any of the charged assets of the Borrower
or take any action which may materially impact the ability of the Borrower to pay any amount when due or
to perform its obligations under this Agreement and/or in respect of the Facility;
(ii) Effect any merger, amalgamation, reconstruction or consolidation or effect any material change in the
management/ownership of the Borrower;
(iii) Stand as surety for anybody or guarantee the repayment of any loan or overdraft or the purchase price of
assets.
(iv) Change its existing accounting methods or policies followed by it as on the date of execution of this
Agreement, during the currency of Facility unless otherwise required in terms of the prevailing Applicable
Law or change in Applicable Law;
(v) In case the Borrower is a Company;
i. Declare or pay dividends in respect of any financial year if an Event of Default has occurred or is
continuing or in case there is an asset liability mismatch in the books of the Borrower;
ii. make any amendments to the ‘objects’ clause in its memorandum or make any changes into its
constitutional documents.`,
  { align: 'justify', indent: 50, lineGap: 5 }
  )
  .text(
    `(b) For so long as any of the Outstanding Amounts are still outstanding, Borrower shall not utilise the
Facility for:`,
    { align: 'justify', indent: 45, lineGap: 5 }
    )
    .text(
      `a) Investments in any company/entity by way of shares, debentures, etc
b) Subscribing to Initial Public Offerings (IPOs) and for purchase of shares from secondary market.`,
      { align: 'justify', indent: 50, lineGap: 5 }
      ).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13. EVENT OF DEFAULT`,
{ align: 'left',indent: 45, }
).moveDown();
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13.1 Event of Default`,
{ align: 'left',indent: 45, }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)
.text(
`An event of default means the occurrence of any of the events specified in this Clause (‘Event ofDefault’)
as below:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `13.1.1 The Borrower fails to make payment of the Outstanding Amounts on the Due Dates in relation to the
Facility;`,
  { align: 'justify', indent: 50, lineGap: 5 }
  ).text(
    `13.1.2 If any event has occurred which in Lender’s opinion dilutes or jeopardizes the Security provided to the
Lender:`,
    { align: 'justify', indent: 50, lineGap: 5 }
    ).text(
      `13.1.3 Breach of any of the covenants mentioned in clause 12 on the part of the Borrower to observe or 
complywith any of the terms and conditions of this Agreement or any other Financing Document;`,
      { align: 'justify', indent: 50, lineGap: 5 }
      )





    // addFooter();

    //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.4 If there is any material breach of trust and willful default or breach of any other obligation under this
Agreement or any other Financing Documents including notice for insolvency;
13.1.5 If the Borrower defaults/threatens to default, in discharging his liability, under any other agreement or 
other writing between the Borrower and the Lender or any agreement entered into by the Borrower with the
Lender, its subsidiaries and affiliates, or under any other agreement or writing of indebtedness of the
Borrower, or under any other agreement with the other creditors or in the performance of any covenant,
term or undertaking thereunder, or any indebtedness of the Borrower not being paid when due or any
creditor of the Borrower becoming entitled to declare any indebtedness due and payable prior to the dateon
which it would otherwise have become due or any guarantee or indemnity or collateral given or other
support agreement entered into by the Borrower not being honored when due and called upon;
13.1.6 Any fraud and/or misrepresentation by the Borrower or any misleading statement made as to any
representation or warranties, or any other material statement made in this Agreement or any suppressionor
concealment of any material fact/essential information by the Borrower;
13.1.7 If any Governmental Authority has condemned, nationalized, seized or otherwise expropriated the 
assetsthat form Security or any substantial assets/property of the Borrower;
13.1.8 Any step is taken, or proceedings started for Borrower’s dissolution under the Code, or winding-up or for 
the appointment of a receiver, judicial manager, trustee or similar officer for the Borrower in any manner
whatsoever;
13.1.9 Initiation of the creditors process/any arrangement with any creditors with respect to the Borrower;
13.1.10 A receiver is appointed over the whole or any part of the property of the Borrower;
13.1.11 The Borrower ceases to carry on its Business or change its object clause of the memorandum of 
association without prior consent of the Lender;
13.1.12 If it has become unlawful for the Borrower to carry on its Business;
13.1.13 If there is any failure on the part of the Borrower to pay on any judgment or court order unless pending
appeal;
13.1.14 In case in the opinion of the Lender, there has been a material adverse change in any of the Borrower’
business or financial condition, such as:
a) if it is certified by a firm of accountants appointed by the Lender (which the Lender is entitled and hereby
authorised to so appoint at any time) that the liabilities of any of the Borrower exceed their respective assets
or that Borrower is carrying on its business at a loss;
b) sale or curtailment or closure of Borrowers’ business;
c) adverse action by any regulatory authority;
d) action by any class of stakeholders which is likely to significantly impair any of the Borrowers’ business; and
e) any other event which in the opinion of the Lender is likely to have an adverse effect on the business or
business environment of the Borrower.
13.1.15 Any material litigation or proceedings instituted against the Borrower including proceedings for crime
involving moral turpitude;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);





      





    addFooter();

     //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.16 There occurs any event or situation, (including happening of an event which in the opinion of the 
Lender is a force majeure event) such as and including but not limited to any material adverse change as 
determined solely by the Lender in the business or financial or other condition or operations or prospects
 of the Borrower, which in the sole opinion of the Lender is prejudicial to the interests of the Lender or 
is likely to materially affect the financial condition of the Borrower and/or its ability to perform all or 
any of its obligations under this Agreement and/or otherwise in respect of the Facility and to comply with 
any of the terms of this Agreement and/or for the Facility;
13.1.17 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility;
13.1.18 There is any material change in the ownership or management of the Borrower which in the sole 
opinion of Lender would prejudicially affect the interest of Lender;
13.1.19 The Borrower repudiates this Agreement or does or causes to be done any act or thing evidencing an
intention to repudiate this Agreement or non-performance of its obligation under this Agreement (whether
voluntary or involuntary);
13.1.20 Any document for creation of the Security in favour of the Lender is not in full force and effect or does 
not create in favour of the Lender, the Security which it expresses to create with the ranking and priority it is
expressed to have, including the due compliance of the requirements of security perfection including but not
limited to registration of charge with the concerned registrar of sub-assurances, within such period as
contemplated under this Agreement or otherwise allowed by the Lender, in its sole discretion and/or
 nonsubmission of any of the documents referred to in the Schedule hereto or the occurrence of any act or
circumstances which could, in the sole determination of the Lender, jeopardize, in any way, the Security;
13.1.21 If there is any deterioration or impairment of the Security or any part thereof or any decline or 
depreciation in the value or market price thereof (whether actual or reasonably anticipated), which causes 
the Security or any part thereof, in the judgment of the Lender to become unsatisfactory as to character or 
value;
13.1.22 If the property over which Security is created in favour of the Lender or any part there of is sold 
or disposed of, let out, given on leave or licence, pledged, hypothecated, transferred in any manner, charged 
in any manner whatsoever, Encumbered or otherwise alienated or if any third-party interest is created therein 
in any manner;
13.1.23 The Borrower misuses the Facility or any part thereof, or uses the Facility or any part thereof for any 
purpose other than the Purpose;
13.1.24 Any of the promoters/directors or persons holding key management positions (i.e., managing director/
chief executive officer and/or directors) of the Borrower is declared as willful defaulter in RBI List of 
willful defaulters or any other list of defaulters published by competent authorities from time to time.;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();

        //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.25 Any of the promoters and/or the directors of the Borrower are accused of, charged with, arrested or
convicted in a criminal offence involving moral turpitude, dishonesty, bribery or which otherwise impinges
on the integrity of such promoter and/or director, including any accusations, material charges and/or
convictions of any offence relating to bribery; or
13.1.26 Any force majeure event or an event not in the control of Borrower, for example, riot, war, act of terror,
earthquake, flood, fire, industrial disputes, strike or any events of similar nature occur.
13.1.27 If the Borrower fails to inform the Lender of any actual/potential Event of Default;
13.1.28 In the event there is a commencement of any action under any RBI guidelines, circulars, directions, etc. 
with respect to the Borrower or any of its subsidiaries or holding company;
13.1.29 If the Borrower fails to comply with the Applicable laws including the regulations, directions, circulars and
prudential norms notified by the concerned Regulator.
13.1.30 Any other event occurs which in the sole opinion of the Lender is likely to adversely affect the ability of 
the Borrower to perform its obligations under this Agreement.`,
{ align: 'justify', indent: 45, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2 Consequences of Events of Default`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`13.2.1 Upon the occurrence of an Event of Default as set out in clause 13.1, the Lender shall have the right 
and shall take any or all of the following actions:
(a) To cancel any outstanding commitments and/or recall the Facility;
(b) To require the Borrower to mandatorily Repay the principal amount on the Facility, along with accrued but 
unpaid interest, prepayment penalty and other costs, Charges and expenses incurred under or in connection with
this Agreement and other Financing Documents and other Outstanding Amounts;
(c) To declare all or any part of the Outstanding Amounts to be immediately (or on such dates as the Lendermay
specify) due and payable and ensure due payment thereof;
(d) To commence legal proceedings to recover such sum, the Borrower will further pay the Lender all advances,
Charges, cost and expenses, including all legal fees, incurred or paid by the Lender in exercising any right,
power or remedy conferred by this Agreement, (and/ or in the enforcement thereof) and all such amounts
shall become a part of the indebtedness secured hereunder and shall be paid to the Lender by the Borrower
immediately and without demand.
(e) To enforce the Security and/or additional security pertaining to the Facility, including but not limited to the
substitution of the Borrower/ sale of the land/ properties.
(f) Appoint a nominee director on the board of the Borrower;
(g) Exercise any other rights that Lender may have under the Financing Documents or under Applicable Law;
(h) Utilise and appropriate any amount lying or credited in the accounts of the Borrower, for
payment/repayment of Outstanding Amount, as due and payable till the date of such Event of Default;
(i) Transfer or appropriate the Security by sale or otherwise as the Lender may deem fit, to any other Person
and utilize any surplus realized from such transfer towards the fulfilment of all the obligations of Borrower
under the Financing Documents and may pay the surplus (if any) to the Borrower, after the satisfaction of
obligations of the Borrower;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2.2 Cross Collateralization`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower hereby undertakes and confirms that the Borrower shall execute any and all security
documents as may be required by the Lender to ensure that any Security(ies) furnished by the Borrower,
pursuant to any other credit facility granted by the Lender, its group companies, its affiliates to the Borrower
shall be extended as a Security(ies) towards the Facility extended under this Agreement. Further, the
Borrower also agrees to execute such security documents as may be required by the Lender to extend the
security(ies) offered in respect of this Facility towards other loan(s)/facility( ies) availed/to be availed by the
Borrower from the Lender or any of its group companies.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`14. ASSIGNMENT`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`14.1 The Borrower shall not transfer or assign any of its rights or liabilities under this Agreement to any other
person or entity without the prior written consent of the Lender.
14.2 The Borrower agrees that notwithstanding anything to the contrary contained in any document executed
under or in relation to this Agreement, the Lender shall have the right to (in full or in part) assign, transfer,
novate and/or otherwise securitize its rights or obligations under this Agreement and the other Financing
Documents and/or the Outstanding Amounts and/or enter into indemnity or other arrangements for risk
sharing, whether with or without recourse to the Lender, to one or more bank/s, financial institution/s or any
other entity including any trust or association whether located/placed in India or outside India as permitted
under the Applicable Law without any reference or notice to the Borrower. However, the Borrower shall not
claim any privity of contract with any such entity to whom the outstanding and/or the rights or obligations
under this Agreement or the other documents in relation to the Facility have been assigned/transferred
/novated/securitized or with whom the Lender has entered into indemnity or arrangements for risk sharing.
14.3 The Borrower agrees that the Lender (or any nominee of the Lender) may retain the Security Interest created
on the Security pursuant to the Security documents (or any part thereof) in trust and for the benefit of such
assignee (and upon part assignment of the Facility, in trust and for the benefit of both the Lender and such
assignee on a pari passu basis), without requiring any consent of or notice or making any reference to the
Borrower or the Sponsor. Upon any such transfer or assignment as contemplated herein, such assignee and
the Lender, as the case may be, will be entitled to take any action, including recovery and enforcement of the
Lender’ rights hereunder, in its own name without making the Lender or the assignee, as the case may be, a
party thereto.
14.4 Without prejudice to the right of the Lender to proceed against the Borrower under Applicable Law for
recovery of Outstanding Amounts, the Borrower hereby gives consent that the Lender will be entitled, subject
to Applicable Law, to recover the dues, assign the debt and/or securities and/or initiate proceedings under
the provisions of the SARFAESI Act and/or Code and/or any other Applicable Law and the Borrower agrees to
pay the Lender all cost, charges and expenses incurred in connection thereto.
14.5 The Borrower irrevocably and unconditionally confirms that it shall continue to be bound by the terms of
this Agreement and the other documents in relation to the Facility notwithstanding such transfer or
assignment by the Lender, further the Borrower shall duly comply with the instructions in respect of the
Facility as maybe issued by the Lender upon such transfer or assignment by the Lender.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


    // addFooter();


    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15. COST, CHARGES, EXPENSES AND STAMP DUTY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`15.1 The Borrower shall bear and promptly pay the following:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) an upfront non-refundable processing fee as mentioned in the Sanction Letter and statutory levies thereon,
but subject to deduction of TDS as per Applicable Law, as processing fee to the Lender for the purpose of
processing the Facility. The processing fee shall be paid at the time of disbursement of the Facility itself for
which purpose, the Borrower hereby authorizes the Lender to adjust the processing fee from the proceeds of
the disbursement. The processing fee is non-refundable fee and independent of disbursement/cancellation
of the Facility by the Borrower;
(b) all fees for the services performed by Lender, all out of pocket and travelling expenses and other costs,
Charges and expenses in any way incurred by Lender, its officers, employees or agents in connection with
the negotiation, preparation, execution, delivery, administration, waiver, modification or amendment of or
the preservation, protection or release of the rights of the Lender on exercise of any rights, remedies or
powers granted hereunder or any documents or instruments contemplated or in connection with or relating
to these presents including, without limitation, costs of investigation of title;
(c) all legal fees for drafting and stamping of this Agreement and all other Financing Documents, costs, Charges
and expenses of the external legal counsel of the Lender and all such sums incurred or paid by the Lender in
connection with and incidental to or in connection with these presents and incurred in connection with the
enforcement of any rights hereunder or under any of the Financing Documents or for payment of any
additional stamp duty or penalties in relation to the stamp duty under any Financing Documents including
any cost incurred in the assertion or defence of the rights of Lender as such for, andfor the benefit of the
Lender for the protection and preservation of whole or any part of the Security and for the demand,
realization and recovery of the Outstanding Amounts which shall be added to the Outstanding Amounts and
be secured hereby; and
(d) all stamp duty, Taxes, Charges and penalties on any Financing Documents if and when the Borrower may be
required to pay the same according to the Applicable Law.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `15.2 The Borrower agrees to indemnify and keep the Lender indemnified at all times against any and all loss,
costs, Charges, expenses and liabilities including penalties with respect to or resulting from delay or
omissions to pay any such stamp, registration and similar taxes or Charges. Such stamp, registration and
similar taxes or Charges (if not paid or reimbursed by the Borrower) shall be deemed to be the amounts
outstanding under the Facility.
15.3 The Borrower shall pay all stamp duty charges and other similar taxes payable in respect of this Agreement
and other Financing Documents and indemnify the Lender against any cost, loss or liability that the
Lender may suffer, pay or incur by reason of or in connection with all stamp duty charges and other similar
taxes payable in respect of this Agreement or any other Financing Documents
  `,
  { align: 'justify', indent: 40, lineGap: 5 }
  );


    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15.4 If the Borrower fails in defraying the costs, expenses, Charges, duties or fees referred to above as
and when required, the Lender may (but is not obligated to) make such payments on behalf of the
Borrower. All such payments made by the Lender shall be for the account of the Borrower and the
Borrower undertakes promptly on demand, to reimburse the Lender or its authorized agents,
representatives, successors and assignees for any such monies so paid, together with the interest
thereon at the rate of the Additional Interest over the Applicable Interest Rate until the date such
amounts are actually reimbursed by the Borrower. All such costs and expenses shall be part of the
‘Outstanding Amounts’ and shall be a charge upon the Security in priority to the charge
securing the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `16. INDEMNITY`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();

  doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower shall, without prejudice to any other right of Lender, indemnify and keep indemnified and hold
harmless Lender against any cost, loss, obligations, damages, penalties, actions, judgments, suits, expenses,
liability or disbursements of any kind or nature whatsoever (including legal fees, disbursements to lawyers
and out of pocket expenses), which may be imposed on, incurred by or asserted against the Lender (or its
directors, employees and agents) in any claim, litigation, proceeding or investigation instituted or conducted
by any governmental agency or instrumentality or any person or entity, and which are related directly or
indirectly to this Agreement or Financing Documents or any document executed pursuant hereto, whether
Lender is a party thereto, and shall pay and reimburse to Lender, without any dispute or demure any losses,
costs, charges or expenses which Lender, shall certify as sustained or suffered or incurred by Lender as a
result of:

(i) the occurrence of an Event of Default, or any other breach of obligations by the Borrower under, Financing
Documents and/or this Agreement or otherwise in connection with this Agreement (including any interest or
fees incurred in funding any unpaid sum) or otherwise on account of the Facility;
(ii) the Lender investigating any event which it believes is an Event of Default;

The Borrower shall within 5 (five) Business Days of demand of the above, make good such payment to Lender
accordingly. For avoidance of doubt, Lender shall not be required to risk its own funds or otherwise incur
any financial liability in the performance of any of its duties hereunder or in the exercise ofany of its rights or
powers under this Agreement. The Borrower will not seek to claim or recover from Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of Lender hereunder and/or in respect of the
Facility, taken or omitted by Lender, in terms hereof and/or pursuant hereto and/or to protect any of its
interests and rights as Lender and the Borrower hereby expressly waives any right to seek or make any such
claim or recovery on any ground whatsoever.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
)





    // addFooter();
//=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`17. TAXES`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`17.1 If the Borrower is required by Lender, or under any of the law to make any deduction or withholding towards,
for or in respect of any tax, the Borrower must:
(a) pay to the Lender any additional amount as may be necessary to ensure that the Lender receives the
full amount of the relevant payment as if that deduction or withholding had not been made; and
(b) supply promptly to the Lender evidence satisfactory to the Lender that it has accounted to the relevant
Governmental Authority for the withholding or deduction.
Provided that in case the Borrower provides a certificate, within the statutory timelines, evidencing payment
of withholding taxes in relation to any payments made to the Lender, it shall not be requiredto gross up
the payments as provided under this clause 17.1.
17.2 The Borrower shall during the Tenor bear all interest tax as may be applicable or as may be levied bya
Governmental Authority in relation to any Interest or other sum paid by the Borrower to the Lender under
the Facility. If the Lender is required to make any payment on account of any interest tax in relation to
Interest or other sum received or receivable by the Lender hereunder, then the Interest or sum payable by
the Borrower shall be increased to the extent necessary to ensure that after making such payment, the
Lender receives and retains a sum equal to the sum which it would have received and retained had no
such payment or deduction been made or required to be made.
17.3 If the Borrower is required to make any deduction for or on account of any interest tax (other than statutory
deduction of taxes at source) in relation to any Interest or other sum payable to the Lender hereunder, then,
in such case, the sum payable to the Lender shall be increased to the extent necessary to ensure that, after
making such deduction the Lender receives and retains (without any liability for such deduction) a sum
equal to the sum which it would have received and retained had no such deduction been made or required to
be made.
17.4 If there is, at any time, any incidence of any indirect taxes on the Lender directly connected and/or
attributable to the Facility, the Lender shall notify the Borrower of such incidence of tax and shall be entitled
to pass on such incidence to the Borrower. The Borrower shall make payment of such taxes without demur,
protest or cavil. Notwithstanding the above, if the Lender makes payment of any such indirect tax, the
Lender shall, be entitled to be reimbursed for the same by the Borrower.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`18. CONSTITUTED ATTORNEY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.1 The Borrower hereby agrees and appoints or cause to appoint the Lender and its officers, employees and
agents and authorised representatives to be its duly constituted attorneys for all or any of the following
purposes, upon the occurrence of an Event of Default, namely:
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(a) to sign all papers, documents agreements indentures and writings that the Borrower would be
bound to do under or in pursuance of these presents and / or the Facility and/or the Security for
and behalf of the Borrower and to attend before the Sub-Registrar of Assurancesor any other
relevant authority and admit execution thereof;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()





    // addFooter();

    //=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(b) Generally to do perform and/or execute or cause to be done performed or executed all acts deeds
matters things and documents in all matters arising under or out of or concerning or touching these
presents as the Borrower could itself do perform or execute;
(c) And for the better and more effectually doing effecting and performing the several matters and
things including as aforesaid, and to appoint from time to time or generally such other Persons,
bodies, companies, organizations, or agencies as the Lender may think fit as its substitute or
substitutes to do execute and perform all or any such acts and things as aforesaid and such
substitute or substitutes at pleasure to remove and to appoint other or others in his or their place;
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.2 The Borrower agrees that the above powers may be exercised without any prior notice to the Borrower
and further agrees to ratify and confirm all that the Lender or any substitute or substitutes appointed by the
Lender may lawfully do or cause to be done in exercise of the aforesaid powers.
18.3 The Borrower further agrees to give all assistance to the Lender and its officers authorised representatives
and other substitutes for the purpose of exercising any of the powers hereinabove set out, including
endorsing of documents, signing of papers and doing all such things as may be necessary to enable the Lender
and its officers and other substitutes to exercise all the powers hereby conferred.
18.4 The Borrower further agrees that the aforesaid powers have been granted for valuable consideration and as
such shall be irrevocable in nature till such time as any amounts remain due owing or payable under or in
respect of or in pursuance of the Facility and/or these presents.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`19. GOVERNING LAW AND JURISDICTION`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`This Agreement and all documents executed under/in relation to this Agreement shall be governed by the laws of
India. Any disputes arising under/in relation to this Agreement shall be subject to the exclusive jurisdiction
of the competent courts situated in New Delhi. However, this shall not limit the rights of the Lender to take
proceedings in any other court of competent jurisdiction of its choice.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`20. MISCELLANEOUS`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `20.1 Notices`,
  { align: 'left', indent: 40, lineGap: 5 }
  );

  doc.font('Helvetica')
    .fontSize(9)


.text(
`Any notices to be provided by each Party shall be in writing, signed by an authorised officer, and shall be sent
by post, letter or email to such address, email id or number as mentioned below or to such other contact
details as may be notified by the Parties from time to time. Notices shall be deemed to have beendelivered on
the earlier of the actual date of delivery or 7 (seven) Business Days following dispatch.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Borrower:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


  doc.font('Helvetica')
    .fontSize(9)


.text(
`As mentioned in the Schedule
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Lender:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


doc.font('Helvetica')
.fontSize(9)
.text(
   `Address: 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI 110001`,
   { align: 'justify', indent: 40, lineGap: 5 }
);

doc.text(
`Email: `,
{ continued: true, indent: 40 }
)
.font('Helvetica-Bold')
.fillColor('blue')
.text(
   `support@growmoneycapital.com`,
   {
      link: 'mailto:support@growmoneycapital.com', // This makes the email clickable
      underline: true, // Optional: to visually indicate it's a link
   }
)
.fillColor('black'); // Reset the color to black for further text
// .moveDown();

    // addFooter();


//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);



doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`(The Borrower agrees that all instructions and/or correspondence sent by the Borrower to the Lender
are sent at the Borrower’s risk, and the Lender does not assume any responsibility for anyinaccuracy,
interruption, error, delay or failure in transmission or delivery whether sent by post, telegraph,
cable, telex or any other form of written or electronic communication.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.2 Any provision of this Agreement, which is prohibited or unenforceable in any jurisdiction shall, as to such
jurisdiction, be ineffective only to the extent of prohibition or unenforceability and it shall not invalidate the
remaining provisions of this Agreement or affect such provision in any other jurisdiction.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.3 Disclosure`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.3.1 The Borrower hereby agrees as a pre-condition of the Facility given to the Borrower by the Lender that, in
case the Borrower commits default in the Repayment of the Facility in accordance with or in the paymentof
Interest thereon on date(s) specified in Repayment Schedule , the Lender and/or the Reserve Bank of India
will have an unqualified right to disclose or publish the Borrower’s name as defaulter in such manner and
through such medium as the Lender or Reserve Bank of India in their absolute discretion may think fit.
Accordingly, the Lender shall have the right to furnish and publish the name of the Borroweras defaulter to
the public at large and Reserve Bank of India or other regulatory authority. Notwithstanding above the
Borrower hereby accept and confirm that as a pre-condition to the grant of the credit facility by the Lender
to the Borrower including, the Facility the Lender, requires consent of the Borrower to make certain
disclosures in relation to the Borrower including information and data relating to the Borrower and any
credit facility availed of or to be availed of by the Borrower, obligations assumed or to be assumed by the
Borrower in relation thereto and default, if any, committed by the Borrower in discharge thereof.
Accordingly, the Borrower hereby agrees and gives consent to the disclosure by the Lender of all or any such
information and data relating to the Borrower:
(a) in relation to any credit facilities including, the Facility availed of or to be availed of by the Borrower from
the Lender and the Borrower’s obligations in any credit facility granted/to be granted, by the Lender, for the
purposes of credit reference checks, verification, etc; and
(b) in case of default, if any, committed by the Borrower in discharge of any of his obligations, or any other
information that the Lender may deem appropriate and necessary, to disclose and furnish to RBI, any Credit
Information Agency and/or any other agency authorized in this behalf by the RBI or any other regulatory
authority.

20.3.2 The Borrower undertakes and declares that the information and data furnished by the Borrower to the
Lender is/shall be true and correct and any Credit Information Agency and/or any other authorized agency
may use, process the said information and data disclosed by the Lender as deemed fit by them and may
furnish for consideration such processed information/data/products to banks/financial institutions and
other entities as maybe specified by RBI.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// addFooter();

//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)
.text(`20.3.3 The Borrower and the Guarantor hereby give specific consent to the Lender for disclosing/submitting the
‘financial information’ as defined in Section 3 (13) of the Code read with the relevant regulations/ rules
framed under the Code, as amended from time to time in respect of the Facility availed from the Lender, from
time to time, to any ‘Information Utility’ (“IU”) as defined in Section 3 (21) of the Code, in accordance with the
relevant regulations framed under the Code, and directions issued by RBI from time to time and hereby
specifically agree to promptly authenticate the financial information submitted by the Lenders, as and when
requested by the concerned IU.

20.3.4 The Borrower hereby consents to the Lender, its officers and agents disclosing information relating to the
Borrower and its current bank account or Escrow Account, account(s) and/or dealing relationship(s) with
the Lender, including but not limited to details of its facilities, any security taken, transactions undertaken
and balances and positions with the Lender, to:

(i) the head office of the Lender, any of its subsidiaries or subsidiaries of its holding company, affiliates,
representative and branch offices in any jurisdiction (together with the Lender, the “Permitted Parties”);
(ii) professional advisers and service providers of the Permitted Parties who are under a duty of
confidentiality to the Permitted Parties;
(iii) any actual or potential assignee, novatee, transferee participant or sub-participant in relation to any of the
Lender’s rights and/or obligations under any agreement (or any agent or adviser of any of the foregoing);
(iv) any rating agency, insurer or insurance broker of, or direct or indirect provider of credit protection to any
Permitted Party; and
(v) any court or tribunal or regulatory, supervisory, governmental or quasi-Governmental Authority with
jurisdiction over the Permitted Parties
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.4 Lender’s records to be accepted by Borrower`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The records maintained by the Lender in its ordinary course of business shall be the final proof for the due
amounts from the Borrower in respect of the Facility under this Agreement. A certificate in writing signed by
an officer of the Lender or a system generated electronic certificate stating the Outstanding Amount from the
Borrower in respect of the Facility at any particular time shall be conclusive evidence against the Borrower
in respect of payments due from the Borrower in respect of the Facility`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.5 Engagement of third parties`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower expressly recognizes and accepts that the Lender shall, without prejudice to its right to
perform such activities itself or through its officers or employees, be entitled and has full power and
authority to appoint one or more third parties as Lender may select and to delegate to such third party all or
any of its functions, rights and powers under this Agreement relating to administration of Facility including
right and authority to collect and receive on behalf of the Lender from the Borrower any payments and other
amounts due by the Borrower under this Agreement and to perform and execute all lawful acts, deeds
matters and things connected therewith and incidental thereto. For the aforesaid purpose, Lender shall be
entitled to disclose to any such third parties all necessary and relevant information pertaining to the
`,
{ align: 'justify', indent: 40, lineGap: 5 }
);






    // addFooter();

    //=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)


.text(
`Borrower and the Facility and the Borrower hereby consents to such disclosure by the Lender.
Notwithstanding above, in the event of Borrower committing any act of default and/or occurrence of any
Event of Default, the Borrower expressly accepts and authorizes Lender to contact any third parties as
Lender may select and disclose all necessary and relevant information pertaining to the Borrower and the
Facility.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.6 Waiver`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The Borrower confirms that no delay of the Lender in exercising or not exercising any right, power or
remedy accruing/available to the Lender on Borrower’s default or otherwise under this Agreement or any
other Financing Documents shall impair or prejudice such right, power or remedy or shall be construed asits
waiver or acquiescence. The Borrower further confirms that any single or partial exercise of any right, power
or remedy by the Lender shall not preclude further exercise thereof. Every right and remedy of the Lender
shall continue in full force until the Lender specifically waives it by a written instrument`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.7 Liens; Right of Set Off`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The rights, powers and remedies given to the Lender by this Agreement shall be in addition to all rights
powers and remedies given to the Lender by virtue of any other Security, statute, or rule of law or equity. The
Lender may exercise a banker’s lien or right of set- off with respect to any obligation of the Borrower as if the
obligation were unsecured and shall have a lien on all property or securities of the Borrower in the Lender’s
possession or custody whether for safe-keeping or otherwise. Without prejudice to what is stated
hereinabove, the Borrower hereby expressly agrees and confirms that in the event of the Borrower failing to
completely pay/repay the Outstanding Amounts under the Facility, in addition to any general or specific lien
to which the Lender may be entitled by Applicable Law, the Lender shall, without prejudice to any of its
specific rights under this Agreement, be at liberty to apply any other money or amounts standingto the credit
of the Borrower in any account with the Lender in or towards repayment of the Outstanding Amounts under
the Facility, without notice to the Borrower, on happening of any Event of Default or if upon demand by the
Lender the said Dues are not repaid within the prescribed time. In case of any deficit, the deficit amount may
be recovered by the Lender from the Borrower. The joint account holder/s to such monies, securities,
deposits and other assets is/are aware of, and have no objection to (a) the Facility applied for, (b) the Facility
terms, (c) using such monies from the joint accounts for paying/Repaying the Facility and all other amounts
due to the Lender, and (d) the Lender’s rights of setoff in the event of their default of the Facility terms: It
shall be the Borrower’s sole responsibility and liability to settle all disputes/objections with such joint
account holders, if so required, and the Lender shallbe well within its rights to exercise the right of set off
against any money lying in any account/deposit/bond/other assets held singly or jointly, for settlement of
dues.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.8 Sanction Letter`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The terms of the Sanction Letter shall form part of this Agreement and shall be in addition to and be read in
conjunction with the terms of this Agreement. If there are any inconsistencies between the terms of the
Sanction Letter and this Agreement then, the terms of Sanction Letter shall prevail to the extent of
inconsistency.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.9 Entire Agreement`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
// about the subject matter, comprised within the Financing Documents and shall replace all previous
// agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
// representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
// the Financing Documents.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();






    // addFooter();

    //-------------------------------new page---------------------------
    doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.9 Entire Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
about the subject matter, comprised within the Financing Documents and shall replace all previous
agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
the Financing Documents.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.10 Survival ofRights`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The provisions of Clause 16 (Indemnity), Clause 20.1 (Notices), Clause 20.15 (Dispute Resolution) Clause 19
(Governing Law and Jurisdiction) and this Clause 20.10 (Survival of Rights) and other clauses which by their
nature are intended to survive, shall survive termination or expiry of this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.11 Benefits:`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The terms and provisions of this Agreement shall be binding upon, and the benefits & obligations hereof shall
inure or pass on to the Lender's successors and assigns, and Borrower's successors and permitted assigns (if
appointed after permission of Lender, and as the case maybe), who in absence of Borrower will be required
to fulfil each and every requirement or obligation as maybe required by Lender from time to time or as
detailed under this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.12 Liability of Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`In the event of there being more than one Borrower (Co-Borrower), the liability of each Co-Borrower
hereunder shall be co-extensive as that of Borrower’s liability. Each of the Co-Borrowers shall be having same
and equal extent of liabilities as that of other Borrower under this Agreement and in the Event of Default, the
liabilities of all the Borrowers and Co-Borrower shall be cumulative towards the Lender and the Lender at its
discretion may proceed against any or all of the Borrower or Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.13 Acceptance`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees and acknowledges that this entire Agreement, duly filled in
schedules/annexures/letters/undertakings hereto, Sanction Letter and other documents relating to Facility
have been explained to the Borrower in the language understood by it, and it has understood the entire
meaning of the aforementioned and shall be bound by all the conditions mentioned therein. Any act of
acceptance of the terms contained herein or token thereof (including acceptance through facsimile or
electronic transmission) by the Borrower (in a manner acceptable to the Lender) may be considered as due
and proper execution of this Agreement on the part of the Borrower.

20.14 The Borrower hereby represents and warrants the genuineness of the signatures of the authorised
signatories of the Borrower, or each of the Borrowers in the event of there being more than one Borrower,
as the case may be.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.15 Dispute Resolution`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
// after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
// used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
// Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
// the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
// arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
// Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
// shall be conducted preferably through online means or otherwise through conventional means in English
// language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
// conducted through conventional means) shall be at Delhi.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();

// addFooter();

  //-------------------------------new page---------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

  doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.15 Dispute Resolution`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

  doc.font('Helvetica')
.fontSize(9)


.text(
`All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
shall be conducted preferably through online means or otherwise through conventional means in English
language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
conducted through conventional means) shall be at Delhi.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
  doc.font('Helvetica-Bold')
  .fontSize(9)
  
  
  .text(
  `20.16 Counterparts`,
  { align: 'justify', indent: 40, lineGap: 5 }
  );
  
  doc.font('Helvetica')
  .fontSize(9)
  .text(`The Agreement may be executed in any number of counterparts, each of which (without variation) shall
constitute an original and all of which together shall constitute one and the same instrument. Delivery of an
executed counterpart of the signature page to this Agreement by facsimile shall be as effective as delivery of
a manually executed counterpart of this Agreement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();
  


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.17 Status of the Loan Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees that its obligations hereunder are absolute and unconditional and shall not be affected
by any circumstance (including any right of set-off or counterclaim), which otherwise might, prior to the
satisfaction of those obligations, operate to release or constitute a discharge or other-wise exonerate the
Borrower from its obligations hereunder or affect such obligations, with the intent that the Borrower’s
obligations under this Agreement shall remain at all times in full force and effect until payment of the
amounts due under this Agreement have been made in full and all obligations of the Borrower under this
Agreement have been fully discharged to the satisfaction of the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();







    // addFooter();




//-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();


  
    // Title styling for OFFER LETTER in uppercase and underlined
    doc.moveDown(6);
    const yPosition = doc.y; // Get the current y position
  
    doc
      .fontSize(7)
      .font(fontBold)
      .text("Schedule", { align: "center" })
      .moveDown(1)
      .text("(Forming part & parcel of Agreement)", { align: "center" })
      .moveDown(1)
      .text(` DATED :${allPerameters.agreementdate} \n\n Place of Agreement : Indore \n\n Location of the Lender’s Office/Branch : Indore` , { align: "left" })
    
    doc.moveDown(4);

    doc
    .fontSize(9)
    .font('Helvetica-Bold')
    .text("Borrower(s) Details", { align: "left" })
    .moveDown(0.5)
    // Add a function to draw black table borders
    function drawTable(tableData) {
        const startX = 50;
        let startY = doc.y + 10;
        const columnWidths = [500]; // Total width for the table
        const keyWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for field names
        const valueWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for values
        
        // Function to draw a block for borrower details
        function drawBorrowerBlock(borrowerData) {
            borrowerData.forEach((row, rowIndex) => {
                let valueRowHeight = 20; // Set height for each row
    
                // Check if it's a special row like "Borrower/Security Provider Details" or "Guarantor"
                if (row.field1 === "Borrower/Security Provider Details" || row.field1 === "Guarantor") {
                    // Draw a full-width row (horizontal lines only)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth + valueWidth, valueRowHeight) // Full-width
                        .strokeColor("black")
                        .lineWidth(0.5)
                        .moveTo(startX, startY) // Top horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw text across the full width
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth + valueWidth // Full width for text
                        });
                } else {
                    // Draw field background (for regular fields like 'Name', 'Residence Address', etc.)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX, startY) // Top horizontal line for field name
                        .lineTo(startX + keyWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line for field name
                        .lineTo(startX + keyWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw field name (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth
                        });
    
                    // Draw value background (half-width for value)
                    doc.fillColor("#ffffff")
                        .rect(startX + keyWidth, startY, valueWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX + keyWidth, startY) // Top horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX + keyWidth, startY + valueRowHeight) // Bottom horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw value text (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.value1 || "", startX + keyWidth + 5, startY + 5, {
                            baseline: "hanging",
                            width: valueWidth
                        });
                }
    
                // Move to next row
                startY += valueRowHeight;
            });
    
            // Add spacing after each borrower block
            startY += 10;
        }
    
        // Filter and group data for each borrower block
        const borrowerBlocks = [];
        let currentBlock = [];
    
        tableData.forEach(row => {
            if (row.field1.includes("Borrower/Security Provider Details") || row.field1 === "Guarantor") {
                if (currentBlock.length > 0) {
                    borrowerBlocks.push(currentBlock);
                }
                currentBlock = [];
            }
            currentBlock.push(row);
        });
    
        if (currentBlock.length > 0) {
            borrowerBlocks.push(currentBlock);
        }
    
        // Draw each borrower block
        borrowerBlocks.forEach(borrowerData => {
            drawBorrowerBlock(borrowerData);
        });
    }
    
    const loanTableData = [
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.customerName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.address}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.registeredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.corporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.emailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.constitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.identityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.typeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.securityProvider}` },
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.coApplicantName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddress}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.coEmailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.coConstitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProvider}` },
    ];
    
    // Call the drawTable function to generate the table
    drawTable(loanTableData);
    // doc.moveDown(2);
  
    // addFooter();
    
   
  //---------------------------------------- new page 2--------------------------------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);
  
  const secondPageTable = [
    { field1: "Borrower/Security Provider Details" },
    { field1: "a) Name", value1: `${allPerameters.coApplicantNameTwo}` },
    { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddressTwo}` },
    { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddressTwo}` },
    { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddressTwo}` },
    { field1: "e) Email Address", value1: `${allPerameters.coEmailAddressTwo}` },
    { field1: "f) Constitution", value1: `${allPerameters.coConstitutionTwo}` },
    { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumberTwo}` },
    { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrowerTwo}` },
    { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProviderTwo}` },
   
    { field1: "Guarantor" },
    { field1: "a) Name", value1: `${allPerameters.guarantorName}` },
    { field1: "b) Residence Address", value1: `${allPerameters.guarantorAddress}` },
    { field1: "c) Registered Office Address", value1: `${allPerameters.guarantorRegisteredOfficeAddress}` },
    { field1: "d) Corporate Office Address", value1: `${allPerameters.guarantorCorporateOfficeAddress}` },
    { field1: "e) Email Address", value1: `${allPerameters.guarantorEmailAddress}` },
    { field1: "f) Constitution", value1: `${allPerameters.guarantorConstitution}` },
    { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.guarantorIdentityNumber}` },
    { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.guarantorTypeOfBorrower}` },
    { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.guarantorSecurityProvider}` },
  ];
  drawTable(secondPageTable);
  // doc.moveDown(2);
  // addFooter();
  
//   // ------------------------------------- new page 3-------------------------------------------------
  
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

function newTable(tableData) {
    const startX = 50;
    let startY = doc.y + 10;
    const columnWidths = [500];

    const keyWidth = Math.round((columnWidths[0] * 1) / 2);
    const valueWidth = Math.round((columnWidths[0] * 1) / 2);

    tableData.forEach((row, rowIndex) => {
        doc.lineWidth(0.5);

        const valueText = row.value1 || "";
        const isFullWidthRow = row.field1 === "Details of the Loan/Credit Facility" || row.field1.startsWith("Payment Instrument(s)");
        
        // Calculate row height to accommodate multiline text
        let rowWidth = isFullWidthRow ? columnWidths[0] : valueWidth;

        // Set specific height for "Payment Instrument(s)" row
        let rowHeight;
        if (row.field1.startsWith("Payment Instrument(s)")) {
            // Increase height for this specific row
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 60; // Increase height as needed
        } else {
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 10; // Normal height for other rows
        }
        rowHeight = Math.max(rowHeight, 20); // Set a minimum height if needed

        // Draw background for the row
        doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX, startY, columnWidths[0], rowHeight)
            .stroke("black")
            .fill();

        if (isFullWidthRow) {
            // Render full-width text with wrapping
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1 + "\n" + valueText, startX + 5, startY + 8, {
                    baseline: "top",
                    width: columnWidths[0] - 10, // Slight padding to avoid overflow
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        } else {
            // Draw first column cell
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 8, {
                    baseline: "top",
                    width: keyWidth,
                    align: 'left'
                });

            // Draw second column cell with wrapping
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(valueText, startX + keyWidth + 5, startY + 8, {
                    baseline: "top",
                    width: valueWidth - 10, // Prevent overflow by setting width constraint
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        }

        // Move to the next row position
        startY += rowHeight;
    });
}
  
  const details = [
    { field1: "Purpose of the Loan/Credit Facility", value1: `WORKING CAPITAL` },
    { field1: "Details of the Loan/Credit Facility", value1: ``},
    { field1: "Loan Amount/Credit Facility", value1: `Rs.${allPerameters.loanAmount}` },
    { field1: "Security Details (Details of the Security as per Sanction Letter such as Property Address/Equipment details/Intangible Collateral, etc.)", value1:`${allPerameters.securityDetails}` },
    { field1: "Security Cover", value1: `${allPerameters.securityCover}` },
    { field1: "Tenor or Tenure of the Loan/Credit Facility", value1: `${allPerameters.tenor} Months` },
    { field1: "Rate of Interest", value1: `FLOATING RATE OF INTEREST \n · Grow Money Reference Rate (URR): ${allPerameters.benchmarkInterest}% p.a (per cent per annum)\n · Floating Rate of Interest(p.a.): URR + ${allPerameters.SpreadInterestRate}%=${allPerameters.Roi}% p.a. (per cent per annum) Review Frequency: Monthly` },
    { field1: "Sanction Letter", value1: `${allPerameters.sanctionLetterDate}` },
    { field1: "Application Fees", value1: `2% + 18% GST` },
    { field1: "Processing Fees", value1: `2% + 18% GST` },
    { field1: "CERSAI Charges", value1: `AS APPLICABLE` },
    { field1: "Late Payment Interest/Additional Interest", value1: `___% p.m. (________ per cent per month) or _____ % p.a. (_________ per cent per annum) on the Instalment overdue from the date of overdue upto the date of payment` },
    { field1: "Repayment Bank A/c Details", value1: `${allPerameters.repaymentBank}` },
    { field1: "Details of Receivables", value1: `${allPerameters.detailsOfReceivables}`, },
    { field1: "Pre-payment/Foreclosure of the Facility", value1:  `· 6% of Principal outstanding for loan foreclosed within 12 months of loan sanction \n · 4% of Principal outstanding for loan foreclosed after 12 months of loan sanction \n regulatory requirements and directions prescribed by Reserve Bank of India from time to time.` },
    { field1: "Payment Instrument(s)\n Bank Account on which the Repayment Cheques are drawn and/or EDI (Electronic Debit Instrument)/NACH are made and details thereof\n · The Repayment Cheque/NACH can be used by the FIN COOPERS for realization of delayed payment charges/Default Interest also and in such events additional cheque(s)/NACH shall be furnished to cover the balance Repayment Amount.(“Account”)\n · Repayment Cheques should be in favour of “FIN COOPERS Securities Pvt Ltd”", value1: `` },
  ];
  
  newTable(details);
  
  doc.moveDown(2)
  
  doc
  .fontSize(8)
  .font('Helvetica')
  .text("Repayment details:", { align: "left" })
  .moveDown(1)
  

function repaymentFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  // Function to draw a checkbox
  const drawCheckbox = (doc, x, y, size, isChecked) => {
      doc
          .rect(x, y, size, size) // Draw checkbox square
          .stroke();
      if (isChecked) {
          doc
              .moveTo(x, y + size / 2)
              .lineTo(x + size / 3, y + size - 2)
              .lineTo(x + size - 2, y + 2)
              .strokeColor('black')
              .stroke();
      }
  };

  const validColumns = Object.keys(tableData[0]).filter((key) => {
      return tableData.some(row => row[key] !== ""); // Exclude blank columns
  });
  const columnCount = validColumns.length;

  const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // Dynamic column widths
  const fixedRowHeight = 20;

  // Render the first column
  const firstColumnValue = tableData[0][validColumns[0]];
  doc.fillColor("#f5f5f5")
      .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length)
      .stroke("black")
      .fill();

  doc.font(font)
      .fillColor("black")
      .fontSize(7.2)
      .text(firstColumnValue, startX + 5, startY + 5, {
          width: columnWidths[0] - 10,
          align: 'left',
      });

  // Render other rows
  tableData.forEach((row, rowIndex) => {
      doc.lineWidth(0.5);

      doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], fixedRowHeight)
          .stroke("black")
          .fill();

      validColumns.slice(1).forEach((columnKey, colIndex) => {
          const value = row[columnKey];
          const cellX = startX + columnWidths.slice(0, colIndex + 1).reduce((acc, width) => acc + width, 0);
          const cellWidth = columnWidths[colIndex + 1];

          // Draw cell background
          doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
              .rect(cellX, startY, cellWidth, fixedRowHeight)
              .stroke("black")
              .fill();

          if (value === "check") {
              // Draw checkbox if the value is "check"
              drawCheckbox(doc, cellX + 5, startY + 5, 10, true);
          } else {
              // Handle regular text
              const lines = (value || "").split('\n');
              lines.forEach((line, lineIndex) => {
                  doc.font(font)
                      .fillColor("black")
                      .fontSize(7.2)
                      .text(line, cellX + 5, startY + 5 + (lineIndex * 10), {
                          baseline: "hanging",
                          width: cellWidth - 10,
                      });
              });
          }
      });

      startY += fixedRowHeight;
  });
}


const repaymentTable = [
    { field1: "Repayment Options", filed2: "EMI", field3: "Step Up", field4: "Step Down", field5: "Structured", field6: "Balloon", field7: "Bullet" },
    { field1: "", filed2:"check", field3: ``, field4: ``, field5: ``, field6: ``, field7: `` },
];

repaymentFunction(repaymentTable);



// Call the function to draw the table

doc.moveDown(0.8)
const repaymentFrequencyTable = [
    { field1: "Repayment Frequency", filed2: "Monthly", field3: "Bi-monthly", field4: "Quarterly", field5: "Half Yearly", field6: "Yearly",},
    { field1: "", filed2: "check", field3: ``, field4: ``, field5: ``, field6: ``,  },
];

repaymentFunction(repaymentFrequencyTable);
  
  // addFooter();
  
//   //---------------------------------------- new page 4--------------------------------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);


const repaymentDateTable = [
    { field1: "Repayment Cycle date", filed2: "3rd of the month ", field3: "5th of the month", field4: "10th of the month" },
    { field1: "", filed2: ``, field3: ``, field4: "check",  },
];

repaymentFunction(repaymentDateTable);
doc.moveDown(0.5);

function intrestTableFunction(tableData) {
    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;
    const totalWidth = 500; // Total column width
    const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
    const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

    tableData.forEach((row, rowIndex) => {
        // Set default row height
        let rowHeight = 15;

        // Calculate the height of the text for field1 and value1
        const field1TextHeight = doc
            .font(font)
            .fontSize(7.2)
            .heightOfString(row.field1, { width: keyWidth });

        let value1TextHeight = 0;
        if (row.value1) {
            value1TextHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(row.value1, { width: valueWidth });
        }

        // Determine the maximum height between field1 and value1 to set row height
        rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

        // Alternate row background color
        doc.lineWidth(0.5);
        doc
            .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX, startY, keyWidth, rowHeight)
            .stroke("black")
            .fill();

        // Draw text in field1 cell
        doc
            .font(font)
            .fillColor("black")
            .fontSize(7.2)
            .text(row.field1, startX + 5, startY + 5, {
                baseline: "hanging",
                width: keyWidth,
            });

        // Draw the second column, even if value1 is absent
        doc
            .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX + keyWidth, startY, valueWidth, rowHeight)
            .stroke()
            .fill();

        // Draw the key-value pair for value1 or leave it empty
        const keyValueText = row.value1 ? `${row.value1}` : ""; // Show empty text if no value
        doc
            .font(font)
            .fillColor("black")
            .fontSize(7.2)
            .text(keyValueText, startX + keyWidth + 5, startY + 5, {
                baseline: "hanging",
                width: valueWidth,
            });

        // Draw vertical line between the columns
        doc.lineWidth(0.5);
        doc.strokeColor("black");
        doc.moveTo(startX + keyWidth, startY);
        doc.lineTo(startX + keyWidth, startY + rowHeight);
        doc.stroke();

        // Move to the next row position
        startY += rowHeight;
    });
}

  
const intrestData = [
  { field1: "Pre-Instalment Interest Date(s)",value1: `${allPerameters.preInstalmentInterestDate}` },
  { field1: "Date when first instalment is due", value1: `10TH OF EVERY MONTH` },
  { field1: "Total No. of Instalments", value1: `${allPerameters.tenor} Months` },
  { field1: "Amount of each instalment", value1: `Rs.${allPerameters.amountOfEachInstalment}` },
  { field1: "Exact dates of repayment", value1: `The instalments shall be due on the repayment cycle date as mentioned above basis the frequency agreed. \n\n The repayment dates are subject to change depending on the Disbursement of the Facility. Exact dates of repayment shall be communicated through a detailed repayment schedule which shall be sent along with a welcome letter` },
];

intrestTableFunction(intrestData);
doc.moveDown(-0.5);

function repaymentAmountFunction(tableData) {
    // Check if tableData is not empty
    if (!Array.isArray(tableData) || tableData.length === 0 || typeof tableData[0] !== 'object') {
        console.error("Invalid table data");
        return;
    }

    const fixedRowHeight = 20; // Define fixed row height

    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;

//     // Determine the number of columns from the first row, excluding blank fields
    const validColumns = Object.keys(tableData[0]).filter((key) => {
        return tableData.some(row => row[key] !== ""); // Exclude columns that are completely blank
    });
    const columnCount = validColumns.length;

    // Set column widths (first column wider)
    const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // First column = 150, others share the remaining width

    // Function to calculate required height based on text content
    const calculateRowHeight = (row, isLastRow) => {
        const lineHeight = 10; // Height of each line (adjust as necessary)
        let maxHeight = 0;

        // Calculate height needed for each column in the row
        validColumns.forEach((columnKey) => {
            const value = row[columnKey] || "";
            const lines = value.split('\n');
            const cellHeight = lines.length * lineHeight + 10; // 10 for padding
            maxHeight = Math.max(maxHeight, cellHeight);
        });

        // If it's the last row, ensure we check for the height of field2 specifically
        if (isLastRow) {
            const field2Height = (row[validColumns[1]] || "").split('\n').length * lineHeight + 10;
            maxHeight = Math.max(maxHeight, field2Height);
        }

        return maxHeight;
    };

    // Render first column spanning all rows
    const firstColumnValue = tableData[0][validColumns[0]]; // Value to be spanned in first column
    doc.fillColor("#f5f5f5")
        .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length) // Spans across all rows
        .stroke("black")
        .fill();

    doc.font(font)
        .fillColor("black")
        .fontSize(7.2)
        .text(firstColumnValue, startX + 5, startY + 5, {
            width: columnWidths[0] - 10, // Adjust for padding
            align: 'left',
        });

    // Render the rest of the table row by row
    tableData.forEach((row, rowIndex) => {
        // Calculate the height for the current row
        const isLastRow = rowIndex === tableData.length - 1; // Check if it's the last row
        const rowHeight = calculateRowHeight(row, isLastRow);
        doc.lineWidth(0.5);

        // Alternate row background color
        doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], rowHeight) // Background for other columns
            .stroke("black")
            .fill();

        // Check if field3 and field4 are empty
        const isField3Empty = !row[validColumns[2]]; // Check if field3 is empty
        const isField4Empty = !row[validColumns[3]]; // Check if field4 is empty

        if (isField3Empty && isField4Empty) {
            // Span field2 across the rest of the columns
            const cellWidth = columnWidths[1] + columnWidths[2] + columnWidths[3]; // Total width of field2, field3, and field4 combined
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + columnWidths[0], startY, cellWidth, rowHeight) // Span cell
                .stroke("black")
                .fill();

            // Draw the value for field2
            const value = row[validColumns[1]];
            const lines = (value || "").split('\n');
            lines.forEach((line, lineIndex) => {
                doc.font(font)
                    .fillColor("black")
                    .fontSize(7.2)
                    .text(line, startX + columnWidths[0] + 5, startY + 5 + (lineIndex * 10), {
                        baseline: "hanging",
                        width: cellWidth - 10, // Adjust for padding
                    });
            });
        } else {
            // Draw field2, field3, and field4 normally
            validColumns.slice(1).forEach((columnKey, colIndex) => {
                const value = row[columnKey];
                const cellWidth = columnWidths[colIndex + 1];
                doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                    .rect(startX + columnWidths[0] + colIndex * cellWidth, startY, cellWidth, rowHeight) // For each column after the first
                    .stroke("black")
                    .fill();

                // Handle line breaks in the cell
                const lines = (value || "").split('\n');
                lines.forEach((line, lineIndex) => {
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(line, startX + columnWidths[0] + colIndex * cellWidth + 5, startY + 5 + (lineIndex * 10), {
                            baseline: "hanging",
                            width: cellWidth - 10, // Adjust for padding
                        });
                });
            });
        }

        // Move to next row position
        startY += rowHeight; // Adjust starting position based on calculated row height
    });
}

const repaymentAmountTable = [
    { field1: "Total Repayment Amount", filed2: "Principal ", field3: "Total Interest*", field4: "Total repayment amount" },
    { field1: "", filed2:  `${allPerameters.loanAmount}`, field3:  `${allPerameters.totalInterest}`, field4:  `${allPerameters.totalRepaymentAmount}`, },
    { field1: "", filed2: "*The interest amount is calculated basis the ROI and Tenure of the Facility and is excluding any Pre EMI/ broken period interest that may be computed and applied basis the Disbursement date", field3: "", field4: "", },
];

// Call the function with the correct parameter
// repaymentAmountFunction(repaymentAmountTable);
doc.moveDown(-0.1);
const npaTable = [
    { field1: "Default and NPA  classification",value1: `Please refer Annexure 1` },
  ];
  intrestTableFunction(npaTable);
  doc.moveDown(1.5);

  const startX = 50; // Set a left margin
  const startY = doc.y; // Get the current Y position
  
  doc
    .fontSize(8)
    .font('Helvetica')
    .text(
      `Repayment Cheques should be drawn in favour of GROW MONEY CAPITAL PVT LTD\n` +
      `Schedule of Charges on the Loan / Credit Facility\n\n\n\n` +
      `Details pertaining to the Loan Application by Borrower(s) / Co-Borrower(s)\n` +
      `Received copy of Agreement along with the Schedules and Annexure thereto`, 
      startX, // Use the startX value for left alignment
      startY, // Start at the current Y position
      {
        width: 500, // Define a width for text wrapping if needed
        indent: 0, // No indentation
        paragraphGap: 10, // Space between paragraphs
      }
    );
  // addFooter();

// //------------------------------------------- new page 5--------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Annexure 1`, startX, doc.y, { align: "center", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Illustration on due dates and NPA classification`, startX, doc.y, { align: "left", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`If due date of a loan account is March 31, 2021, and full dues are not received before the lending institution runs the day-end process for this date, the date of overdue shall be March 31, 2021. If it continues to remain overdue, then this account shall get tagged as SMA-1 upon running day-end process on April 30, 2021 i.e. upon completion of 30 days of being continuously overdue. Accordingly, the date of SMA-1 classification for that account shall be April 30, 2021.\n\nSimilarly, if the account continues to remain overdue, it shall get tagged as SMA-2 upon running day-end process on May 30, 2021 and if continues to remain overdue further, it shall get classified as NPA upon running day-end process on June 29, 2021.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);


function tableFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row
        for (let field in row) {
            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows, no bold for header
            doc
                .font('Helvetica') // Regular font
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const tableData = [
    { field1: "Status", field2: "DPD", field3: "Illustration 2", field4: "Illustration 1", field5: "Illustration 3", field6: "Illustration 4 (Leap year)" },
    { field1: "*Due date/Overdue (if not paid)", field2: `1 day`, field3: `05-02-22`, field4:`03-06-22`, field5:`15-01-22`, field6: `15-01-24` },
    { field1: "SMA-1", field2: `31 days`, field3: `07-03-22`, field4: `03-07-22`, field5: `14-02-22`, field6: `14-02-24` },
    { field1: "SMA-2", field2: `61 days`, field3: `06-04-22`, field4: `02-08-22`, field5: `16-03-22`, field6: `15-03-24` },
    { field1: "#Non-Performing Asset", field2: `91 days`, field3: `06-05-22`, field4: `01-09-22`, field5: `15-04-22`, field6: `14-04-24` },
];

// Call the function to create the table
tableFunction(tableData);  
doc.moveDown(2)

doc
.fontSize(8)
.font('Helvetica')
.text(`* Any amount due to the lender under any credit facility is ‘overdue’ if it is not paid on the due date fixed by the Lender. If there is any overdue in an account, the default/ non-repayment is reported with the credit bureau companies like CIBIL etc. and the CIBIL report of the customer will reflect defaults and its classification status.\n\n# Once an account is classified as NPAs then it shall be upgraded as ‘standard’ asset only if entire arrears of interest and principal are paid by the borrower\n\nIN WITNESS WHEREOF the Parties hereto have hereunto set and execute this Agreement on the day and year as first mentioned hereinabove.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Lender:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);
doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named GROW MONEY\nCAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(6)
.font('Helvetica')
.text(`________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`Authorised Signatory.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Borrowers and Co-Borrowers:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named “Borrowers”\nand “Co-Borrowers”`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`.1 ${allPerameters.nameOne}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.2 ${allPerameters.nameTwo}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.3 ${allPerameters.namethird}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.4 ${allPerameters.nameFourth}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})



// addFooter();

// // --------------------------------------------new page 6-------------------------------------------------------


doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica')
.text(`Affix Revenue Stamp`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`DEMAND PROMISSORY NOTE`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`To,\nThe Manager\nGROW MONEY CAPITAL PVT LTD\nFlat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`On demand I/We and our respective heirs, representatives, executors, administrators, successors and/or permitted assigns,(jointly & severally) unconditionally promise to pay GROW MONEY CAPITAL PVT LTD (“GROW MONEY”, including, its successors and assigns), or order, for value received, the sum of Rs. ${allPerameters.loanAmount}/-${allPerameters.loanAmountinwords} along with applicable interest and charges thereon, which may from time to time be varied in accordance with the policy decision of GROW MONEY.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`To be signed by the Borrower(s)\n\nPlace - ${allPerameters.borrowerPlace}\n\nDATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`______________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);
doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);


// addFooter();


// //----------------------------------------------new page 7-----------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST FORM`,startX, doc.y, { align: "center", width: 500, underline:true})
doc.moveDown(1);

function requestFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Draw the outer rectangle for the box with normal line width
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .lineWidth(0.5) // Set thinner line width for borders
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row with normal line width
        for (let field in row) {
            // Draw rectangle for the field box
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .lineWidth(0.5) // Set thinner line width for field borders
                .stroke("black") // Border for field box
                .fill();

            // Set font style based on whether it's the header row
            const isHeader = rowIndex === 0; // Check if it's the header row
            doc
                .font(isHeader ? 'Helvetica-Bold' : 'Helvetica') // Set font to bold for header
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const requestTableData = [
    { field1: "Name of Applicant", field2: `${allPerameters.customerName}`},
    { field1: "Loan ID", field2: `${allPerameters.loanId}` },
    { field1: "Disbursement Amount Request", field2: `Rs.${allPerameters.disbursementAmount}` },
    { field1: "Date by which the Disbursement is required", field2: `${allPerameters.dateDisbursementRequired}` },
    { field1: "Loan Type ", field2: `Secured Loan` },
    { field1: "LAN No", field2: `${allPerameters.lanNo}` },
];

// Call the function to create the table
requestFunction(requestTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH CHEQUE(S)/DRAFT[1](S) REQUIRED`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const requiredTable = [
    { field1: "Cheque/DD in favour of Payee", field2: "Payable At", field3: "Bank Name of Payee", field4: "Savings/Current Bank Account No of Payee", field5: "Amount" },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
];

// Call the function to create the table
tableFunction(requiredTable);  
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH RTGS`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const rtgsTableData = [
    { field1: "PARTICULARS", field2: "CUSTOMER DETAILS"},
    { field1: "Account Holder Name", field2: `${allPerameters.accountHolderName}` },
    { field1: "Bank Name", field2: `${allPerameters.nameOfBank}` },
    { field1: "Bank Address", field2: `${allPerameters.bankAddress}` },
    { field1: "Bank Account No.", field2: `${allPerameters.accountNo}` },
    { field1: "Bank Account Type", field2: `${allPerameters.accountType}` },
    { field1: "IFSC Code", field2: `${allPerameters.IFSCCode}` },
    { field1: "Customer E-Mail Address", field2: `${allPerameters.emailAddress}` },
    { field1: "For Official Use", field2: `${allPerameters.officeUse}` },
    { field1: "Amount Payable", field2: `${allPerameters.amountPayable}` },
    { field1: "Application ID", field2: `${allPerameters.applicantId}` },
    { field1: "Agreement No", field2: `${allPerameters.agrementNo}` },
];

// Call the function to create the table
requestFunction(rtgsTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Operation`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(-2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DATED : ${allPerameters.disbursementDate}`,startX, doc.y, { align: "left", width: 500, underline:true})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Applicant`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Co-Applicants`,startX, doc.y, { align: "right", width: 500});
// doc.moveDown(0.5);

// addFooter();

// // -------------------------------------------------new page 8------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`REPAYMENT CHEQUE ACKNOWLEDGEMENT LETTER`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(0.5);

function latterTableFunction(tableData) {
    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;
    const totalWidth = 500; // Total column width
    const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
    const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

    tableData.forEach((row, rowIndex) => {
        // Set default row height
        let rowHeight = 15;

        // If it's the last field, span both columns
        if (rowIndex === tableData.length - 1) {
            const fullText = `${row.field1} ${row.value1 || ''}`.trim();
            const textHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(fullText, { width: totalWidth });

            rowHeight = textHeight + 10; // Add some padding

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, totalWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw the text spanning both columns
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(fullText, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: totalWidth,
                });
        } else {
            // Calculate the height of the text for field1 and value1
            const field1TextHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(row.field1, { width: keyWidth });

            let value1TextHeight = 0;
            if (row.value1) {
                value1TextHeight = doc
                    .font(font)
                    .fontSize(7.2)
                    .heightOfString(row.value1, { width: valueWidth });
            }

            // Determine the maximum height between field1 and value1 to set row height
            rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw text in field1 cell
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: keyWidth,
                });

            // Draw the second column, even if value1 is absent
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke()
                .fill();

            // Draw the key-value pair for value1 or leave it empty
            // const keyValueText = row.value1 ? `Value: ${row.value1}` : ""; // Show empty text if no value
            const keyValueText = row.value1 || ""; 

            doc

                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(keyValueText, startX + keyWidth + 5, startY + 5, {
                    baseline: "hanging",
                    width: valueWidth,
                });

            // Draw vertical line between the columns
            doc.lineWidth(0.5);
            doc.strokeColor("black");
            doc.moveTo(startX + keyWidth, startY);
            doc.lineTo(startX + keyWidth, startY + rowHeight);
            doc.stroke();
        }

        // Move to the next row position
        startY += rowHeight;
    });
}

const letterData = [
  { field1: "Customer Name", value1: `${allPerameters.customerName}` },
  { field1: "Address", value1: `${allPerameters.address}` },
  { field1: "Contact Nos.", value1: `${allPerameters.registeredMobile}` },
  { field1: "Credit Facility", value1: `` },
  { field1: "Facility Amount", value1: `Rs.${allPerameters.loanAmount}-${allPerameters.loanAmountinwords}` },
  { field1: "Repayment Mode", value1: `NACH / PDC` },
  { field1: `MENTION THE COUNT OF CHEQUE RECEIVED\n\nCheque Received (A) Undated: 5 (B) Cancelled: 0\n\nCheques Handed over to Mr./Mrs.: ${allPerameters.chequesHandedName}\n\nSourcing Channel Name:${allPerameters.sourcingChannelName}`, value1: "" }
];

latterTableFunction(letterData);

function draweeFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const fieldWidths = [0.25 * boxWidth, 0.5 * boxWidth, 0.25 * boxWidth]; // Widths for each main column
    const extraPadding = 15; // Additional padding for row height

    // Calculate the total height for the entire box
    let totalHeight = 0;
    tableData.forEach(row => {
        let rowHeight = 0;
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });
        totalHeight += rowHeight;
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5);

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0")
        .rect(startX, startY, boxWidth, totalHeight)
        .stroke("black")
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX;
        let rowHeight = 0;

        // Determine row height with extra padding
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });

        // Draw rectangles and text for each field in the row
        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[0], rowHeight).stroke("black");
        doc.font('Helvetica').fillColor("black").fontSize(7.2).text(row.field1, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[0] - 10, align: 'left' });
        currentX += fieldWidths[0];

        if (rowIndex === 0) {
            doc.rect(currentX, startY, fieldWidths[1], rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[1] - 10, align: 'center' });
            currentX += fieldWidths[1];
        } else {
            const subFieldWidth = fieldWidths[1] / 2;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_2 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
        }

        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[2], rowHeight).stroke("black").fillColor("black").text(row.field3, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[2] - 10, align: 'center' });

        // Move to the next row
        startY += rowHeight;
    });
}

// Sample data
const DraweeData = [
    { field1: "Drawee Bank", field2_1: "Cheque No.", field2_2: "", field3: "No of Cheques" },
    { field1: " ", field2_1: "From", field2_2: "To", field3: " " },
    { field1: `APP`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.appbranchName}`, field2_1: `${allPerameters.appchequeNo1}`, field2_2: `${allPerameters.appchequeNo5}`, field3: `${allPerameters.totalCheque}` },
    { field1: `GAU`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.gaubranchName}`, field2_1: `${allPerameters.gaucheqNo1}`, field2_2: `${allPerameters.gauchequeNo5}`, field3: `${allPerameters.gautotalCheq}` },
];

// Call the function to create the table
draweeFunction(DraweeData);


doc.moveDown(3);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`I ${allPerameters.customerName} hereby confirm that I have handed over FIVE cheques detailed above towards repayment of Instalment(s) or security cheque for the loan/facility already taken/to be taken from GROW MONEY CAPITAL PVT LTD and that all cheques were drawn in favour of “GROW MONEY CAPITAL PVT LTD” and also recorded my name on the reverse side of the cheques.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`DATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Name) - ${allPerameters.customerName}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Signature)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`This is to confirm that physical cheques were cross tallied with the above schedule and found correct.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

function SignatureTableFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const normalRowHeight = 20; // Normal height for other rows
    const signatureRowHeight = 40; // Increased height for the signature row

    // Define fixed column widths for three columns
    const columnWidths = [150, 150, 200]; // Adjust widths for your layout

    // Calculate total height needed for the entire box
    let totalHeight = tableData.length * normalRowHeight; // Total height based on normal row height

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row

        // Determine row height based on whether it's the signature row
        const rowHeight = rowIndex === 0 ? signatureRowHeight : normalRowHeight; // Change height for the first row (signature)

        // Draw rectangles for each field in the row
        columnWidths.forEach((width, index) => {
            const field = `field${index + 1}`;

            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, width, rowHeight) // Use determined row height
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows
            doc
                .font('Helvetica')
                .fillColor("black")
                .fontSize(7.2);

            // Draw the field text in the box
            const fieldValue = row[field] || ""; // Use empty string for missing fields
            doc.text(fieldValue, currentX + 3, startY + 5, {
                baseline: "hanging",
                width: width - 10, // Adjust width to provide padding inside the box
                align: 'left', // Align text to the left
            });

            // Move to the next column
            currentX += width; // Update X position for the next field
        });

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row based on the determined height
    });
}

const SignatureTable = [
    { field1: "Signature", field2: "", field3: "" },
    { field1: "Name", field2: ``, field3: "" },
    { field1: "", field2: "Sales Executive / DSA", field3: "CPA / FIN COOPERS Staff" },
];

// Call the function to create the table
SignatureTableFunction(SignatureTable);

// addFooter();

// //---------------------------------------------- new page 9---------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`LETTER OF CONTINUITY`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(2.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Place: Indore`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`Dear Sir(s),`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`I/We ${allPerameters.customerName} a company incorporated under the provisions of the Companies Act, 1956/2013 /a partnership firm registered under the provisions of the Indian Partnership Act, 1932/ sole proprietorship concern or an individual having its office/ place of business at ${allPerameters.place}, acting through _______________________________, who is duly authorized in that behalf vide board resolution/ letter of authority/power of attorney dated DATED : ${allPerameters.date} (the “Borrower(s)”), enclose a Promissory Note dated DATED : ${allPerameters.date} for Rs.${allPerameters.disbursementAmount} payable on demand which is given to you (“DPN”) as collateral security for repayment to GROW MONEY, (hereinafter referred to as the “GROW MONEY”, including its successors and assigns) of any sum now due or which may hereafter become due from me/us to GROW MONEY in respect of Rs.${allPerameters.disbursementAmount} (hereinafter referred to as the “Facility”) granted by GROW MONEY vide Facility Agreement dated DATED : ${allPerameters.date}.I/We hereby irrevocably and unconditionally agree, confirm and undertake that:\n\n1. the DPN shall operate as continuing security to you to be enforceable for the repayment of the ultimate balance and/or all sums remaining unpaid under the Facility now or hereafter, including all interest to become payable in respect of / under the Facility or which may in future be advanced; and\n\n2. we will remain liable on the DPN notwithstanding payment made into the account of the Facility from time to time or the Facility being reduced or extinguished from time to time or even if the balance in the account of the Facility may be in credit.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(3);

doc
.fontSize(8)
.font('Helvetica')
.text(`Yours faithfully`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`(Borrowers)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`___________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500});
// doc.moveDown(2);

// addFooter();

// //----------------------------------------------- new page 10-----------------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
    .fontSize(8)
    .font('Helvetica-Bold') // Use the bold version of Helvetica
    .text(`END-USE UNDERTAKING`, startX, doc.y, { align: "center", width: 500, underline:true })
    .moveDown(2)

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`DATED : ${allPerameters.date}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Dear Sir/Madam,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Subject:- Undertaking regarding utilizations of Loans to be granted by GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`I/We ${allPerameters.customerName} acknowedge that  GROW MONEY has sanctioned loan amount of Rs. ${allPerameters.loanAmount} (${allPerameters.loanAmountinwords}) to subject to the terms and conditions as mentioned in the Sanction Letter Date:${allPerameters.sanctionLatterDate}(sanction letter). The Loan has been sanctioned by GROW MONEY inter alia, on the basis of my/our representation that we/I are/am engaged in the business of and the loan will be utilized only for the purpose of .\n\n I/We hereby solemnly confirm and certify that Loan shall be utilized only for the aforesaid purpose and no other purpose. I/We will never utilize the Loan or any part thereof for any speculative, illegal and prohibited activity (prohibited under any applicable laws/rules/regulations). Any breach or violation of the representation made herein, and other documents executed in relation to Loan will be my/our responsibility solely.\n\nI/We shall extend necessary support and co-operation to GROW MONEY for any matter in connection with this letter and Facility Agreement.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(2);

// addFooter();


    // Finalize the PDF
    doc.end();
  
    // const pdfFileUrl = `/uploads/pdf/${pdfFilename}`;

    // const objData = {
    //     fileName: pdfFileUrl,
    //     file: doc.toString('base64')
    //  }
    //   await initESign(objData)
  
    // return new Promise((resolve, reject) => {
    //   stream.on("finish", () => {
    //     resolve(pdfFileUrl);
    //   });
    //   stream.on("error", reject);
    // });

    return new Promise((resolve) => {
      doc.on('end', () => resolve(Buffer.concat(buffers)));
    });
  }
  async function ratannaFinSanctionLetterPdf1(allPerameters,logo,partnerName) {

    const font = "assets/font/Cambria.ttf";
    const fontBold = "assets/font/Cambria-Bold.ttf";
    const fontKerlaTamil = "assets/font/KarlaTamilUpright-Regular.ttf"
    const fontUrdu = "assets/font/IBMPlexSansArabic-Regular.ttf"
    const fontTelugu = "assets/font/TiroTelugu-Regular.ttf"
    const fontPanjabi = "assets/font/BalooPaaji2-VariableFont_wght.ttf"
    const fontMalayam = "assets/font/AnekMalayalam-VariableFont_wdth.ttf"
    const fontKannada = "assets/font/NotoSansKannada-VariableFont_wdth.ttf"
    const fontGujarati = "assets/font/Rasa-VariableFont_wght.ttf"
    const fontHindi = "assets/font/Mukta-Regular.ttf"
    const fontOriya = 'assets/font/BalooBhaina2-VariableFont_wght.ttf'
    const fontMarathi = 'assets/font/Hind-Regular.ttf'
    const fontBengali = 'assets/font/NotoSansBengali-VariableFont_wdth.ttf'
    // const baseDir = path.join("./uploads/");
    // const outputDir = path.join(baseDir, "pdf/");

    const PDFDocument = require('pdfkit');
  const doc = new PDFDocument({ margin: 50, size: "A4" });

  // Buffer to hold the PDF content
  const buffers = [];
  doc.on('data', (chunk) => buffers.push(chunk));
  doc.on('end', () => console.log('PDF generated successfully!'));

  
    // draw a border around the page
    function drawBorder() {
      const pageWidth = doc.page.width;
      const pageHeight = doc.page.height;
      const margin = 30;
      const lineWidth = 2;
  
      // Draw a simple border rectangle
      doc.lineWidth(lineWidth);
      doc
        .rect(margin, margin, pageWidth - 2 * margin, pageHeight - 2 * margin)
        .strokeColor("#324e98") // Set the color of the border
        .stroke();
    }
  
    // add logo to every page
    // function addLogo() {
    //   if (fs.existsSync(logo)) {
    //     doc.image(logo, 400, 50, {
    //       fit: [150, 50],
    //       align: "right",
    //       valign: "bottom",
    //     });
    //   } else {
    //     console.error(`Logo file not found at: ${logo}`);
    //   }
    // }
    const FinpdfLogo = path.join(
        __dirname,
        "../../../../../assets/image/FINCOOPERSLOGO.png"
      );

    function addLogo() {
          if (fs.existsSync(FinpdfLogo)) {
            doc.image(FinpdfLogo, 400, 50, { fit: [150, 50], align: "left", valign: "bottom" });
          } else {
            console.error(`Logo file not found at: ${FinpdfLogo}`);
          }
      
          if (fs.existsSync(logo)) {
                  doc.image(logo, 40, 50, {
                    fit: [150, 50],
                    align: "right",
                    valign: "bottom",
                  });
                } else {
                  console.error(`Left logo file not found at: ${logo}`);
                }
        }
  
    // watermark function
    function addWatermark() {
      if (fs.existsSync(watermarklogo)) {
        doc.save();
        doc.rotate(-45, { origin: [doc.page.width / 2, doc.page.height / 2] });
  
        doc.image(
          watermarklogo,
          doc.page.width / 2 - 200,
          doc.page.height / 2 - 200,
          {
            fit: [450, 400],
            opacity: 0.05,
            align: "center",
            valign: "center",
          }
        );
  
        doc.restore();
      } else {
        console.error(`Logo file not found at: ${watermarklogo}`);
      }
    }
  
    // Footer with border and stylized text
    // Footer with border and stylized text
    function addFooter() {
      if( partnerName == "GROW MONEY CAPITAL PVT LTD"){
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("Grow Money Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }else {
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("FinCoopers Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }
     
    }
  
    // if (!fs.existsSync(outputDir)) {
    //   fs.mkdirSync(outputDir, { recursive: true });
    // }
  
    const timestamp = Date.now();
    // const candidateName = 
    // (`${candidateDetails.name}`); // Capitalize name
    // const pdfFilename = `growLoanAggrement.pdf`;
    // const pdfPath = path.join(outputDir, pdfFilename);
  
    // const doc = new PDFDocument({ margin: 50, size: "A4" });
    // const stream = fs.createWriteStream(pdfPath);
  
    // doc.pipe(stream);
    // //---------------------------------------------------- new page 14-------------------------------------------------------

// addLogo();
// drawBorder();
doc.moveDown(7);


doc
.fontSize(9)
.font('Helvetica-Bold')
.fontSize(9)
.text(`Vernacular Language Form`,  { align: "center",underline: false, width: 500 });
doc.moveDown(2);


function declarationTableFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  const columnWidths = {
    field1: 50,
    field2: 100,
    field3: 330,
  };

  // Define min and max row height to avoid extremes
  const MIN_ROW_HEIGHT = 15;
  const MAX_ROW_HEIGHT = 45;

  // Function to calculate row height based on text content
  const calculateRowHeight = (row) => {
    let maxHeight = 0;
    Object.keys(row).forEach((field) => {
      const text = row[field] || '';
      const columnWidth = columnWidths[field] || 100;

      // Calculate the text height for each field
      const textHeight = doc
        .font(field === 'field3' ? fontKerlaTamil : 'Helvetica')
        .fontSize(7.2)
        .heightOfString(text, { width: columnWidth });

      // Track the highest text height in the row
      maxHeight = Math.max(maxHeight, textHeight);
    });

    // Ensure the row height stays within the defined min and max limits
    return Math.max(MIN_ROW_HEIGHT, Math.min(maxHeight, MAX_ROW_HEIGHT));
  };

  const totalWidth = Object.values(columnWidths).reduce((sum, width) => sum + width, 0);

  tableData.forEach((row, rowIndex) => {
    let currentX = startX;
    const rowHeight = calculateRowHeight(row); // Calculate the row height based on text content

    // Set up the table border at the beginning
    doc
      .lineWidth(0.25)
      .rect(startX, startY, totalWidth, rowHeight)
      .stroke("black");

    Object.keys(columnWidths).forEach((field) => {
      const columnWidth = columnWidths[field];
      const content = row[field] || '';

      doc
        .lineWidth(0.25)
        .rect(currentX, startY, columnWidth, rowHeight)
        .stroke("black");

      const isHeader = rowIndex === 0;
      const paddingTop = 2;  // Adjust padding from the top (increase if needed)
      const textYPosition = startY + paddingTop;

      if (field === 'field1' && content) {
        doc.image(content, currentX + 5, textYPosition + (rowHeight - 8) / 2, { width: 8, height: 8 });
      } else {
        doc
          .font(isHeader ? 'Helvetica-Bold' : 'Helvetica')
          .fillColor("black")
          .fontSize(7.2);

        const text = content || '';
        if (field === 'field3') {
          // Checking for specific languages to apply respective fonts
          if (/[\u0C00-\u0C7F]/.test(text)) {  // Telugu Unicode range
            doc.font(fontTelugu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0D00-\u0D7F]/.test(text)) {  // Malayalam Unicode range
            doc.font(fontMalayam).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0C80-\u0CFF]/.test(text)) {  // Kannada Unicode range
            doc.font(fontKannada).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0A80-\u0AFF]/.test(text)) {  // Gujarati Unicode range
            doc.font(fontGujarati)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0600-\u06FF]/.test(text)) {  // Urdu Unicode range
            doc.font(fontUrdu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'right',
               });
          } else if (/[\u0A00-\u0A7F]/.test(text)) {  // Punjabi Unicode range
            doc.font(fontPanjabi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0B80-\u0BFF]/.test(text)) {  // Tamil Unicode range
            doc.font(fontKerlaTamil).text(text, currentX + 3, textYPosition, {
                baseline: "top",
                width: columnWidth - 6,
                align: 'left',
            });
          } else if (/[\u0900-\u097F]/.test(text)) {  // Hindi Unicode range
            doc.font(fontHindi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else  if (/[\u0B00-\u0B7F]/.test(text)) {  // Odia Unicode range
            doc.font(fontOriya)  // Make sure 'fontOdia' is defined and points to the correct font file
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
           } else if (/[\u0900-\u097F]/.test(text)) {  // Marathi (Devanagari Unicode range)
            doc.font(fontMarathi)  // Ensure you have the Marathi font file available
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
        } else if (/[\u0980-\u09FF]/.test(text)) {  // Bengali Unicode range
          doc.font(fontBengali)  // Ensure you have the Bengali font file available
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }else {
            doc.font('Helvetica')
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          }
        } else {
          doc.font('Helvetica')
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }
      }

      currentX += columnWidth;
    });

    startY += rowHeight; // Adjust to the row's actual height
  });
}

const gujratiFont = [
'આ અરજી/કરાર/પત્ર/નિયમો અને શરતોનો સામગ્રી અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહકને અંગ્રેજીમાં વાંચીને સમજાવી',
'  અને વ્યાખ્યા કરવામાં આવી છે અને અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહક દ્વારા તેને સમજવામાં આવી છે',
]

const declarationTable = [
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "English", 
    field3: "The content of this Application/ Agreement/letter/Terms and Conditions has been read out, explained and interpreted to the applicant(s)/Borrower and to the Co-Borrower(s) in English and understood by the applicant(s)/Borrower and Co-Borrower(s).",  // English text
  },
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "Hindi", 
    field3: "इसआवेदन / समझौ ते / पत्र / नि यमों औमों रशर्तों की सा मग्री को आवेदक (ओं)ओं / उधा रकर्ता औरअंग्रेजीग्रे जीमेंसह-उधा रकर्ता (ओं)ओं को समझा औरसमझा यागयाहैऔहै रआवेदक (ओं)ओं याउधा रकर्ता द्वा रा समझा गया है ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Punjabi", 
    field3: "ਇਸਬਿ ਨੈ-ਪੱਤਰ / ਸਮਝੌਤੇਝੌਤੇ/ ਪੱਤਰ / ਨਿ ਯਮਾਂ ਅਮਾਂ ਤੇਸ਼ਰਤਾਂ ਦੀਤਾਂ ਦੀਸਮੱਗਰੀ ਨੂੰਬਿ ਨੈਕਾ ਰ /ਉਧਾ ਰਲੈਣਵਾ ਲੇਅਤੇਅੰਗ੍ਰੇਜ਼ੀ ਵਿ ਚਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇਨੂੰਸਮਝਾ ਕੇਸਮਝਾ ਇਆਗਿ ਆਹੈਅਤੇਬਿ ਨੈਕਾ ਰਦੁਆਰਾ ਸਮਝੇਗਝੇ ਏਅਤੇਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Kannada", 
    field3: "ಈ ಅಪ್ಲಿಕೇ ಶನ್/ಒಪ್ಪಂ ದ/ಪತ್ರ / ನಿಯಮಗಳುಮತ್ತು ಷರತ್ತು ಗಳವಿಷಯವನ್ನು ಅರ್ಜಿ ದಾ ರ (ರು )/ ಸಾ ಲಗಾರಮತ್ತು ಇಂ ಗ್ಲಿಷ್ನಲ್ಲಿಸಹ-ಸಾ ಲಗಾರ(ಗಳು)ಗೆಓದಿ, ವಿವರಿಸಲಾ ಗಿದೆಮತ್ತು ವ್ಯಾ ಖ್ಯಾ ನಿಸಲಾ ಗಿದೆಮತ್ತು ಅರ್ಜಿ ದಾ ರರು (ಗಳು ) /ಸಾ ಲಗಾರರಿಂ ದಅರ್ಥ ಮಾ ಡಿಕೊ ಳ್ಳಲಾ ಗಿದೆಮತ್ತು ಸಹ-ಸಾ ಲಗಾ ರ (ಗಳು).  ",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Telugu", 
    field3: "ఈ అప్లికేప్లిషన్ / ఒప్పం దం / లేఖ / నిబం ధనలుమరియుషరతులయొక్క కం టెం ట్దరట్ద ఖాస్తుదారు(లు) / రుణగ్ర హీతమరియుఆం గ్లం లోసహ-రుణగ్ర హీత (ల)కుచదవబడిం ది, వివరిం చబడిం దిమరియువివరిం చబడిం దిమరియుదరఖాస్తుదారు(లు) / రుణగ్ర హీతఅర్థం చేసుకున్నా రుమరియుసహ-రుణగ్ర హీత (లు)."
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Tamil", 
    field3: "இந்தவிண்ணப்பம் / ஒப்பந்தம் / கடிதம்வி தி முறைகள்மற்றும்நி பந்தனை களி ன்உள்ளடக்கம்விண்ணப்பதா ரர்(கள்)/கடன்வா ங்குபவர் மற்றும்இணைக்கடன்வா ங்குபவர்(கள்) ஆகி யோ ருக்குஆங்கி லத்தி ல்படித்துவி ளக்கப்பட்டுவி ளக்கம்அளி க்கப்பட்டுள்ளதுமற்றும்விண்ணப் பதா ரர்(கள்)/கடன்வா ங்குபவர்புர",  // Tamil text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Malayalam", 
    field3: 'ഈ ആപ്ലി ക്കേ ഷന്റെ ഉള്ളടക്കം / കരാ ർ / കത്ത് / നി ബന്ധനകളും വ്യ വസ്ഥകളും അപേ ക്ഷകന് / കടം വാ ങ്ങു ന്നയാ ൾക്കും ഇം ഗ്ലീ ഷി ൽ സഹ-കടം വാ ങ്ങു ന്നയാ ൾക്കും വാ യിക്കു കയും വി ശദീ കരിക്കു കയും വ്യാ ഖ്യാ നിക്കു കയും ചെ യ്തു കൂ ടാ തെ അ പേ ക്ഷകൻ (ങ്ങൾ) / കടം വാ ങ്ങു ന്നയാ ൾ മനസ്സി ലാ ക്കു കയും ചെ യ്യു ന്നു . ഒപ്പം സഹ-കടം വാ ങ്ങു ന്നവരും .',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Oriya", 
    field3: 'ଏହିଆହି ବେ ଦନ / ଚୁକ୍ତିନା ମା / ଚିଠିଚି ଠି/ ସର୍ତ୍ତା ବଳୀ ଏବଂ ଚୁକ୍ତିନା ମା ଗୁଡିକଡି ଆବେ ଦନକା ରୀ (()) / orrଣଗ୍ରହୀ ତା ଏବଂ ସହ-orrଣଗ୍ରହୀ ତା ଙ୍କୁଇଂ ରା ଜୀ ରେ ପ read ା ଯା ଇଛି,ଛିବ୍ୟା ଖ୍ୟା କରା ଯା ଇଛିଏବଂ ଆବେ ଦନକା ରୀ (ମା ନେ ) / orrଣଦା ତା ଦ୍ୱା ରା ବୁଝିଛଝିନ୍ତିଏନ୍ତିବଂ ସହ-orrଣଦା ତା (ଗୁଡିକଡି ) |',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Marathi", 
    field3: 'याअर्जा ची / करा रा ची / पत्रा ची / अटी व शर्तीं ची मा हि ती वा चूनका ढली गेली आहे,हेअर्जदा रा ला /कर्जदा रा ला आणि इंग्रजी मध्येसह-कर्जदा रा ला /केली आहे व अर्जदा रा ने /कर्जदा रा नेसमजूनघेतली आहे.हेआणि सह-कर्जदा र',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Gujarati", 
    field3: gujratiFont.join('\n'),  // English text
  },
  {
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Urdu", 
    field3: "درخواست/معاہدہ/خط/شرائط و ضوابط کا مواد درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ کو انگریزی میں پڑھ کر سنایا گیا، وضاحت کی گئی اور اس کی تشریح کی گئی اور درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ نے اسے سمجھ لیا۔",  // Urdu text
  },
];

// // Call the table function to render the data
declarationTableFunction(declarationTable);
doc.moveDown(3);

// doc
// .fontSize(9)
// .font('Helvetica')
// .text(`___________________________`,  doc.y, { align: "left",underline: true, width: 500 });
// doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica-Bold')
// .text(`FOR Borrower,Co-Borrower and Guarantor`,{ align: 'left',lineGap: 5  });
// doc.moveDown(1);

// Reset the starting position
doc
.fontSize(8)
.font('Helvetica-Bold')
.text(
  `FOR Borrower, Co-Borrower and Guarantor`,
  40, // X-coordinate for absolute left alignment
  doc.y, // Y-coordinate: use the current vertical position
  { align: 'left', lineGap: 5 }
);
doc.moveDown(1);

  
// addFooter();
doc.addPage();


    // addLogo();
    // drawBorder();
    doc.moveDown(6);

   doc.font(font).fontSize(11).text('FACILITY AGREEMENT', { align: 'center', underline: true });
   doc.moveDown(2);


doc.font('Helvetica').fontSize(9).text(`THIS FACILITY AGREEMENT`, {
  align: 'left',
  indent: 40,
  lineGap: 5,
  continued: true
})
.font('Helvetica-Bold').text(`(“Agreement”)`, {
  continued: true, // Allows the text to continue on the same line
})
.font('Helvetica').fontSize(9).text(` is made at the place and on the date stated in the Schedule of this Agreement (“Schedule”) by and between:`, {
  align: 'left',
 align:"justify",
  indent: 40,
  lineGap: 5,
})

doc.moveDown(1)

.font('Helvetica').text(`GROW MONEY CAPITAL PVT LTD,`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica').text(` a company incorporated under the Companies Act, 1956 and validly existing under and within the meaning of the Companies Act, with CIN: U74899DL1995PTC069216, registered as a nonbanking financial company`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica-Bold').text(`(“NBFC”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica').text(`under the Reserve Bank of India`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica-Bold').text(`(“RBI”) `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`Act, 1934, having its registered office at 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI-110001 (M.P.), India (hereinafter referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(` “Lender”,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`which expressionshall, unless repugnant to the subject or context thereof, be deemed to include its successors, transferees, novatees and assigns), of the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(`FIRST PART;`) 

  doc.moveDown(1);
  doc.font(font).fontSize(9).text('AND', { align: 'center' });
  doc.moveDown(1);

  doc.font('Helvetica').text(`which expression shall, unless repugnant to the subject or context there of, be deemed to include its successors, transferees, novatees and assigns), of the `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(` SECOND PART`) 

  doc.font('Helvetica').text(`The Borrower and Lender are hereinafter collectively referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(`“ Parties”`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and individually referred to as `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(` “Party”`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`WHEREAS`) 
  doc.moveDown(1);

  doc.font('Helvetica').text(`1. The Borrower is engaged in the business or employment as detailed in the Schedule appended here with`, {
    continued: true, // Allows the text to continue on the same line
  })
  
  doc.font('Helvetica-Bold').text(`(“Business”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and it has requested the Lender to sanction a credit facility for an amount as mentioned in the Schedule `, {
    continued: true, // Allows the text to continue on the same line
  })

  doc.font('Helvetica-Bold').text(`(“Facility”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 2. The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 3. At the Borrower’s request and relying upon the correctness of the information, the representations and the assurances given by the Borrower, the Lender has agreed to grant the Facility to the Borrower, on the terms and conditions contained herein.`)
  doc.moveDown(1);

  doc.font('Helvetica-Bold').text(`NOW, THEREFORE,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`in consideration of the premises and mutual agreements and covenants contained in this Agreement and other good and valuable consideration (the receipt and adequacy of which is hereby mutually acknowledged), each of the Parties hereby agrees as follows:`)

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`DEFINITIONS AND INTERPRETATION`) 
  doc.moveDown(1);

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`1.1 Definitions`) 
  doc.moveDown(1);
  
  doc.font('Helvetica').text(`Wherever used in this Agreement or any Schedule, unless the context otherwise requires, in addition to the terms defined in the Recitals and in the text of this Agreement, the following capitalized terms have the following meanings:`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`“Additional Interest Rate” means the additional interest rate as detailed in the Schedule,`) 
  doc.font('Helvetica-Bold').text(`“Applicable Interest Rate”`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica').text(`means the rate of interest as mentioned in the Schedule payable by the Borrower to the Lender on the outstanding principal amount under the Facility and serviced in a manner as specified in this Agreement.`)
  doc.font('Helvetica-Bold').text(`“Applicable Law”`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`means any statute, national, state, provincial, local, municipal, or other law, treaty, code, regulation, ordinance, rule, judgment, order, decree, bye-law, any act or enactment including but not limited to the Insolvency and Bankruptcy Code, 2016`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica-Bold').text(`( “Code”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`, Securitization and Reconstruction of Financial Assets and Enforcement of Security Interest Act, 2002`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica-Bold').text(`(“SARFAESI Act”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`The Industrial Disputes Act, 1947, Environment Protection Act, 1986, Reserve Bank of India Act, 1934 and other RBI regulations,Companies Act, 2013, Transfer of Property Act, 1882, approval of any Governmental Authority, directive, guideline, policy, requirementor other governmental restriction or any similar form of decision of or determination by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    continued: false, // Allows the text to continue on the same line
  })
   
    // addFooter();
    //------------------------------------------new page ----------------------------------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    // doc.moveDown();


    // doc.font('Helvetica').fontSize(9).text(`by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    //     continued: true, 
    //   })

    doc.font('Helvetica-Bold').fontSize(9).text(`“Application Form”`, {
        continued: true, // Allows the text to continue on the same line
    })  

    doc.font('Helvetica').text(`” means the application form and/or relevant information submitted through any means by the Borrower to the Lender for applying and availing the Loan/Facility, together with all other information particulars, clarifications and declarations, if any, furnished by the Borrower or any other person from time to time in connection with the said Loan/Facility,`)  

    doc.font('Helvetica-Bold').text(`“Business Day”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean a day of the week on which the scheduled commercial banks are open for businessin such state or union territory of India where the office of the Lender, as specified in the Schedule, is located. `)  

    doc.font('Helvetica-Bold').text(`“Borrower/Co-borrower”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`means and includes all the borrower(s) and co-borrower(s) and shall deem to include (i) in case of the individual- his or her heirs, executors and administrators and in case of more than one Borrower their respective heirs executors and administrators, (ii) in case of a company incorporated under the provisions of \n\n Companies Act or a society registered under the applicable laws relating to societies- its successors in interest and permitted assigns, (iii) in case of a partnership firm within the meaning of Indian Partnership Act,1932- any ofor each of the partner or survivor/s of them from time to time (both their personal capacity and as partners of the firm) and their respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the firm, (iv) in the case of proprietary concern- the proprietor(s) (both in his/her personal capacity and as proprietor/proprietress of the concern) and his her respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the concern, (v) in the case of a Hindu Undivided Family` , {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(` (“HUF”),`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`, the Karta of the HUF and any or each of the adult members/coparceners of the HUF and their survivor(s) and their respective heirs, legal representatives, executors, administrators and permitted assigns, (vi) in the case of trust, the trust/trustee/s for the time being its successors.`) 

    doc.font('Helvetica-Bold').text(`“Charges”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean the charges which may be charged by the Lender in relation to the Loan/ Facility, including the charges provided in the Sanction Letter. Any revision to the Charges as per this Agreement as may be communicated or notified to the Borrower shall be the applicable Charges and shall be deemed to have been incorporated in the Sanction Letter, and the Sanction Letter to this effect be deemed to have been modified;`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(`“Companies Act”`, {
        continued: true, // Allows the text to continue on the same line
    })
    
    doc.font('Helvetica').text(`” means individually and collectively, the provisions of the Companies Act, 2013 and such relevant provisions of the Companies Act, 1956, which are still in force and effect including all amendments, enactments, re-enactments or modifications thereof, from time to time, including the rules and regulations prescribed therein`) 
  
    doc.font('Helvetica-Bold').text(`“Conditions Precedent”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means the conditions as specified in Clause 3.5 of this Agreement which are required to be satisfied (unless waived in writing by the Lender) by the Borrower,`)

   doc.font('Helvetica-Bold').text(`“Credit Information Agency”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`” shall mean and include TransUnion CIBIL Limited, CRIF High Mark Credit Information Services Private Limited, Equifax India and Equifax Analytics Private Limited, Experian Credit Information Company of India Private Limited or such other company or any other agency as may be notified or recognized as such by the RBI or any other regulatory authority,`)

    doc.font('Helvetica-Bold').text(`“Designated Account”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means a current bank account of the Lender for receipt of the Outstanding Amounts; “Disbursement” means the disbursement of the Facility or any part thereof, made by the Lender pursuant to the request thereof by the Borrower subject to the terms of this Agreement;`)
  
    doc.font('Helvetica-Bold').text(`“Disbursement Request Form”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“DRF”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means a form (as per format in attached annexure) or a request (in a form and manner acceptable to the Lender) submitted by the Borrower to the Lender requesting that all or a portion of the Facility be disbursed to the Borrower;`)
    doc.font('Helvetica-Bold').text(`“Due Date”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the date(s) on which any amounts in respect of the Facility including the principal, interest or other monies fall due under the terms of this Agreement and/or the other Financing Documents and/or as more particularly described under the Schedule;`)
    doc.font('Helvetica-Bold').text(`“Electronic Clearing Service”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`‘ECS'`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`'NACH',`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the electronic clearing services and electronic payment services, notified by RBI from time to time, being mode(s) of effecting payment transactions using the services of a clearing house or any other platform or mechanism duly authorized in this regard including without limitation the National Electronic Clearing Service;`)
    doc.font('Helvetica-Bold').text(`“Encumbrance”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the creation of charge, lien, security, quasi security, non-disposal arrangement, claim, option, negative lien, power of sale in favor of a third party, retention of title, right of pre-emption, right of first refusal, lock-in of any nature including as may be stipulated by the Securities Exchange Board of India, or other third party right or security interest or an agreement, arrangement or obligation to create any of the foregoing whether presently or in the future. The term`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbrancer”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbered”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall be accordingly construed;`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Event of Default”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall have the meaning prescribed to it under clause 13 herein;`)
    doc.font('Helvetica-Bold')
   .fontSize(9)
   .text(
      `"Account Bank" or "Escrow Agent"`,
      { continued: true }
   )
   .font('Helvetica')
   .text(` means the bank acceptable to the Lender`, { continued: true })
   .font('Helvetica')
   .text(
      ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
    // addFooter();
      //-------------------------------------------------new page ------------------------------------------------------
      doc.addPage();
      // addLogo();
      // drawBorder();

      doc.moveDown(7);

      // doc.moveDown();

  //     doc.font('Helvetica-Bold')
  //  .fontSize(9)
  //  .text(
  //     `"Account Bank" or "Escrow Agent"`,
  //     { continued: true }
  //  )
  //  .font('Helvetica')
  //  .text(` means the bank acceptable to the Lender`, { continued: true })
  //  .font('Helvetica')
  //  .text(
  //     ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
  //     { align: 'justify', indent: 40, lineGap: 5 }
  //  )
  //  .moveDown(1);

doc.font('Helvetica-Bold')
    .fontSize(9)
   .text('"Escrow Account"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the account opened/maybe opened with the Account Bank in accordance with this Agreement and the Escrow Agreement, for the repayment of Outstanding Amounts or any amount payable by Borrower to Lender under this Agreement,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Escrow Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` for the purpose of this Agreement, as the context may require, shall either mean the agreement executed/to be executed/maybe executed at any date as required by Lender and entered into by and between inter alia the Bank (defined below), the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account and the Lender reserves the right to make Borrower a part of Escrow Agreement on such terms and conditions as the Lender may decide in its sole discretion or it shall mean the agreement executed/to be executed/maybe executed at any date as required by Lender, and entered into by and between inter alia the Borrower, the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Facility"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the aggregate amount of credit facility/facilities provided under the terms of this Agreement, and any other outstanding amounts thereunder;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Financing Documents"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Application Form, this Agreement, the Sanction Letter, and all other deeds, instruments, and agreements including security documents of any nature that have been/are to be executed between the Parties, or with any third parties in relation to the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

// addFooter();
// doc.addPage();
// addLogo();
// drawBorder();

// Continue with bold and normal text
doc.font('Helvetica-Bold')
   .text('"Facility Agreement" or "Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` means this agreement, all Schedules and amendments to this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   

doc.font('Helvetica-Bold')
   .text('"Guarantor"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Person(s) as more particularly mentioned in the Schedule, providing guarantee to secure the Outstanding Amount and for the due performance of the terms and conditions of this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Governmental Approval"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean any consent, approval, authorization, waiver, permit, grant, franchise, concession, agreement, license, certificate, exemption, order registration, declaration, filing, report, or notice of, with or to any Governmental Authority,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

   doc.font('Helvetica-Bold')
   .text('"Governmental Authority"', { continued: true })
   .font('Helvetica')
   .text(
      ` means any:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(0.5);

// Point a
doc.text(
   `a) government (central, federal, state or otherwise) or sovereign state and`,
   { indent: 60, align: 'justify', lineGap: 5,  }
)
   .moveDown(0.5);

// Point b
doc.text(
   `b) any governmental agency, semi-governmental or judicial or quasi-judicial or administrative entity,\n department or authority, or any political subdivision thereof, including without limitation, any stock exchange\n or any self-regulatory organization, established under any Applicable Law,`,
   { indent: 60, align: 'justify', lineGap: 5,continued: false }
)
   doc.moveDown(1);

   doc.font('Helvetica-Bold')
.fontSize(9)

   .text('"Instalments"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the amount of payment necessary to amortize the Facility with Interest (rounded off to the next rupee) with in such period as may be determined in the Repayment Schedule,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   doc.font('Helvetica-Bold')
   .text('"Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the interest payable on the Facility at the Applicable Interest Rate, including the Pre-Instalment Interest payable by the Borrower to the Lender at Applicable Interest Rate as specified in the Schedule hereunder,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );


      
      
      // addFooter();

  //-------------------------------------------------new page ------------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();

doc.moveDown(7)
// doc.moveDown()





doc.font('Helvetica-Bold')
.fontSize(9)
   .text('"Market Disruption Event"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean happening of an event which in the opinion of the Lender would make it unviable for the Lender to continue the Loan/Facility,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Outstanding Amounts"', { continued: true })
   .font('Helvetica')
   .text(
      ` means at any time all the amounts payable in relation to the Facility by the Borrower to the Lender, pursuant to the terms of the Financing Documents, including the following amounts:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.text(
   `a) The principal amount of the Facility and Interest there on.`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) All dues payable by the Borrower, as reflected in the books and records maintained by the Lender in its\n normal course of business from time to time.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) All other moneys, debts, and liabilities of the Borrower, including indemnities, liquidated damages, costs,\n Charges, expenses, and fees and interest incurred under, arising out of or in connection with the Financing\n Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) Any and all sums expended by the Lender in order to preserve any Security; and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `e) Any and all costs, expenses, fees, and duties for the enforcement and collection of any amounts due\n under the Financing Documents, including expenses of enforcement and realization of the Security\n and costs and expenses set out in Clause 15 (Costs, Charges, Expenses and Stamp Duty) hereto.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );






doc.font('Helvetica-Bold')
   .text('"Payment Instrument(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the instrument as specified by the Lender in the Schedule hereunder, including but not limited to ECS, NACH, digital or electronic payments, money transfer through mobile applications and PDCs, by which the Borrower shall make the payment of Outstanding Amounts to the Lender.“Person(s)” shall mean any natural person or legal entity whether incorporated or not, limited or unlimitedliability company, body corporate, co-operative society, corporation, partnership (whether limited or unlimited), proprietorship, society, HUF, trust, union, association or association of persons, body of individuals, government or any agency there of, or any other entity that may be treated as a person under the Applicable Law; “Post Date Cheque(s)” or “PDC(s)” shall mean the postdated cheque(s) issued in favor of the Lender to ensure continuity of repayment by the Borrower under the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the interest payable on the disbursed amount, at the Applicable Interest Rate, for the period commencing from the relevant disbursement date to the date immediately prior to the commencement of Repayment, payable by the Borrower on the Pre-Instalment Interest Date(s).`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   
   doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest Payment Date(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the date, if any, which is specified in the Schedule on which the Borrower shall pay the Pre-Instalment Interest;.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   doc.font('Helvetica-Bold')
   .text('"Prepayment Statement"', { continued: true })
   .font('Helvetica' )
   .text(`or`,{ continued: true })
   .font('Helvetica-Bold')
   .text('"PForeclosure Statement"', { continued: true })
   .font('Helvetica' )
   .text(
      `  shall mean the statement which shall be sent by the Lender to the Borrower, on providing the written consent as per Clause 6.3 hereunder, which statement shall contain the terms and conditions of the prepayment of the Outstanding Amount, or any part thereof by the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .font('Helvetica-Bold' )
   .text('"Purpose"',{ continued: true})
   .font('Helvetica' )
   .text(
    `  shall have the meaning as specified in the Schedule.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .font('Helvetica-Bold' )
 .text('"Receivables"',{ continued: true})
 .font('Helvetica' )
 .text(
  ` shall mean the receivables as more particularly described under the Schedule.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)


   

doc.font('Helvetica-Bold')
   .text('"Repayment"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the repayment and/or the prepayment of the principal amount of the Facility, interest thereon, Additional Interest, costs and other charges, premium, fees or other dues payable in accordance with this Agreement. The words “Repay” and “Repaid” shall be construed accordingly.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Repayment Schedule"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the manner in which the Repayment shall be made by the Borrower including details like due dates, installment amount etc. prepared in line with the details specified in the Schedule to this Agreement as may be revised from time to time and communicated to the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );






// addFooter();
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Restricted Party"', { continued: true })
   .font('Helvetica')
   .text(
      `means a person that is: (i) listed on, or owned or controlled by a person listed on, or acting on behalf of a person listed on, any Sanctions List; (ii) located in, incorporated under the laws of, or owned or (directly or indirectly) controlled by, or acting on behalf of, a person located in or organised under the laws of a country or territory that is the target of country-wide or territory-wide Sanctions; or (iii) otherwise a target of Sanctions ("target of Sanctions" signifying a person with whom a US person or other national of a Sanctions Authority would be prohibited or restricted by law from engaging in trade, business or other activities); "Sanctions" means the economic sanctions laws, regulations, embargoes or restrictive measures administered, enacted or enforced by: (i) the United States government; (ii) the United Nations; (iii) the European Union; (iv) the United Kingdom; or (v) the respective governmental institutions and agencies of any of the foregoing, including,without limitation, the Office of Foreign Assets Control of the US Department of Treasury ("OFAC"), the United States Department of State, and Her Majesty's Treasury ("HMT") or (vi) RBI or any other Indian authority (together the
`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions Authorities"');

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Sanction Letter"', { continued: true })
   .font('Helvetica')
   .text(
      `means the sanction letter as mentioned in the Schedule, issued by the Lender and accepted by the Borrower regarding the sanction of the Facility, as may be amended, modified, varied and supplemented including, any subsequent sanction letter(s) issued by the Lender regarding the Facility from time to time;
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions List"',{continued: true })
   .font('Helvetica')
   .text(
      `means the "Specially Designated Nationals and Blocked Persons" list maintained by OFAC, the Consolidated List of Financial Sanctions Targets and the Investment Ban List maintained by HMT, or any similar list maintained by, or public announcement of Sanctions designation made by, any of the Sanctions Authorities.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Security"',{continued: true })
   .font('Helvetica')
   .text(
      `shall have the meaning ascribed to it under clause 8.1 of this Agreement.
`,
      { align: 'justify', indent: 40, lineGap: 5,  }
   )
   .font('Helvetica-Bold')
   .text('"Security Interest"',{continued: true })
   .font('Helvetica')
   .text(
      `means (i) any mortgage, charge (whether fixed or floating), pledge, lien, hypothecation, assignment, deed of trust, security interest or other Encumbrance of any kind securing, or conferring any priority of payment in respect of, any obligation of any Person, including without limitation any right granted by a transaction which, in legal terms, is not the granting of security but which has an economic or financial effect similar to the granting of security under Applicable Law, (ii) any voting agreement, interest, option, right of first offer, refusal or transfer restriction in favour of any Person, and/or (iii) any adverse claim as to title, possession or use;

`,
      { align: 'justify', indent: 40, lineGap: 5, }
   );

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Security Provider"', { continued: true })
   .font('Helvetica')
   .text(
      `means the Person(s) who provide(s) security in respect of the Facility, as more particularly described under the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Taxes"', { continued: true })
   .font('Helvetica')
   .text(
      `means any present or future tax, levy, duty or other charge of a similar nature (including any penalty or interest payable on Escrow Account or any failure to pay or delay in paying the same), now or hereafter imposed by law by any Governmental Authority.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Tenor"', { continued: true })
   .font('Helvetica')
   .text(
      `means the period specified in the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"GROW MONEY CAPITAL PVT LTD Reference Rate"', { continued: true })
   .font('Helvetica')
   .text(
      `shall mean the percentage rate of interest per annum decided by the Lender from time to time and announced/notified by the Lender as the GROW MONEY CAPITAL PVT LTD Reference Rate on its website or otherwise as the case may be.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )


// addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)

   .text('1.2 INTERPRETATION', { align: 'left' })

doc.font('Helvetica')
   .text(
      `In this Agreement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `
      (a) Unless the context otherwise requires reference to a Recital/Clause and/or a Schedule of this Agreement,
       all of which constitute an integral and operative part of this Agreement.
      (b) Headings to parts, clauses and paragraphs are for convenience only and do not affect the interpretation of
       this Agreement.
      (c) Reference to any statute or statutory provision or order or regulation made there under shall include
       references to that statutes, provision, order or regulation as amended, modified, re-enacted or replaced 
       from time to time whether before or after the date hereof.
      (d) Reference to any document includes an amendment to that document, but disregarding any amendment
       made in breach of this Agreement.
      (e) Reference to an “amendment” includes a supplement, modification, novation, replacement or
       re-enactmentand “amended” is to be construed accordingly.
      (f) Unless the context otherwise requires, words denoting the singular shall include the plural and vice
       versa, and words denoting any gender include all genders.
      (g) Reference to the word “include” or “including” shall be construed without limitation.
      (h) References to a “person” or “Person” shall include that Person’s successors in title, executors, permitted
       transferees and permitted assignees and references to a Person’s representatives shall be to its officers,\n employees, legal or other professional advisers, sub-contractors, agents, attorneys and other duly authorised \nrepresentatives.
      `,
      { align: 'justify', indent: 40, }
   );
   doc.font('Helvetica')
   .text(`(i) Words`,{indent: 40,continued:true})
   .font('Helvetica-Bold')
   .text(`"hereof", “herein”, “hereto”, “hereunder”` ,{ continued:true,align: 'justify', indent: 40, });
   doc.font('Helvetica')
   .text(` or similar terms used with reference to a specific clause\n in this Agreement shall refer to such clause in this Agreement and when used otherwise than\n in connection with specific clauses shall refer to this Agreement as a whole.
    ` ,{ align: 'justify', indent: 40, lineGap: 5 });
    doc.font('Helvetica')
   .text(`(j) In the computation of periods of time from a specified date to a later specified date, the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 });

    doc.font('Helvetica-Bold')
    .text(`"from" ` ,{ continued:true,align: 'justify', indent: 40, });
    doc.font('Helvetica')
    .text(` and ` ,{ align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on" ` ,{ continued:true,align: 'justify', indent: 40, })
    .font('Helvetica')
    .text(` mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"from and including" ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on and including”, respectively" ` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`, and the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`“to”, “until” ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`each mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"to but not including", "until but not including"` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on but not including"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` respectively ` ,{align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(k) Unless otherwise specified, whenever any payment to be made or action to be taken under this Agreement,\n is required to be made or taken on a day other than a Business Day, such payment shall be made,\n or action be taken on the\n immediately following Business Day.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(l) Where a wider construction is possible, the words` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"other” and “otherwise"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` shall not be construed ejusdem\n generis with any foregoing words.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(m) A time of day is a reference to India time.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica-Bold')
.fontSize(9)

   .text('2. THE FACILITY AND PURPOSE', { align: 'left' })

doc.font('Helvetica')
   .text(
      `The Borrower hereby agrees to borrow, and the Lender hereby agrees to lend the Facility to the Borrower, subject to the terms and conditions of the Financing Documents. The Borrower hereby confirms that it shall utilize the Facility only for the Purpose as mentioned in the Schedule. If in the opinion of the Lender (which opinion shall be binding and conclusive against the Borrower) the Facility is not used for the Purpose (provided that the Lender shall not be bound to enquire as to, or be responsible for, the use or application of any funds advanced under the Facility), the Lender shall have the right to declare it as an Event of Default.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
    // addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
   .fontSize(9)
   .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.1 Subject to the conditions mentioned in this Agreement, the Lender may, at its sole and absolute discretion,\n disburse the Facility or any part thereof as per disbursement request made by the Borrower to the Lender
       any time during the Tenor of Facility. The Borrower shall ensure the following before making any request 
       for the Disbursement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.text(
   `a) no actual/potential Event of Default has occurred, is in existence and/or is continuing;`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) all the representations and warranties are correct, complete and are in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) all Conditions Precedent have been fulfilled;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
    `d) post disbursal conditions with respect to the previous Disbursement/s have been met (if any);`,
    { indent: 60, align: 'justify', lineGap: 5 }
 )
 .text(
  `e) he Security has been validly created in form and substance acceptable to the Lender as per theterms of
      the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
)
.text(
  `f) he Borrower is in compliance with the terms and conditions of the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
);
 

   // Page 5: Continue with Disbursement and Conditions


// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.2 Not withs tanding any other provision hereof, the Lender, may at its sole discretion, cancel first or any 
      further/subsequent disbursement of the Facility if, in the reasonable opinion of the Lender:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) An Event of Default is likely to occur/has occurred/is continuing/threatened/which may result from
      such disbursement or if it becomes unlawful for the Lender to disburse or continue the Facility;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) Any representation and/or warranty is not correct, complete or is not in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) Any event has occurred/is continuing which has/could result in a material adverse effect or constitute 
       a Market Disruption Event; or`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) An Applicable Law restrains, prevents or imposes adverse conditions upon the transactions contemplated
       by the Financing Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );

// addFooter();

// // Page 6: Continue Disbursement and Conditions
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.3 The fulfilment or satisfaction of any Condition Precedent may be waived or deferred in writing by the
       Lender, at its sole discretion, following a written request from the Borrower setting out:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) the Condition Precedent in respect of which the Borrower seeks a waiver/deferment, and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) the reasons for seeking such waiver/deferment.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.4 The Borrower shall promptly give a written notice to the Lender, of the satisfaction of the Conditions Precedent
       along with documentary evidence of such satisfaction by issuance of a Conditions Precedent satisfaction
       notice and if it becomes aware of any event/circumstance which will/may prevent such 
       satisfaction, it shall forthwith notify the Lender in writing.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

// addFooter();

// // Page 7: Continue with Conditions Precedent and Facility Agreement
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica-Bold')
   .text(
      `3.5 Conditions Precedent`,
      { align: 'left', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica')
   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to them
      respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );
   

// addFooter();

// ---------------------------------------new page-----------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7)

doc.font('Helvetica')
.fontSize(9)

   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to
      them respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
      
   )
   .moveDown(1);
   

doc.font('Helvetica')
   .text(`3.5.1 The Borrower assures to the Lender that it (or in case the of under construction immovable property , the
seller/builder of such immovable property will transfer the marketable title in favour of Borrower by way
ofconveyance) has absolute, clear and marketable title to the immovable property including free from
Encumbrance, any liability, charge/lien or from any litigation/court decree whatsoever, to be mortgaged by
it as Security for the Facility and Lender is free to get the title of the immovable property checked/verified in
the manner it deems fit at the cost and risk of the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 })
.moveDown(1);




doc.font('Helvetica')
   .text(
      `3.5.2 The obligation of Lender to make any Disbursement under the Financing Documents shall also be subject to
       the following Conditions Precedent:.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `The Borrower acknowledges that the Facility is granted subject to the terms and conditions specified in 
       this Agreement and any subsequent amendments or supplements made in writing by the Lender.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1)
   .text(
    `(a) Borrower shall meet the minimum creditworthiness requirements as may be specified by Lender. For this
      purpose, the Borrower will provide all the information and assistance required by the Lender so that the
      Lender may conduct any inquiries, as deemed fit and proper in the Lender’s sole discretion, in this regard. .`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) No Event of Default has occurred or is likely to occur.`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) The Borrower shall have satisfied the Lender about the (i) utilisation of the proceeds of any prior
         disbursement and (ii) proposed utilization of the proceeds of the Disbursement after the sanction 
         of Facility,within the time frame specified by Lender, along with the request for release of part 
         of the funds needed by the Borrower for the Purpose..`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d) No extraordinary or other circumstances shall have occurred which shall make it improbable for 
        the Borrower to fulfill its obligations under the Financing Documents.`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)The Borrower/Security Provider shall prior to the disbursement of the Facility have executed all security
documents and created perfect Security including but not limited to registration of charge with the
concerned registrar of sub-assurances in the form and manner acceptable to the Lender and shall ensure
appropriate filing of charge, if any, along with proper stamp duty being paid on duly executed instruments of
Security.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) The Borrower shall satisfy the Lender to the effect that there is no action, suit, proceeding or investigation
pending or threatened by or against the Borrower, Guarantor or Security Provider, before any court of lawor
Governmental Authority or any other competent authority which might have material adverse effect on the
affairs of the Borrower or the Guarantor or Security Provider.`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `3.5.3 Not with standing anything contained herein, in case any disbursement has been made, the Borrower shall
continue to be under obligation to repay along with interests and costs, the entire amount so disbursed in
terms of the Financing Documents.`,
            { align: 'justify', indent: 40, lineGap: 5 });


// addFooter();

//-------------------------------------New page ------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
   .text(
      `3.5.4 The Borrower, whenever required by the Lender, shall provide the following, in a form and substance
satisfactory to the Lender:
`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   
   .moveDown(1)
   .text(
    `(a)  Evidence that all consents, resolutions, approvals, authorizations and permissions required for availing ofthe
Facility or for creation of Security in favour of the Lender have been obtained;.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) Certified true copies of the audited accounts of the Borrower;`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) Evidence that all compliance under the Companies Act, 2013 or any other law as maybe applicable to the
constitution of Borrower, has been adhered to;
`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d)  Evidence that all duly stamped Financing Documents shall have been properly stamped, executed and have
come into force as per their respective terms duly registered with the sub registrar of assurances or any
other competent authority, in favour of the Borrower and the necessary security can be created in favour of
Lender in the form and manner as acceptable to the Borrower;
`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)Evidence to show insurance cover on the Security has been obtained to the satisfaction of the Lender;.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) Evidence, as may be deemed necessary by Lender, including but not limited to an undertaking and indemnity
that the Facility or any part thereof shall be used only for Purpose as disclosed by the Borrower;
`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `(g) Such other documents as may be required by the Lender.`,
            { align: 'justify', indent: 40, lineGap: 5 })
            .moveDown()
            doc.text(
          `The Borrower also hereby agrees and undertakes to pay the complete stamp duty due on Financing Documents or any other document related thereto and in the event of any deficiency or default thereof, the Borrower shall indemnify and keep the Lender indemnified from and against any actual payment, losses and cost that the Lender has or may have incurred towards the same within `,
              { align: 'justify', indent: 40, lineGap: 5, continued: true }
           );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand. Borrower undertakes to regularize the documents, if required, by the respective courts or collector of stamps, by paying the actual difference in stamp duty and the amount of penalty as may be applicable. In the event, any litigation is initiated under this Agreement, Borrower agrees to indemnify the Lender from any actual and direct loss, cost, expenses that it may incur or suffer in defending the litigation within `,
                 { align: 'justify', indent: 40, lineGap: 5, continued: true }
              );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              );
              doc.moveDown();

              doc.font('Helvetica-Bold')
              .text('3.6 Amortisation', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `3.6.1 The Borrower will amortise the Facility strictly as stipulated in the Schedule, subject to any other changes in
such amortisation as communicated later in writing by Lender to the Borrower. However, in the event of
delay or advancement, for any reason whatsoever, in the disbursement of Facility, the Due Date of payment
of first Instalment shall in such case be the corresponding day of the following months to the day currently
stated in the Schedule.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `3.6.2 The Borrower shall also pay to Lender, the Pre-Instalment Interest as maybe applicable on the Facility under
the terms of this Agreement..`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `3.6.3 The Borrower agrees that the amount shall be remitted to Lender on each and every Due Date of the
Instalments. In the event of any dishonour of Payment Instrument, the Borrower agrees to pay a dishonour
charge as mentioned in the Sanction Letter, in addition to any Additional Interest that may be levied by
Lender as per its discretion`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           



    // addFooter();

    //-----------------new page-----------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica')
     .fontSize(9)
    .text(
      `3.6.4 In the event of any variation in the date of payment of Instalments/the amount of Interest, principal or
Instalments/the numbers thereof, the Borrower undertakes to forthwith issue fresh PDCs/ECS/such other
payment instruments as may be required by Lender`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `3.6.5 Notwithstanding anything herein, Lender shall always have the right to review and reschedule the
repayment terms of the Facility or of the outstanding amount thereof in such manner and to such extent as
Lender may decide. In such event/s the Borrower shall repay the Facility or the Outstanding Amount
thereof as per the revised Schedule as may be determined by Lender in its sole discretion`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `3.6.6 In case any amount is prepaid by the Borrower, unless otherwise decided by the Lender in its discretion, the
same shall be adjusted/appropriated towards the Pre-Instalment Interest, other applicable interest,
principal outstanding and the balance towards other charges under the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.moveDown();

doc.font('Helvetica-Bold')
              .text('4. INTEREST', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `4.1 The Borrower shall pay Interest to the Lender in respect of the principal amount of the Facility outstanding
from time to time, and on all fees, costs, commissions, Charges and other amounts due under or in respect of
this Agreement under the Facility at the Applicable Interest Rate. It is hereby clarified that the Lender may, in
its discretion among other alternatives, require the Borrower to pay upfront the Pre- Instalment Interest at
Applicable Interest Rate or the Pre-Instalment Interest may be deducted from the amount of the Facility
disbursed.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `4.2 Interest shall be payable at Applicable Interest Rate (or such other rate as may be notified by the Lender
from time to time) through such Payment Instruments and in the manner specified and at such intervals
specified under the Schedule.`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `4.3 The Applicable Interest Rate for the Facility provided on floating rate of interest shall be calculated with
reference to the GROW MONEY CAPITAL PVT LTD Reference Rate and shall comprise of GROW MONEY
CAPITAL PVT LTD Reference Rate plus margin (as may be agreed with the Lender from timeto time). It is
hereby clarified that the GROW MONEY CAPITAL PVT LTD Reference Rate and the Applicable Interest Rate
may fluctuate/vary from time to time or as may be determined by the Lender in its absolute discretion.`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           doc.font('Helvetica-Bold')
           .text(
            `4.4 In the event of default on the part of the Borrower in the payment of any sum due hereunder, in any
manner whatsoever or the Borrower committing any breach or default of any condition of this
Agreement or Financing Document, the Borrower shall pay to the Lender, Additional Interest at the
Additional Interest Rate which will be calculated on a daily basis over and above the Applicable
Interest Rate to be charged on the overdue Installment(s). Such interest shall be payable on and from
the date of default to and including the date on which such delay or defaultis rectified (“Additional
Interest”). The Lender’s right to claim such Additional Interest shall be without prejudice and in
addition to the Lender’s right to take any other action available to it under the terms of this
Agreement or at law in respect of such event of default.`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );

         doc.font('Helvetica')
           .text(
            `4.5 In the event of revision of Applicable Interest Rate, the Lender shall notify the same to Borrower, such
notification shall form a part of this Agreement. In the event the Borrower does not agree to such revision,the
Borrower shall forthwith repay the Outstanding Amount within 30 (thirty) days from the date of intimation.
In case if such repayment is not forthcoming within the said period, the Borrower shall be liableto service the
Facility in accordance with the revised interest rate`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );



    // addFooter();
//-------------------new page--------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `4.6 The Borrower acknowledges that any sums, interest, default amount including but not limited to
(i) the Prepayment Charges and (ii) the Additional Interest, are reasonable and that they represent
genuine pre-estimates of the loss which would be incurred by the Lender in the event of nonpayment or 
default by the Borrower in accordance with the Financing Documents. The Borrower waives any right it 
may have to raise any claim/defence in this regard.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `4.7 Interest, Additional Interest and all other charges shall accrue from day to day on the actual number
of days elapsed and shall be calculated on an actual day count basis, i.e., actual number of days
elapsed divided by the actual number of days in the year`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica')
 .text(
  `4.8 The Borrower confirms, agrees and acknowledges that it has perused and understood the Lender’s method
of calculating the Applicable Interest Rate and further agrees and undertakes to abide by the same without
any demur/objection.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `4.9 The Borrower acknowledges that the Facility provided under this Agreement is for a commercial transaction
and the Borrower waives any defences available under usury or other laws relating to the charging of
interest.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

// point 5

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5. DISBURSEMENT`,
      { align: 'left' }
   );
   doc.moveDown();
   doc.font('Helvetica')
   .text(
    `The Facility can be disbursed by the Lender in one or more tranches in its sole and absolute discretion,
subject to the terms contained in the Sanction Letter and this Agreement. The Disbursement can be doneby
the Lender either in favour of/in the bank account of the Borrower or in favour of/in the bank account ofsuch
person/entity who/which is specified by the Borrower in its request for Disbursement to the Lender.
Nothing contained herein shall be deemed to be a guarantee or an assurance on behalf of the Lender
regarding Disbursement of the Facility.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.1 Schedule of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
 .text(
  `Subject to fulfilment of the Conditions Precedent and at the Lender’s discretion, the Facility shall be
disbursed in single or in multiple tranches as more specifically detailed in the Sanction Letter.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.2 Mode of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
.text(
  `All payments to be made by the Lender to the Borrower under this Agreement shall be deposited in the bank
account which is maintained by the Borrower which maybe specified in the disbursement request, by way of
Real Time Gross Settlement (RTGS)/Cheque/s duly crossed and marked “A/c Payee Only” or such other
manner as specified by the Lender in the Schedule and the collection charges, if any, in respect of 
RTGS/cheque(s) and/or such other instruments as specified in the Schedule will have to be borne by the
Borrower. The Interest on the Facility will begin to accrue in favour of the Lender from the date on which the
Disbursement is done by the Lender by way of making/issuance of the RTGS/cheque(s) and/or such other
instruments as specified in the Schedule irrespective of the time taken for transit or for collection/realization
thereof. Without prejudice to anything contained herein, if necessitated by prevailing circumstances, the
Lender shall be at liberty to use any other method or mode for disbursement underthis Agreement and if the
same is not rejected by Borrower, then such disbursement shall be deemed to be accepted disbursement and
have same effect as any other Disbursement under the Agreement.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//------------------------new page-------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.3 Other Charges`,
      { align: 'left' }
   )
   
   .text(
    `The Borrower shall, on or before the date of the first drawdown/disbursal of the Facility, pay to the
Lender the Charges as specified by the Lender from time to time. The Borrower hereby agrees that
any amount outstanding from his/her/its any other loan/facility with the Lender may be, deducted
and/or adjusted from amount disbursed or held with Lender under this Agreement.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 ).moveDown();

 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `6. REPAYMENT / PREPAYMENT
`,
      { align: 'left' }
   ).moveDown();
 doc.font('Helvetica')
 .text(
  `6.1 Except as otherwise agreed by the Lender, the Borrower shall repay the amounts under the Facility
outstanding from time to time on each and every Due Date in an amount equal to the Instalment as specified
in the Repayment Schedule provided that:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `a) The Facility shall be repaid in full by the final repayment date as specified in the Repayment Schedule 
  through such payment instruments as specified in the Schedule;`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `b) The Lender shall be entitled to demand immediate repayment of the entire amount of the Facility
outstanding if any portion of the principal amount of the Facility or any interest due thereon is not paid as
and when it is due to be paid; and`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `c) The Borrower shall repay the principal amount of the Facility along with interest & costs under the
Agreement free from and clear of any deduction and/or set off on any account whether by operation of law or
otherwise and if any such deductions are required by operation of law or otherwise, then same shall be
entirely borne by the Borrower. It is hereby clarified that in case the Borrower has been sanctioned multiple
facilities, there will not be any setoff without the prior written consent of the Lender.`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown()
.text(
  `6.2 The Borrower shall be solely responsible to timely pay all costs, Charges and expenses of the Lender
promptly as and when required to do so by the Lender and the Lender shall be under no obligation to
provide the Borrower with any notice, reminder or other intimation to the Borrower regarding its obligation
to pay the same.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica-Bold')
.text(
  `6.3 The Borrower may become entitled to prepay the Facility through such Payment Instruments as
specified in the Schedule only with the prior written consent of the Lender (extent of which may or
may not be granted by the Lender). If acceptable to Lender, then any prepayment shall be done only
after the expiry of such period as maybe specified in this regard under the Sanction Letter, by giving
not less than 7 (seven) days’ notice to the Lender and provided that any such prepayment shall be
made subject to payment of any prepayment costs (“Prepayment Charges”) as specified herein or in
Sanction Letter. The Lender shall provide to the Borrower a Prepayment Statement and the Borrower
shall prepay the whole or any part of the Facility strictly in accordance with the Prepayment
Statement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.text(
  `6.4 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility, the Lender shall promptly
notify the Borrower upon becoming aware of that event and the Lender shall be at liberty to not make any
further advancement of amount under Facility and it shall be entitled to call in the entire Outstanding
Amounts forthwith and the Borrower shall on such date as the Lender may specify, without demur or dispute
whatsoever, repay the Outstanding Amount owing to the Lender in respect of the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//--------------new page-------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `7. INCREASED COSTS`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `If, by reason of (i) any change in law or in its interpretation or administration and/or (ii) compliance with
any request/requirement of RBI or any other authority, which request/requirement affects the manner in
which the Lender is required to or does maintain capital resources or reserves having regard to Lender’s
obligations hereunder and to amounts owing to it hereunder, the Lender:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `(a) incurs a cost as a result of Lender having entered into/complying with and/or performing
   its obligations under this Agreement; or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(b) becomes liable to make any payment on account of tax or otherwise (not being a tax imposed on
the net income of the Lender) on or calculated by reference to the Facility sanctioned or to be
sanctioned by the Lender hereunder and/or to any sum received or receivable by it hereunder,
then the Borrower shall, from time to time on demand of the Lender, promptly pay to the Lender
amounts sufficient to indemnify the Lender against, as the case may be (1) all such costs as above,
( 2) such reduction in such rate of return (or such proportion of such reduction as is, in the
opinion of the Lender, attributable to its obligations hereunder), 
(3) such increased cost (or such proportion of such increased cost as is, in the opinion of the Lender,
 attributable to its funding or maintaining an advance hereunder) or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(4) such liability. The Lender shall also be entitled to recover such increased cost, reduction in rate of return
and any such liability incurred by the Lender by deducting an amount equivalent to the same from the
subsequent disbursal or drawdown to be made to the Borrower.
`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `8. SECURITY`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `8.1 In consideration of the Lender making available the Facility and to secure the repayment of the Outstanding
Amounts, the Borrower agrees that the Security Interest shall be created in favour of the Lender in the form
and manner satisfactory to the Lender on the asset/s as more specifically mentioned in the Schedule of the
Agreement     `,
  { align: 'justify', indent: 40, lineGap: 5,continued:true }
)
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `            (“Security”).`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.text(
  `8.2 The Borrower hereby agrees that it shall, at all times during the Tenor of the Facility, ensure that the Security
provided by the Borrower or Security Provider (other than Borrower) under this Agreement is of such value
as is sufficient to meet the security cover requirements of the Lender as specified in the Schedule. In the
event either the value of the Security deteriorates and/or the Lender advances further sum(s) to the
Borrower under this Agreement such that the value of the Security provided by the Borrower under this
Agreement does not meet the security margin requirements of the Lender, then the Borrower shall deposit
with the Lender, additional security in the form of cash or such other securities as are acceptable to the
Lender, failing which the Lender may at its discretion sell, dispose of, or realise any or all of the Security
without being liable for any loss or damage or diminution in value of the Security.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `8.3 The Security, if any created/to be created by the Borrower/Security Provider in favour of the Lender shall be
released by the Lender on complete payment of the Outstanding Amounts and/or any other outstanding
dues of the Borrower/s (whether a Borrower or a Guarantor) to any of its affiliates or group companies.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);


// addFooter();

//-----------------------------new page-------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
    .text(
      `9. CO-LENDING ARRANGEMENT`,
      { align: 'left' }
    ).moveDown();
    doc.font('Helvetica')
   .text(
      `9.1 Without prejudice to anything contained in this Agreement, the Lender reserves the right to enter into a co-
      lending arrangement    `,
      { align: 'justify', indent: 45, lineGap: 5, continued: true }
   );

doc.font('Helvetica-Bold')
   .text(
      `              ("Arrangement")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      ` in pursuance to and subject to applicable guidelines/circular`,
      { align: 'justify', indent: 40, lineGap: 5 })

       
      .text(`/notification issued by the RBI, from time to time, with anyone of the banks or financial institutions of 
        its choice with which the Lender has entered into a formal agreement for co-lending of the Facility(ies)        `,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.font('Helvetica-Bold')
   .text(
      ` ("Bank or Lender 2")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      `, therefore whole or a part of the disbursed Facility amount might be taken over by the 
        concerned bank in its books as per the agreed terms of Arrangement by and between Lender and Bank.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `9.2 If Bank and Lender enters into an Arrangement with respect to Facility under this Agreement then
subsequent to Bank taking its share of Facility amount in its books, the Bank for all technical, legal and
operational purposes shall become a co-creditor of the Borrower in form of a co-lending partner of Lender.
The Borrower is aware about the possibility of Arrangement taking place between Lender and Bank. It is
clarified that subject to the terms of the Arrangement all the duties, obligations, rights, benefits and
entitlements of Lender as contained in this Agreement or other Financing Documents, in addition to Lender,
shall also inure to benefit of the Bank, and the extent, manner and form of exercising such duties,obligations,
rights, benefits and entitlements of Bank shall depend upon the understanding between the Lender and Bank
as maybe contained in the Arrangement. The Borrower also has acknowledged all the other probable
implications of such co-lending arrangement on the Facility provided herein and Borrower’s responsibilities
thereof.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   .text(
    `9.3 If the Lender enters into an Arrangement with Bank, then the right to take recovery/legal action or initiate
appropriate legal proceedings against the Borrower on the default by the Borrower under this Agreement or
other Financing Documents and all the remedies available can be exercised jointly or severally by the Lender
and/or Bank, or by the Lender on behalf of the Bank or vice-versa depending upon the terms of Arrangement.
The remedies available to the Lender and Bank under the law, this Agreement or equity shall be in addition to
each other or cumulative. The manner, form and time of exercising the rights or remedies will be as per the
discretion the Lender and/or Bank (as the case maybe).`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )

 .text(
  `9.4 The Borrower unconditionally accepts and acknowledges that it shall abide/comply by/with the instructions
which might be issued by the Lender with respect to the Facility upon Arrangement taking place between
Lender and Bank. The Borrower also unconditionally accepts and acknowledges that Lender may
change/modify any of the terms contained in Schedule I appended hereto by way of an intimation through a
letter or a notice thereof and the Borrower shall duly comply with such letter or notice without any delay or
demur.`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `9. CO-LENDING ARRANGEMENT`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `The Borrower undertakes to make payments of all the amount payable to Lender under the Financing
Documents into the Designated Account of the Lender, however, without prejudice to the aforementioned,the
Lender reserves the right to make Borrower enter into an escrow mechanism for such payments and to which
Borrower agrees to as under:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

    


// addFooter();

//-------------------new page----------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `10.1 The Borrower can be required to open, establish and maintain the Escrow Account during the entire or part
of Tenor of the Facility with the Account Bank as per terms of this Agreement and/or the Escrow Agreement
or just make the payments of Outstanding Amounts into the Escrow Account, as maybe directed by the
Lender`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.2 If opened, Escrow Account shall not be closed without the prior written approval of the Lender. All costs,
Charges, expenses, fees in connection with the Escrow Account shall be borne by the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.3 If required by the Lender, the Borrower shall deposit/transfer all Receivables in the Escrow Account at the
end of the day of receipt of the Receivables`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.4 Subject to the Applicable Law, the Lender shall be the joint signatory in the Escrow Account as per the
Escrow Agreement until the Facility is fully repaid. In the Event of Default and subject to Applicable Law, the
Lender and/or Bank shall become entitled to create charge (by way of lien or otherwise) over the bank
account of Borrower as linked with Escrow Account and utilize the proceeds thereof towards Outstanding
Amounts or any in any other manner as Lender may deem fit.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.6 Provided that nothing contained herein or under any other document/s regarding the Arrangement with the
Bank shall be applicable if the Lender does not formally enter into Arrangement with the Bank, in which case
the Borrower shall continue to discharge all its obligations contained in this Agreement or other Financing
Documents, in favour of the Lender alone and the Facility shall be deemed to be provided by a single entity,
i.e., Lender. Unless the details of Bank are specifically mentioned herein or intimated to Borrower through a
separate letter or notice, the Borrower shall always presume that the Lender has not entered into an
Arrangement regarding the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `11. CANCELLATION`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `Notwithstanding anything contrary contained in this Agreement:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `11.1 The Borrower agrees that the Lender shall at any and all time, during the currency of the Facility have an
unconditional right to terminate and/or cancel the un-utilized or un-disbursed portion of the Facility
(whether in part or in full) at its sole discretion as well as withdraw and/or recall the disbursed Facility or
any part thereof on the occurrence of any actual/potential Event of Default whereupon, forthwith all
Outstanding Amounts under the Facility shall immediately become due and payable by the Borrower to the
Lender. Provided, no notice will be given by the Lender to the Borrower, where an Event of Default has
already been declared.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).text(
  `11.2 The Borrower agrees that the Facility shall be repaid upon the happening of a Market Disruption Event and
the Lender can, at any time, at its sole and absolute discretion, terminate, cancel, withdraw or recall the
Facility or any part thereof without any liability and without any obligation to give any reasons whatsoever,
whereupon all Outstanding Amounts under the Facility shall immediately become due and payable by the
Borrower to the Lender forthwith upon demand made by the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


    // addFooter();

    //------------------------new page---------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12. BORROWER’S REPRESENTATIONS AND COVENANTS`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `12.1 Representations`,
{ align: 'left' }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `12.1.1 The Borrower hereby agrees and represents that for so long as any of the Outstanding Amounts are 
  dueand payable, the Borrower shall ensure and confirm that:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

.text(
  `(i) It is duly organised and validly existing under law and has the requisite legal power and authority to execute
this Agreement and carry out the terms, conditions and provisions hereof and the performanc e by the
Borrower of this Agreement does not and will not violate any Applicable Law, its constitutional documents,
any judgment, order, decree, writ or Governmental Approval or any agreement to which the Borrower is a
party or by which it is bound or any consents, Governmental Approvals or waivers, as the case may be, of any
Person required to give effect to and complete the transactions contemplated hereunder;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ii) The Borrower is carrying out or conducting the Business and shall continue to do so as per Applicable Law
and it will, at all times, comply with and abide by all Applicable Laws;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(iii) The execution, delivery and performance hereof have been duly authorized by all necessary Government
Approvals, permissions, corporate action, consents, etc. under the laws applicable to the Borrower, and the
individual executing this Agreement and other ancillary documents is duly authorized and duty-boundto do
so and other ancillary actions and the agreement so executed and delivered would be legally binding on the
Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) The Borrower and authorized Persons of the Borrower executing this Agreement and other ancillary
documents, confirm that all the representations and warranties made by the Borrower thereunder and all
other Financing Documents and all the information provided to the Lender are true and correct and such
authorized Persons, as the case may be, have checked the correctness of such representations and
warranties;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(v) The Borrower has not taken any action, nor have any steps been taken or legal proceedings of any manner
been initiated or threatened against or notice been received by the Borrower for its incompetency to enter
into a contract, winding-up, dissolution, administration, re-organisation, insolvency, bankruptcy,
appointment of receiver, administrator or other court officer of the Borrower or all of any of its assets,
businesses or undertakings or for the appointment of any provisional liquidator or any interim resolution
professional or resolution professional in terms of the Code;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(vi) There is no restriction, action, suit, proceeding or investigation pending and/or continuing or to the
knowledge of the Borrower threatened by or against the Borrower or the property of the Borrower or its
partners, directors, key managerial personnel, subsidiaries or group companies before any court of law,
Government Authority or other competent authority on account of any due and payable Taxes or other sums
or any other matter which may have a material effect on the affairs of the Borrower, or which may call into
question the validity, enforceability or performance by the Borrower of any or all terms of this Agreement
nor has any of the aforementioned, any knowledge of any existing ground on which any claim, investigation
or proceeding might be commenced;`,
{ align: 'justify', indent: 50, lineGap: 5 }
);



    // addFooter();

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(vii) The Borrower has obtained all Governmental Approvals for availing of the Facility, and creating the Security
and will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(viii) No actual/potential Event of Default has occurred and/or is in existence or continuing;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ix) All factual and other information provided to the Lender are true and accurate as at a date no earlier thanthe
date on which it was provided;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(x) The Borrower will promptly inform the Lender about any litigation, dispute, or any proposal by aregulatory
body to acquire the Security, or any of it;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xi) The Borrower at any time has not received any notice or intimation regarding insolvency proceedings
initiated against it or it being incompetent to enter into a contract;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xii) No proceeding is pending and/or initiated and/or threatened against the Borrower for or on account of any
Taxes or any other sums, which may be due and payable by the Borrower to the Government of India or to
any State Government or Government Agency;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xiii) Neither the Borrower nor any of its Security Assets is entitled to immunity from suit, execution, attachment
or other legal process initiated by Lender. This Agreement and the other Financing Documents constitutes,
and the exercise of its rights and performance of and compliance with its obligations in relation thereto, will
constitute, private and commercial acts done and performed for privateand commercial purposes; perfectly
binding on the Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xiv) There is no circumstance in existence, or which is likely to come into existence, which may affect the
enforceability of the Security or transferability of the Security Assets pursuant to enforcement of the
Security;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xv) The audited annual accounts of the Borrower for the year(s) as may be specified by the Lender, have been
prepared as per the applicable accounting principles/standards in force consistently applied and give, in
conjunction with the notes thereto, a true and fair view of the financial condition and position of the
Borrower during the financial year then ended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvi) There has been no material adverse change in the financial condition of the Borrower, nor has any event,
which is/may be prejudicial to the interest of the Lender and/or which is likely to materially and/or
adversely affect the Borrower/Lender to perform all or any of its obligations hereunder, taken place or in the
Borrower’s estimation, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvii) There are no charges, or liens of whatsoever nature against any of the Borrower’s/Security Provider’s
assets charged and/or agreed to be charged in favour of the Lender;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) No facts, circumstances or events, materially detrimental to the borrowing, the ability of the Borrower to
meet its obligations hereunder and/or in respect of the Facility, and/or the financial condition of the
Borrower, and/or the ability of the Lender to exercise its rights hereunder and/or under the documents
creating the Security and/or to receive due Repayment and payment of the amounts due by the Borrower
under the Facility, has occurred or, in the estimation of the Borrower, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xix) The Borrower/Security Provider has the interest, right, title or ownership over the assets comprising the
Security and such assets are free from any existing or potential encumbrances; In Event of Default underthis
Agreement, the Lender will be able to enforce such Security without any hinderance or objection fromany
person (whether individual/s or body corporate) including the Borrower or its associated.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();


    //new

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xx) Never have the name of the Borrower nor any of Borrower’s directors/associate/partner or key managerial
persons or Guarantor or Security Provider has never appeared in the willful defaulters’ list, orany other list
of defaulters published by competent authorities from time to time;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxi) The Borrower will, at all times, comply with and abide by all Applicable Laws and directions, regulations,
circulars and instructions notified or issued by the concerned regulator from time to time including but not
limited to all labour welfare related and environment protection statutes and provisions. All the
environmental authorisations/permissions required under the Environmental Protection Act 1986 and
other environmental laws in India as applicable in relation to the business and operations of the Borrower
have been obtained and maintained in full force and effect and nothing has occurred or will occur in
future, which might cause such environmental authorization/permission to be revoked, suspended or
amended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxii) The Borrower shall comply with, and shall conduct its business operations, and maintain its assets,
equipment, property, leaseholds, and other facilities in compliance with all Applicable laws relating to the
environment, labour laws and health and safety measures. The Borrower shall maintain all required
approvals relating to: (i) air emissions; (ii) discharge of surface water or ground water; (iii) noise emissions;
(iv) solid or liquid waste disposal; (v) the use, generation, storage, transportation, or disposal of toxic or
hazardous substances or wastes; and (vi) other environmental, health, or safety matters.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxiii) The Borrower shall comply with and shall conduct its business operations as per all the labour laws
applicable in India including but not limited to The Minimum Wages Act, 1948, The Factories Act, 1948, The
Industrial Disputes Act, 1947, The Child Labour (Prohibition and Regulation) Act, 1986 as amended from time
to time. Borrower also represents that it will ensure strict adherence to all the labour laws and implement the
policies as per the rules/guidelines/instructions issued by the governmental authorities therein.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxiv) The Borrower agrees and confirms that , neither the Borrower or Guarantor, and none of their subsidiaries
and, to the knowledge of senior management of each Borrower or Guarantor, none of its affiliates and none
of its respective officers, directors, brokers or agents, acting in their capacity on behalf of such Borrower or
Guarantor or such subsidiary or affiliate (i) has violated or is in violation of or shall violate any applicable
anti-money laundering law; (ii) has engaged or engages in any transaction, investment, undertaking or
activity that conceals the identity, source or destination of the proceeds from any category of offenses
designated in any applicable law; (iii) is a Restricted Party; or has received notice of or is aware of any action
or investigation against it with respect to any Sanctions by any Sanctions Authority; (iv) directly or indirectly
violated applicable anti-corruption laws or made, undertaken, offered to make, promised to make or
authorized the payment or giving of a prohibited payment; (v) used funds or other assets, or made any
promise or undertaking in such regard, for the establishment or maintenance of a secret or unrecorded fund;
or (vi) made any false or fictitious entries inany books or records of the Borrower, Guarantor or any member
of the affiliates relating to any prohibited payment with respect to the transactions contemplated by this
Agreement or the other Financing Documents.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

// addFooter();
//--------------------------------------------new page--------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `(xxv) The Borrower and/or Security Provider will not seek to claim or recover from the Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of the Lender in respect of the Security, taken
or omitted by the Lender in terms hereof and/or pursuant hereto and/or to protect any of its interests and
rights as the lender or a creditor, and the Borrower and/or Security Provider hereby expressly waives any
right to seek or make any such claim or recovery on any grounds whatsoever;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxvi) The Borrower herby acknowledges to maintain a sufficient security cover of such proportion of the amount
financed by the Lender, as specified in the Schedule hereunder during the Tenor or term of the Facility;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxvii) The Borrower herby confirms that the fair value of the assets of the Borrower exceeds all of its aggregate
liabilities whether under this Agreement or under any other agreement or any business arrangement (ii) the
Borrower has the ability to meet all of its obligations as they mature under any business arrangementor any
agreement; and (iii) the Borrower has sufficient capital to carry on its business.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxviii) The Borrower confirms that all insurances coverage, in relation to the assets of the Borrower or security
provider (other than Borrower) [ including immovable property(ies)/plant and machinery /stocks] which
have been provided to the Lender as Security, have been obtained, and are in full force and effect and it has
complied with all its obligations under the respective insurance contracts including payment of regular
insurance premium thereon, and no event or circumstance has occurred nor has there been any omission to
disclose a fact which in any such case would entitle any insurer to avoid or otherwise reduce its liability
thereunder compared to the amount provided in the relevant policy and insurance coverage provided by
such insurance;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxix) Borrower and/or Security Provider has obtained all Governmental Approvals for creating the Security and
will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxx) The execution and delivery of the security agreement and documents to be executed in pursuance hereof,
 in favour of the Lender, and the performance of the Borrower and/or Security Provider’s obligations
thereunder does not and will not (i) contravene any Applicable Law, statute or regulation or any judgment or
decree to which the Borrower and/or Security Provider and/or its assets, businesses and/or undertakings is
subject, (ii) conflict with or result in any breach of, any of the terms of or constitutedefault of any covenants,
conditions and stipulations under any existing agreement or contract or binding to which the Borrower
and/or Security Provider is a party or subject, or (iii) conflict or contravene any provision of the
memorandum and the articles of association and/or any constituting/governing documents of the Borrower
and/or Security Provider;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxxi) The Borrower will not utilize the Facility for any activity other than the Purpose as mentioned in the
Schedule hereunder and that the Security will not be charged or Encumbered in favor of any other
bank/financial institution`,
{ align: 'justify', indent: 50, lineGap: 5 }
);


    // addFooter();

    //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12.2 Covenants and Undertakings`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `A. Affirmative Covenants`,
{ align: 'left',indent: 43, }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `The Borrower hereby agrees and undertakes to the Lender and represents that for so long as any of 
 the Outstanding Amounts are due and payable, the Borrower shall:`,
{ align: 'justify', indent: 41, lineGap: 5 }
)
.text(
  `(i) Allow representative(s) and/or nominee(s) (including agent, investor, financier and any authorized
personnel of the Lender) of the Lender to enter into the premises of the Borrower in order to inspect and
audit the property, books of account and other relevant accounts, documents and records of the Borrower
provided to the Lender for the obligations of the Borrower hereunder, and the Borrower shall fully
facilitate/co-operate in this regard by making its personnel and such information/documents available during
such inspection or audit and the costs incurred thereby shall be borne by the Borrower:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(ii) Execute in favour of the Lender and/or its nominee(s) such further documents, forms and/or papers as the
Lender may in its absolute discretion require in connection with the Facility`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iii) Completely repay the Facility and Interest and costs thereon and all monies owing to Lender hereunder,
according to the terms of this Agreement and comply with any further instruction as maybe issued by the
Lender from time to time in this regard;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) Promptly notify the Lender of any change in the Borrower’s address, phone number, employer name, email
address;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(v) Provide to the Lender all the documents and information as may be requested by the Lender from time to
time in terms of the Know Your Customer (“KYC”) guidelines issued under any applicable laws or by any
regulator/government authorities and keep the same updated at all times during the validity of the Financing
Documents;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(vi) Promptly inform the Lender of any occurrence, event or incident of which it becomes aware which might
adversely affect the Borrower or affect its ability to pay any amount when due or to perform its obligations
under this Agreement and/or in respect of the Facility;
(vii) Promptly inform the Lender of any material deviation or change in any other information submitted by the
Borrower to the Lender at any time before or after entering into this Agreement;
(viii) Pay regularly all taxes, assessments, dues, duties, levies and impositions as may, from time to time, be 
payable to any Governmental Authority;
(ix) Immediately notify Lender upon becoming aware of any actual/potential Event of Default.
(x) Furnish such other documents and/or information as may be required by the Lender.
(xi) At its own cost and expense keep all immovable property(ies)/plant and machinery/stocks of the Borroweror
Security Provider (other than Borrower) which have been provided to the Lender as Security in respect of the
obligations of the Borrower under this Agreement fully insured against such risks, and for such amount(s)
and for such period and in such form(s) as the Lender may from time to time require, either in the joint names
of the Lender and the Borrower, or with the Lender named as loss payee therein, with such reputable
insurer(s) as the Lender shall approve in writing. The Borrower shall deposit with the Lender all such
insurances along with any cover notes and receipts evidencing payment of premia etc.
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

    //next
     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xii) In relation to such insurances as are required to be maintained pursuant to this Agreement, the Borrower
shall make punctual payment of all premia to be paid in relation to such insurances and shall not do or suffer
to be done any act which may invalidate such insurance.
(xiii) In the event the Borrower becomes entitled to make any claims under the above insurances, promptly 
make a claim under such insurances, and apply all monies received either in reinstatement of the property
-(ies)/plantand machinery/stocks insured or towards repayment of the Outstanding Amounts.
(xiv) If the Borrower fails to insure and/or keep insured any of the [property(ies)/plant and machinery/stocks]
provided to the Lender as Security the Lender shall, without prejudice to its rights and liabilities under this
Agreement or at law, be at liberty to insure and keep insured any of the above [property(ies)/plant and
machinery/stocks] and the Borrower shall on demand repay the Lender all fees, costs, commissions and
Charges incurred by the Lender in doing so.
(xv) Promptly inform the Lender about any occurrence, event, incident, litigation, arbitration, investigative,
regulatory or administrative proceeding/action having a material adverse effect on the condition, assets,
operations, prospects or business of the Borrower, its ability to perform and comply with its obligations in
respect of the Facility, the validity, legality or enforceability of, or the rights or remedies of the Lender under
this Agreement or any other document in relation to the Facility and the validity, legality or enforceability of
the Security or on the priority or ranking of the Security.
(xvi) Deliver to the Lender as soon as the same becomes available:
(a) but in any event within 30 (thirty) after the end of each of its financial years, its audited financial
statements for that financial year;
(b) but in any event within 30 (thirty) after the end of each half of each of its financial years, its unaudited
financial statements for that financial half year; and
(c) any other statement or statements or information pertaining to the operations of the Borrower as the
Lender may reasonably require, within such period as required by the Lender.
(xvii) Maintain adequate and proper books, accounts and records in accordance with generally
accepted/applicable accounting principles, standards and practices, consistently applied;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) Perform, on Lender’s request, acts necessary to carry out the intent of this Agreement.
(xix) Promptly inform the Lender of any distress or other process of court being taken against any of the
Borrower’s premises/assets;
(xx) Promptly inform the Lender of any change taking place in the ownership or control of the Borrower
whereby the effective beneficial ownership or control of the Borrower will materially change;
(xxi) Without prejudice to the Borrower’s obligations hereunder, it shall furnish to the Lender:
(a) within six months after the close of each of the Borrower’s fiscal year or such other period as reasonably
required by the Lender, a copy of the annual report of the Borrower, certified by a chartered accountant of
recognized standing, acceptable to the Lender together with financial statement consisting of a balance sheet
and profit and loss account as of the end of such fiscal year;
(b) any other publicly available information and statements respecting the financial condition and operations of
the Borrower as the Lender may from time to time reasonably request.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`(xxii) Comply and shall cause each other Security Provider to comply in all material respects with all applicable
anti-money laundering laws and shall not engage in any transaction, investment, undertaking or activity that
conceals the identity, source or destination of the proceeds from any category of offenses designated in any
applicable law.
(xxiii) Comply with all Conditions Precedent as stated in Clause 3.5 and the Schedule.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`B. Negative Covenants`,
{ align: 'left',indent: 45, }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) For so long as any of the Outstanding Amounts are unpaid, the Borrower shall not change in its constitution
or management without the prior written consent of the Lender and shall not:
`,
{ align: 'justify', indent: 45, lineGap: 5 }
)
.text(
  `(i) Create or permit to subsist any encumbrance or charge over all or any of the charged assets of the Borrower
or take any action which may materially impact the ability of the Borrower to pay any amount when due or
to perform its obligations under this Agreement and/or in respect of the Facility;
(ii) Effect any merger, amalgamation, reconstruction or consolidation or effect any material change in the
management/ownership of the Borrower;
(iii) Stand as surety for anybody or guarantee the repayment of any loan or overdraft or the purchase price of
assets.
(iv) Change its existing accounting methods or policies followed by it as on the date of execution of this
Agreement, during the currency of Facility unless otherwise required in terms of the prevailing Applicable
Law or change in Applicable Law;
(v) In case the Borrower is a Company;
i. Declare or pay dividends in respect of any financial year if an Event of Default has occurred or is
continuing or in case there is an asset liability mismatch in the books of the Borrower;
ii. make any amendments to the ‘objects’ clause in its memorandum or make any changes into its
constitutional documents.`,
  { align: 'justify', indent: 50, lineGap: 5 }
  )
  .text(
    `(b) For so long as any of the Outstanding Amounts are still outstanding, Borrower shall not utilise the
Facility for:`,
    { align: 'justify', indent: 45, lineGap: 5 }
    )
    .text(
      `a) Investments in any company/entity by way of shares, debentures, etc
b) Subscribing to Initial Public Offerings (IPOs) and for purchase of shares from secondary market.`,
      { align: 'justify', indent: 50, lineGap: 5 }
      ).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13. EVENT OF DEFAULT`,
{ align: 'left',indent: 45, }
).moveDown();
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13.1 Event of Default`,
{ align: 'left',indent: 45, }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)
.text(
`An event of default means the occurrence of any of the events specified in this Clause (‘Event ofDefault’)
as below:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `13.1.1 The Borrower fails to make payment of the Outstanding Amounts on the Due Dates in relation to the
Facility;`,
  { align: 'justify', indent: 50, lineGap: 5 }
  ).text(
    `13.1.2 If any event has occurred which in Lender’s opinion dilutes or jeopardizes the Security provided to the
Lender:`,
    { align: 'justify', indent: 50, lineGap: 5 }
    ).text(
      `13.1.3 Breach of any of the covenants mentioned in clause 12 on the part of the Borrower to observe or 
complywith any of the terms and conditions of this Agreement or any other Financing Document;`,
      { align: 'justify', indent: 50, lineGap: 5 }
      )





    // addFooter();

    //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.4 If there is any material breach of trust and willful default or breach of any other obligation under this
Agreement or any other Financing Documents including notice for insolvency;
13.1.5 If the Borrower defaults/threatens to default, in discharging his liability, under any other agreement or 
other writing between the Borrower and the Lender or any agreement entered into by the Borrower with the
Lender, its subsidiaries and affiliates, or under any other agreement or writing of indebtedness of the
Borrower, or under any other agreement with the other creditors or in the performance of any covenant,
term or undertaking thereunder, or any indebtedness of the Borrower not being paid when due or any
creditor of the Borrower becoming entitled to declare any indebtedness due and payable prior to the dateon
which it would otherwise have become due or any guarantee or indemnity or collateral given or other
support agreement entered into by the Borrower not being honored when due and called upon;
13.1.6 Any fraud and/or misrepresentation by the Borrower or any misleading statement made as to any
representation or warranties, or any other material statement made in this Agreement or any suppressionor
concealment of any material fact/essential information by the Borrower;
13.1.7 If any Governmental Authority has condemned, nationalized, seized or otherwise expropriated the 
assetsthat form Security or any substantial assets/property of the Borrower;
13.1.8 Any step is taken, or proceedings started for Borrower’s dissolution under the Code, or winding-up or for 
the appointment of a receiver, judicial manager, trustee or similar officer for the Borrower in any manner
whatsoever;
13.1.9 Initiation of the creditors process/any arrangement with any creditors with respect to the Borrower;
13.1.10 A receiver is appointed over the whole or any part of the property of the Borrower;
13.1.11 The Borrower ceases to carry on its Business or change its object clause of the memorandum of 
association without prior consent of the Lender;
13.1.12 If it has become unlawful for the Borrower to carry on its Business;
13.1.13 If there is any failure on the part of the Borrower to pay on any judgment or court order unless pending
appeal;
13.1.14 In case in the opinion of the Lender, there has been a material adverse change in any of the Borrower’
business or financial condition, such as:
a) if it is certified by a firm of accountants appointed by the Lender (which the Lender is entitled and hereby
authorised to so appoint at any time) that the liabilities of any of the Borrower exceed their respective assets
or that Borrower is carrying on its business at a loss;
b) sale or curtailment or closure of Borrowers’ business;
c) adverse action by any regulatory authority;
d) action by any class of stakeholders which is likely to significantly impair any of the Borrowers’ business; and
e) any other event which in the opinion of the Lender is likely to have an adverse effect on the business or
business environment of the Borrower.
13.1.15 Any material litigation or proceedings instituted against the Borrower including proceedings for crime
involving moral turpitude;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);





      





    addFooter();

     //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.16 There occurs any event or situation, (including happening of an event which in the opinion of the 
Lender is a force majeure event) such as and including but not limited to any material adverse change as 
determined solely by the Lender in the business or financial or other condition or operations or prospects
 of the Borrower, which in the sole opinion of the Lender is prejudicial to the interests of the Lender or 
is likely to materially affect the financial condition of the Borrower and/or its ability to perform all or 
any of its obligations under this Agreement and/or otherwise in respect of the Facility and to comply with 
any of the terms of this Agreement and/or for the Facility;
13.1.17 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility;
13.1.18 There is any material change in the ownership or management of the Borrower which in the sole 
opinion of Lender would prejudicially affect the interest of Lender;
13.1.19 The Borrower repudiates this Agreement or does or causes to be done any act or thing evidencing an
intention to repudiate this Agreement or non-performance of its obligation under this Agreement (whether
voluntary or involuntary);
13.1.20 Any document for creation of the Security in favour of the Lender is not in full force and effect or does 
not create in favour of the Lender, the Security which it expresses to create with the ranking and priority it is
expressed to have, including the due compliance of the requirements of security perfection including but not
limited to registration of charge with the concerned registrar of sub-assurances, within such period as
contemplated under this Agreement or otherwise allowed by the Lender, in its sole discretion and/or
 nonsubmission of any of the documents referred to in the Schedule hereto or the occurrence of any act or
circumstances which could, in the sole determination of the Lender, jeopardize, in any way, the Security;
13.1.21 If there is any deterioration or impairment of the Security or any part thereof or any decline or 
depreciation in the value or market price thereof (whether actual or reasonably anticipated), which causes 
the Security or any part thereof, in the judgment of the Lender to become unsatisfactory as to character or 
value;
13.1.22 If the property over which Security is created in favour of the Lender or any part there of is sold 
or disposed of, let out, given on leave or licence, pledged, hypothecated, transferred in any manner, charged 
in any manner whatsoever, Encumbered or otherwise alienated or if any third-party interest is created therein 
in any manner;
13.1.23 The Borrower misuses the Facility or any part thereof, or uses the Facility or any part thereof for any 
purpose other than the Purpose;
13.1.24 Any of the promoters/directors or persons holding key management positions (i.e., managing director/
chief executive officer and/or directors) of the Borrower is declared as willful defaulter in RBI List of 
willful defaulters or any other list of defaulters published by competent authorities from time to time.;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();

        //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.25 Any of the promoters and/or the directors of the Borrower are accused of, charged with, arrested or
convicted in a criminal offence involving moral turpitude, dishonesty, bribery or which otherwise impinges
on the integrity of such promoter and/or director, including any accusations, material charges and/or
convictions of any offence relating to bribery; or
13.1.26 Any force majeure event or an event not in the control of Borrower, for example, riot, war, act of terror,
earthquake, flood, fire, industrial disputes, strike or any events of similar nature occur.
13.1.27 If the Borrower fails to inform the Lender of any actual/potential Event of Default;
13.1.28 In the event there is a commencement of any action under any RBI guidelines, circulars, directions, etc. 
with respect to the Borrower or any of its subsidiaries or holding company;
13.1.29 If the Borrower fails to comply with the Applicable laws including the regulations, directions, circulars and
prudential norms notified by the concerned Regulator.
13.1.30 Any other event occurs which in the sole opinion of the Lender is likely to adversely affect the ability of 
the Borrower to perform its obligations under this Agreement.`,
{ align: 'justify', indent: 45, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2 Consequences of Events of Default`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`13.2.1 Upon the occurrence of an Event of Default as set out in clause 13.1, the Lender shall have the right 
and shall take any or all of the following actions:
(a) To cancel any outstanding commitments and/or recall the Facility;
(b) To require the Borrower to mandatorily Repay the principal amount on the Facility, along with accrued but 
unpaid interest, prepayment penalty and other costs, Charges and expenses incurred under or in connection with
this Agreement and other Financing Documents and other Outstanding Amounts;
(c) To declare all or any part of the Outstanding Amounts to be immediately (or on such dates as the Lendermay
specify) due and payable and ensure due payment thereof;
(d) To commence legal proceedings to recover such sum, the Borrower will further pay the Lender all advances,
Charges, cost and expenses, including all legal fees, incurred or paid by the Lender in exercising any right,
power or remedy conferred by this Agreement, (and/ or in the enforcement thereof) and all such amounts
shall become a part of the indebtedness secured hereunder and shall be paid to the Lender by the Borrower
immediately and without demand.
(e) To enforce the Security and/or additional security pertaining to the Facility, including but not limited to the
substitution of the Borrower/ sale of the land/ properties.
(f) Appoint a nominee director on the board of the Borrower;
(g) Exercise any other rights that Lender may have under the Financing Documents or under Applicable Law;
(h) Utilise and appropriate any amount lying or credited in the accounts of the Borrower, for
payment/repayment of Outstanding Amount, as due and payable till the date of such Event of Default;
(i) Transfer or appropriate the Security by sale or otherwise as the Lender may deem fit, to any other Person
and utilize any surplus realized from such transfer towards the fulfilment of all the obligations of Borrower
under the Financing Documents and may pay the surplus (if any) to the Borrower, after the satisfaction of
obligations of the Borrower;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2.2 Cross Collateralization`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower hereby undertakes and confirms that the Borrower shall execute any and all security
documents as may be required by the Lender to ensure that any Security(ies) furnished by the Borrower,
pursuant to any other credit facility granted by the Lender, its group companies, its affiliates to the Borrower
shall be extended as a Security(ies) towards the Facility extended under this Agreement. Further, the
Borrower also agrees to execute such security documents as may be required by the Lender to extend the
security(ies) offered in respect of this Facility towards other loan(s)/facility( ies) availed/to be availed by the
Borrower from the Lender or any of its group companies.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`14. ASSIGNMENT`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`14.1 The Borrower shall not transfer or assign any of its rights or liabilities under this Agreement to any other
person or entity without the prior written consent of the Lender.
14.2 The Borrower agrees that notwithstanding anything to the contrary contained in any document executed
under or in relation to this Agreement, the Lender shall have the right to (in full or in part) assign, transfer,
novate and/or otherwise securitize its rights or obligations under this Agreement and the other Financing
Documents and/or the Outstanding Amounts and/or enter into indemnity or other arrangements for risk
sharing, whether with or without recourse to the Lender, to one or more bank/s, financial institution/s or any
other entity including any trust or association whether located/placed in India or outside India as permitted
under the Applicable Law without any reference or notice to the Borrower. However, the Borrower shall not
claim any privity of contract with any such entity to whom the outstanding and/or the rights or obligations
under this Agreement or the other documents in relation to the Facility have been assigned/transferred
/novated/securitized or with whom the Lender has entered into indemnity or arrangements for risk sharing.
14.3 The Borrower agrees that the Lender (or any nominee of the Lender) may retain the Security Interest created
on the Security pursuant to the Security documents (or any part thereof) in trust and for the benefit of such
assignee (and upon part assignment of the Facility, in trust and for the benefit of both the Lender and such
assignee on a pari passu basis), without requiring any consent of or notice or making any reference to the
Borrower or the Sponsor. Upon any such transfer or assignment as contemplated herein, such assignee and
the Lender, as the case may be, will be entitled to take any action, including recovery and enforcement of the
Lender’ rights hereunder, in its own name without making the Lender or the assignee, as the case may be, a
party thereto.
14.4 Without prejudice to the right of the Lender to proceed against the Borrower under Applicable Law for
recovery of Outstanding Amounts, the Borrower hereby gives consent that the Lender will be entitled, subject
to Applicable Law, to recover the dues, assign the debt and/or securities and/or initiate proceedings under
the provisions of the SARFAESI Act and/or Code and/or any other Applicable Law and the Borrower agrees to
pay the Lender all cost, charges and expenses incurred in connection thereto.
14.5 The Borrower irrevocably and unconditionally confirms that it shall continue to be bound by the terms of
this Agreement and the other documents in relation to the Facility notwithstanding such transfer or
assignment by the Lender, further the Borrower shall duly comply with the instructions in respect of the
Facility as maybe issued by the Lender upon such transfer or assignment by the Lender.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


    // addFooter();


    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15. COST, CHARGES, EXPENSES AND STAMP DUTY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`15.1 The Borrower shall bear and promptly pay the following:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) an upfront non-refundable processing fee as mentioned in the Sanction Letter and statutory levies thereon,
but subject to deduction of TDS as per Applicable Law, as processing fee to the Lender for the purpose of
processing the Facility. The processing fee shall be paid at the time of disbursement of the Facility itself for
which purpose, the Borrower hereby authorizes the Lender to adjust the processing fee from the proceeds of
the disbursement. The processing fee is non-refundable fee and independent of disbursement/cancellation
of the Facility by the Borrower;
(b) all fees for the services performed by Lender, all out of pocket and travelling expenses and other costs,
Charges and expenses in any way incurred by Lender, its officers, employees or agents in connection with
the negotiation, preparation, execution, delivery, administration, waiver, modification or amendment of or
the preservation, protection or release of the rights of the Lender on exercise of any rights, remedies or
powers granted hereunder or any documents or instruments contemplated or in connection with or relating
to these presents including, without limitation, costs of investigation of title;
(c) all legal fees for drafting and stamping of this Agreement and all other Financing Documents, costs, Charges
and expenses of the external legal counsel of the Lender and all such sums incurred or paid by the Lender in
connection with and incidental to or in connection with these presents and incurred in connection with the
enforcement of any rights hereunder or under any of the Financing Documents or for payment of any
additional stamp duty or penalties in relation to the stamp duty under any Financing Documents including
any cost incurred in the assertion or defence of the rights of Lender as such for, andfor the benefit of the
Lender for the protection and preservation of whole or any part of the Security and for the demand,
realization and recovery of the Outstanding Amounts which shall be added to the Outstanding Amounts and
be secured hereby; and
(d) all stamp duty, Taxes, Charges and penalties on any Financing Documents if and when the Borrower may be
required to pay the same according to the Applicable Law.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `15.2 The Borrower agrees to indemnify and keep the Lender indemnified at all times against any and all loss,
costs, Charges, expenses and liabilities including penalties with respect to or resulting from delay or
omissions to pay any such stamp, registration and similar taxes or Charges. Such stamp, registration and
similar taxes or Charges (if not paid or reimbursed by the Borrower) shall be deemed to be the amounts
outstanding under the Facility.
15.3 The Borrower shall pay all stamp duty charges and other similar taxes payable in respect of this Agreement
and other Financing Documents and indemnify the Lender against any cost, loss or liability that the
Lender may suffer, pay or incur by reason of or in connection with all stamp duty charges and other similar
taxes payable in respect of this Agreement or any other Financing Documents
  `,
  { align: 'justify', indent: 40, lineGap: 5 }
  );


    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15.4 If the Borrower fails in defraying the costs, expenses, Charges, duties or fees referred to above as
and when required, the Lender may (but is not obligated to) make such payments on behalf of the
Borrower. All such payments made by the Lender shall be for the account of the Borrower and the
Borrower undertakes promptly on demand, to reimburse the Lender or its authorized agents,
representatives, successors and assignees for any such monies so paid, together with the interest
thereon at the rate of the Additional Interest over the Applicable Interest Rate until the date such
amounts are actually reimbursed by the Borrower. All such costs and expenses shall be part of the
‘Outstanding Amounts’ and shall be a charge upon the Security in priority to the charge
securing the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `16. INDEMNITY`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();

  doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower shall, without prejudice to any other right of Lender, indemnify and keep indemnified and hold
harmless Lender against any cost, loss, obligations, damages, penalties, actions, judgments, suits, expenses,
liability or disbursements of any kind or nature whatsoever (including legal fees, disbursements to lawyers
and out of pocket expenses), which may be imposed on, incurred by or asserted against the Lender (or its
directors, employees and agents) in any claim, litigation, proceeding or investigation instituted or conducted
by any governmental agency or instrumentality or any person or entity, and which are related directly or
indirectly to this Agreement or Financing Documents or any document executed pursuant hereto, whether
Lender is a party thereto, and shall pay and reimburse to Lender, without any dispute or demure any losses,
costs, charges or expenses which Lender, shall certify as sustained or suffered or incurred by Lender as a
result of:

(i) the occurrence of an Event of Default, or any other breach of obligations by the Borrower under, Financing
Documents and/or this Agreement or otherwise in connection with this Agreement (including any interest or
fees incurred in funding any unpaid sum) or otherwise on account of the Facility;
(ii) the Lender investigating any event which it believes is an Event of Default;

The Borrower shall within 5 (five) Business Days of demand of the above, make good such payment to Lender
accordingly. For avoidance of doubt, Lender shall not be required to risk its own funds or otherwise incur
any financial liability in the performance of any of its duties hereunder or in the exercise ofany of its rights or
powers under this Agreement. The Borrower will not seek to claim or recover from Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of Lender hereunder and/or in respect of the
Facility, taken or omitted by Lender, in terms hereof and/or pursuant hereto and/or to protect any of its
interests and rights as Lender and the Borrower hereby expressly waives any right to seek or make any such
claim or recovery on any ground whatsoever.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
)





    // addFooter();
//=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`17. TAXES`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`17.1 If the Borrower is required by Lender, or under any of the law to make any deduction or withholding towards,
for or in respect of any tax, the Borrower must:
(a) pay to the Lender any additional amount as may be necessary to ensure that the Lender receives the
full amount of the relevant payment as if that deduction or withholding had not been made; and
(b) supply promptly to the Lender evidence satisfactory to the Lender that it has accounted to the relevant
Governmental Authority for the withholding or deduction.
Provided that in case the Borrower provides a certificate, within the statutory timelines, evidencing payment
of withholding taxes in relation to any payments made to the Lender, it shall not be requiredto gross up
the payments as provided under this clause 17.1.
17.2 The Borrower shall during the Tenor bear all interest tax as may be applicable or as may be levied bya
Governmental Authority in relation to any Interest or other sum paid by the Borrower to the Lender under
the Facility. If the Lender is required to make any payment on account of any interest tax in relation to
Interest or other sum received or receivable by the Lender hereunder, then the Interest or sum payable by
the Borrower shall be increased to the extent necessary to ensure that after making such payment, the
Lender receives and retains a sum equal to the sum which it would have received and retained had no
such payment or deduction been made or required to be made.
17.3 If the Borrower is required to make any deduction for or on account of any interest tax (other than statutory
deduction of taxes at source) in relation to any Interest or other sum payable to the Lender hereunder, then,
in such case, the sum payable to the Lender shall be increased to the extent necessary to ensure that, after
making such deduction the Lender receives and retains (without any liability for such deduction) a sum
equal to the sum which it would have received and retained had no such deduction been made or required to
be made.
17.4 If there is, at any time, any incidence of any indirect taxes on the Lender directly connected and/or
attributable to the Facility, the Lender shall notify the Borrower of such incidence of tax and shall be entitled
to pass on such incidence to the Borrower. The Borrower shall make payment of such taxes without demur,
protest or cavil. Notwithstanding the above, if the Lender makes payment of any such indirect tax, the
Lender shall, be entitled to be reimbursed for the same by the Borrower.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`18. CONSTITUTED ATTORNEY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.1 The Borrower hereby agrees and appoints or cause to appoint the Lender and its officers, employees and
agents and authorised representatives to be its duly constituted attorneys for all or any of the following
purposes, upon the occurrence of an Event of Default, namely:
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(a) to sign all papers, documents agreements indentures and writings that the Borrower would be
bound to do under or in pursuance of these presents and / or the Facility and/or the Security for
and behalf of the Borrower and to attend before the Sub-Registrar of Assurancesor any other
relevant authority and admit execution thereof;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()





    // addFooter();

    //=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(b) Generally to do perform and/or execute or cause to be done performed or executed all acts deeds
matters things and documents in all matters arising under or out of or concerning or touching these
presents as the Borrower could itself do perform or execute;
(c) And for the better and more effectually doing effecting and performing the several matters and
things including as aforesaid, and to appoint from time to time or generally such other Persons,
bodies, companies, organizations, or agencies as the Lender may think fit as its substitute or
substitutes to do execute and perform all or any such acts and things as aforesaid and such
substitute or substitutes at pleasure to remove and to appoint other or others in his or their place;
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.2 The Borrower agrees that the above powers may be exercised without any prior notice to the Borrower
and further agrees to ratify and confirm all that the Lender or any substitute or substitutes appointed by the
Lender may lawfully do or cause to be done in exercise of the aforesaid powers.
18.3 The Borrower further agrees to give all assistance to the Lender and its officers authorised representatives
and other substitutes for the purpose of exercising any of the powers hereinabove set out, including
endorsing of documents, signing of papers and doing all such things as may be necessary to enable the Lender
and its officers and other substitutes to exercise all the powers hereby conferred.
18.4 The Borrower further agrees that the aforesaid powers have been granted for valuable consideration and as
such shall be irrevocable in nature till such time as any amounts remain due owing or payable under or in
respect of or in pursuance of the Facility and/or these presents.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`19. GOVERNING LAW AND JURISDICTION`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`This Agreement and all documents executed under/in relation to this Agreement shall be governed by the laws of
India. Any disputes arising under/in relation to this Agreement shall be subject to the exclusive jurisdiction
of the competent courts situated in New Delhi. However, this shall not limit the rights of the Lender to take
proceedings in any other court of competent jurisdiction of its choice.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`20. MISCELLANEOUS`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `20.1 Notices`,
  { align: 'left', indent: 40, lineGap: 5 }
  );

  doc.font('Helvetica')
    .fontSize(9)


.text(
`Any notices to be provided by each Party shall be in writing, signed by an authorised officer, and shall be sent
by post, letter or email to such address, email id or number as mentioned below or to such other contact
details as may be notified by the Parties from time to time. Notices shall be deemed to have beendelivered on
the earlier of the actual date of delivery or 7 (seven) Business Days following dispatch.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Borrower:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


  doc.font('Helvetica')
    .fontSize(9)


.text(
`As mentioned in the Schedule
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Lender:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


doc.font('Helvetica')
.fontSize(9)
.text(
   `Address: 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI 110001`,
   { align: 'justify', indent: 40, lineGap: 5 }
);

doc.text(
`Email: `,
{ continued: true, indent: 40 }
)
.font('Helvetica-Bold')
.fillColor('blue')
.text(
   `support@growmoneycapital.com`,
   {
      link: 'mailto:support@growmoneycapital.com', // This makes the email clickable
      underline: true, // Optional: to visually indicate it's a link
   }
)
.fillColor('black'); // Reset the color to black for further text
// .moveDown();

    // addFooter();


//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);



doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`(The Borrower agrees that all instructions and/or correspondence sent by the Borrower to the Lender
are sent at the Borrower’s risk, and the Lender does not assume any responsibility for anyinaccuracy,
interruption, error, delay or failure in transmission or delivery whether sent by post, telegraph,
cable, telex or any other form of written or electronic communication.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.2 Any provision of this Agreement, which is prohibited or unenforceable in any jurisdiction shall, as to such
jurisdiction, be ineffective only to the extent of prohibition or unenforceability and it shall not invalidate the
remaining provisions of this Agreement or affect such provision in any other jurisdiction.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.3 Disclosure`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.3.1 The Borrower hereby agrees as a pre-condition of the Facility given to the Borrower by the Lender that, in
case the Borrower commits default in the Repayment of the Facility in accordance with or in the paymentof
Interest thereon on date(s) specified in Repayment Schedule , the Lender and/or the Reserve Bank of India
will have an unqualified right to disclose or publish the Borrower’s name as defaulter in such manner and
through such medium as the Lender or Reserve Bank of India in their absolute discretion may think fit.
Accordingly, the Lender shall have the right to furnish and publish the name of the Borroweras defaulter to
the public at large and Reserve Bank of India or other regulatory authority. Notwithstanding above the
Borrower hereby accept and confirm that as a pre-condition to the grant of the credit facility by the Lender
to the Borrower including, the Facility the Lender, requires consent of the Borrower to make certain
disclosures in relation to the Borrower including information and data relating to the Borrower and any
credit facility availed of or to be availed of by the Borrower, obligations assumed or to be assumed by the
Borrower in relation thereto and default, if any, committed by the Borrower in discharge thereof.
Accordingly, the Borrower hereby agrees and gives consent to the disclosure by the Lender of all or any such
information and data relating to the Borrower:
(a) in relation to any credit facilities including, the Facility availed of or to be availed of by the Borrower from
the Lender and the Borrower’s obligations in any credit facility granted/to be granted, by the Lender, for the
purposes of credit reference checks, verification, etc; and
(b) in case of default, if any, committed by the Borrower in discharge of any of his obligations, or any other
information that the Lender may deem appropriate and necessary, to disclose and furnish to RBI, any Credit
Information Agency and/or any other agency authorized in this behalf by the RBI or any other regulatory
authority.

20.3.2 The Borrower undertakes and declares that the information and data furnished by the Borrower to the
Lender is/shall be true and correct and any Credit Information Agency and/or any other authorized agency
may use, process the said information and data disclosed by the Lender as deemed fit by them and may
furnish for consideration such processed information/data/products to banks/financial institutions and
other entities as maybe specified by RBI.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// addFooter();

//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)
.text(`20.3.3 The Borrower and the Guarantor hereby give specific consent to the Lender for disclosing/submitting the
‘financial information’ as defined in Section 3 (13) of the Code read with the relevant regulations/ rules
framed under the Code, as amended from time to time in respect of the Facility availed from the Lender, from
time to time, to any ‘Information Utility’ (“IU”) as defined in Section 3 (21) of the Code, in accordance with the
relevant regulations framed under the Code, and directions issued by RBI from time to time and hereby
specifically agree to promptly authenticate the financial information submitted by the Lenders, as and when
requested by the concerned IU.

20.3.4 The Borrower hereby consents to the Lender, its officers and agents disclosing information relating to the
Borrower and its current bank account or Escrow Account, account(s) and/or dealing relationship(s) with
the Lender, including but not limited to details of its facilities, any security taken, transactions undertaken
and balances and positions with the Lender, to:

(i) the head office of the Lender, any of its subsidiaries or subsidiaries of its holding company, affiliates,
representative and branch offices in any jurisdiction (together with the Lender, the “Permitted Parties”);
(ii) professional advisers and service providers of the Permitted Parties who are under a duty of
confidentiality to the Permitted Parties;
(iii) any actual or potential assignee, novatee, transferee participant or sub-participant in relation to any of the
Lender’s rights and/or obligations under any agreement (or any agent or adviser of any of the foregoing);
(iv) any rating agency, insurer or insurance broker of, or direct or indirect provider of credit protection to any
Permitted Party; and
(v) any court or tribunal or regulatory, supervisory, governmental or quasi-Governmental Authority with
jurisdiction over the Permitted Parties
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.4 Lender’s records to be accepted by Borrower`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The records maintained by the Lender in its ordinary course of business shall be the final proof for the due
amounts from the Borrower in respect of the Facility under this Agreement. A certificate in writing signed by
an officer of the Lender or a system generated electronic certificate stating the Outstanding Amount from the
Borrower in respect of the Facility at any particular time shall be conclusive evidence against the Borrower
in respect of payments due from the Borrower in respect of the Facility`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.5 Engagement of third parties`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower expressly recognizes and accepts that the Lender shall, without prejudice to its right to
perform such activities itself or through its officers or employees, be entitled and has full power and
authority to appoint one or more third parties as Lender may select and to delegate to such third party all or
any of its functions, rights and powers under this Agreement relating to administration of Facility including
right and authority to collect and receive on behalf of the Lender from the Borrower any payments and other
amounts due by the Borrower under this Agreement and to perform and execute all lawful acts, deeds
matters and things connected therewith and incidental thereto. For the aforesaid purpose, Lender shall be
entitled to disclose to any such third parties all necessary and relevant information pertaining to the
`,
{ align: 'justify', indent: 40, lineGap: 5 }
);






    // addFooter();

    //=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)


.text(
`Borrower and the Facility and the Borrower hereby consents to such disclosure by the Lender.
Notwithstanding above, in the event of Borrower committing any act of default and/or occurrence of any
Event of Default, the Borrower expressly accepts and authorizes Lender to contact any third parties as
Lender may select and disclose all necessary and relevant information pertaining to the Borrower and the
Facility.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.6 Waiver`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The Borrower confirms that no delay of the Lender in exercising or not exercising any right, power or
remedy accruing/available to the Lender on Borrower’s default or otherwise under this Agreement or any
other Financing Documents shall impair or prejudice such right, power or remedy or shall be construed asits
waiver or acquiescence. The Borrower further confirms that any single or partial exercise of any right, power
or remedy by the Lender shall not preclude further exercise thereof. Every right and remedy of the Lender
shall continue in full force until the Lender specifically waives it by a written instrument`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.7 Liens; Right of Set Off`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The rights, powers and remedies given to the Lender by this Agreement shall be in addition to all rights
powers and remedies given to the Lender by virtue of any other Security, statute, or rule of law or equity. The
Lender may exercise a banker’s lien or right of set- off with respect to any obligation of the Borrower as if the
obligation were unsecured and shall have a lien on all property or securities of the Borrower in the Lender’s
possession or custody whether for safe-keeping or otherwise. Without prejudice to what is stated
hereinabove, the Borrower hereby expressly agrees and confirms that in the event of the Borrower failing to
completely pay/repay the Outstanding Amounts under the Facility, in addition to any general or specific lien
to which the Lender may be entitled by Applicable Law, the Lender shall, without prejudice to any of its
specific rights under this Agreement, be at liberty to apply any other money or amounts standingto the credit
of the Borrower in any account with the Lender in or towards repayment of the Outstanding Amounts under
the Facility, without notice to the Borrower, on happening of any Event of Default or if upon demand by the
Lender the said Dues are not repaid within the prescribed time. In case of any deficit, the deficit amount may
be recovered by the Lender from the Borrower. The joint account holder/s to such monies, securities,
deposits and other assets is/are aware of, and have no objection to (a) the Facility applied for, (b) the Facility
terms, (c) using such monies from the joint accounts for paying/Repaying the Facility and all other amounts
due to the Lender, and (d) the Lender’s rights of setoff in the event of their default of the Facility terms: It
shall be the Borrower’s sole responsibility and liability to settle all disputes/objections with such joint
account holders, if so required, and the Lender shallbe well within its rights to exercise the right of set off
against any money lying in any account/deposit/bond/other assets held singly or jointly, for settlement of
dues.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.8 Sanction Letter`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The terms of the Sanction Letter shall form part of this Agreement and shall be in addition to and be read in
conjunction with the terms of this Agreement. If there are any inconsistencies between the terms of the
Sanction Letter and this Agreement then, the terms of Sanction Letter shall prevail to the extent of
inconsistency.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.9 Entire Agreement`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
// about the subject matter, comprised within the Financing Documents and shall replace all previous
// agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
// representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
// the Financing Documents.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();






    // addFooter();

    //-------------------------------new page---------------------------
    doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.9 Entire Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
about the subject matter, comprised within the Financing Documents and shall replace all previous
agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
the Financing Documents.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.10 Survival ofRights`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The provisions of Clause 16 (Indemnity), Clause 20.1 (Notices), Clause 20.15 (Dispute Resolution) Clause 19
(Governing Law and Jurisdiction) and this Clause 20.10 (Survival of Rights) and other clauses which by their
nature are intended to survive, shall survive termination or expiry of this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.11 Benefits:`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The terms and provisions of this Agreement shall be binding upon, and the benefits & obligations hereof shall
inure or pass on to the Lender's successors and assigns, and Borrower's successors and permitted assigns (if
appointed after permission of Lender, and as the case maybe), who in absence of Borrower will be required
to fulfil each and every requirement or obligation as maybe required by Lender from time to time or as
detailed under this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.12 Liability of Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`In the event of there being more than one Borrower (Co-Borrower), the liability of each Co-Borrower
hereunder shall be co-extensive as that of Borrower’s liability. Each of the Co-Borrowers shall be having same
and equal extent of liabilities as that of other Borrower under this Agreement and in the Event of Default, the
liabilities of all the Borrowers and Co-Borrower shall be cumulative towards the Lender and the Lender at its
discretion may proceed against any or all of the Borrower or Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.13 Acceptance`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees and acknowledges that this entire Agreement, duly filled in
schedules/annexures/letters/undertakings hereto, Sanction Letter and other documents relating to Facility
have been explained to the Borrower in the language understood by it, and it has understood the entire
meaning of the aforementioned and shall be bound by all the conditions mentioned therein. Any act of
acceptance of the terms contained herein or token thereof (including acceptance through facsimile or
electronic transmission) by the Borrower (in a manner acceptable to the Lender) may be considered as due
and proper execution of this Agreement on the part of the Borrower.

20.14 The Borrower hereby represents and warrants the genuineness of the signatures of the authorised
signatories of the Borrower, or each of the Borrowers in the event of there being more than one Borrower,
as the case may be.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.15 Dispute Resolution`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
// after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
// used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
// Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
// the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
// arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
// Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
// shall be conducted preferably through online means or otherwise through conventional means in English
// language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
// conducted through conventional means) shall be at Delhi.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();

// addFooter();

  //-------------------------------new page---------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

  doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.15 Dispute Resolution`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

  doc.font('Helvetica')
.fontSize(9)


.text(
`All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
shall be conducted preferably through online means or otherwise through conventional means in English
language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
conducted through conventional means) shall be at Delhi.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
  doc.font('Helvetica-Bold')
  .fontSize(9)
  
  
  .text(
  `20.16 Counterparts`,
  { align: 'justify', indent: 40, lineGap: 5 }
  );
  
  doc.font('Helvetica')
  .fontSize(9)
  .text(`The Agreement may be executed in any number of counterparts, each of which (without variation) shall
constitute an original and all of which together shall constitute one and the same instrument. Delivery of an
executed counterpart of the signature page to this Agreement by facsimile shall be as effective as delivery of
a manually executed counterpart of this Agreement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();
  


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.17 Status of the Loan Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees that its obligations hereunder are absolute and unconditional and shall not be affected
by any circumstance (including any right of set-off or counterclaim), which otherwise might, prior to the
satisfaction of those obligations, operate to release or constitute a discharge or other-wise exonerate the
Borrower from its obligations hereunder or affect such obligations, with the intent that the Borrower’s
obligations under this Agreement shall remain at all times in full force and effect until payment of the
amounts due under this Agreement have been made in full and all obligations of the Borrower under this
Agreement have been fully discharged to the satisfaction of the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();







    // addFooter();




//-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();


  
    // Title styling for OFFER LETTER in uppercase and underlined
    doc.moveDown(6);
    const yPosition = doc.y; // Get the current y position
  
    doc
      .fontSize(7)
      .font(fontBold)
      .text("Schedule", { align: "center" })
      .moveDown(1)
      .text("(Forming part & parcel of Agreement)", { align: "center" })
      .moveDown(1)
      .text(` DATED :${allPerameters.agreementdate} \n\n Place of Agreement : Indore \n\n Location of the Lender’s Office/Branch : Indore` , { align: "left" })
    
    doc.moveDown(4);

    doc
    .fontSize(9)
    .font('Helvetica-Bold')
    .text("Borrower(s) Details", { align: "left" })
    .moveDown(0.5)
    // Add a function to draw black table borders
    function drawTable(tableData) {
        const startX = 50;
        let startY = doc.y + 10;
        const columnWidths = [500]; // Total width for the table
        const keyWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for field names
        const valueWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for values
        
        // Function to draw a block for borrower details
        function drawBorrowerBlock(borrowerData) {
            borrowerData.forEach((row, rowIndex) => {
                let valueRowHeight = 20; // Set height for each row
    
                // Check if it's a special row like "Borrower/Security Provider Details" or "Guarantor"
                if (row.field1 === "Borrower/Security Provider Details" || row.field1 === "Guarantor") {
                    // Draw a full-width row (horizontal lines only)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth + valueWidth, valueRowHeight) // Full-width
                        .strokeColor("black")
                        .lineWidth(0.5)
                        .moveTo(startX, startY) // Top horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw text across the full width
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth + valueWidth // Full width for text
                        });
                } else {
                    // Draw field background (for regular fields like 'Name', 'Residence Address', etc.)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX, startY) // Top horizontal line for field name
                        .lineTo(startX + keyWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line for field name
                        .lineTo(startX + keyWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw field name (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth
                        });
    
                    // Draw value background (half-width for value)
                    doc.fillColor("#ffffff")
                        .rect(startX + keyWidth, startY, valueWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX + keyWidth, startY) // Top horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX + keyWidth, startY + valueRowHeight) // Bottom horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw value text (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.value1 || "", startX + keyWidth + 5, startY + 5, {
                            baseline: "hanging",
                            width: valueWidth
                        });
                }
    
                // Move to next row
                startY += valueRowHeight;
            });
    
            // Add spacing after each borrower block
            startY += 10;
        }
    
        // Filter and group data for each borrower block
        const borrowerBlocks = [];
        let currentBlock = [];
    
        tableData.forEach(row => {
            if (row.field1.includes("Borrower/Security Provider Details") || row.field1 === "Guarantor") {
                if (currentBlock.length > 0) {
                    borrowerBlocks.push(currentBlock);
                }
                currentBlock = [];
            }
            currentBlock.push(row);
        });
    
        if (currentBlock.length > 0) {
            borrowerBlocks.push(currentBlock);
        }
    
        // Draw each borrower block
        borrowerBlocks.forEach(borrowerData => {
            drawBorrowerBlock(borrowerData);
        });
    }
    
    const loanTableData = [
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.customerName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.address}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.registeredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.corporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.emailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.constitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.identityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.typeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.securityProvider}` },
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.coApplicantName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddress}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.coEmailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.coConstitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProvider}` },
    ];
    
    // Call the drawTable function to generate the table
    drawTable(loanTableData);
    // doc.moveDown(2);
  
    // addFooter();
    
   
  //---------------------------------------- new page 2--------------------------------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  // doc.moveDown(7);
  
  const secondPageTable = [
    // { field1: "Borrower/Security Provider Details" },
    // { field1: "a) Name", value1: `${allPerameters.coApplicantNameTwo}` },
    // { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddressTwo}` },
    // { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddressTwo}` },
    // { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddressTwo}` },
    // { field1: "e) Email Address", value1: `${allPerameters.coEmailAddressTwo}` },
    // { field1: "f) Constitution", value1: `${allPerameters.coConstitutionTwo}` },
    // { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumberTwo}` },
    // { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrowerTwo}` },
    // { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProviderTwo}` },
   
    { field1: "Guarantor" },
    { field1: "a) Name", value1: `${allPerameters.guarantorName}` },
    { field1: "b) Residence Address", value1: `${allPerameters.guarantorAddress}` },
    { field1: "c) Registered Office Address", value1: `${allPerameters.guarantorRegisteredOfficeAddress}` },
    { field1: "d) Corporate Office Address", value1: `${allPerameters.guarantorCorporateOfficeAddress}` },
    { field1: "e) Email Address", value1: `${allPerameters.guarantorEmailAddress}` },
    { field1: "f) Constitution", value1: `${allPerameters.guarantorConstitution}` },
    { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.guarantorIdentityNumber}` },
    { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.guarantorTypeOfBorrower}` },
    { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.guarantorSecurityProvider}` },
  ];
  drawTable(secondPageTable);
  doc.moveDown(2);
  function newTable(tableData) {
    const startX = 50;
    let startY = doc.y + 10;
    const columnWidths = [500];

    const keyWidth = Math.round((columnWidths[0] * 1) / 2);
    const valueWidth = Math.round((columnWidths[0] * 1) / 2);

    tableData.forEach((row, rowIndex) => {
        doc.lineWidth(0.5);

        const valueText = row.value1 || "";
        const isFullWidthRow = row.field1 === "Details of the Loan/Credit Facility" || row.field1.startsWith("Payment Instrument(s)");
        
        // Calculate row height to accommodate multiline text
        let rowWidth = isFullWidthRow ? columnWidths[0] : valueWidth;

        // Set specific height for "Payment Instrument(s)" row
        let rowHeight;
        if (row.field1.startsWith("Payment Instrument(s)")) {
            // Increase height for this specific row
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 60; // Increase height as needed
        } else {
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 10; // Normal height for other rows
        }
        rowHeight = Math.max(rowHeight, 20); // Set a minimum height if needed

        // Draw background for the row
        doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX, startY, columnWidths[0], rowHeight)
            .stroke("black")
            .fill();

        if (isFullWidthRow) {
            // Render full-width text with wrapping
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1 + "\n" + valueText, startX + 5, startY + 8, {
                    baseline: "top",
                    width: columnWidths[0] - 10, // Slight padding to avoid overflow
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        } else {
            // Draw first column cell
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 8, {
                    baseline: "top",
                    width: keyWidth,
                    align: 'left'
                });

            // Draw second column cell with wrapping
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(valueText, startX + keyWidth + 5, startY + 8, {
                    baseline: "top",
                    width: valueWidth - 10, // Prevent overflow by setting width constraint
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        }

        // Move to the next row position
        startY += rowHeight;
    });
}
  
  const details = [
    { field1: "Purpose of the Loan/Credit Facility", value1: `WORKING CAPITAL` },
    { field1: "Details of the Loan/Credit Facility", value1: ``},
    { field1: "Loan Amount/Credit Facility", value1: `Rs.${allPerameters.loanAmount}` },
    { field1: "Security Details (Details of the Security as per Sanction Letter such as Property Address/Equipment details/Intangible Collateral, etc.)", value1:`${allPerameters.securityDetails}` },
    { field1: "Security Cover", value1: `${allPerameters.securityCover}` },
    { field1: "Tenor or Tenure of the Loan/Credit Facility", value1: `${allPerameters.tenor} Months` },
    { field1: "Rate of Interest", value1: `FLOATING RATE OF INTEREST \n · Grow Money Reference Rate (URR): ${allPerameters.benchmarkInterest}% p.a (per cent per annum)\n · Floating Rate of Interest(p.a.): URR + ${allPerameters.SpreadInterestRate}%=${allPerameters.Roi}% p.a. (per cent per annum) Review Frequency: Monthly` },
    { field1: "Sanction Letter", value1: `${allPerameters.sanctionLetterDate}` },
    { field1: "Application Fees", value1: `2% + 18% GST` },
    { field1: "Processing Fees", value1: `2% + 18% GST` },
    { field1: "CERSAI Charges", value1: `AS APPLICABLE` },
    { field1: "Late Payment Interest/Additional Interest", value1: `___% p.m. (________ per cent per month) or _____ % p.a. (_________ per cent per annum) on the Instalment overdue from the date of overdue upto the date of payment` },
    { field1: "Repayment Bank A/c Details", value1: `${allPerameters.repaymentBank}` },
    { field1: "Details of Receivables", value1: `${allPerameters.detailsOfReceivables}`, },
    { field1: "Pre-payment/Foreclosure of the Facility", value1:  `· 6% of Principal outstanding for loan foreclosed within 12 months of loan sanction \n · 4% of Principal outstanding for loan foreclosed after 12 months of loan sanction \n regulatory requirements and directions prescribed by Reserve Bank of India from time to time.` },
    { field1: "Payment Instrument(s)\n Bank Account on which the Repayment Cheques are drawn and/or EDI (Electronic Debit Instrument)/NACH are made and details thereof\n · The Repayment Cheque/NACH can be used by the FIN COOPERS for realization of delayed payment charges/Default Interest also and in such events additional cheque(s)/NACH shall be furnished to cover the balance Repayment Amount.(“Account”)\n · Repayment Cheques should be in favour of “FIN COOPERS Securities Pvt Ltd”", value1: `` },
  ];
  
  newTable(details);
  // addFooter();
  
//   // ------------------------------------- new page 3-------------------------------------------------
  
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

// function newTable(tableData) {
//     const startX = 50;
//     let startY = doc.y + 10;
//     const columnWidths = [500];

//     const keyWidth = Math.round((columnWidths[0] * 1) / 2);
//     const valueWidth = Math.round((columnWidths[0] * 1) / 2);

//     tableData.forEach((row, rowIndex) => {
//         doc.lineWidth(0.5);

//         const valueText = row.value1 || "";
//         const isFullWidthRow = row.field1 === "Details of the Loan/Credit Facility" || row.field1.startsWith("Payment Instrument(s)");
        
//         // Calculate row height to accommodate multiline text
//         let rowWidth = isFullWidthRow ? columnWidths[0] : valueWidth;

//         // Set specific height for "Payment Instrument(s)" row
//         let rowHeight;
//         if (row.field1.startsWith("Payment Instrument(s)")) {
//             // Increase height for this specific row
//             rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 60; // Increase height as needed
//         } else {
//             rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 10; // Normal height for other rows
//         }
//         rowHeight = Math.max(rowHeight, 20); // Set a minimum height if needed

//         // Draw background for the row
//         doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX, startY, columnWidths[0], rowHeight)
//             .stroke("black")
//             .fill();

//         if (isFullWidthRow) {
//             // Render full-width text with wrapping
//             doc.font(font)
//                 .fillColor("black")
//                 .fontSize(7.2)
//                 .text(row.field1 + "\n" + valueText, startX + 5, startY + 8, {
//                     baseline: "top",
//                     width: columnWidths[0] - 10, // Slight padding to avoid overflow
//                     align: 'left',
//                     height: rowHeight - 10, // Ensure the text wraps within the row height
//                 });
//         } else {
//             // Draw first column cell
//             doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                 .rect(startX, startY, keyWidth, rowHeight)
//                 .stroke("black")
//                 .fill();
//             doc.font(font)
//                 .fillColor("black")
//                 .fontSize(7.2)
//                 .text(row.field1, startX + 5, startY + 8, {
//                     baseline: "top",
//                     width: keyWidth,
//                     align: 'left'
//                 });

//             // Draw second column cell with wrapping
//             doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                 .rect(startX + keyWidth, startY, valueWidth, rowHeight)
//                 .stroke("black")
//                 .fill();
//             doc.font(font)
//                 .fillColor("black")
//                 .fontSize(7.2)
//                 .text(valueText, startX + keyWidth + 5, startY + 8, {
//                     baseline: "top",
//                     width: valueWidth - 10, // Prevent overflow by setting width constraint
//                     align: 'left',
//                     height: rowHeight - 10, // Ensure the text wraps within the row height
//                 });
//         }

//         // Move to the next row position
//         startY += rowHeight;
//     });
// }
  
//   const details = [
//     { field1: "Purpose of the Loan/Credit Facility", value1: `WORKING CAPITAL` },
//     { field1: "Details of the Loan/Credit Facility", value1: ``},
//     { field1: "Loan Amount/Credit Facility", value1: `Rs.${allPerameters.loanAmount}` },
//     { field1: "Security Details (Details of the Security as per Sanction Letter such as Property Address/Equipment details/Intangible Collateral, etc.)", value1:`${allPerameters.securityDetails}` },
//     { field1: "Security Cover", value1: `${allPerameters.securityCover}` },
//     { field1: "Tenor or Tenure of the Loan/Credit Facility", value1: `${allPerameters.tenor} Months` },
//     { field1: "Rate of Interest", value1: `FLOATING RATE OF INTEREST \n · FIN COOPERS Reference Rate (URR): ${allPerameters.benchmarkInterest}% p.a (per cent per annum)\n · Floating Rate of Interest(p.a.): URR + ${allPerameters.SpreadInterestRate}%=${allPerameters.Roi}% p.a. (per cent per annum) Review Frequency: Monthly` },
//     { field1: "Sanction Letter", value1: `${allPerameters.sanctionLetterDate}` },
//     { field1: "Application Fees", value1: `2% + 18% GST` },
//     { field1: "Processing Fees", value1: `2% + 18% GST` },
//     { field1: "CERSAI Charges", value1: `AS APPLICABLE` },
//     { field1: "Late Payment Interest/Additional Interest", value1: `___% p.m. (________ per cent per month) or _____ % p.a. (_________ per cent per annum) on the Instalment overdue from the date of overdue upto the date of payment` },
//     { field1: "Repayment Bank A/c Details", value1: `${allPerameters.repaymentBank}` },
//     { field1: "Details of Receivables", value1: `${allPerameters.detailsOfReceivables}`, },
//     { field1: "Pre-payment/Foreclosure of the Facility", value1:  `· 6% of Principal outstanding for loan foreclosed within 12 months of loan sanction \n · 4% of Principal outstanding for loan foreclosed after 12 months of loan sanction \n regulatory requirements and directions prescribed by Reserve Bank of India from time to time.` },
//     { field1: "Payment Instrument(s)\n Bank Account on which the Repayment Cheques are drawn and/or EDI (Electronic Debit Instrument)/NACH are made and details thereof\n · The Repayment Cheque/NACH can be used by the FIN COOPERS for realization of delayed payment charges/Default Interest also and in such events additional cheque(s)/NACH shall be furnished to cover the balance Repayment Amount.(“Account”)\n · Repayment Cheques should be in favour of “FIN COOPERS Securities Pvt Ltd”", value1: `` },
//   ];
  
//   newTable(details);
  
  // doc.moveDown(2)
  
  doc
  .fontSize(8)
  .font('Helvetica')
  .text("Repayment details:", { align: "left" })
  .moveDown(1)
  

function repaymentFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  // Function to draw a checkbox
  const drawCheckbox = (doc, x, y, size, isChecked) => {
      doc
          .rect(x, y, size, size) // Draw checkbox square
          .stroke();
      if (isChecked) {
          doc
              .moveTo(x, y + size / 2)
              .lineTo(x + size / 3, y + size - 2)
              .lineTo(x + size - 2, y + 2)
              .strokeColor('black')
              .stroke();
      }
  };

  const validColumns = Object.keys(tableData[0]).filter((key) => {
      return tableData.some(row => row[key] !== ""); // Exclude blank columns
  });
  const columnCount = validColumns.length;

  const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // Dynamic column widths
  const fixedRowHeight = 20;

  // Render the first column
  const firstColumnValue = tableData[0][validColumns[0]];
  doc.fillColor("#f5f5f5")
      .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length)
      .stroke("black")
      .fill();

  doc.font(font)
      .fillColor("black")
      .fontSize(7.2)
      .text(firstColumnValue, startX + 5, startY + 5, {
          width: columnWidths[0] - 10,
          align: 'left',
      });

  // Render other rows
  tableData.forEach((row, rowIndex) => {
      doc.lineWidth(0.5);

      doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], fixedRowHeight)
          .stroke("black")
          .fill();

      validColumns.slice(1).forEach((columnKey, colIndex) => {
          const value = row[columnKey];
          const cellX = startX + columnWidths.slice(0, colIndex + 1).reduce((acc, width) => acc + width, 0);
          const cellWidth = columnWidths[colIndex + 1];

          // Draw cell background
          doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
              .rect(cellX, startY, cellWidth, fixedRowHeight)
              .stroke("black")
              .fill();

          if (value === "check") {
              // Draw checkbox if the value is "check"
              drawCheckbox(doc, cellX + 5, startY + 5, 10, true);
          } else {
              // Handle regular text
              const lines = (value || "").split('\n');
              lines.forEach((line, lineIndex) => {
                  doc.font(font)
                      .fillColor("black")
                      .fontSize(7.2)
                      .text(line, cellX + 5, startY + 5 + (lineIndex * 10), {
                          baseline: "hanging",
                          width: cellWidth - 10,
                      });
              });
          }
      });

      startY += fixedRowHeight;
  });
}


const repaymentTable = [
    { field1: "Repayment Options", filed2: "EMI", field3: "Step Up", field4: "Step Down", field5: "Structured", field6: "Balloon", field7: "Bullet" },
    { field1: "", filed2:"check", field3: ``, field4: ``, field5: ``, field6: ``, field7: `` },
];

repaymentFunction(repaymentTable);



// Call the function to draw the table

doc.moveDown(0.8)
const repaymentFrequencyTable = [
    { field1: "Repayment Frequency", filed2: "Monthly", field3: "Bi-monthly", field4: "Quarterly", field5: "Half Yearly", field6: "Yearly",},
    { field1: "", filed2: "check", field3: ``, field4: ``, field5: ``, field6: ``,  },
];

repaymentFunction(repaymentFrequencyTable);
doc.moveDown()
const repaymentDateTable = [
  { field1: "Repayment Cycle date", filed2: "3rd of the month ", field3: "5th of the month", field4: "10th of the month" },
  { field1: "", filed2: ``, field3: ``, field4: "check",  },
];

repaymentFunction(repaymentDateTable);
doc.moveDown(0.5);

function intrestTableFunction(tableData) {
  // Add Table Header
  const startX = 50;
  let startY = doc.y + 10;
  const totalWidth = 500; // Total column width
  const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
  const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

  tableData.forEach((row, rowIndex) => {
      // Set default row height
      let rowHeight = 15;

      // Calculate the height of the text for field1 and value1
      const field1TextHeight = doc
          .font(font)
          .fontSize(7.2)
          .heightOfString(row.field1, { width: keyWidth });

      let value1TextHeight = 0;
      if (row.value1) {
          value1TextHeight = doc
              .font(font)
              .fontSize(7.2)
              .heightOfString(row.value1, { width: valueWidth });
      }

      // Determine the maximum height between field1 and value1 to set row height
      rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

      // Alternate row background color
      doc.lineWidth(0.5);
      doc
          .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX, startY, keyWidth, rowHeight)
          .stroke("black")
          .fill();

      // Draw text in field1 cell
      doc
          .font(font)
          .fillColor("black")
          .fontSize(7.2)
          .text(row.field1, startX + 5, startY + 5, {
              baseline: "hanging",
              width: keyWidth,
          });

      // Draw the second column, even if value1 is absent
      doc
          .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + keyWidth, startY, valueWidth, rowHeight)
          .stroke()
          .fill();

      // Draw the key-value pair for value1 or leave it empty
      const keyValueText = row.value1 ? `${row.value1}` : ""; // Show empty text if no value
      doc
          .font(font)
          .fillColor("black")
          .fontSize(7.2)
          .text(keyValueText, startX + keyWidth + 5, startY + 5, {
              baseline: "hanging",
              width: valueWidth,
          });

      // Draw vertical line between the columns
      doc.lineWidth(0.5);
      doc.strokeColor("black");
      doc.moveTo(startX + keyWidth, startY);
      doc.lineTo(startX + keyWidth, startY + rowHeight);
      doc.stroke();

      // Move to the next row position
      startY += rowHeight;
  });
}


const intrestData = [
{ field1: "Pre-Instalment Interest Date(s)",value1: `${allPerameters.preInstalmentInterestDate}` },
{ field1: "Date when first instalment is due", value1: `10TH OF EVERY MONTH` },
{ field1: "Total No. of Instalments", value1: `${allPerameters.tenor} Months` },
{ field1: "Amount of each instalment", value1: `Rs.${allPerameters.amountOfEachInstalment}` },
{ field1: "Exact dates of repayment", value1: `The instalments shall be due on the repayment cycle date as mentioned above basis the frequency agreed. \n\n The repayment dates are subject to change depending on the Disbursement of the Facility. Exact dates of repayment shall be communicated through a detailed repayment schedule which shall be sent along with a welcome letter` },
];

intrestTableFunction(intrestData);
doc.moveDown(-0.5);
function repaymentAmountFunction(tableData) {
  // Check if tableData is not empty
  if (!Array.isArray(tableData) || tableData.length === 0 || typeof tableData[0] !== 'object') {
      console.error("Invalid table data");
      return;
  }

  const fixedRowHeight = 20; // Define fixed row height

  // Add Table Header
  const startX = 50;
  let startY = doc.y + 10;

//     // Determine the number of columns from the first row, excluding blank fields
  const validColumns = Object.keys(tableData[0]).filter((key) => {
      return tableData.some(row => row[key] !== ""); // Exclude columns that are completely blank
  });
  const columnCount = validColumns.length;

  // Set column widths (first column wider)
  const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // First column = 150, others share the remaining width

  // Function to calculate required height based on text content
  const calculateRowHeight = (row, isLastRow) => {
      const lineHeight = 10; // Height of each line (adjust as necessary)
      let maxHeight = 0;

      // Calculate height needed for each column in the row
      validColumns.forEach((columnKey) => {
          const value = row[columnKey] || "";
          const lines = value.split('\n');
          const cellHeight = lines.length * lineHeight + 10; // 10 for padding
          maxHeight = Math.max(maxHeight, cellHeight);
      });

      // If it's the last row, ensure we check for the height of field2 specifically
      if (isLastRow) {
          const field2Height = (row[validColumns[1]] || "").split('\n').length * lineHeight + 10;
          maxHeight = Math.max(maxHeight, field2Height);
      }

      return maxHeight;
  };

  // Render first column spanning all rows
  const firstColumnValue = tableData[0][validColumns[0]]; // Value to be spanned in first column
  doc.fillColor("#f5f5f5")
      .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length) // Spans across all rows
      .stroke("black")
      .fill();

  doc.font(font)
      .fillColor("black")
      .fontSize(7.2)
      .text(firstColumnValue, startX + 5, startY + 5, {
          width: columnWidths[0] - 10, // Adjust for padding
          align: 'left',
      });

  // Render the rest of the table row by row
  tableData.forEach((row, rowIndex) => {
      // Calculate the height for the current row
      const isLastRow = rowIndex === tableData.length - 1; // Check if it's the last row
      const rowHeight = calculateRowHeight(row, isLastRow);
      doc.lineWidth(0.5);

      // Alternate row background color
      doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], rowHeight) // Background for other columns
          .stroke("black")
          .fill();

      // Check if field3 and field4 are empty
      const isField3Empty = !row[validColumns[2]]; // Check if field3 is empty
      const isField4Empty = !row[validColumns[3]]; // Check if field4 is empty

      if (isField3Empty && isField4Empty) {
          // Span field2 across the rest of the columns
          const cellWidth = columnWidths[1] + columnWidths[2] + columnWidths[3]; // Total width of field2, field3, and field4 combined
          doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
              .rect(startX + columnWidths[0], startY, cellWidth, rowHeight) // Span cell
              .stroke("black")
              .fill();

          // Draw the value for field2
          const value = row[validColumns[1]];
          const lines = (value || "").split('\n');
          lines.forEach((line, lineIndex) => {
              doc.font(font)
                  .fillColor("black")
                  .fontSize(7.2)
                  .text(line, startX + columnWidths[0] + 5, startY + 5 + (lineIndex * 10), {
                      baseline: "hanging",
                      width: cellWidth - 10, // Adjust for padding
                  });
          });
      } else {
          // Draw field2, field3, and field4 normally
          validColumns.slice(1).forEach((columnKey, colIndex) => {
              const value = row[columnKey];
              const cellWidth = columnWidths[colIndex + 1];
              doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                  .rect(startX + columnWidths[0] + colIndex * cellWidth, startY, cellWidth, rowHeight) // For each column after the first
                  .stroke("black")
                  .fill();

              // Handle line breaks in the cell
              const lines = (value || "").split('\n');
              lines.forEach((line, lineIndex) => {
                  doc.font(font)
                      .fillColor("black")
                      .fontSize(7.2)
                      .text(line, startX + columnWidths[0] + colIndex * cellWidth + 5, startY + 5 + (lineIndex * 10), {
                          baseline: "hanging",
                          width: cellWidth - 10, // Adjust for padding
                      });
              });
          });
      }

      // Move to next row position
      startY += rowHeight; // Adjust starting position based on calculated row height
  });
}

const repaymentAmountTable = [
  { field1: "Total Repayment Amount", filed2: "Principal ", field3: "Total Interest*", field4: "Total repayment amount" },
  { field1: "", filed2:  `${allPerameters.loanAmount}`, field3:  `${allPerameters.totalInterest}`, field4:  `${allPerameters.totalRepaymentAmount}`, },
  { field1: "", filed2: "*The interest amount is calculated basis the ROI and Tenure of the Facility and is excluding any Pre EMI/ broken period interest that may be computed and applied basis the Disbursement date", field3: "", field4: "", },
];

// Call the function with the correct parameter
// repaymentAmountFunction(repaymentAmountTable);
doc.moveDown(-0.1);
const npaTable = [
  { field1: "Default and NPA  classification",value1: `Please refer Annexure 1` },
];
intrestTableFunction(npaTable);
doc.moveDown(1.5);

const startX = 50; // Set a left margin
const startY = doc.y; // Get the current Y position

doc
  .fontSize(8)
  .font('Helvetica')
  .text(
    `Repayment Cheques should be drawn in favour of GROW MONEY CAPITAL PVT LTD\n` +
    `Schedule of Charges on the Loan / Credit Facility\n\n\n\n` +
    `Details pertaining to the Loan Application by Borrower(s) / Co-Borrower(s)\n` +
    `Received copy of Agreement along with the Schedules and Annexure thereto`, 
    startX, // Use the startX value for left alignment
    startY, // Start at the current Y position
    {
      width: 500, // Define a width for text wrapping if needed
      indent: 0, // No indentation
      paragraphGap: 10, // Space between paragraphs
    }
  );
  
  // addFooter();
  
//   //---------------------------------------- new page 4--------------------------------------------------
//   doc.addPage();
//   // addLogo();
//   // drawBorder();
//   doc.moveDown(7);


// const repaymentDateTable = [
//     { field1: "Repayment Cycle date", filed2: "3rd of the month ", field3: "5th of the month", field4: "10th of the month" },
//     { field1: "", filed2: ``, field3: ``, field4: "check",  },
// ];

// repaymentFunction(repaymentDateTable);
// doc.moveDown(0.5);

// function intrestTableFunction(tableData) {
//     // Add Table Header
//     const startX = 50;
//     let startY = doc.y + 10;
//     const totalWidth = 500; // Total column width
//     const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
//     const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

//     tableData.forEach((row, rowIndex) => {
//         // Set default row height
//         let rowHeight = 15;

//         // Calculate the height of the text for field1 and value1
//         const field1TextHeight = doc
//             .font(font)
//             .fontSize(7.2)
//             .heightOfString(row.field1, { width: keyWidth });

//         let value1TextHeight = 0;
//         if (row.value1) {
//             value1TextHeight = doc
//                 .font(font)
//                 .fontSize(7.2)
//                 .heightOfString(row.value1, { width: valueWidth });
//         }

//         // Determine the maximum height between field1 and value1 to set row height
//         rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

//         // Alternate row background color
//         doc.lineWidth(0.5);
//         doc
//             .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX, startY, keyWidth, rowHeight)
//             .stroke("black")
//             .fill();

//         // Draw text in field1 cell
//         doc
//             .font(font)
//             .fillColor("black")
//             .fontSize(7.2)
//             .text(row.field1, startX + 5, startY + 5, {
//                 baseline: "hanging",
//                 width: keyWidth,
//             });

//         // Draw the second column, even if value1 is absent
//         doc
//             .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX + keyWidth, startY, valueWidth, rowHeight)
//             .stroke()
//             .fill();

//         // Draw the key-value pair for value1 or leave it empty
//         const keyValueText = row.value1 ? `${row.value1}` : ""; // Show empty text if no value
//         doc
//             .font(font)
//             .fillColor("black")
//             .fontSize(7.2)
//             .text(keyValueText, startX + keyWidth + 5, startY + 5, {
//                 baseline: "hanging",
//                 width: valueWidth,
//             });

//         // Draw vertical line between the columns
//         doc.lineWidth(0.5);
//         doc.strokeColor("black");
//         doc.moveTo(startX + keyWidth, startY);
//         doc.lineTo(startX + keyWidth, startY + rowHeight);
//         doc.stroke();

//         // Move to the next row position
//         startY += rowHeight;
//     });
// }

  
// const intrestData = [
//   { field1: "Pre-Instalment Interest Date(s)",value1: `${allPerameters.preInstalmentInterestDate}` },
//   { field1: "Date when first instalment is due", value1: `10TH OF EVERY MONTH` },
//   { field1: "Total No. of Instalments", value1: `${allPerameters.tenor} Months` },
//   { field1: "Amount of each instalment", value1: `Rs.${allPerameters.amountOfEachInstalment}` },
//   { field1: "Exact dates of repayment", value1: `The instalments shall be due on the repayment cycle date as mentioned above basis the frequency agreed. \n\n The repayment dates are subject to change depending on the Disbursement of the Facility. Exact dates of repayment shall be communicated through a detailed repayment schedule which shall be sent along with a welcome letter` },
// ];

// intrestTableFunction(intrestData);
// doc.moveDown(-0.5);

// function repaymentAmountFunction(tableData) {
//     // Check if tableData is not empty
//     if (!Array.isArray(tableData) || tableData.length === 0 || typeof tableData[0] !== 'object') {
//         console.error("Invalid table data");
//         return;
//     }

//     const fixedRowHeight = 20; // Define fixed row height

//     // Add Table Header
//     const startX = 50;
//     let startY = doc.y + 10;

// //     // Determine the number of columns from the first row, excluding blank fields
//     const validColumns = Object.keys(tableData[0]).filter((key) => {
//         return tableData.some(row => row[key] !== ""); // Exclude columns that are completely blank
//     });
//     const columnCount = validColumns.length;

//     // Set column widths (first column wider)
//     const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // First column = 150, others share the remaining width

//     // Function to calculate required height based on text content
//     const calculateRowHeight = (row, isLastRow) => {
//         const lineHeight = 10; // Height of each line (adjust as necessary)
//         let maxHeight = 0;

//         // Calculate height needed for each column in the row
//         validColumns.forEach((columnKey) => {
//             const value = row[columnKey] || "";
//             const lines = value.split('\n');
//             const cellHeight = lines.length * lineHeight + 10; // 10 for padding
//             maxHeight = Math.max(maxHeight, cellHeight);
//         });

//         // If it's the last row, ensure we check for the height of field2 specifically
//         if (isLastRow) {
//             const field2Height = (row[validColumns[1]] || "").split('\n').length * lineHeight + 10;
//             maxHeight = Math.max(maxHeight, field2Height);
//         }

//         return maxHeight;
//     };

//     // Render first column spanning all rows
//     const firstColumnValue = tableData[0][validColumns[0]]; // Value to be spanned in first column
//     doc.fillColor("#f5f5f5")
//         .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length) // Spans across all rows
//         .stroke("black")
//         .fill();

//     doc.font(font)
//         .fillColor("black")
//         .fontSize(7.2)
//         .text(firstColumnValue, startX + 5, startY + 5, {
//             width: columnWidths[0] - 10, // Adjust for padding
//             align: 'left',
//         });

//     // Render the rest of the table row by row
//     tableData.forEach((row, rowIndex) => {
//         // Calculate the height for the current row
//         const isLastRow = rowIndex === tableData.length - 1; // Check if it's the last row
//         const rowHeight = calculateRowHeight(row, isLastRow);
//         doc.lineWidth(0.5);

//         // Alternate row background color
//         doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], rowHeight) // Background for other columns
//             .stroke("black")
//             .fill();

//         // Check if field3 and field4 are empty
//         const isField3Empty = !row[validColumns[2]]; // Check if field3 is empty
//         const isField4Empty = !row[validColumns[3]]; // Check if field4 is empty

//         if (isField3Empty && isField4Empty) {
//             // Span field2 across the rest of the columns
//             const cellWidth = columnWidths[1] + columnWidths[2] + columnWidths[3]; // Total width of field2, field3, and field4 combined
//             doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                 .rect(startX + columnWidths[0], startY, cellWidth, rowHeight) // Span cell
//                 .stroke("black")
//                 .fill();

//             // Draw the value for field2
//             const value = row[validColumns[1]];
//             const lines = (value || "").split('\n');
//             lines.forEach((line, lineIndex) => {
//                 doc.font(font)
//                     .fillColor("black")
//                     .fontSize(7.2)
//                     .text(line, startX + columnWidths[0] + 5, startY + 5 + (lineIndex * 10), {
//                         baseline: "hanging",
//                         width: cellWidth - 10, // Adjust for padding
//                     });
//             });
//         } else {
//             // Draw field2, field3, and field4 normally
//             validColumns.slice(1).forEach((columnKey, colIndex) => {
//                 const value = row[columnKey];
//                 const cellWidth = columnWidths[colIndex + 1];
//                 doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                     .rect(startX + columnWidths[0] + colIndex * cellWidth, startY, cellWidth, rowHeight) // For each column after the first
//                     .stroke("black")
//                     .fill();

//                 // Handle line breaks in the cell
//                 const lines = (value || "").split('\n');
//                 lines.forEach((line, lineIndex) => {
//                     doc.font(font)
//                         .fillColor("black")
//                         .fontSize(7.2)
//                         .text(line, startX + columnWidths[0] + colIndex * cellWidth + 5, startY + 5 + (lineIndex * 10), {
//                             baseline: "hanging",
//                             width: cellWidth - 10, // Adjust for padding
//                         });
//                 });
//             });
//         }

//         // Move to next row position
//         startY += rowHeight; // Adjust starting position based on calculated row height
//     });
// }

// const repaymentAmountTable = [
//     { field1: "Total Repayment Amount", filed2: "Principal ", field3: "Total Interest*", field4: "Total repayment amount" },
//     { field1: "", filed2:  `${allPerameters.loanAmount}`, field3:  `${allPerameters.totalInterest}`, field4:  `${allPerameters.totalRepaymentAmount}`, },
//     { field1: "", filed2: "*The interest amount is calculated basis the ROI and Tenure of the Facility and is excluding any Pre EMI/ broken period interest that may be computed and applied basis the Disbursement date", field3: "", field4: "", },
// ];

// // Call the function with the correct parameter
// // repaymentAmountFunction(repaymentAmountTable);
// doc.moveDown(-0.1);
// const npaTable = [
//     { field1: "Default and NPA  classification",value1: `Please refer Annexure 1` },
//   ];
//   intrestTableFunction(npaTable);
//   doc.moveDown(1.5);

//   const startX = 50; // Set a left margin
//   const startY = doc.y; // Get the current Y position
  
//   doc
//     .fontSize(8)
//     .font('Helvetica')
//     .text(
//       `Repayment Cheques should be drawn in favour of GROW MONEY CAPITAL PVT LTD\n` +
//       `Schedule of Charges on the Loan / Credit Facility\n\n\n\n` +
//       `Details pertaining to the Loan Application by Borrower(s) / Co-Borrower(s)\n` +
//       `Received copy of Agreement along with the Schedules and Annexure thereto`, 
//       startX, // Use the startX value for left alignment
//       startY, // Start at the current Y position
//       {
//         width: 500, // Define a width for text wrapping if needed
//         indent: 0, // No indentation
//         paragraphGap: 10, // Space between paragraphs
//       }
//     );
  // addFooter();

// //------------------------------------------- new page 5--------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Annexure 1`, startX, doc.y, { align: "center", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Illustration on due dates and NPA classification`, startX, doc.y, { align: "left", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`If due date of a loan account is March 31, 2021, and full dues are not received before the lending institution runs the day-end process for this date, the date of overdue shall be March 31, 2021. If it continues to remain overdue, then this account shall get tagged as SMA-1 upon running day-end process on April 30, 2021 i.e. upon completion of 30 days of being continuously overdue. Accordingly, the date of SMA-1 classification for that account shall be April 30, 2021.\n\nSimilarly, if the account continues to remain overdue, it shall get tagged as SMA-2 upon running day-end process on May 30, 2021 and if continues to remain overdue further, it shall get classified as NPA upon running day-end process on June 29, 2021.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);


function tableFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row
        for (let field in row) {
            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows, no bold for header
            doc
                .font('Helvetica') // Regular font
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const tableData = [
    { field1: "Status", field2: "DPD", field3: "Illustration 2", field4: "Illustration 1", field5: "Illustration 3", field6: "Illustration 4 (Leap year)" },
    { field1: "*Due date/Overdue (if not paid)", field2: `1 day`, field3: `05-02-22`, field4:`03-06-22`, field5:`15-01-22`, field6: `15-01-24` },
    { field1: "SMA-1", field2: `31 days`, field3: `07-03-22`, field4: `03-07-22`, field5: `14-02-22`, field6: `14-02-24` },
    { field1: "SMA-2", field2: `61 days`, field3: `06-04-22`, field4: `02-08-22`, field5: `16-03-22`, field6: `15-03-24` },
    { field1: "#Non-Performing Asset", field2: `91 days`, field3: `06-05-22`, field4: `01-09-22`, field5: `15-04-22`, field6: `14-04-24` },
];

// Call the function to create the table
tableFunction(tableData);  
doc.moveDown(2)

doc
.fontSize(8)
.font('Helvetica')
.text(`* Any amount due to the lender under any credit facility is ‘overdue’ if it is not paid on the due date fixed by the Lender. If there is any overdue in an account, the default/ non-repayment is reported with the credit bureau companies like CIBIL etc. and the CIBIL report of the customer will reflect defaults and its classification status.\n\n# Once an account is classified as NPAs then it shall be upgraded as ‘standard’ asset only if entire arrears of interest and principal are paid by the borrower\n\nIN WITNESS WHEREOF the Parties hereto have hereunto set and execute this Agreement on the day and year as first mentioned hereinabove.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Lender:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);
doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named GROW MONEY\nCAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(6)
.font('Helvetica')
.text(`________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`Authorised Signatory.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Borrowers and Co-Borrowers:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named “Borrowers”\nand “Co-Borrowers”`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`.1 ${allPerameters.nameOne}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.2 ${allPerameters.nameTwo}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`.3 ${allPerameters.namethird}`,startX, doc.y, { align: "left", width: 500})
// doc.moveDown(1);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
// doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.3 ${allPerameters.nameFourth}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})



// addFooter();

// // --------------------------------------------new page 6-------------------------------------------------------


doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica')
.text(`Affix Revenue Stamp`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`DEMAND PROMISSORY NOTE`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`To,\nThe Manager\nGROW MONEY CAPITAL PVT LTD\nFlat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`On demand I/We and our respective heirs, representatives, executors, administrators, successors and/or permitted assigns,(jointly & severally) unconditionally promise to pay GROW MONEY CAPITAL PVT LTD (“GROW MONEY”, including, its successors and assigns), or order, for value received, the sum of Rs. ${allPerameters.loanAmount}/-${allPerameters.loanAmountinwords} along with applicable interest and charges thereon, which may from time to time be varied in accordance with the policy decision of GROW MONEY.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`To be signed by the Borrower(s)\n\nPlace - ${allPerameters.borrowerPlace}\n\nDATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`______________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);
doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);


// addFooter();


// //----------------------------------------------new page 7-----------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST FORM`,startX, doc.y, { align: "center", width: 500, underline:true})
doc.moveDown(1);

function requestFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Draw the outer rectangle for the box with normal line width
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .lineWidth(0.5) // Set thinner line width for borders
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row with normal line width
        for (let field in row) {
            // Draw rectangle for the field box
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .lineWidth(0.5) // Set thinner line width for field borders
                .stroke("black") // Border for field box
                .fill();

            // Set font style based on whether it's the header row
            const isHeader = rowIndex === 0; // Check if it's the header row
            doc
                .font(isHeader ? 'Helvetica-Bold' : 'Helvetica') // Set font to bold for header
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const requestTableData = [
    { field1: "Name of Applicant", field2: `${allPerameters.customerName}`},
    { field1: "Loan ID", field2: `${allPerameters.loanId}` },
    { field1: "Disbursement Amount Request", field2: `Rs.${allPerameters.disbursementAmount}` },
    { field1: "Date by which the Disbursement is required", field2: `${allPerameters.dateDisbursementRequired}` },
    { field1: "Loan Type ", field2: `Secured Loan` },
    { field1: "LAN No", field2: `${allPerameters.lanNo}` },
];

// Call the function to create the table
requestFunction(requestTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH CHEQUE(S)/DRAFT[1](S) REQUIRED`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const requiredTable = [
    { field1: "Cheque/DD in favour of Payee", field2: "Payable At", field3: "Bank Name of Payee", field4: "Savings/Current Bank Account No of Payee", field5: "Amount" },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
];

// Call the function to create the table
tableFunction(requiredTable);  
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH RTGS`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const rtgsTableData = [
    { field1: "PARTICULARS", field2: "CUSTOMER DETAILS"},
    { field1: "Account Holder Name", field2: `${allPerameters.accountHolderName}` },
    { field1: "Bank Name", field2: `${allPerameters.nameOfBank}` },
    { field1: "Bank Address", field2: `${allPerameters.bankAddress}` },
    { field1: "Bank Account No.", field2: `${allPerameters.accountNo}` },
    { field1: "Bank Account Type", field2: `${allPerameters.accountType}` },
    { field1: "IFSC Code", field2: `${allPerameters.IFSCCode}` },
    { field1: "Customer E-Mail Address", field2: `${allPerameters.emailAddress}` },
    { field1: "For Official Use", field2: `${allPerameters.officeUse}` },
    { field1: "Amount Payable", field2: `${allPerameters.amountPayable}` },
    { field1: "Application ID", field2: `${allPerameters.applicantId}` },
    { field1: "Agreement No", field2: `${allPerameters.agrementNo}` },
];

// Call the function to create the table
requestFunction(rtgsTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Operation`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(-2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DATED : ${allPerameters.disbursementDate}`,startX, doc.y, { align: "left", width: 500, underline:true})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Applicant`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Co-Applicants`,startX, doc.y, { align: "right", width: 500});
// doc.moveDown(0.5);

// addFooter();

// // -------------------------------------------------new page 8------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`REPAYMENT CHEQUE ACKNOWLEDGEMENT LETTER`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(0.5);

function latterTableFunction(tableData) {
    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;
    const totalWidth = 500; // Total column width
    const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
    const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

    tableData.forEach((row, rowIndex) => {
        // Set default row height
        let rowHeight = 15;

        // If it's the last field, span both columns
        if (rowIndex === tableData.length - 1) {
            const fullText = `${row.field1} ${row.value1 || ''}`.trim();
            const textHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(fullText, { width: totalWidth });

            rowHeight = textHeight + 10; // Add some padding

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, totalWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw the text spanning both columns
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(fullText, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: totalWidth,
                });
        } else {
            // Calculate the height of the text for field1 and value1
            const field1TextHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(row.field1, { width: keyWidth });

            let value1TextHeight = 0;
            if (row.value1) {
                value1TextHeight = doc
                    .font(font)
                    .fontSize(7.2)
                    .heightOfString(row.value1, { width: valueWidth });
            }

            // Determine the maximum height between field1 and value1 to set row height
            rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw text in field1 cell
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: keyWidth,
                });

            // Draw the second column, even if value1 is absent
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke()
                .fill();

            // Draw the key-value pair for value1 or leave it empty
            // const keyValueText = row.value1 ? `Value: ${row.value1}` : ""; // Show empty text if no value
            const keyValueText = row.value1 || ""; 

            doc

                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(keyValueText, startX + keyWidth + 5, startY + 5, {
                    baseline: "hanging",
                    width: valueWidth,
                });

            // Draw vertical line between the columns
            doc.lineWidth(0.5);
            doc.strokeColor("black");
            doc.moveTo(startX + keyWidth, startY);
            doc.lineTo(startX + keyWidth, startY + rowHeight);
            doc.stroke();
        }

        // Move to the next row position
        startY += rowHeight;
    });
}

const letterData = [
  { field1: "Customer Name", value1: `${allPerameters.customerName}` },
  { field1: "Address", value1: `${allPerameters.address}` },
  { field1: "Contact Nos.", value1: `${allPerameters.registeredMobile}` },
  { field1: "Credit Facility", value1: `` },
  { field1: "Facility Amount", value1: `Rs.${allPerameters.loanAmount}-${allPerameters.loanAmountinwords}` },
  { field1: "Repayment Mode", value1: `NACH / PDC` },
  { field1: `MENTION THE COUNT OF CHEQUE RECEIVED\n\nCheque Received (A) Undated: 5 (B) Cancelled: 0\n\nCheques Handed over to Mr./Mrs.: ${allPerameters.chequesHandedName}\n\nSourcing Channel Name:${allPerameters.sourcingChannelName}`, value1: "" }
];

latterTableFunction(letterData);

function draweeFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const fieldWidths = [0.25 * boxWidth, 0.5 * boxWidth, 0.25 * boxWidth]; // Widths for each main column
    const extraPadding = 15; // Additional padding for row height

    // Calculate the total height for the entire box
    let totalHeight = 0;
    tableData.forEach(row => {
        let rowHeight = 0;
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });
        totalHeight += rowHeight;
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5);

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0")
        .rect(startX, startY, boxWidth, totalHeight)
        .stroke("black")
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX;
        let rowHeight = 0;

        // Determine row height with extra padding
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });

        // Draw rectangles and text for each field in the row
        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[0], rowHeight).stroke("black");
        doc.font('Helvetica').fillColor("black").fontSize(7.2).text(row.field1, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[0] - 10, align: 'left' });
        currentX += fieldWidths[0];

        if (rowIndex === 0) {
            doc.rect(currentX, startY, fieldWidths[1], rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[1] - 10, align: 'center' });
            currentX += fieldWidths[1];
        } else {
            const subFieldWidth = fieldWidths[1] / 2;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_2 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
        }

        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[2], rowHeight).stroke("black").fillColor("black").text(row.field3, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[2] - 10, align: 'center' });

        // Move to the next row
        startY += rowHeight;
    });
}

// Sample data
const DraweeData = [
    { field1: "Drawee Bank", field2_1: "Cheque No.", field2_2: "", field3: "No of Cheques" },
    { field1: " ", field2_1: "From", field2_2: "To", field3: " " },
    { field1: `APP`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.appbranchName}`, field2_1: `${allPerameters.appchequeNo1}`, field2_2: `${allPerameters.appchequeNo5}`, field3: `${allPerameters.totalCheque}` },
    { field1: `GAU`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.gaubranchName}`, field2_1: `${allPerameters.gaucheqNo1}`, field2_2: `${allPerameters.gauchequeNo5}`, field3: `${allPerameters.gautotalCheq}` },
];

// Call the function to create the table
draweeFunction(DraweeData);


doc.moveDown(3);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`I ${allPerameters.customerName} hereby confirm that I have handed over FIVE cheques detailed above towards repayment of Instalment(s) or security cheque for the loan/facility already taken/to be taken from GROW MONEY CAPITAL PVT LTD and that all cheques were drawn in favour of “GROW MONEY CAPITAL PVT LTD” and also recorded my name on the reverse side of the cheques.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`DATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Name) - ${allPerameters.customerName}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Signature)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`This is to confirm that physical cheques were cross tallied with the above schedule and found correct.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

function SignatureTableFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const normalRowHeight = 20; // Normal height for other rows
    const signatureRowHeight = 40; // Increased height for the signature row

    // Define fixed column widths for three columns
    const columnWidths = [150, 150, 200]; // Adjust widths for your layout

    // Calculate total height needed for the entire box
    let totalHeight = tableData.length * normalRowHeight; // Total height based on normal row height

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row

        // Determine row height based on whether it's the signature row
        const rowHeight = rowIndex === 0 ? signatureRowHeight : normalRowHeight; // Change height for the first row (signature)

        // Draw rectangles for each field in the row
        columnWidths.forEach((width, index) => {
            const field = `field${index + 1}`;

            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, width, rowHeight) // Use determined row height
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows
            doc
                .font('Helvetica')
                .fillColor("black")
                .fontSize(7.2);

            // Draw the field text in the box
            const fieldValue = row[field] || ""; // Use empty string for missing fields
            doc.text(fieldValue, currentX + 3, startY + 5, {
                baseline: "hanging",
                width: width - 10, // Adjust width to provide padding inside the box
                align: 'left', // Align text to the left
            });

            // Move to the next column
            currentX += width; // Update X position for the next field
        });

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row based on the determined height
    });
}

const SignatureTable = [
    { field1: "Signature", field2: "", field3: "" },
    { field1: "Name", field2: ``, field3: "" },
    { field1: "", field2: "Sales Executive / DSA", field3: "CPA / FIN COOPERS Staff" },
];

// Call the function to create the table
SignatureTableFunction(SignatureTable);

// addFooter();

// //---------------------------------------------- new page 9---------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`LETTER OF CONTINUITY`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(2.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Place: Indore`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`Dear Sir(s),`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`I/We ${allPerameters.customerName} a company incorporated under the provisions of the Companies Act, 1956/2013 /a partnership firm registered under the provisions of the Indian Partnership Act, 1932/ sole proprietorship concern or an individual having its office/ place of business at ${allPerameters.place}, acting through _______________________________, who is duly authorized in that behalf vide board resolution/ letter of authority/power of attorney dated DATED : ${allPerameters.date} (the “Borrower(s)”), enclose a Promissory Note dated DATED : ${allPerameters.date} for Rs.${allPerameters.disbursementAmount} payable on demand which is given to you (“DPN”) as collateral security for repayment to GROW MONEY, (hereinafter referred to as the “GROW MONEY”, including its successors and assigns) of any sum now due or which may hereafter become due from me/us to GROW MONEY in respect of Rs.${allPerameters.disbursementAmount} (hereinafter referred to as the “Facility”) granted by GROW MONEY vide Facility Agreement dated DATED : ${allPerameters.date}.I/We hereby irrevocably and unconditionally agree, confirm and undertake that:\n\n1. the DPN shall operate as continuing security to you to be enforceable for the repayment of the ultimate balance and/or all sums remaining unpaid under the Facility now or hereafter, including all interest to become payable in respect of / under the Facility or which may in future be advanced; and\n\n2. we will remain liable on the DPN notwithstanding payment made into the account of the Facility from time to time or the Facility being reduced or extinguished from time to time or even if the balance in the account of the Facility may be in credit.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(3);

doc
.fontSize(8)
.font('Helvetica')
.text(`Yours faithfully`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`(Borrowers)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`___________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500});
// doc.moveDown(2);

// addFooter();

// //----------------------------------------------- new page 10-----------------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
    .fontSize(8)
    .font('Helvetica-Bold') // Use the bold version of Helvetica
    .text(`END-USE UNDERTAKING`, startX, doc.y, { align: "center", width: 500, underline:true })
    .moveDown(2)

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`DATED : ${allPerameters.date}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Dear Sir/Madam,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Subject:- Undertaking regarding utilizations of Loans to be granted by GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`I/We ${allPerameters.customerName} acknowedge that  GROW MONEY has sanctioned loan amount of Rs. ${allPerameters.loanAmount} (${allPerameters.loanAmountinwords}) to subject to the terms and conditions as mentioned in the Sanction Letter Date:${allPerameters.sanctionLatterDate}(sanction letter). The Loan has been sanctioned by GROW MONEY inter alia, on the basis of my/our representation that we/I are/am engaged in the business of and the loan will be utilized only for the purpose of .\n\n I/We hereby solemnly confirm and certify that Loan shall be utilized only for the aforesaid purpose and no other purpose. I/We will never utilize the Loan or any part thereof for any speculative, illegal and prohibited activity (prohibited under any applicable laws/rules/regulations). Any breach or violation of the representation made herein, and other documents executed in relation to Loan will be my/our responsibility solely.\n\nI/We shall extend necessary support and co-operation to GROW MONEY for any matter in connection with this letter and Facility Agreement.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(2);

// addFooter();


    // Finalize the PDF
    doc.end();
  
    // const pdfFileUrl = `/uploads/pdf/${pdfFilename}`;

    // const objData = {
    //     fileName: pdfFileUrl,
    //     file: doc.toString('base64')
    //  }
    //   await initESign(objData)
  
    // return new Promise((resolve, reject) => {
    //   stream.on("finish", () => {
    //     resolve(pdfFileUrl);
    //   });
    //   stream.on("error", reject);
    // });

    return new Promise((resolve) => {
      doc.on('end', () => resolve(Buffer.concat(buffers)));
    });
  }

  async function ratannaFinSanctionLetterPdf2(allPerameters,logo,partnerName) {

    const font = "assets/font/Cambria.ttf";
    const fontBold = "assets/font/Cambria-Bold.ttf";
    const fontKerlaTamil = "assets/font/KarlaTamilUpright-Regular.ttf"
    const fontUrdu = "assets/font/IBMPlexSansArabic-Regular.ttf"
    const fontTelugu = "assets/font/TiroTelugu-Regular.ttf"
    const fontPanjabi = "assets/font/BalooPaaji2-VariableFont_wght.ttf"
    const fontMalayam = "assets/font/AnekMalayalam-VariableFont_wdth.ttf"
    const fontKannada = "assets/font/NotoSansKannada-VariableFont_wdth.ttf"
    const fontGujarati = "assets/font/Rasa-VariableFont_wght.ttf"
    const fontHindi = "assets/font/Mukta-Regular.ttf"
    const fontOriya = 'assets/font/BalooBhaina2-VariableFont_wght.ttf'
    const fontMarathi = 'assets/font/Hind-Regular.ttf'
    const fontBengali = 'assets/font/NotoSansBengali-VariableFont_wdth.ttf'
    // const baseDir = path.join("./uploads/");
    // const outputDir = path.join(baseDir, "pdf/");

    const PDFDocument = require('pdfkit');
  const doc = new PDFDocument({ margin: 50, size: "A4" });

  // Buffer to hold the PDF content
  const buffers = [];
  doc.on('data', (chunk) => buffers.push(chunk));
  doc.on('end', () => console.log('PDF generated successfully!'));

  
    // draw a border around the page
    function drawBorder() {
      const pageWidth = doc.page.width;
      const pageHeight = doc.page.height;
      const margin = 30;
      const lineWidth = 2;
  
      // Draw a simple border rectangle
      doc.lineWidth(lineWidth);
      doc
        .rect(margin, margin, pageWidth - 2 * margin, pageHeight - 2 * margin)
        .strokeColor("#324e98") // Set the color of the border
        .stroke();
    }
  
    // add logo to every page
    // function addLogo() {
    //   if (fs.existsSync(logo)) {
    //     doc.image(logo, 400, 50, {
    //       fit: [150, 50],
    //       align: "right",
    //       valign: "bottom",
    //     });
    //   } else {
    //     console.error(`Logo file not found at: ${logo}`);
    //   }
    // }
    const FinpdfLogo = path.join(
        __dirname,
        "../../../../../assets/image/FINCOOPERSLOGO.png"
      );

    function addLogo() {
          if (fs.existsSync(FinpdfLogo)) {
            doc.image(FinpdfLogo, 400, 50, { fit: [150, 50], align: "left", valign: "bottom" });
          } else {
            console.error(`Logo file not found at: ${FinpdfLogo}`);
          }
      
          if (fs.existsSync(logo)) {
                  doc.image(logo, 40, 50, {
                    fit: [150, 50],
                    align: "right",
                    valign: "bottom",
                  });
                } else {
                  console.error(`Left logo file not found at: ${logo}`);
                }
        }
  
    // watermark function
    function addWatermark() {
      if (fs.existsSync(watermarklogo)) {
        doc.save();
        doc.rotate(-45, { origin: [doc.page.width / 2, doc.page.height / 2] });
  
        doc.image(
          watermarklogo,
          doc.page.width / 2 - 200,
          doc.page.height / 2 - 200,
          {
            fit: [450, 400],
            opacity: 0.05,
            align: "center",
            valign: "center",
          }
        );
  
        doc.restore();
      } else {
        console.error(`Logo file not found at: ${watermarklogo}`);
      }
    }
  
    // Footer with border and stylized text
    // Footer with border and stylized text
    function addFooter() {
      if( partnerName == "GROW MONEY CAPITAL PVT LTD"){
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("Grow Money Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }else {
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("FinCoopers Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }
     
    }
  
    // if (!fs.existsSync(outputDir)) {
    //   fs.mkdirSync(outputDir, { recursive: true });
    // }
  
    const timestamp = Date.now();
    // const candidateName = 
    // (`${candidateDetails.name}`); // Capitalize name
    // const pdfFilename = `growLoanAggrement.pdf`;
    // const pdfPath = path.join(outputDir, pdfFilename);
  
    // const doc = new PDFDocument({ margin: 50, size: "A4" });
    // const stream = fs.createWriteStream(pdfPath);
  
    // doc.pipe(stream);
    // //---------------------------------------------------- new page 14-------------------------------------------------------

// addLogo();
// drawBorder();
doc.moveDown(7);


doc
.fontSize(9)
.font('Helvetica-Bold')
.fontSize(9)
.text(`Vernacular Language Form`,  { align: "center",underline: false, width: 500 });
doc.moveDown(2);


function declarationTableFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  const columnWidths = {
    field1: 50,
    field2: 100,
    field3: 330,
  };

  // Define min and max row height to avoid extremes
  const MIN_ROW_HEIGHT = 15;
  const MAX_ROW_HEIGHT = 45;

  // Function to calculate row height based on text content
  const calculateRowHeight = (row) => {
    let maxHeight = 0;
    Object.keys(row).forEach((field) => {
      const text = row[field] || '';
      const columnWidth = columnWidths[field] || 100;

      // Calculate the text height for each field
      const textHeight = doc
        .font(field === 'field3' ? fontKerlaTamil : 'Helvetica')
        .fontSize(7.2)
        .heightOfString(text, { width: columnWidth });

      // Track the highest text height in the row
      maxHeight = Math.max(maxHeight, textHeight);
    });

    // Ensure the row height stays within the defined min and max limits
    return Math.max(MIN_ROW_HEIGHT, Math.min(maxHeight, MAX_ROW_HEIGHT));
  };

  const totalWidth = Object.values(columnWidths).reduce((sum, width) => sum + width, 0);

  tableData.forEach((row, rowIndex) => {
    let currentX = startX;
    const rowHeight = calculateRowHeight(row); // Calculate the row height based on text content

    // Set up the table border at the beginning
    doc
      .lineWidth(0.25)
      .rect(startX, startY, totalWidth, rowHeight)
      .stroke("black");

    Object.keys(columnWidths).forEach((field) => {
      const columnWidth = columnWidths[field];
      const content = row[field] || '';

      doc
        .lineWidth(0.25)
        .rect(currentX, startY, columnWidth, rowHeight)
        .stroke("black");

      const isHeader = rowIndex === 0;
      const paddingTop = 2;  // Adjust padding from the top (increase if needed)
      const textYPosition = startY + paddingTop;

      if (field === 'field1' && content) {
        doc.image(content, currentX + 5, textYPosition + (rowHeight - 8) / 2, { width: 8, height: 8 });
      } else {
        doc
          .font(isHeader ? 'Helvetica-Bold' : 'Helvetica')
          .fillColor("black")
          .fontSize(7.2);

        const text = content || '';
        if (field === 'field3') {
          // Checking for specific languages to apply respective fonts
          if (/[\u0C00-\u0C7F]/.test(text)) {  // Telugu Unicode range
            doc.font(fontTelugu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0D00-\u0D7F]/.test(text)) {  // Malayalam Unicode range
            doc.font(fontMalayam).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0C80-\u0CFF]/.test(text)) {  // Kannada Unicode range
            doc.font(fontKannada).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0A80-\u0AFF]/.test(text)) {  // Gujarati Unicode range
            doc.font(fontGujarati)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0600-\u06FF]/.test(text)) {  // Urdu Unicode range
            doc.font(fontUrdu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'right',
               });
          } else if (/[\u0A00-\u0A7F]/.test(text)) {  // Punjabi Unicode range
            doc.font(fontPanjabi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0B80-\u0BFF]/.test(text)) {  // Tamil Unicode range
            doc.font(fontKerlaTamil).text(text, currentX + 3, textYPosition, {
                baseline: "top",
                width: columnWidth - 6,
                align: 'left',
            });
          } else if (/[\u0900-\u097F]/.test(text)) {  // Hindi Unicode range
            doc.font(fontHindi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else  if (/[\u0B00-\u0B7F]/.test(text)) {  // Odia Unicode range
            doc.font(fontOriya)  // Make sure 'fontOdia' is defined and points to the correct font file
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
           } else if (/[\u0900-\u097F]/.test(text)) {  // Marathi (Devanagari Unicode range)
            doc.font(fontMarathi)  // Ensure you have the Marathi font file available
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
        } else if (/[\u0980-\u09FF]/.test(text)) {  // Bengali Unicode range
          doc.font(fontBengali)  // Ensure you have the Bengali font file available
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }else {
            doc.font('Helvetica')
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          }
        } else {
          doc.font('Helvetica')
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }
      }

      currentX += columnWidth;
    });

    startY += rowHeight; // Adjust to the row's actual height
  });
}

const gujratiFont = [
'આ અરજી/કરાર/પત્ર/નિયમો અને શરતોનો સામગ્રી અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહકને અંગ્રેજીમાં વાંચીને સમજાવી',
'  અને વ્યાખ્યા કરવામાં આવી છે અને અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહક દ્વારા તેને સમજવામાં આવી છે',
]

const declarationTable = [
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "English", 
    field3: "The content of this Application/ Agreement/letter/Terms and Conditions has been read out, explained and interpreted to the applicant(s)/Borrower and to the Co-Borrower(s) in English and understood by the applicant(s)/Borrower and Co-Borrower(s).",  // English text
  },
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "Hindi", 
    field3: "इसआवेदन / समझौ ते / पत्र / नि यमों औमों रशर्तों की सा मग्री को आवेदक (ओं)ओं / उधा रकर्ता औरअंग्रेजीग्रे जीमेंसह-उधा रकर्ता (ओं)ओं को समझा औरसमझा यागयाहैऔहै रआवेदक (ओं)ओं याउधा रकर्ता द्वा रा समझा गया है ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Punjabi", 
    field3: "ਇਸਬਿ ਨੈ-ਪੱਤਰ / ਸਮਝੌਤੇਝੌਤੇ/ ਪੱਤਰ / ਨਿ ਯਮਾਂ ਅਮਾਂ ਤੇਸ਼ਰਤਾਂ ਦੀਤਾਂ ਦੀਸਮੱਗਰੀ ਨੂੰਬਿ ਨੈਕਾ ਰ /ਉਧਾ ਰਲੈਣਵਾ ਲੇਅਤੇਅੰਗ੍ਰੇਜ਼ੀ ਵਿ ਚਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇਨੂੰਸਮਝਾ ਕੇਸਮਝਾ ਇਆਗਿ ਆਹੈਅਤੇਬਿ ਨੈਕਾ ਰਦੁਆਰਾ ਸਮਝੇਗਝੇ ਏਅਤੇਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Kannada", 
    field3: "ಈ ಅಪ್ಲಿಕೇ ಶನ್/ಒಪ್ಪಂ ದ/ಪತ್ರ / ನಿಯಮಗಳುಮತ್ತು ಷರತ್ತು ಗಳವಿಷಯವನ್ನು ಅರ್ಜಿ ದಾ ರ (ರು )/ ಸಾ ಲಗಾರಮತ್ತು ಇಂ ಗ್ಲಿಷ್ನಲ್ಲಿಸಹ-ಸಾ ಲಗಾರ(ಗಳು)ಗೆಓದಿ, ವಿವರಿಸಲಾ ಗಿದೆಮತ್ತು ವ್ಯಾ ಖ್ಯಾ ನಿಸಲಾ ಗಿದೆಮತ್ತು ಅರ್ಜಿ ದಾ ರರು (ಗಳು ) /ಸಾ ಲಗಾರರಿಂ ದಅರ್ಥ ಮಾ ಡಿಕೊ ಳ್ಳಲಾ ಗಿದೆಮತ್ತು ಸಹ-ಸಾ ಲಗಾ ರ (ಗಳು).  ",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Telugu", 
    field3: "ఈ అప్లికేప్లిషన్ / ఒప్పం దం / లేఖ / నిబం ధనలుమరియుషరతులయొక్క కం టెం ట్దరట్ద ఖాస్తుదారు(లు) / రుణగ్ర హీతమరియుఆం గ్లం లోసహ-రుణగ్ర హీత (ల)కుచదవబడిం ది, వివరిం చబడిం దిమరియువివరిం చబడిం దిమరియుదరఖాస్తుదారు(లు) / రుణగ్ర హీతఅర్థం చేసుకున్నా రుమరియుసహ-రుణగ్ర హీత (లు)."
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Tamil", 
    field3: "இந்தவிண்ணப்பம் / ஒப்பந்தம் / கடிதம்வி தி முறைகள்மற்றும்நி பந்தனை களி ன்உள்ளடக்கம்விண்ணப்பதா ரர்(கள்)/கடன்வா ங்குபவர் மற்றும்இணைக்கடன்வா ங்குபவர்(கள்) ஆகி யோ ருக்குஆங்கி லத்தி ல்படித்துவி ளக்கப்பட்டுவி ளக்கம்அளி க்கப்பட்டுள்ளதுமற்றும்விண்ணப் பதா ரர்(கள்)/கடன்வா ங்குபவர்புர",  // Tamil text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Malayalam", 
    field3: 'ഈ ആപ്ലി ക്കേ ഷന്റെ ഉള്ളടക്കം / കരാ ർ / കത്ത് / നി ബന്ധനകളും വ്യ വസ്ഥകളും അപേ ക്ഷകന് / കടം വാ ങ്ങു ന്നയാ ൾക്കും ഇം ഗ്ലീ ഷി ൽ സഹ-കടം വാ ങ്ങു ന്നയാ ൾക്കും വാ യിക്കു കയും വി ശദീ കരിക്കു കയും വ്യാ ഖ്യാ നിക്കു കയും ചെ യ്തു കൂ ടാ തെ അ പേ ക്ഷകൻ (ങ്ങൾ) / കടം വാ ങ്ങു ന്നയാ ൾ മനസ്സി ലാ ക്കു കയും ചെ യ്യു ന്നു . ഒപ്പം സഹ-കടം വാ ങ്ങു ന്നവരും .',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Oriya", 
    field3: 'ଏହିଆହି ବେ ଦନ / ଚୁକ୍ତିନା ମା / ଚିଠିଚି ଠି/ ସର୍ତ୍ତା ବଳୀ ଏବଂ ଚୁକ୍ତିନା ମା ଗୁଡିକଡି ଆବେ ଦନକା ରୀ (()) / orrଣଗ୍ରହୀ ତା ଏବଂ ସହ-orrଣଗ୍ରହୀ ତା ଙ୍କୁଇଂ ରା ଜୀ ରେ ପ read ା ଯା ଇଛି,ଛିବ୍ୟା ଖ୍ୟା କରା ଯା ଇଛିଏବଂ ଆବେ ଦନକା ରୀ (ମା ନେ ) / orrଣଦା ତା ଦ୍ୱା ରା ବୁଝିଛଝିନ୍ତିଏନ୍ତିବଂ ସହ-orrଣଦା ତା (ଗୁଡିକଡି ) |',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Marathi", 
    field3: 'याअर्जा ची / करा रा ची / पत्रा ची / अटी व शर्तीं ची मा हि ती वा चूनका ढली गेली आहे,हेअर्जदा रा ला /कर्जदा रा ला आणि इंग्रजी मध्येसह-कर्जदा रा ला /केली आहे व अर्जदा रा ने /कर्जदा रा नेसमजूनघेतली आहे.हेआणि सह-कर्जदा र',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Gujarati", 
    field3: gujratiFont.join('\n'),  // English text
  },
  {
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Urdu", 
    field3: "درخواست/معاہدہ/خط/شرائط و ضوابط کا مواد درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ کو انگریزی میں پڑھ کر سنایا گیا، وضاحت کی گئی اور اس کی تشریح کی گئی اور درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ نے اسے سمجھ لیا۔",  // Urdu text
  },
];

// // Call the table function to render the data
declarationTableFunction(declarationTable);
doc.moveDown(3);

// doc
// .fontSize(9)
// .font('Helvetica')
// .text(`___________________________`,  doc.y, { align: "left",underline: true, width: 500 });
// doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica-Bold')
// .text(`FOR Borrower,Co-Borrower and Guarantor`,{ align: 'left',lineGap: 5  });
// doc.moveDown(1);

// Reset the starting position
doc
.fontSize(8)
.font('Helvetica-Bold')
.text(
  `FOR Borrower, Co-Borrower and Guarantor`,
  40, // X-coordinate for absolute left alignment
  doc.y, // Y-coordinate: use the current vertical position
  { align: 'left', lineGap: 5 }
);
doc.moveDown(1);

  
// addFooter();
doc.addPage();


    // addLogo();
    // drawBorder();
    doc.moveDown(6);

   doc.font(font).fontSize(11).text('FACILITY AGREEMENT', { align: 'center', underline: true });
   doc.moveDown(2);


doc.font('Helvetica').fontSize(9).text(`THIS FACILITY AGREEMENT`, {
  align: 'left',
  indent: 40,
  lineGap: 5,
  continued: true
})
.font('Helvetica-Bold').text(`(“Agreement”)`, {
  continued: true, // Allows the text to continue on the same line
})
.font('Helvetica').fontSize(9).text(` is made at the place and on the date stated in the Schedule of this Agreement (“Schedule”) by and between:`, {
  align: 'left',
 align:"justify",
  indent: 40,
  lineGap: 5,
})

doc.moveDown(1)

.font('Helvetica').text(`GROW MONEY CAPITAL PVT LTD,`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica').text(` a company incorporated under the Companies Act, 1956 and validly existing under and within the meaning of the Companies Act, with CIN: U74899DL1995PTC069216, registered as a nonbanking financial company`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica-Bold').text(`(“NBFC”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica').text(`under the Reserve Bank of India`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica-Bold').text(`(“RBI”) `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`Act, 1934, having its registered office at 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI-110001 (M.P.), India (hereinafter referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(` “Lender”,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`which expressionshall, unless repugnant to the subject or context thereof, be deemed to include its successors, transferees, novatees and assigns), of the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(`FIRST PART;`) 

  doc.moveDown(1);
  doc.font(font).fontSize(9).text('AND', { align: 'center' });
  doc.moveDown(1);

  doc.font('Helvetica').text(`which expression shall, unless repugnant to the subject or context there of, be deemed to include its successors, transferees, novatees and assigns), of the `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(` SECOND PART`) 

  doc.font('Helvetica').text(`The Borrower and Lender are hereinafter collectively referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(`“ Parties”`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and individually referred to as `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(` “Party”`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`WHEREAS`) 
  doc.moveDown(1);

  doc.font('Helvetica').text(`1. The Borrower is engaged in the business or employment as detailed in the Schedule appended here with`, {
    continued: true, // Allows the text to continue on the same line
  })
  
  doc.font('Helvetica-Bold').text(`(“Business”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and it has requested the Lender to sanction a credit facility for an amount as mentioned in the Schedule `, {
    continued: true, // Allows the text to continue on the same line
  })

  doc.font('Helvetica-Bold').text(`(“Facility”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 2. The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 3. At the Borrower’s request and relying upon the correctness of the information, the representations and the assurances given by the Borrower, the Lender has agreed to grant the Facility to the Borrower, on the terms and conditions contained herein.`)
  doc.moveDown(1);

  doc.font('Helvetica-Bold').text(`NOW, THEREFORE,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`in consideration of the premises and mutual agreements and covenants contained in this Agreement and other good and valuable consideration (the receipt and adequacy of which is hereby mutually acknowledged), each of the Parties hereby agrees as follows:`)

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`DEFINITIONS AND INTERPRETATION`) 
  doc.moveDown(1);

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`1.1 Definitions`) 
  doc.moveDown(1);
  
  doc.font('Helvetica').text(`Wherever used in this Agreement or any Schedule, unless the context otherwise requires, in addition to the terms defined in the Recitals and in the text of this Agreement, the following capitalized terms have the following meanings:`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`“Additional Interest Rate” means the additional interest rate as detailed in the Schedule,`) 
  doc.font('Helvetica-Bold').text(`“Applicable Interest Rate”`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica').text(`means the rate of interest as mentioned in the Schedule payable by the Borrower to the Lender on the outstanding principal amount under the Facility and serviced in a manner as specified in this Agreement.`)
  doc.font('Helvetica-Bold').text(`“Applicable Law”`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`means any statute, national, state, provincial, local, municipal, or other law, treaty, code, regulation, ordinance, rule, judgment, order, decree, bye-law, any act or enactment including but not limited to the Insolvency and Bankruptcy Code, 2016`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica-Bold').text(`( “Code”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`, Securitization and Reconstruction of Financial Assets and Enforcement of Security Interest Act, 2002`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica-Bold').text(`(“SARFAESI Act”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`The Industrial Disputes Act, 1947, Environment Protection Act, 1986, Reserve Bank of India Act, 1934 and other RBI regulations,Companies Act, 2013, Transfer of Property Act, 1882, approval of any Governmental Authority, directive, guideline, policy, requirementor other governmental restriction or any similar form of decision of or determination by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    continued: false, // Allows the text to continue on the same line
  })
   
    // addFooter();
    //------------------------------------------new page ----------------------------------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    // doc.moveDown();


    // doc.font('Helvetica').fontSize(9).text(`by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    //     continued: true, 
    //   })

    doc.font('Helvetica-Bold').fontSize(9).text(`“Application Form”`, {
        continued: true, // Allows the text to continue on the same line
    })  

    doc.font('Helvetica').text(`” means the application form and/or relevant information submitted through any means by the Borrower to the Lender for applying and availing the Loan/Facility, together with all other information particulars, clarifications and declarations, if any, furnished by the Borrower or any other person from time to time in connection with the said Loan/Facility,`)  

    doc.font('Helvetica-Bold').text(`“Business Day”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean a day of the week on which the scheduled commercial banks are open for businessin such state or union territory of India where the office of the Lender, as specified in the Schedule, is located. `)  

    doc.font('Helvetica-Bold').text(`“Borrower/Co-borrower”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`means and includes all the borrower(s) and co-borrower(s) and shall deem to include (i) in case of the individual- his or her heirs, executors and administrators and in case of more than one Borrower their respective heirs executors and administrators, (ii) in case of a company incorporated under the provisions of \n\n Companies Act or a society registered under the applicable laws relating to societies- its successors in interest and permitted assigns, (iii) in case of a partnership firm within the meaning of Indian Partnership Act,1932- any ofor each of the partner or survivor/s of them from time to time (both their personal capacity and as partners of the firm) and their respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the firm, (iv) in the case of proprietary concern- the proprietor(s) (both in his/her personal capacity and as proprietor/proprietress of the concern) and his her respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the concern, (v) in the case of a Hindu Undivided Family` , {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(` (“HUF”),`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`, the Karta of the HUF and any or each of the adult members/coparceners of the HUF and their survivor(s) and their respective heirs, legal representatives, executors, administrators and permitted assigns, (vi) in the case of trust, the trust/trustee/s for the time being its successors.`) 

    doc.font('Helvetica-Bold').text(`“Charges”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean the charges which may be charged by the Lender in relation to the Loan/ Facility, including the charges provided in the Sanction Letter. Any revision to the Charges as per this Agreement as may be communicated or notified to the Borrower shall be the applicable Charges and shall be deemed to have been incorporated in the Sanction Letter, and the Sanction Letter to this effect be deemed to have been modified;`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(`“Companies Act”`, {
        continued: true, // Allows the text to continue on the same line
    })
    
    doc.font('Helvetica').text(`” means individually and collectively, the provisions of the Companies Act, 2013 and such relevant provisions of the Companies Act, 1956, which are still in force and effect including all amendments, enactments, re-enactments or modifications thereof, from time to time, including the rules and regulations prescribed therein`) 
  
    doc.font('Helvetica-Bold').text(`“Conditions Precedent”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means the conditions as specified in Clause 3.5 of this Agreement which are required to be satisfied (unless waived in writing by the Lender) by the Borrower,`)

   doc.font('Helvetica-Bold').text(`“Credit Information Agency”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`” shall mean and include TransUnion CIBIL Limited, CRIF High Mark Credit Information Services Private Limited, Equifax India and Equifax Analytics Private Limited, Experian Credit Information Company of India Private Limited or such other company or any other agency as may be notified or recognized as such by the RBI or any other regulatory authority,`)

    doc.font('Helvetica-Bold').text(`“Designated Account”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means a current bank account of the Lender for receipt of the Outstanding Amounts; “Disbursement” means the disbursement of the Facility or any part thereof, made by the Lender pursuant to the request thereof by the Borrower subject to the terms of this Agreement;`)
  
    doc.font('Helvetica-Bold').text(`“Disbursement Request Form”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“DRF”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means a form (as per format in attached annexure) or a request (in a form and manner acceptable to the Lender) submitted by the Borrower to the Lender requesting that all or a portion of the Facility be disbursed to the Borrower;`)
    doc.font('Helvetica-Bold').text(`“Due Date”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the date(s) on which any amounts in respect of the Facility including the principal, interest or other monies fall due under the terms of this Agreement and/or the other Financing Documents and/or as more particularly described under the Schedule;`)
    doc.font('Helvetica-Bold').text(`“Electronic Clearing Service”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`‘ECS'`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`'NACH',`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the electronic clearing services and electronic payment services, notified by RBI from time to time, being mode(s) of effecting payment transactions using the services of a clearing house or any other platform or mechanism duly authorized in this regard including without limitation the National Electronic Clearing Service;`)
    doc.font('Helvetica-Bold').text(`“Encumbrance”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the creation of charge, lien, security, quasi security, non-disposal arrangement, claim, option, negative lien, power of sale in favor of a third party, retention of title, right of pre-emption, right of first refusal, lock-in of any nature including as may be stipulated by the Securities Exchange Board of India, or other third party right or security interest or an agreement, arrangement or obligation to create any of the foregoing whether presently or in the future. The term`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbrancer”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbered”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall be accordingly construed;`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Event of Default”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall have the meaning prescribed to it under clause 13 herein;`)
    doc.font('Helvetica-Bold')
   .fontSize(9)
   .text(
      `"Account Bank" or "Escrow Agent"`,
      { continued: true }
   )
   .font('Helvetica')
   .text(` means the bank acceptable to the Lender`, { continued: true })
   .font('Helvetica')
   .text(
      ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
    // addFooter();
      //-------------------------------------------------new page ------------------------------------------------------
      doc.addPage();
      // addLogo();
      // drawBorder();

      doc.moveDown(7);

      // doc.moveDown();

  //     doc.font('Helvetica-Bold')
  //  .fontSize(9)
  //  .text(
  //     `"Account Bank" or "Escrow Agent"`,
  //     { continued: true }
  //  )
  //  .font('Helvetica')
  //  .text(` means the bank acceptable to the Lender`, { continued: true })
  //  .font('Helvetica')
  //  .text(
  //     ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
  //     { align: 'justify', indent: 40, lineGap: 5 }
  //  )
  //  .moveDown(1);

doc.font('Helvetica-Bold')
    .fontSize(9)
   .text('"Escrow Account"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the account opened/maybe opened with the Account Bank in accordance with this Agreement and the Escrow Agreement, for the repayment of Outstanding Amounts or any amount payable by Borrower to Lender under this Agreement,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Escrow Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` for the purpose of this Agreement, as the context may require, shall either mean the agreement executed/to be executed/maybe executed at any date as required by Lender and entered into by and between inter alia the Bank (defined below), the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account and the Lender reserves the right to make Borrower a part of Escrow Agreement on such terms and conditions as the Lender may decide in its sole discretion or it shall mean the agreement executed/to be executed/maybe executed at any date as required by Lender, and entered into by and between inter alia the Borrower, the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Facility"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the aggregate amount of credit facility/facilities provided under the terms of this Agreement, and any other outstanding amounts thereunder;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Financing Documents"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Application Form, this Agreement, the Sanction Letter, and all other deeds, instruments, and agreements including security documents of any nature that have been/are to be executed between the Parties, or with any third parties in relation to the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

// addFooter();
// doc.addPage();
// addLogo();
// drawBorder();

// Continue with bold and normal text
doc.font('Helvetica-Bold')
   .text('"Facility Agreement" or "Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` means this agreement, all Schedules and amendments to this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   

doc.font('Helvetica-Bold')
   .text('"Guarantor"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Person(s) as more particularly mentioned in the Schedule, providing guarantee to secure the Outstanding Amount and for the due performance of the terms and conditions of this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Governmental Approval"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean any consent, approval, authorization, waiver, permit, grant, franchise, concession, agreement, license, certificate, exemption, order registration, declaration, filing, report, or notice of, with or to any Governmental Authority,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

   doc.font('Helvetica-Bold')
   .text('"Governmental Authority"', { continued: true })
   .font('Helvetica')
   .text(
      ` means any:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(0.5);

// Point a
doc.text(
   `a) government (central, federal, state or otherwise) or sovereign state and`,
   { indent: 60, align: 'justify', lineGap: 5,  }
)
   .moveDown(0.5);

// Point b
doc.text(
   `b) any governmental agency, semi-governmental or judicial or quasi-judicial or administrative entity,\n department or authority, or any political subdivision thereof, including without limitation, any stock exchange\n or any self-regulatory organization, established under any Applicable Law,`,
   { indent: 60, align: 'justify', lineGap: 5,continued: false }
)
   doc.moveDown(1);

   doc.font('Helvetica-Bold')
.fontSize(9)

   .text('"Instalments"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the amount of payment necessary to amortize the Facility with Interest (rounded off to the next rupee) with in such period as may be determined in the Repayment Schedule,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   doc.font('Helvetica-Bold')
   .text('"Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the interest payable on the Facility at the Applicable Interest Rate, including the Pre-Instalment Interest payable by the Borrower to the Lender at Applicable Interest Rate as specified in the Schedule hereunder,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );


      
      
      // addFooter();

  //-------------------------------------------------new page ------------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();

doc.moveDown(7)
// doc.moveDown()





doc.font('Helvetica-Bold')
.fontSize(9)
   .text('"Market Disruption Event"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean happening of an event which in the opinion of the Lender would make it unviable for the Lender to continue the Loan/Facility,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Outstanding Amounts"', { continued: true })
   .font('Helvetica')
   .text(
      ` means at any time all the amounts payable in relation to the Facility by the Borrower to the Lender, pursuant to the terms of the Financing Documents, including the following amounts:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.text(
   `a) The principal amount of the Facility and Interest there on.`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) All dues payable by the Borrower, as reflected in the books and records maintained by the Lender in its\n normal course of business from time to time.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) All other moneys, debts, and liabilities of the Borrower, including indemnities, liquidated damages, costs,\n Charges, expenses, and fees and interest incurred under, arising out of or in connection with the Financing\n Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) Any and all sums expended by the Lender in order to preserve any Security; and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `e) Any and all costs, expenses, fees, and duties for the enforcement and collection of any amounts due\n under the Financing Documents, including expenses of enforcement and realization of the Security\n and costs and expenses set out in Clause 15 (Costs, Charges, Expenses and Stamp Duty) hereto.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );






doc.font('Helvetica-Bold')
   .text('"Payment Instrument(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the instrument as specified by the Lender in the Schedule hereunder, including but not limited to ECS, NACH, digital or electronic payments, money transfer through mobile applications and PDCs, by which the Borrower shall make the payment of Outstanding Amounts to the Lender.“Person(s)” shall mean any natural person or legal entity whether incorporated or not, limited or unlimitedliability company, body corporate, co-operative society, corporation, partnership (whether limited or unlimited), proprietorship, society, HUF, trust, union, association or association of persons, body of individuals, government or any agency there of, or any other entity that may be treated as a person under the Applicable Law; “Post Date Cheque(s)” or “PDC(s)” shall mean the postdated cheque(s) issued in favor of the Lender to ensure continuity of repayment by the Borrower under the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the interest payable on the disbursed amount, at the Applicable Interest Rate, for the period commencing from the relevant disbursement date to the date immediately prior to the commencement of Repayment, payable by the Borrower on the Pre-Instalment Interest Date(s).`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   
   doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest Payment Date(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the date, if any, which is specified in the Schedule on which the Borrower shall pay the Pre-Instalment Interest;.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   doc.font('Helvetica-Bold')
   .text('"Prepayment Statement"', { continued: true })
   .font('Helvetica' )
   .text(`or`,{ continued: true })
   .font('Helvetica-Bold')
   .text('"PForeclosure Statement"', { continued: true })
   .font('Helvetica' )
   .text(
      `  shall mean the statement which shall be sent by the Lender to the Borrower, on providing the written consent as per Clause 6.3 hereunder, which statement shall contain the terms and conditions of the prepayment of the Outstanding Amount, or any part thereof by the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .font('Helvetica-Bold' )
   .text('"Purpose"',{ continued: true})
   .font('Helvetica' )
   .text(
    `  shall have the meaning as specified in the Schedule.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .font('Helvetica-Bold' )
 .text('"Receivables"',{ continued: true})
 .font('Helvetica' )
 .text(
  ` shall mean the receivables as more particularly described under the Schedule.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)


   

doc.font('Helvetica-Bold')
   .text('"Repayment"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the repayment and/or the prepayment of the principal amount of the Facility, interest thereon, Additional Interest, costs and other charges, premium, fees or other dues payable in accordance with this Agreement. The words “Repay” and “Repaid” shall be construed accordingly.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Repayment Schedule"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the manner in which the Repayment shall be made by the Borrower including details like due dates, installment amount etc. prepared in line with the details specified in the Schedule to this Agreement as may be revised from time to time and communicated to the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );






// addFooter();
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Restricted Party"', { continued: true })
   .font('Helvetica')
   .text(
      `means a person that is: (i) listed on, or owned or controlled by a person listed on, or acting on behalf of a person listed on, any Sanctions List; (ii) located in, incorporated under the laws of, or owned or (directly or indirectly) controlled by, or acting on behalf of, a person located in or organised under the laws of a country or territory that is the target of country-wide or territory-wide Sanctions; or (iii) otherwise a target of Sanctions ("target of Sanctions" signifying a person with whom a US person or other national of a Sanctions Authority would be prohibited or restricted by law from engaging in trade, business or other activities); "Sanctions" means the economic sanctions laws, regulations, embargoes or restrictive measures administered, enacted or enforced by: (i) the United States government; (ii) the United Nations; (iii) the European Union; (iv) the United Kingdom; or (v) the respective governmental institutions and agencies of any of the foregoing, including,without limitation, the Office of Foreign Assets Control of the US Department of Treasury ("OFAC"), the United States Department of State, and Her Majesty's Treasury ("HMT") or (vi) RBI or any other Indian authority (together the
`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions Authorities"');

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Sanction Letter"', { continued: true })
   .font('Helvetica')
   .text(
      `means the sanction letter as mentioned in the Schedule, issued by the Lender and accepted by the Borrower regarding the sanction of the Facility, as may be amended, modified, varied and supplemented including, any subsequent sanction letter(s) issued by the Lender regarding the Facility from time to time;
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions List"',{continued: true })
   .font('Helvetica')
   .text(
      `means the "Specially Designated Nationals and Blocked Persons" list maintained by OFAC, the Consolidated List of Financial Sanctions Targets and the Investment Ban List maintained by HMT, or any similar list maintained by, or public announcement of Sanctions designation made by, any of the Sanctions Authorities.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Security"',{continued: true })
   .font('Helvetica')
   .text(
      `shall have the meaning ascribed to it under clause 8.1 of this Agreement.
`,
      { align: 'justify', indent: 40, lineGap: 5,  }
   )
   .font('Helvetica-Bold')
   .text('"Security Interest"',{continued: true })
   .font('Helvetica')
   .text(
      `means (i) any mortgage, charge (whether fixed or floating), pledge, lien, hypothecation, assignment, deed of trust, security interest or other Encumbrance of any kind securing, or conferring any priority of payment in respect of, any obligation of any Person, including without limitation any right granted by a transaction which, in legal terms, is not the granting of security but which has an economic or financial effect similar to the granting of security under Applicable Law, (ii) any voting agreement, interest, option, right of first offer, refusal or transfer restriction in favour of any Person, and/or (iii) any adverse claim as to title, possession or use;

`,
      { align: 'justify', indent: 40, lineGap: 5, }
   );

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Security Provider"', { continued: true })
   .font('Helvetica')
   .text(
      `means the Person(s) who provide(s) security in respect of the Facility, as more particularly described under the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Taxes"', { continued: true })
   .font('Helvetica')
   .text(
      `means any present or future tax, levy, duty or other charge of a similar nature (including any penalty or interest payable on Escrow Account or any failure to pay or delay in paying the same), now or hereafter imposed by law by any Governmental Authority.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Tenor"', { continued: true })
   .font('Helvetica')
   .text(
      `means the period specified in the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"GROW MONEY CAPITAL PVT LTD Reference Rate"', { continued: true })
   .font('Helvetica')
   .text(
      `shall mean the percentage rate of interest per annum decided by the Lender from time to time and announced/notified by the Lender as the GROW MONEY CAPITAL PVT LTD Reference Rate on its website or otherwise as the case may be.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )


// addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)

   .text('1.2 INTERPRETATION', { align: 'left' })

doc.font('Helvetica')
   .text(
      `In this Agreement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `
      (a) Unless the context otherwise requires reference to a Recital/Clause and/or a Schedule of this Agreement,
       all of which constitute an integral and operative part of this Agreement.
      (b) Headings to parts, clauses and paragraphs are for convenience only and do not affect the interpretation of
       this Agreement.
      (c) Reference to any statute or statutory provision or order or regulation made there under shall include
       references to that statutes, provision, order or regulation as amended, modified, re-enacted or replaced 
       from time to time whether before or after the date hereof.
      (d) Reference to any document includes an amendment to that document, but disregarding any amendment
       made in breach of this Agreement.
      (e) Reference to an “amendment” includes a supplement, modification, novation, replacement or
       re-enactmentand “amended” is to be construed accordingly.
      (f) Unless the context otherwise requires, words denoting the singular shall include the plural and vice
       versa, and words denoting any gender include all genders.
      (g) Reference to the word “include” or “including” shall be construed without limitation.
      (h) References to a “person” or “Person” shall include that Person’s successors in title, executors, permitted
       transferees and permitted assignees and references to a Person’s representatives shall be to its officers,\n employees, legal or other professional advisers, sub-contractors, agents, attorneys and other duly authorised \nrepresentatives.
      `,
      { align: 'justify', indent: 40, }
   );
   doc.font('Helvetica')
   .text(`(i) Words`,{indent: 40,continued:true})
   .font('Helvetica-Bold')
   .text(`"hereof", “herein”, “hereto”, “hereunder”` ,{ continued:true,align: 'justify', indent: 40, });
   doc.font('Helvetica')
   .text(` or similar terms used with reference to a specific clause\n in this Agreement shall refer to such clause in this Agreement and when used otherwise than\n in connection with specific clauses shall refer to this Agreement as a whole.
    ` ,{ align: 'justify', indent: 40, lineGap: 5 });
    doc.font('Helvetica')
   .text(`(j) In the computation of periods of time from a specified date to a later specified date, the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 });

    doc.font('Helvetica-Bold')
    .text(`"from" ` ,{ continued:true,align: 'justify', indent: 40, });
    doc.font('Helvetica')
    .text(` and ` ,{ align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on" ` ,{ continued:true,align: 'justify', indent: 40, })
    .font('Helvetica')
    .text(` mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"from and including" ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on and including”, respectively" ` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`, and the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`“to”, “until” ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`each mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"to but not including", "until but not including"` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on but not including"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` respectively ` ,{align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(k) Unless otherwise specified, whenever any payment to be made or action to be taken under this Agreement,\n is required to be made or taken on a day other than a Business Day, such payment shall be made,\n or action be taken on the\n immediately following Business Day.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(l) Where a wider construction is possible, the words` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"other” and “otherwise"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` shall not be construed ejusdem\n generis with any foregoing words.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(m) A time of day is a reference to India time.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica-Bold')
.fontSize(9)

   .text('2. THE FACILITY AND PURPOSE', { align: 'left' })

doc.font('Helvetica')
   .text(
      `The Borrower hereby agrees to borrow, and the Lender hereby agrees to lend the Facility to the Borrower, subject to the terms and conditions of the Financing Documents. The Borrower hereby confirms that it shall utilize the Facility only for the Purpose as mentioned in the Schedule. If in the opinion of the Lender (which opinion shall be binding and conclusive against the Borrower) the Facility is not used for the Purpose (provided that the Lender shall not be bound to enquire as to, or be responsible for, the use or application of any funds advanced under the Facility), the Lender shall have the right to declare it as an Event of Default.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
    // addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
   .fontSize(9)
   .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.1 Subject to the conditions mentioned in this Agreement, the Lender may, at its sole and absolute discretion,\n disburse the Facility or any part thereof as per disbursement request made by the Borrower to the Lender
       any time during the Tenor of Facility. The Borrower shall ensure the following before making any request 
       for the Disbursement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.text(
   `a) no actual/potential Event of Default has occurred, is in existence and/or is continuing;`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) all the representations and warranties are correct, complete and are in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) all Conditions Precedent have been fulfilled;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
    `d) post disbursal conditions with respect to the previous Disbursement/s have been met (if any);`,
    { indent: 60, align: 'justify', lineGap: 5 }
 )
 .text(
  `e) he Security has been validly created in form and substance acceptable to the Lender as per theterms of
      the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
)
.text(
  `f) he Borrower is in compliance with the terms and conditions of the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
);
 

   // Page 5: Continue with Disbursement and Conditions


// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.2 Not withs tanding any other provision hereof, the Lender, may at its sole discretion, cancel first or any 
      further/subsequent disbursement of the Facility if, in the reasonable opinion of the Lender:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) An Event of Default is likely to occur/has occurred/is continuing/threatened/which may result from
      such disbursement or if it becomes unlawful for the Lender to disburse or continue the Facility;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) Any representation and/or warranty is not correct, complete or is not in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) Any event has occurred/is continuing which has/could result in a material adverse effect or constitute 
       a Market Disruption Event; or`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) An Applicable Law restrains, prevents or imposes adverse conditions upon the transactions contemplated
       by the Financing Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );

// addFooter();

// // Page 6: Continue Disbursement and Conditions
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.3 The fulfilment or satisfaction of any Condition Precedent may be waived or deferred in writing by the
       Lender, at its sole discretion, following a written request from the Borrower setting out:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) the Condition Precedent in respect of which the Borrower seeks a waiver/deferment, and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) the reasons for seeking such waiver/deferment.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.4 The Borrower shall promptly give a written notice to the Lender, of the satisfaction of the Conditions Precedent
       along with documentary evidence of such satisfaction by issuance of a Conditions Precedent satisfaction
       notice and if it becomes aware of any event/circumstance which will/may prevent such 
       satisfaction, it shall forthwith notify the Lender in writing.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

// addFooter();

// // Page 7: Continue with Conditions Precedent and Facility Agreement
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica-Bold')
   .text(
      `3.5 Conditions Precedent`,
      { align: 'left', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica')
   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to them
      respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );
   

// addFooter();

// ---------------------------------------new page-----------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7)

doc.font('Helvetica')
.fontSize(9)

   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to
      them respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
      
   )
   .moveDown(1);
   

doc.font('Helvetica')
   .text(`3.5.1 The Borrower assures to the Lender that it (or in case the of under construction immovable property , the
seller/builder of such immovable property will transfer the marketable title in favour of Borrower by way
ofconveyance) has absolute, clear and marketable title to the immovable property including free from
Encumbrance, any liability, charge/lien or from any litigation/court decree whatsoever, to be mortgaged by
it as Security for the Facility and Lender is free to get the title of the immovable property checked/verified in
the manner it deems fit at the cost and risk of the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 })
.moveDown(1);




doc.font('Helvetica')
   .text(
      `3.5.2 The obligation of Lender to make any Disbursement under the Financing Documents shall also be subject to
       the following Conditions Precedent:.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `The Borrower acknowledges that the Facility is granted subject to the terms and conditions specified in 
       this Agreement and any subsequent amendments or supplements made in writing by the Lender.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1)
   .text(
    `(a) Borrower shall meet the minimum creditworthiness requirements as may be specified by Lender. For this
      purpose, the Borrower will provide all the information and assistance required by the Lender so that the
      Lender may conduct any inquiries, as deemed fit and proper in the Lender’s sole discretion, in this regard. .`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) No Event of Default has occurred or is likely to occur.`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) The Borrower shall have satisfied the Lender about the (i) utilisation of the proceeds of any prior
         disbursement and (ii) proposed utilization of the proceeds of the Disbursement after the sanction 
         of Facility,within the time frame specified by Lender, along with the request for release of part 
         of the funds needed by the Borrower for the Purpose..`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d) No extraordinary or other circumstances shall have occurred which shall make it improbable for 
        the Borrower to fulfill its obligations under the Financing Documents.`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)The Borrower/Security Provider shall prior to the disbursement of the Facility have executed all security
documents and created perfect Security including but not limited to registration of charge with the
concerned registrar of sub-assurances in the form and manner acceptable to the Lender and shall ensure
appropriate filing of charge, if any, along with proper stamp duty being paid on duly executed instruments of
Security.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) The Borrower shall satisfy the Lender to the effect that there is no action, suit, proceeding or investigation
pending or threatened by or against the Borrower, Guarantor or Security Provider, before any court of lawor
Governmental Authority or any other competent authority which might have material adverse effect on the
affairs of the Borrower or the Guarantor or Security Provider.`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `3.5.3 Not with standing anything contained herein, in case any disbursement has been made, the Borrower shall
continue to be under obligation to repay along with interests and costs, the entire amount so disbursed in
terms of the Financing Documents.`,
            { align: 'justify', indent: 40, lineGap: 5 });


// addFooter();

//-------------------------------------New page ------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
   .text(
      `3.5.4 The Borrower, whenever required by the Lender, shall provide the following, in a form and substance
satisfactory to the Lender:
`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   
   .moveDown(1)
   .text(
    `(a)  Evidence that all consents, resolutions, approvals, authorizations and permissions required for availing ofthe
Facility or for creation of Security in favour of the Lender have been obtained;.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) Certified true copies of the audited accounts of the Borrower;`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) Evidence that all compliance under the Companies Act, 2013 or any other law as maybe applicable to the
constitution of Borrower, has been adhered to;
`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d)  Evidence that all duly stamped Financing Documents shall have been properly stamped, executed and have
come into force as per their respective terms duly registered with the sub registrar of assurances or any
other competent authority, in favour of the Borrower and the necessary security can be created in favour of
Lender in the form and manner as acceptable to the Borrower;
`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)Evidence to show insurance cover on the Security has been obtained to the satisfaction of the Lender;.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) Evidence, as may be deemed necessary by Lender, including but not limited to an undertaking and indemnity
that the Facility or any part thereof shall be used only for Purpose as disclosed by the Borrower;
`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `(g) Such other documents as may be required by the Lender.`,
            { align: 'justify', indent: 40, lineGap: 5 })
            .moveDown()
            doc.text(
          `The Borrower also hereby agrees and undertakes to pay the complete stamp duty due on Financing Documents or any other document related thereto and in the event of any deficiency or default thereof, the Borrower shall indemnify and keep the Lender indemnified from and against any actual payment, losses and cost that the Lender has or may have incurred towards the same within `,
              { align: 'justify', indent: 40, lineGap: 5, continued: true }
           );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand. Borrower undertakes to regularize the documents, if required, by the respective courts or collector of stamps, by paying the actual difference in stamp duty and the amount of penalty as may be applicable. In the event, any litigation is initiated under this Agreement, Borrower agrees to indemnify the Lender from any actual and direct loss, cost, expenses that it may incur or suffer in defending the litigation within `,
                 { align: 'justify', indent: 40, lineGap: 5, continued: true }
              );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              );
              doc.moveDown();

              doc.font('Helvetica-Bold')
              .text('3.6 Amortisation', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `3.6.1 The Borrower will amortise the Facility strictly as stipulated in the Schedule, subject to any other changes in
such amortisation as communicated later in writing by Lender to the Borrower. However, in the event of
delay or advancement, for any reason whatsoever, in the disbursement of Facility, the Due Date of payment
of first Instalment shall in such case be the corresponding day of the following months to the day currently
stated in the Schedule.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `3.6.2 The Borrower shall also pay to Lender, the Pre-Instalment Interest as maybe applicable on the Facility under
the terms of this Agreement..`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `3.6.3 The Borrower agrees that the amount shall be remitted to Lender on each and every Due Date of the
Instalments. In the event of any dishonour of Payment Instrument, the Borrower agrees to pay a dishonour
charge as mentioned in the Sanction Letter, in addition to any Additional Interest that may be levied by
Lender as per its discretion`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           



    // addFooter();

    //-----------------new page-----------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica')
     .fontSize(9)
    .text(
      `3.6.4 In the event of any variation in the date of payment of Instalments/the amount of Interest, principal or
Instalments/the numbers thereof, the Borrower undertakes to forthwith issue fresh PDCs/ECS/such other
payment instruments as may be required by Lender`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `3.6.5 Notwithstanding anything herein, Lender shall always have the right to review and reschedule the
repayment terms of the Facility or of the outstanding amount thereof in such manner and to such extent as
Lender may decide. In such event/s the Borrower shall repay the Facility or the Outstanding Amount
thereof as per the revised Schedule as may be determined by Lender in its sole discretion`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `3.6.6 In case any amount is prepaid by the Borrower, unless otherwise decided by the Lender in its discretion, the
same shall be adjusted/appropriated towards the Pre-Instalment Interest, other applicable interest,
principal outstanding and the balance towards other charges under the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.moveDown();

doc.font('Helvetica-Bold')
              .text('4. INTEREST', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `4.1 The Borrower shall pay Interest to the Lender in respect of the principal amount of the Facility outstanding
from time to time, and on all fees, costs, commissions, Charges and other amounts due under or in respect of
this Agreement under the Facility at the Applicable Interest Rate. It is hereby clarified that the Lender may, in
its discretion among other alternatives, require the Borrower to pay upfront the Pre- Instalment Interest at
Applicable Interest Rate or the Pre-Instalment Interest may be deducted from the amount of the Facility
disbursed.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `4.2 Interest shall be payable at Applicable Interest Rate (or such other rate as may be notified by the Lender
from time to time) through such Payment Instruments and in the manner specified and at such intervals
specified under the Schedule.`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `4.3 The Applicable Interest Rate for the Facility provided on floating rate of interest shall be calculated with
reference to the GROW MONEY CAPITAL PVT LTD Reference Rate and shall comprise of GROW MONEY
CAPITAL PVT LTD Reference Rate plus margin (as may be agreed with the Lender from timeto time). It is
hereby clarified that the GROW MONEY CAPITAL PVT LTD Reference Rate and the Applicable Interest Rate
may fluctuate/vary from time to time or as may be determined by the Lender in its absolute discretion.`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           doc.font('Helvetica-Bold')
           .text(
            `4.4 In the event of default on the part of the Borrower in the payment of any sum due hereunder, in any
manner whatsoever or the Borrower committing any breach or default of any condition of this
Agreement or Financing Document, the Borrower shall pay to the Lender, Additional Interest at the
Additional Interest Rate which will be calculated on a daily basis over and above the Applicable
Interest Rate to be charged on the overdue Installment(s). Such interest shall be payable on and from
the date of default to and including the date on which such delay or defaultis rectified (“Additional
Interest”). The Lender’s right to claim such Additional Interest shall be without prejudice and in
addition to the Lender’s right to take any other action available to it under the terms of this
Agreement or at law in respect of such event of default.`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );

         doc.font('Helvetica')
           .text(
            `4.5 In the event of revision of Applicable Interest Rate, the Lender shall notify the same to Borrower, such
notification shall form a part of this Agreement. In the event the Borrower does not agree to such revision,the
Borrower shall forthwith repay the Outstanding Amount within 30 (thirty) days from the date of intimation.
In case if such repayment is not forthcoming within the said period, the Borrower shall be liableto service the
Facility in accordance with the revised interest rate`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );



    // addFooter();
//-------------------new page--------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `4.6 The Borrower acknowledges that any sums, interest, default amount including but not limited to
(i) the Prepayment Charges and (ii) the Additional Interest, are reasonable and that they represent
genuine pre-estimates of the loss which would be incurred by the Lender in the event of nonpayment or 
default by the Borrower in accordance with the Financing Documents. The Borrower waives any right it 
may have to raise any claim/defence in this regard.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `4.7 Interest, Additional Interest and all other charges shall accrue from day to day on the actual number
of days elapsed and shall be calculated on an actual day count basis, i.e., actual number of days
elapsed divided by the actual number of days in the year`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica')
 .text(
  `4.8 The Borrower confirms, agrees and acknowledges that it has perused and understood the Lender’s method
of calculating the Applicable Interest Rate and further agrees and undertakes to abide by the same without
any demur/objection.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `4.9 The Borrower acknowledges that the Facility provided under this Agreement is for a commercial transaction
and the Borrower waives any defences available under usury or other laws relating to the charging of
interest.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

// point 5

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5. DISBURSEMENT`,
      { align: 'left' }
   );
   doc.moveDown();
   doc.font('Helvetica')
   .text(
    `The Facility can be disbursed by the Lender in one or more tranches in its sole and absolute discretion,
subject to the terms contained in the Sanction Letter and this Agreement. The Disbursement can be doneby
the Lender either in favour of/in the bank account of the Borrower or in favour of/in the bank account ofsuch
person/entity who/which is specified by the Borrower in its request for Disbursement to the Lender.
Nothing contained herein shall be deemed to be a guarantee or an assurance on behalf of the Lender
regarding Disbursement of the Facility.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.1 Schedule of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
 .text(
  `Subject to fulfilment of the Conditions Precedent and at the Lender’s discretion, the Facility shall be
disbursed in single or in multiple tranches as more specifically detailed in the Sanction Letter.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.2 Mode of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
.text(
  `All payments to be made by the Lender to the Borrower under this Agreement shall be deposited in the bank
account which is maintained by the Borrower which maybe specified in the disbursement request, by way of
Real Time Gross Settlement (RTGS)/Cheque/s duly crossed and marked “A/c Payee Only” or such other
manner as specified by the Lender in the Schedule and the collection charges, if any, in respect of 
RTGS/cheque(s) and/or such other instruments as specified in the Schedule will have to be borne by the
Borrower. The Interest on the Facility will begin to accrue in favour of the Lender from the date on which the
Disbursement is done by the Lender by way of making/issuance of the RTGS/cheque(s) and/or such other
instruments as specified in the Schedule irrespective of the time taken for transit or for collection/realization
thereof. Without prejudice to anything contained herein, if necessitated by prevailing circumstances, the
Lender shall be at liberty to use any other method or mode for disbursement underthis Agreement and if the
same is not rejected by Borrower, then such disbursement shall be deemed to be accepted disbursement and
have same effect as any other Disbursement under the Agreement.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//------------------------new page-------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.3 Other Charges`,
      { align: 'left' }
   )
   
   .text(
    `The Borrower shall, on or before the date of the first drawdown/disbursal of the Facility, pay to the
Lender the Charges as specified by the Lender from time to time. The Borrower hereby agrees that
any amount outstanding from his/her/its any other loan/facility with the Lender may be, deducted
and/or adjusted from amount disbursed or held with Lender under this Agreement.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 ).moveDown();

 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `6. REPAYMENT / PREPAYMENT
`,
      { align: 'left' }
   ).moveDown();
 doc.font('Helvetica')
 .text(
  `6.1 Except as otherwise agreed by the Lender, the Borrower shall repay the amounts under the Facility
outstanding from time to time on each and every Due Date in an amount equal to the Instalment as specified
in the Repayment Schedule provided that:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `a) The Facility shall be repaid in full by the final repayment date as specified in the Repayment Schedule 
  through such payment instruments as specified in the Schedule;`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `b) The Lender shall be entitled to demand immediate repayment of the entire amount of the Facility
outstanding if any portion of the principal amount of the Facility or any interest due thereon is not paid as
and when it is due to be paid; and`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `c) The Borrower shall repay the principal amount of the Facility along with interest & costs under the
Agreement free from and clear of any deduction and/or set off on any account whether by operation of law or
otherwise and if any such deductions are required by operation of law or otherwise, then same shall be
entirely borne by the Borrower. It is hereby clarified that in case the Borrower has been sanctioned multiple
facilities, there will not be any setoff without the prior written consent of the Lender.`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown()
.text(
  `6.2 The Borrower shall be solely responsible to timely pay all costs, Charges and expenses of the Lender
promptly as and when required to do so by the Lender and the Lender shall be under no obligation to
provide the Borrower with any notice, reminder or other intimation to the Borrower regarding its obligation
to pay the same.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica-Bold')
.text(
  `6.3 The Borrower may become entitled to prepay the Facility through such Payment Instruments as
specified in the Schedule only with the prior written consent of the Lender (extent of which may or
may not be granted by the Lender). If acceptable to Lender, then any prepayment shall be done only
after the expiry of such period as maybe specified in this regard under the Sanction Letter, by giving
not less than 7 (seven) days’ notice to the Lender and provided that any such prepayment shall be
made subject to payment of any prepayment costs (“Prepayment Charges”) as specified herein or in
Sanction Letter. The Lender shall provide to the Borrower a Prepayment Statement and the Borrower
shall prepay the whole or any part of the Facility strictly in accordance with the Prepayment
Statement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.text(
  `6.4 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility, the Lender shall promptly
notify the Borrower upon becoming aware of that event and the Lender shall be at liberty to not make any
further advancement of amount under Facility and it shall be entitled to call in the entire Outstanding
Amounts forthwith and the Borrower shall on such date as the Lender may specify, without demur or dispute
whatsoever, repay the Outstanding Amount owing to the Lender in respect of the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//--------------new page-------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `7. INCREASED COSTS`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `If, by reason of (i) any change in law or in its interpretation or administration and/or (ii) compliance with
any request/requirement of RBI or any other authority, which request/requirement affects the manner in
which the Lender is required to or does maintain capital resources or reserves having regard to Lender’s
obligations hereunder and to amounts owing to it hereunder, the Lender:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `(a) incurs a cost as a result of Lender having entered into/complying with and/or performing
   its obligations under this Agreement; or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(b) becomes liable to make any payment on account of tax or otherwise (not being a tax imposed on
the net income of the Lender) on or calculated by reference to the Facility sanctioned or to be
sanctioned by the Lender hereunder and/or to any sum received or receivable by it hereunder,
then the Borrower shall, from time to time on demand of the Lender, promptly pay to the Lender
amounts sufficient to indemnify the Lender against, as the case may be (1) all such costs as above,
( 2) such reduction in such rate of return (or such proportion of such reduction as is, in the
opinion of the Lender, attributable to its obligations hereunder), 
(3) such increased cost (or such proportion of such increased cost as is, in the opinion of the Lender,
 attributable to its funding or maintaining an advance hereunder) or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(4) such liability. The Lender shall also be entitled to recover such increased cost, reduction in rate of return
and any such liability incurred by the Lender by deducting an amount equivalent to the same from the
subsequent disbursal or drawdown to be made to the Borrower.
`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `8. SECURITY`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `8.1 In consideration of the Lender making available the Facility and to secure the repayment of the Outstanding
Amounts, the Borrower agrees that the Security Interest shall be created in favour of the Lender in the form
and manner satisfactory to the Lender on the asset/s as more specifically mentioned in the Schedule of the
Agreement     `,
  { align: 'justify', indent: 40, lineGap: 5,continued:true }
)
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `            (“Security”).`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.text(
  `8.2 The Borrower hereby agrees that it shall, at all times during the Tenor of the Facility, ensure that the Security
provided by the Borrower or Security Provider (other than Borrower) under this Agreement is of such value
as is sufficient to meet the security cover requirements of the Lender as specified in the Schedule. In the
event either the value of the Security deteriorates and/or the Lender advances further sum(s) to the
Borrower under this Agreement such that the value of the Security provided by the Borrower under this
Agreement does not meet the security margin requirements of the Lender, then the Borrower shall deposit
with the Lender, additional security in the form of cash or such other securities as are acceptable to the
Lender, failing which the Lender may at its discretion sell, dispose of, or realise any or all of the Security
without being liable for any loss or damage or diminution in value of the Security.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `8.3 The Security, if any created/to be created by the Borrower/Security Provider in favour of the Lender shall be
released by the Lender on complete payment of the Outstanding Amounts and/or any other outstanding
dues of the Borrower/s (whether a Borrower or a Guarantor) to any of its affiliates or group companies.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);


// addFooter();

//-----------------------------new page-------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
    .text(
      `9. CO-LENDING ARRANGEMENT`,
      { align: 'left' }
    ).moveDown();
    doc.font('Helvetica')
   .text(
      `9.1 Without prejudice to anything contained in this Agreement, the Lender reserves the right to enter into a co-
      lending arrangement    `,
      { align: 'justify', indent: 45, lineGap: 5, continued: true }
   );

doc.font('Helvetica-Bold')
   .text(
      `              ("Arrangement")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      ` in pursuance to and subject to applicable guidelines/circular`,
      { align: 'justify', indent: 40, lineGap: 5 })

       
      .text(`/notification issued by the RBI, from time to time, with anyone of the banks or financial institutions of 
        its choice with which the Lender has entered into a formal agreement for co-lending of the Facility(ies)        `,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.font('Helvetica-Bold')
   .text(
      ` ("Bank or Lender 2")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      `, therefore whole or a part of the disbursed Facility amount might be taken over by the 
        concerned bank in its books as per the agreed terms of Arrangement by and between Lender and Bank.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `9.2 If Bank and Lender enters into an Arrangement with respect to Facility under this Agreement then
subsequent to Bank taking its share of Facility amount in its books, the Bank for all technical, legal and
operational purposes shall become a co-creditor of the Borrower in form of a co-lending partner of Lender.
The Borrower is aware about the possibility of Arrangement taking place between Lender and Bank. It is
clarified that subject to the terms of the Arrangement all the duties, obligations, rights, benefits and
entitlements of Lender as contained in this Agreement or other Financing Documents, in addition to Lender,
shall also inure to benefit of the Bank, and the extent, manner and form of exercising such duties,obligations,
rights, benefits and entitlements of Bank shall depend upon the understanding between the Lender and Bank
as maybe contained in the Arrangement. The Borrower also has acknowledged all the other probable
implications of such co-lending arrangement on the Facility provided herein and Borrower’s responsibilities
thereof.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   .text(
    `9.3 If the Lender enters into an Arrangement with Bank, then the right to take recovery/legal action or initiate
appropriate legal proceedings against the Borrower on the default by the Borrower under this Agreement or
other Financing Documents and all the remedies available can be exercised jointly or severally by the Lender
and/or Bank, or by the Lender on behalf of the Bank or vice-versa depending upon the terms of Arrangement.
The remedies available to the Lender and Bank under the law, this Agreement or equity shall be in addition to
each other or cumulative. The manner, form and time of exercising the rights or remedies will be as per the
discretion the Lender and/or Bank (as the case maybe).`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )

 .text(
  `9.4 The Borrower unconditionally accepts and acknowledges that it shall abide/comply by/with the instructions
which might be issued by the Lender with respect to the Facility upon Arrangement taking place between
Lender and Bank. The Borrower also unconditionally accepts and acknowledges that Lender may
change/modify any of the terms contained in Schedule I appended hereto by way of an intimation through a
letter or a notice thereof and the Borrower shall duly comply with such letter or notice without any delay or
demur.`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `9. CO-LENDING ARRANGEMENT`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `The Borrower undertakes to make payments of all the amount payable to Lender under the Financing
Documents into the Designated Account of the Lender, however, without prejudice to the aforementioned,the
Lender reserves the right to make Borrower enter into an escrow mechanism for such payments and to which
Borrower agrees to as under:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

    


// addFooter();

//-------------------new page----------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `10.1 The Borrower can be required to open, establish and maintain the Escrow Account during the entire or part
of Tenor of the Facility with the Account Bank as per terms of this Agreement and/or the Escrow Agreement
or just make the payments of Outstanding Amounts into the Escrow Account, as maybe directed by the
Lender`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.2 If opened, Escrow Account shall not be closed without the prior written approval of the Lender. All costs,
Charges, expenses, fees in connection with the Escrow Account shall be borne by the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.3 If required by the Lender, the Borrower shall deposit/transfer all Receivables in the Escrow Account at the
end of the day of receipt of the Receivables`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.4 Subject to the Applicable Law, the Lender shall be the joint signatory in the Escrow Account as per the
Escrow Agreement until the Facility is fully repaid. In the Event of Default and subject to Applicable Law, the
Lender and/or Bank shall become entitled to create charge (by way of lien or otherwise) over the bank
account of Borrower as linked with Escrow Account and utilize the proceeds thereof towards Outstanding
Amounts or any in any other manner as Lender may deem fit.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.6 Provided that nothing contained herein or under any other document/s regarding the Arrangement with the
Bank shall be applicable if the Lender does not formally enter into Arrangement with the Bank, in which case
the Borrower shall continue to discharge all its obligations contained in this Agreement or other Financing
Documents, in favour of the Lender alone and the Facility shall be deemed to be provided by a single entity,
i.e., Lender. Unless the details of Bank are specifically mentioned herein or intimated to Borrower through a
separate letter or notice, the Borrower shall always presume that the Lender has not entered into an
Arrangement regarding the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `11. CANCELLATION`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `Notwithstanding anything contrary contained in this Agreement:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `11.1 The Borrower agrees that the Lender shall at any and all time, during the currency of the Facility have an
unconditional right to terminate and/or cancel the un-utilized or un-disbursed portion of the Facility
(whether in part or in full) at its sole discretion as well as withdraw and/or recall the disbursed Facility or
any part thereof on the occurrence of any actual/potential Event of Default whereupon, forthwith all
Outstanding Amounts under the Facility shall immediately become due and payable by the Borrower to the
Lender. Provided, no notice will be given by the Lender to the Borrower, where an Event of Default has
already been declared.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).text(
  `11.2 The Borrower agrees that the Facility shall be repaid upon the happening of a Market Disruption Event and
the Lender can, at any time, at its sole and absolute discretion, terminate, cancel, withdraw or recall the
Facility or any part thereof without any liability and without any obligation to give any reasons whatsoever,
whereupon all Outstanding Amounts under the Facility shall immediately become due and payable by the
Borrower to the Lender forthwith upon demand made by the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


    // addFooter();

    //------------------------new page---------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12. BORROWER’S REPRESENTATIONS AND COVENANTS`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `12.1 Representations`,
{ align: 'left' }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `12.1.1 The Borrower hereby agrees and represents that for so long as any of the Outstanding Amounts are 
  dueand payable, the Borrower shall ensure and confirm that:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

.text(
  `(i) It is duly organised and validly existing under law and has the requisite legal power and authority to execute
this Agreement and carry out the terms, conditions and provisions hereof and the performanc e by the
Borrower of this Agreement does not and will not violate any Applicable Law, its constitutional documents,
any judgment, order, decree, writ or Governmental Approval or any agreement to which the Borrower is a
party or by which it is bound or any consents, Governmental Approvals or waivers, as the case may be, of any
Person required to give effect to and complete the transactions contemplated hereunder;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ii) The Borrower is carrying out or conducting the Business and shall continue to do so as per Applicable Law
and it will, at all times, comply with and abide by all Applicable Laws;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(iii) The execution, delivery and performance hereof have been duly authorized by all necessary Government
Approvals, permissions, corporate action, consents, etc. under the laws applicable to the Borrower, and the
individual executing this Agreement and other ancillary documents is duly authorized and duty-boundto do
so and other ancillary actions and the agreement so executed and delivered would be legally binding on the
Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) The Borrower and authorized Persons of the Borrower executing this Agreement and other ancillary
documents, confirm that all the representations and warranties made by the Borrower thereunder and all
other Financing Documents and all the information provided to the Lender are true and correct and such
authorized Persons, as the case may be, have checked the correctness of such representations and
warranties;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(v) The Borrower has not taken any action, nor have any steps been taken or legal proceedings of any manner
been initiated or threatened against or notice been received by the Borrower for its incompetency to enter
into a contract, winding-up, dissolution, administration, re-organisation, insolvency, bankruptcy,
appointment of receiver, administrator or other court officer of the Borrower or all of any of its assets,
businesses or undertakings or for the appointment of any provisional liquidator or any interim resolution
professional or resolution professional in terms of the Code;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(vi) There is no restriction, action, suit, proceeding or investigation pending and/or continuing or to the
knowledge of the Borrower threatened by or against the Borrower or the property of the Borrower or its
partners, directors, key managerial personnel, subsidiaries or group companies before any court of law,
Government Authority or other competent authority on account of any due and payable Taxes or other sums
or any other matter which may have a material effect on the affairs of the Borrower, or which may call into
question the validity, enforceability or performance by the Borrower of any or all terms of this Agreement
nor has any of the aforementioned, any knowledge of any existing ground on which any claim, investigation
or proceeding might be commenced;`,
{ align: 'justify', indent: 50, lineGap: 5 }
);



    // addFooter();

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(vii) The Borrower has obtained all Governmental Approvals for availing of the Facility, and creating the Security
and will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(viii) No actual/potential Event of Default has occurred and/or is in existence or continuing;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ix) All factual and other information provided to the Lender are true and accurate as at a date no earlier thanthe
date on which it was provided;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(x) The Borrower will promptly inform the Lender about any litigation, dispute, or any proposal by aregulatory
body to acquire the Security, or any of it;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xi) The Borrower at any time has not received any notice or intimation regarding insolvency proceedings
initiated against it or it being incompetent to enter into a contract;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xii) No proceeding is pending and/or initiated and/or threatened against the Borrower for or on account of any
Taxes or any other sums, which may be due and payable by the Borrower to the Government of India or to
any State Government or Government Agency;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xiii) Neither the Borrower nor any of its Security Assets is entitled to immunity from suit, execution, attachment
or other legal process initiated by Lender. This Agreement and the other Financing Documents constitutes,
and the exercise of its rights and performance of and compliance with its obligations in relation thereto, will
constitute, private and commercial acts done and performed for privateand commercial purposes; perfectly
binding on the Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xiv) There is no circumstance in existence, or which is likely to come into existence, which may affect the
enforceability of the Security or transferability of the Security Assets pursuant to enforcement of the
Security;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xv) The audited annual accounts of the Borrower for the year(s) as may be specified by the Lender, have been
prepared as per the applicable accounting principles/standards in force consistently applied and give, in
conjunction with the notes thereto, a true and fair view of the financial condition and position of the
Borrower during the financial year then ended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvi) There has been no material adverse change in the financial condition of the Borrower, nor has any event,
which is/may be prejudicial to the interest of the Lender and/or which is likely to materially and/or
adversely affect the Borrower/Lender to perform all or any of its obligations hereunder, taken place or in the
Borrower’s estimation, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvii) There are no charges, or liens of whatsoever nature against any of the Borrower’s/Security Provider’s
assets charged and/or agreed to be charged in favour of the Lender;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) No facts, circumstances or events, materially detrimental to the borrowing, the ability of the Borrower to
meet its obligations hereunder and/or in respect of the Facility, and/or the financial condition of the
Borrower, and/or the ability of the Lender to exercise its rights hereunder and/or under the documents
creating the Security and/or to receive due Repayment and payment of the amounts due by the Borrower
under the Facility, has occurred or, in the estimation of the Borrower, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xix) The Borrower/Security Provider has the interest, right, title or ownership over the assets comprising the
Security and such assets are free from any existing or potential encumbrances; In Event of Default underthis
Agreement, the Lender will be able to enforce such Security without any hinderance or objection fromany
person (whether individual/s or body corporate) including the Borrower or its associated.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();


    //new

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xx) Never have the name of the Borrower nor any of Borrower’s directors/associate/partner or key managerial
persons or Guarantor or Security Provider has never appeared in the willful defaulters’ list, orany other list
of defaulters published by competent authorities from time to time;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxi) The Borrower will, at all times, comply with and abide by all Applicable Laws and directions, regulations,
circulars and instructions notified or issued by the concerned regulator from time to time including but not
limited to all labour welfare related and environment protection statutes and provisions. All the
environmental authorisations/permissions required under the Environmental Protection Act 1986 and
other environmental laws in India as applicable in relation to the business and operations of the Borrower
have been obtained and maintained in full force and effect and nothing has occurred or will occur in
future, which might cause such environmental authorization/permission to be revoked, suspended or
amended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxii) The Borrower shall comply with, and shall conduct its business operations, and maintain its assets,
equipment, property, leaseholds, and other facilities in compliance with all Applicable laws relating to the
environment, labour laws and health and safety measures. The Borrower shall maintain all required
approvals relating to: (i) air emissions; (ii) discharge of surface water or ground water; (iii) noise emissions;
(iv) solid or liquid waste disposal; (v) the use, generation, storage, transportation, or disposal of toxic or
hazardous substances or wastes; and (vi) other environmental, health, or safety matters.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxiii) The Borrower shall comply with and shall conduct its business operations as per all the labour laws
applicable in India including but not limited to The Minimum Wages Act, 1948, The Factories Act, 1948, The
Industrial Disputes Act, 1947, The Child Labour (Prohibition and Regulation) Act, 1986 as amended from time
to time. Borrower also represents that it will ensure strict adherence to all the labour laws and implement the
policies as per the rules/guidelines/instructions issued by the governmental authorities therein.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxiv) The Borrower agrees and confirms that , neither the Borrower or Guarantor, and none of their subsidiaries
and, to the knowledge of senior management of each Borrower or Guarantor, none of its affiliates and none
of its respective officers, directors, brokers or agents, acting in their capacity on behalf of such Borrower or
Guarantor or such subsidiary or affiliate (i) has violated or is in violation of or shall violate any applicable
anti-money laundering law; (ii) has engaged or engages in any transaction, investment, undertaking or
activity that conceals the identity, source or destination of the proceeds from any category of offenses
designated in any applicable law; (iii) is a Restricted Party; or has received notice of or is aware of any action
or investigation against it with respect to any Sanctions by any Sanctions Authority; (iv) directly or indirectly
violated applicable anti-corruption laws or made, undertaken, offered to make, promised to make or
authorized the payment or giving of a prohibited payment; (v) used funds or other assets, or made any
promise or undertaking in such regard, for the establishment or maintenance of a secret or unrecorded fund;
or (vi) made any false or fictitious entries inany books or records of the Borrower, Guarantor or any member
of the affiliates relating to any prohibited payment with respect to the transactions contemplated by this
Agreement or the other Financing Documents.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

// addFooter();
//--------------------------------------------new page--------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `(xxv) The Borrower and/or Security Provider will not seek to claim or recover from the Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of the Lender in respect of the Security, taken
or omitted by the Lender in terms hereof and/or pursuant hereto and/or to protect any of its interests and
rights as the lender or a creditor, and the Borrower and/or Security Provider hereby expressly waives any
right to seek or make any such claim or recovery on any grounds whatsoever;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxvi) The Borrower herby acknowledges to maintain a sufficient security cover of such proportion of the amount
financed by the Lender, as specified in the Schedule hereunder during the Tenor or term of the Facility;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxvii) The Borrower herby confirms that the fair value of the assets of the Borrower exceeds all of its aggregate
liabilities whether under this Agreement or under any other agreement or any business arrangement (ii) the
Borrower has the ability to meet all of its obligations as they mature under any business arrangementor any
agreement; and (iii) the Borrower has sufficient capital to carry on its business.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxviii) The Borrower confirms that all insurances coverage, in relation to the assets of the Borrower or security
provider (other than Borrower) [ including immovable property(ies)/plant and machinery /stocks] which
have been provided to the Lender as Security, have been obtained, and are in full force and effect and it has
complied with all its obligations under the respective insurance contracts including payment of regular
insurance premium thereon, and no event or circumstance has occurred nor has there been any omission to
disclose a fact which in any such case would entitle any insurer to avoid or otherwise reduce its liability
thereunder compared to the amount provided in the relevant policy and insurance coverage provided by
such insurance;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxix) Borrower and/or Security Provider has obtained all Governmental Approvals for creating the Security and
will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxx) The execution and delivery of the security agreement and documents to be executed in pursuance hereof,
 in favour of the Lender, and the performance of the Borrower and/or Security Provider’s obligations
thereunder does not and will not (i) contravene any Applicable Law, statute or regulation or any judgment or
decree to which the Borrower and/or Security Provider and/or its assets, businesses and/or undertakings is
subject, (ii) conflict with or result in any breach of, any of the terms of or constitutedefault of any covenants,
conditions and stipulations under any existing agreement or contract or binding to which the Borrower
and/or Security Provider is a party or subject, or (iii) conflict or contravene any provision of the
memorandum and the articles of association and/or any constituting/governing documents of the Borrower
and/or Security Provider;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxxi) The Borrower will not utilize the Facility for any activity other than the Purpose as mentioned in the
Schedule hereunder and that the Security will not be charged or Encumbered in favor of any other
bank/financial institution`,
{ align: 'justify', indent: 50, lineGap: 5 }
);


    // addFooter();

    //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12.2 Covenants and Undertakings`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `A. Affirmative Covenants`,
{ align: 'left',indent: 43, }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `The Borrower hereby agrees and undertakes to the Lender and represents that for so long as any of 
 the Outstanding Amounts are due and payable, the Borrower shall:`,
{ align: 'justify', indent: 41, lineGap: 5 }
)
.text(
  `(i) Allow representative(s) and/or nominee(s) (including agent, investor, financier and any authorized
personnel of the Lender) of the Lender to enter into the premises of the Borrower in order to inspect and
audit the property, books of account and other relevant accounts, documents and records of the Borrower
provided to the Lender for the obligations of the Borrower hereunder, and the Borrower shall fully
facilitate/co-operate in this regard by making its personnel and such information/documents available during
such inspection or audit and the costs incurred thereby shall be borne by the Borrower:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(ii) Execute in favour of the Lender and/or its nominee(s) such further documents, forms and/or papers as the
Lender may in its absolute discretion require in connection with the Facility`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iii) Completely repay the Facility and Interest and costs thereon and all monies owing to Lender hereunder,
according to the terms of this Agreement and comply with any further instruction as maybe issued by the
Lender from time to time in this regard;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) Promptly notify the Lender of any change in the Borrower’s address, phone number, employer name, email
address;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(v) Provide to the Lender all the documents and information as may be requested by the Lender from time to
time in terms of the Know Your Customer (“KYC”) guidelines issued under any applicable laws or by any
regulator/government authorities and keep the same updated at all times during the validity of the Financing
Documents;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(vi) Promptly inform the Lender of any occurrence, event or incident of which it becomes aware which might
adversely affect the Borrower or affect its ability to pay any amount when due or to perform its obligations
under this Agreement and/or in respect of the Facility;
(vii) Promptly inform the Lender of any material deviation or change in any other information submitted by the
Borrower to the Lender at any time before or after entering into this Agreement;
(viii) Pay regularly all taxes, assessments, dues, duties, levies and impositions as may, from time to time, be 
payable to any Governmental Authority;
(ix) Immediately notify Lender upon becoming aware of any actual/potential Event of Default.
(x) Furnish such other documents and/or information as may be required by the Lender.
(xi) At its own cost and expense keep all immovable property(ies)/plant and machinery/stocks of the Borroweror
Security Provider (other than Borrower) which have been provided to the Lender as Security in respect of the
obligations of the Borrower under this Agreement fully insured against such risks, and for such amount(s)
and for such period and in such form(s) as the Lender may from time to time require, either in the joint names
of the Lender and the Borrower, or with the Lender named as loss payee therein, with such reputable
insurer(s) as the Lender shall approve in writing. The Borrower shall deposit with the Lender all such
insurances along with any cover notes and receipts evidencing payment of premia etc.
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

    //next
     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xii) In relation to such insurances as are required to be maintained pursuant to this Agreement, the Borrower
shall make punctual payment of all premia to be paid in relation to such insurances and shall not do or suffer
to be done any act which may invalidate such insurance.
(xiii) In the event the Borrower becomes entitled to make any claims under the above insurances, promptly 
make a claim under such insurances, and apply all monies received either in reinstatement of the property
-(ies)/plantand machinery/stocks insured or towards repayment of the Outstanding Amounts.
(xiv) If the Borrower fails to insure and/or keep insured any of the [property(ies)/plant and machinery/stocks]
provided to the Lender as Security the Lender shall, without prejudice to its rights and liabilities under this
Agreement or at law, be at liberty to insure and keep insured any of the above [property(ies)/plant and
machinery/stocks] and the Borrower shall on demand repay the Lender all fees, costs, commissions and
Charges incurred by the Lender in doing so.
(xv) Promptly inform the Lender about any occurrence, event, incident, litigation, arbitration, investigative,
regulatory or administrative proceeding/action having a material adverse effect on the condition, assets,
operations, prospects or business of the Borrower, its ability to perform and comply with its obligations in
respect of the Facility, the validity, legality or enforceability of, or the rights or remedies of the Lender under
this Agreement or any other document in relation to the Facility and the validity, legality or enforceability of
the Security or on the priority or ranking of the Security.
(xvi) Deliver to the Lender as soon as the same becomes available:
(a) but in any event within 30 (thirty) after the end of each of its financial years, its audited financial
statements for that financial year;
(b) but in any event within 30 (thirty) after the end of each half of each of its financial years, its unaudited
financial statements for that financial half year; and
(c) any other statement or statements or information pertaining to the operations of the Borrower as the
Lender may reasonably require, within such period as required by the Lender.
(xvii) Maintain adequate and proper books, accounts and records in accordance with generally
accepted/applicable accounting principles, standards and practices, consistently applied;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) Perform, on Lender’s request, acts necessary to carry out the intent of this Agreement.
(xix) Promptly inform the Lender of any distress or other process of court being taken against any of the
Borrower’s premises/assets;
(xx) Promptly inform the Lender of any change taking place in the ownership or control of the Borrower
whereby the effective beneficial ownership or control of the Borrower will materially change;
(xxi) Without prejudice to the Borrower’s obligations hereunder, it shall furnish to the Lender:
(a) within six months after the close of each of the Borrower’s fiscal year or such other period as reasonably
required by the Lender, a copy of the annual report of the Borrower, certified by a chartered accountant of
recognized standing, acceptable to the Lender together with financial statement consisting of a balance sheet
and profit and loss account as of the end of such fiscal year;
(b) any other publicly available information and statements respecting the financial condition and operations of
the Borrower as the Lender may from time to time reasonably request.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`(xxii) Comply and shall cause each other Security Provider to comply in all material respects with all applicable
anti-money laundering laws and shall not engage in any transaction, investment, undertaking or activity that
conceals the identity, source or destination of the proceeds from any category of offenses designated in any
applicable law.
(xxiii) Comply with all Conditions Precedent as stated in Clause 3.5 and the Schedule.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`B. Negative Covenants`,
{ align: 'left',indent: 45, }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) For so long as any of the Outstanding Amounts are unpaid, the Borrower shall not change in its constitution
or management without the prior written consent of the Lender and shall not:
`,
{ align: 'justify', indent: 45, lineGap: 5 }
)
.text(
  `(i) Create or permit to subsist any encumbrance or charge over all or any of the charged assets of the Borrower
or take any action which may materially impact the ability of the Borrower to pay any amount when due or
to perform its obligations under this Agreement and/or in respect of the Facility;
(ii) Effect any merger, amalgamation, reconstruction or consolidation or effect any material change in the
management/ownership of the Borrower;
(iii) Stand as surety for anybody or guarantee the repayment of any loan or overdraft or the purchase price of
assets.
(iv) Change its existing accounting methods or policies followed by it as on the date of execution of this
Agreement, during the currency of Facility unless otherwise required in terms of the prevailing Applicable
Law or change in Applicable Law;
(v) In case the Borrower is a Company;
i. Declare or pay dividends in respect of any financial year if an Event of Default has occurred or is
continuing or in case there is an asset liability mismatch in the books of the Borrower;
ii. make any amendments to the ‘objects’ clause in its memorandum or make any changes into its
constitutional documents.`,
  { align: 'justify', indent: 50, lineGap: 5 }
  )
  .text(
    `(b) For so long as any of the Outstanding Amounts are still outstanding, Borrower shall not utilise the
Facility for:`,
    { align: 'justify', indent: 45, lineGap: 5 }
    )
    .text(
      `a) Investments in any company/entity by way of shares, debentures, etc
b) Subscribing to Initial Public Offerings (IPOs) and for purchase of shares from secondary market.`,
      { align: 'justify', indent: 50, lineGap: 5 }
      ).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13. EVENT OF DEFAULT`,
{ align: 'left',indent: 45, }
).moveDown();
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13.1 Event of Default`,
{ align: 'left',indent: 45, }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)
.text(
`An event of default means the occurrence of any of the events specified in this Clause (‘Event ofDefault’)
as below:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `13.1.1 The Borrower fails to make payment of the Outstanding Amounts on the Due Dates in relation to the
Facility;`,
  { align: 'justify', indent: 50, lineGap: 5 }
  ).text(
    `13.1.2 If any event has occurred which in Lender’s opinion dilutes or jeopardizes the Security provided to the
Lender:`,
    { align: 'justify', indent: 50, lineGap: 5 }
    ).text(
      `13.1.3 Breach of any of the covenants mentioned in clause 12 on the part of the Borrower to observe or 
complywith any of the terms and conditions of this Agreement or any other Financing Document;`,
      { align: 'justify', indent: 50, lineGap: 5 }
      )





    // addFooter();

    //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.4 If there is any material breach of trust and willful default or breach of any other obligation under this
Agreement or any other Financing Documents including notice for insolvency;
13.1.5 If the Borrower defaults/threatens to default, in discharging his liability, under any other agreement or 
other writing between the Borrower and the Lender or any agreement entered into by the Borrower with the
Lender, its subsidiaries and affiliates, or under any other agreement or writing of indebtedness of the
Borrower, or under any other agreement with the other creditors or in the performance of any covenant,
term or undertaking thereunder, or any indebtedness of the Borrower not being paid when due or any
creditor of the Borrower becoming entitled to declare any indebtedness due and payable prior to the dateon
which it would otherwise have become due or any guarantee or indemnity or collateral given or other
support agreement entered into by the Borrower not being honored when due and called upon;
13.1.6 Any fraud and/or misrepresentation by the Borrower or any misleading statement made as to any
representation or warranties, or any other material statement made in this Agreement or any suppressionor
concealment of any material fact/essential information by the Borrower;
13.1.7 If any Governmental Authority has condemned, nationalized, seized or otherwise expropriated the 
assetsthat form Security or any substantial assets/property of the Borrower;
13.1.8 Any step is taken, or proceedings started for Borrower’s dissolution under the Code, or winding-up or for 
the appointment of a receiver, judicial manager, trustee or similar officer for the Borrower in any manner
whatsoever;
13.1.9 Initiation of the creditors process/any arrangement with any creditors with respect to the Borrower;
13.1.10 A receiver is appointed over the whole or any part of the property of the Borrower;
13.1.11 The Borrower ceases to carry on its Business or change its object clause of the memorandum of 
association without prior consent of the Lender;
13.1.12 If it has become unlawful for the Borrower to carry on its Business;
13.1.13 If there is any failure on the part of the Borrower to pay on any judgment or court order unless pending
appeal;
13.1.14 In case in the opinion of the Lender, there has been a material adverse change in any of the Borrower’
business or financial condition, such as:
a) if it is certified by a firm of accountants appointed by the Lender (which the Lender is entitled and hereby
authorised to so appoint at any time) that the liabilities of any of the Borrower exceed their respective assets
or that Borrower is carrying on its business at a loss;
b) sale or curtailment or closure of Borrowers’ business;
c) adverse action by any regulatory authority;
d) action by any class of stakeholders which is likely to significantly impair any of the Borrowers’ business; and
e) any other event which in the opinion of the Lender is likely to have an adverse effect on the business or
business environment of the Borrower.
13.1.15 Any material litigation or proceedings instituted against the Borrower including proceedings for crime
involving moral turpitude;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);





      





    addFooter();

     //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.16 There occurs any event or situation, (including happening of an event which in the opinion of the 
Lender is a force majeure event) such as and including but not limited to any material adverse change as 
determined solely by the Lender in the business or financial or other condition or operations or prospects
 of the Borrower, which in the sole opinion of the Lender is prejudicial to the interests of the Lender or 
is likely to materially affect the financial condition of the Borrower and/or its ability to perform all or 
any of its obligations under this Agreement and/or otherwise in respect of the Facility and to comply with 
any of the terms of this Agreement and/or for the Facility;
13.1.17 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility;
13.1.18 There is any material change in the ownership or management of the Borrower which in the sole 
opinion of Lender would prejudicially affect the interest of Lender;
13.1.19 The Borrower repudiates this Agreement or does or causes to be done any act or thing evidencing an
intention to repudiate this Agreement or non-performance of its obligation under this Agreement (whether
voluntary or involuntary);
13.1.20 Any document for creation of the Security in favour of the Lender is not in full force and effect or does 
not create in favour of the Lender, the Security which it expresses to create with the ranking and priority it is
expressed to have, including the due compliance of the requirements of security perfection including but not
limited to registration of charge with the concerned registrar of sub-assurances, within such period as
contemplated under this Agreement or otherwise allowed by the Lender, in its sole discretion and/or
 nonsubmission of any of the documents referred to in the Schedule hereto or the occurrence of any act or
circumstances which could, in the sole determination of the Lender, jeopardize, in any way, the Security;
13.1.21 If there is any deterioration or impairment of the Security or any part thereof or any decline or 
depreciation in the value or market price thereof (whether actual or reasonably anticipated), which causes 
the Security or any part thereof, in the judgment of the Lender to become unsatisfactory as to character or 
value;
13.1.22 If the property over which Security is created in favour of the Lender or any part there of is sold 
or disposed of, let out, given on leave or licence, pledged, hypothecated, transferred in any manner, charged 
in any manner whatsoever, Encumbered or otherwise alienated or if any third-party interest is created therein 
in any manner;
13.1.23 The Borrower misuses the Facility or any part thereof, or uses the Facility or any part thereof for any 
purpose other than the Purpose;
13.1.24 Any of the promoters/directors or persons holding key management positions (i.e., managing director/
chief executive officer and/or directors) of the Borrower is declared as willful defaulter in RBI List of 
willful defaulters or any other list of defaulters published by competent authorities from time to time.;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();

        //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.25 Any of the promoters and/or the directors of the Borrower are accused of, charged with, arrested or
convicted in a criminal offence involving moral turpitude, dishonesty, bribery or which otherwise impinges
on the integrity of such promoter and/or director, including any accusations, material charges and/or
convictions of any offence relating to bribery; or
13.1.26 Any force majeure event or an event not in the control of Borrower, for example, riot, war, act of terror,
earthquake, flood, fire, industrial disputes, strike or any events of similar nature occur.
13.1.27 If the Borrower fails to inform the Lender of any actual/potential Event of Default;
13.1.28 In the event there is a commencement of any action under any RBI guidelines, circulars, directions, etc. 
with respect to the Borrower or any of its subsidiaries or holding company;
13.1.29 If the Borrower fails to comply with the Applicable laws including the regulations, directions, circulars and
prudential norms notified by the concerned Regulator.
13.1.30 Any other event occurs which in the sole opinion of the Lender is likely to adversely affect the ability of 
the Borrower to perform its obligations under this Agreement.`,
{ align: 'justify', indent: 45, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2 Consequences of Events of Default`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`13.2.1 Upon the occurrence of an Event of Default as set out in clause 13.1, the Lender shall have the right 
and shall take any or all of the following actions:
(a) To cancel any outstanding commitments and/or recall the Facility;
(b) To require the Borrower to mandatorily Repay the principal amount on the Facility, along with accrued but 
unpaid interest, prepayment penalty and other costs, Charges and expenses incurred under or in connection with
this Agreement and other Financing Documents and other Outstanding Amounts;
(c) To declare all or any part of the Outstanding Amounts to be immediately (or on such dates as the Lendermay
specify) due and payable and ensure due payment thereof;
(d) To commence legal proceedings to recover such sum, the Borrower will further pay the Lender all advances,
Charges, cost and expenses, including all legal fees, incurred or paid by the Lender in exercising any right,
power or remedy conferred by this Agreement, (and/ or in the enforcement thereof) and all such amounts
shall become a part of the indebtedness secured hereunder and shall be paid to the Lender by the Borrower
immediately and without demand.
(e) To enforce the Security and/or additional security pertaining to the Facility, including but not limited to the
substitution of the Borrower/ sale of the land/ properties.
(f) Appoint a nominee director on the board of the Borrower;
(g) Exercise any other rights that Lender may have under the Financing Documents or under Applicable Law;
(h) Utilise and appropriate any amount lying or credited in the accounts of the Borrower, for
payment/repayment of Outstanding Amount, as due and payable till the date of such Event of Default;
(i) Transfer or appropriate the Security by sale or otherwise as the Lender may deem fit, to any other Person
and utilize any surplus realized from such transfer towards the fulfilment of all the obligations of Borrower
under the Financing Documents and may pay the surplus (if any) to the Borrower, after the satisfaction of
obligations of the Borrower;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2.2 Cross Collateralization`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower hereby undertakes and confirms that the Borrower shall execute any and all security
documents as may be required by the Lender to ensure that any Security(ies) furnished by the Borrower,
pursuant to any other credit facility granted by the Lender, its group companies, its affiliates to the Borrower
shall be extended as a Security(ies) towards the Facility extended under this Agreement. Further, the
Borrower also agrees to execute such security documents as may be required by the Lender to extend the
security(ies) offered in respect of this Facility towards other loan(s)/facility( ies) availed/to be availed by the
Borrower from the Lender or any of its group companies.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`14. ASSIGNMENT`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`14.1 The Borrower shall not transfer or assign any of its rights or liabilities under this Agreement to any other
person or entity without the prior written consent of the Lender.
14.2 The Borrower agrees that notwithstanding anything to the contrary contained in any document executed
under or in relation to this Agreement, the Lender shall have the right to (in full or in part) assign, transfer,
novate and/or otherwise securitize its rights or obligations under this Agreement and the other Financing
Documents and/or the Outstanding Amounts and/or enter into indemnity or other arrangements for risk
sharing, whether with or without recourse to the Lender, to one or more bank/s, financial institution/s or any
other entity including any trust or association whether located/placed in India or outside India as permitted
under the Applicable Law without any reference or notice to the Borrower. However, the Borrower shall not
claim any privity of contract with any such entity to whom the outstanding and/or the rights or obligations
under this Agreement or the other documents in relation to the Facility have been assigned/transferred
/novated/securitized or with whom the Lender has entered into indemnity or arrangements for risk sharing.
14.3 The Borrower agrees that the Lender (or any nominee of the Lender) may retain the Security Interest created
on the Security pursuant to the Security documents (or any part thereof) in trust and for the benefit of such
assignee (and upon part assignment of the Facility, in trust and for the benefit of both the Lender and such
assignee on a pari passu basis), without requiring any consent of or notice or making any reference to the
Borrower or the Sponsor. Upon any such transfer or assignment as contemplated herein, such assignee and
the Lender, as the case may be, will be entitled to take any action, including recovery and enforcement of the
Lender’ rights hereunder, in its own name without making the Lender or the assignee, as the case may be, a
party thereto.
14.4 Without prejudice to the right of the Lender to proceed against the Borrower under Applicable Law for
recovery of Outstanding Amounts, the Borrower hereby gives consent that the Lender will be entitled, subject
to Applicable Law, to recover the dues, assign the debt and/or securities and/or initiate proceedings under
the provisions of the SARFAESI Act and/or Code and/or any other Applicable Law and the Borrower agrees to
pay the Lender all cost, charges and expenses incurred in connection thereto.
14.5 The Borrower irrevocably and unconditionally confirms that it shall continue to be bound by the terms of
this Agreement and the other documents in relation to the Facility notwithstanding such transfer or
assignment by the Lender, further the Borrower shall duly comply with the instructions in respect of the
Facility as maybe issued by the Lender upon such transfer or assignment by the Lender.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


    // addFooter();


    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15. COST, CHARGES, EXPENSES AND STAMP DUTY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`15.1 The Borrower shall bear and promptly pay the following:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) an upfront non-refundable processing fee as mentioned in the Sanction Letter and statutory levies thereon,
but subject to deduction of TDS as per Applicable Law, as processing fee to the Lender for the purpose of
processing the Facility. The processing fee shall be paid at the time of disbursement of the Facility itself for
which purpose, the Borrower hereby authorizes the Lender to adjust the processing fee from the proceeds of
the disbursement. The processing fee is non-refundable fee and independent of disbursement/cancellation
of the Facility by the Borrower;
(b) all fees for the services performed by Lender, all out of pocket and travelling expenses and other costs,
Charges and expenses in any way incurred by Lender, its officers, employees or agents in connection with
the negotiation, preparation, execution, delivery, administration, waiver, modification or amendment of or
the preservation, protection or release of the rights of the Lender on exercise of any rights, remedies or
powers granted hereunder or any documents or instruments contemplated or in connection with or relating
to these presents including, without limitation, costs of investigation of title;
(c) all legal fees for drafting and stamping of this Agreement and all other Financing Documents, costs, Charges
and expenses of the external legal counsel of the Lender and all such sums incurred or paid by the Lender in
connection with and incidental to or in connection with these presents and incurred in connection with the
enforcement of any rights hereunder or under any of the Financing Documents or for payment of any
additional stamp duty or penalties in relation to the stamp duty under any Financing Documents including
any cost incurred in the assertion or defence of the rights of Lender as such for, andfor the benefit of the
Lender for the protection and preservation of whole or any part of the Security and for the demand,
realization and recovery of the Outstanding Amounts which shall be added to the Outstanding Amounts and
be secured hereby; and
(d) all stamp duty, Taxes, Charges and penalties on any Financing Documents if and when the Borrower may be
required to pay the same according to the Applicable Law.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `15.2 The Borrower agrees to indemnify and keep the Lender indemnified at all times against any and all loss,
costs, Charges, expenses and liabilities including penalties with respect to or resulting from delay or
omissions to pay any such stamp, registration and similar taxes or Charges. Such stamp, registration and
similar taxes or Charges (if not paid or reimbursed by the Borrower) shall be deemed to be the amounts
outstanding under the Facility.
15.3 The Borrower shall pay all stamp duty charges and other similar taxes payable in respect of this Agreement
and other Financing Documents and indemnify the Lender against any cost, loss or liability that the
Lender may suffer, pay or incur by reason of or in connection with all stamp duty charges and other similar
taxes payable in respect of this Agreement or any other Financing Documents
  `,
  { align: 'justify', indent: 40, lineGap: 5 }
  );


    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15.4 If the Borrower fails in defraying the costs, expenses, Charges, duties or fees referred to above as
and when required, the Lender may (but is not obligated to) make such payments on behalf of the
Borrower. All such payments made by the Lender shall be for the account of the Borrower and the
Borrower undertakes promptly on demand, to reimburse the Lender or its authorized agents,
representatives, successors and assignees for any such monies so paid, together with the interest
thereon at the rate of the Additional Interest over the Applicable Interest Rate until the date such
amounts are actually reimbursed by the Borrower. All such costs and expenses shall be part of the
‘Outstanding Amounts’ and shall be a charge upon the Security in priority to the charge
securing the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `16. INDEMNITY`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();

  doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower shall, without prejudice to any other right of Lender, indemnify and keep indemnified and hold
harmless Lender against any cost, loss, obligations, damages, penalties, actions, judgments, suits, expenses,
liability or disbursements of any kind or nature whatsoever (including legal fees, disbursements to lawyers
and out of pocket expenses), which may be imposed on, incurred by or asserted against the Lender (or its
directors, employees and agents) in any claim, litigation, proceeding or investigation instituted or conducted
by any governmental agency or instrumentality or any person or entity, and which are related directly or
indirectly to this Agreement or Financing Documents or any document executed pursuant hereto, whether
Lender is a party thereto, and shall pay and reimburse to Lender, without any dispute or demure any losses,
costs, charges or expenses which Lender, shall certify as sustained or suffered or incurred by Lender as a
result of:

(i) the occurrence of an Event of Default, or any other breach of obligations by the Borrower under, Financing
Documents and/or this Agreement or otherwise in connection with this Agreement (including any interest or
fees incurred in funding any unpaid sum) or otherwise on account of the Facility;
(ii) the Lender investigating any event which it believes is an Event of Default;

The Borrower shall within 5 (five) Business Days of demand of the above, make good such payment to Lender
accordingly. For avoidance of doubt, Lender shall not be required to risk its own funds or otherwise incur
any financial liability in the performance of any of its duties hereunder or in the exercise ofany of its rights or
powers under this Agreement. The Borrower will not seek to claim or recover from Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of Lender hereunder and/or in respect of the
Facility, taken or omitted by Lender, in terms hereof and/or pursuant hereto and/or to protect any of its
interests and rights as Lender and the Borrower hereby expressly waives any right to seek or make any such
claim or recovery on any ground whatsoever.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
)





    // addFooter();
//=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`17. TAXES`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`17.1 If the Borrower is required by Lender, or under any of the law to make any deduction or withholding towards,
for or in respect of any tax, the Borrower must:
(a) pay to the Lender any additional amount as may be necessary to ensure that the Lender receives the
full amount of the relevant payment as if that deduction or withholding had not been made; and
(b) supply promptly to the Lender evidence satisfactory to the Lender that it has accounted to the relevant
Governmental Authority for the withholding or deduction.
Provided that in case the Borrower provides a certificate, within the statutory timelines, evidencing payment
of withholding taxes in relation to any payments made to the Lender, it shall not be requiredto gross up
the payments as provided under this clause 17.1.
17.2 The Borrower shall during the Tenor bear all interest tax as may be applicable or as may be levied bya
Governmental Authority in relation to any Interest or other sum paid by the Borrower to the Lender under
the Facility. If the Lender is required to make any payment on account of any interest tax in relation to
Interest or other sum received or receivable by the Lender hereunder, then the Interest or sum payable by
the Borrower shall be increased to the extent necessary to ensure that after making such payment, the
Lender receives and retains a sum equal to the sum which it would have received and retained had no
such payment or deduction been made or required to be made.
17.3 If the Borrower is required to make any deduction for or on account of any interest tax (other than statutory
deduction of taxes at source) in relation to any Interest or other sum payable to the Lender hereunder, then,
in such case, the sum payable to the Lender shall be increased to the extent necessary to ensure that, after
making such deduction the Lender receives and retains (without any liability for such deduction) a sum
equal to the sum which it would have received and retained had no such deduction been made or required to
be made.
17.4 If there is, at any time, any incidence of any indirect taxes on the Lender directly connected and/or
attributable to the Facility, the Lender shall notify the Borrower of such incidence of tax and shall be entitled
to pass on such incidence to the Borrower. The Borrower shall make payment of such taxes without demur,
protest or cavil. Notwithstanding the above, if the Lender makes payment of any such indirect tax, the
Lender shall, be entitled to be reimbursed for the same by the Borrower.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`18. CONSTITUTED ATTORNEY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.1 The Borrower hereby agrees and appoints or cause to appoint the Lender and its officers, employees and
agents and authorised representatives to be its duly constituted attorneys for all or any of the following
purposes, upon the occurrence of an Event of Default, namely:
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(a) to sign all papers, documents agreements indentures and writings that the Borrower would be
bound to do under or in pursuance of these presents and / or the Facility and/or the Security for
and behalf of the Borrower and to attend before the Sub-Registrar of Assurancesor any other
relevant authority and admit execution thereof;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()





    // addFooter();

    //=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(b) Generally to do perform and/or execute or cause to be done performed or executed all acts deeds
matters things and documents in all matters arising under or out of or concerning or touching these
presents as the Borrower could itself do perform or execute;
(c) And for the better and more effectually doing effecting and performing the several matters and
things including as aforesaid, and to appoint from time to time or generally such other Persons,
bodies, companies, organizations, or agencies as the Lender may think fit as its substitute or
substitutes to do execute and perform all or any such acts and things as aforesaid and such
substitute or substitutes at pleasure to remove and to appoint other or others in his or their place;
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.2 The Borrower agrees that the above powers may be exercised without any prior notice to the Borrower
and further agrees to ratify and confirm all that the Lender or any substitute or substitutes appointed by the
Lender may lawfully do or cause to be done in exercise of the aforesaid powers.
18.3 The Borrower further agrees to give all assistance to the Lender and its officers authorised representatives
and other substitutes for the purpose of exercising any of the powers hereinabove set out, including
endorsing of documents, signing of papers and doing all such things as may be necessary to enable the Lender
and its officers and other substitutes to exercise all the powers hereby conferred.
18.4 The Borrower further agrees that the aforesaid powers have been granted for valuable consideration and as
such shall be irrevocable in nature till such time as any amounts remain due owing or payable under or in
respect of or in pursuance of the Facility and/or these presents.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`19. GOVERNING LAW AND JURISDICTION`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`This Agreement and all documents executed under/in relation to this Agreement shall be governed by the laws of
India. Any disputes arising under/in relation to this Agreement shall be subject to the exclusive jurisdiction
of the competent courts situated in New Delhi. However, this shall not limit the rights of the Lender to take
proceedings in any other court of competent jurisdiction of its choice.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`20. MISCELLANEOUS`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `20.1 Notices`,
  { align: 'left', indent: 40, lineGap: 5 }
  );

  doc.font('Helvetica')
    .fontSize(9)


.text(
`Any notices to be provided by each Party shall be in writing, signed by an authorised officer, and shall be sent
by post, letter or email to such address, email id or number as mentioned below or to such other contact
details as may be notified by the Parties from time to time. Notices shall be deemed to have beendelivered on
the earlier of the actual date of delivery or 7 (seven) Business Days following dispatch.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Borrower:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


  doc.font('Helvetica')
    .fontSize(9)


.text(
`As mentioned in the Schedule
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Lender:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


doc.font('Helvetica')
.fontSize(9)
.text(
   `Address: 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI 110001`,
   { align: 'justify', indent: 40, lineGap: 5 }
);

doc.text(
`Email: `,
{ continued: true, indent: 40 }
)
.font('Helvetica-Bold')
.fillColor('blue')
.text(
   `support@growmoneycapital.com`,
   {
      link: 'mailto:support@growmoneycapital.com', // This makes the email clickable
      underline: true, // Optional: to visually indicate it's a link
   }
)
.fillColor('black'); // Reset the color to black for further text
// .moveDown();

    // addFooter();


//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);



doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`(The Borrower agrees that all instructions and/or correspondence sent by the Borrower to the Lender
are sent at the Borrower’s risk, and the Lender does not assume any responsibility for anyinaccuracy,
interruption, error, delay or failure in transmission or delivery whether sent by post, telegraph,
cable, telex or any other form of written or electronic communication.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.2 Any provision of this Agreement, which is prohibited or unenforceable in any jurisdiction shall, as to such
jurisdiction, be ineffective only to the extent of prohibition or unenforceability and it shall not invalidate the
remaining provisions of this Agreement or affect such provision in any other jurisdiction.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.3 Disclosure`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.3.1 The Borrower hereby agrees as a pre-condition of the Facility given to the Borrower by the Lender that, in
case the Borrower commits default in the Repayment of the Facility in accordance with or in the paymentof
Interest thereon on date(s) specified in Repayment Schedule , the Lender and/or the Reserve Bank of India
will have an unqualified right to disclose or publish the Borrower’s name as defaulter in such manner and
through such medium as the Lender or Reserve Bank of India in their absolute discretion may think fit.
Accordingly, the Lender shall have the right to furnish and publish the name of the Borroweras defaulter to
the public at large and Reserve Bank of India or other regulatory authority. Notwithstanding above the
Borrower hereby accept and confirm that as a pre-condition to the grant of the credit facility by the Lender
to the Borrower including, the Facility the Lender, requires consent of the Borrower to make certain
disclosures in relation to the Borrower including information and data relating to the Borrower and any
credit facility availed of or to be availed of by the Borrower, obligations assumed or to be assumed by the
Borrower in relation thereto and default, if any, committed by the Borrower in discharge thereof.
Accordingly, the Borrower hereby agrees and gives consent to the disclosure by the Lender of all or any such
information and data relating to the Borrower:
(a) in relation to any credit facilities including, the Facility availed of or to be availed of by the Borrower from
the Lender and the Borrower’s obligations in any credit facility granted/to be granted, by the Lender, for the
purposes of credit reference checks, verification, etc; and
(b) in case of default, if any, committed by the Borrower in discharge of any of his obligations, or any other
information that the Lender may deem appropriate and necessary, to disclose and furnish to RBI, any Credit
Information Agency and/or any other agency authorized in this behalf by the RBI or any other regulatory
authority.

20.3.2 The Borrower undertakes and declares that the information and data furnished by the Borrower to the
Lender is/shall be true and correct and any Credit Information Agency and/or any other authorized agency
may use, process the said information and data disclosed by the Lender as deemed fit by them and may
furnish for consideration such processed information/data/products to banks/financial institutions and
other entities as maybe specified by RBI.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// addFooter();

//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)
.text(`20.3.3 The Borrower and the Guarantor hereby give specific consent to the Lender for disclosing/submitting the
‘financial information’ as defined in Section 3 (13) of the Code read with the relevant regulations/ rules
framed under the Code, as amended from time to time in respect of the Facility availed from the Lender, from
time to time, to any ‘Information Utility’ (“IU”) as defined in Section 3 (21) of the Code, in accordance with the
relevant regulations framed under the Code, and directions issued by RBI from time to time and hereby
specifically agree to promptly authenticate the financial information submitted by the Lenders, as and when
requested by the concerned IU.

20.3.4 The Borrower hereby consents to the Lender, its officers and agents disclosing information relating to the
Borrower and its current bank account or Escrow Account, account(s) and/or dealing relationship(s) with
the Lender, including but not limited to details of its facilities, any security taken, transactions undertaken
and balances and positions with the Lender, to:

(i) the head office of the Lender, any of its subsidiaries or subsidiaries of its holding company, affiliates,
representative and branch offices in any jurisdiction (together with the Lender, the “Permitted Parties”);
(ii) professional advisers and service providers of the Permitted Parties who are under a duty of
confidentiality to the Permitted Parties;
(iii) any actual or potential assignee, novatee, transferee participant or sub-participant in relation to any of the
Lender’s rights and/or obligations under any agreement (or any agent or adviser of any of the foregoing);
(iv) any rating agency, insurer or insurance broker of, or direct or indirect provider of credit protection to any
Permitted Party; and
(v) any court or tribunal or regulatory, supervisory, governmental or quasi-Governmental Authority with
jurisdiction over the Permitted Parties
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.4 Lender’s records to be accepted by Borrower`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The records maintained by the Lender in its ordinary course of business shall be the final proof for the due
amounts from the Borrower in respect of the Facility under this Agreement. A certificate in writing signed by
an officer of the Lender or a system generated electronic certificate stating the Outstanding Amount from the
Borrower in respect of the Facility at any particular time shall be conclusive evidence against the Borrower
in respect of payments due from the Borrower in respect of the Facility`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.5 Engagement of third parties`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower expressly recognizes and accepts that the Lender shall, without prejudice to its right to
perform such activities itself or through its officers or employees, be entitled and has full power and
authority to appoint one or more third parties as Lender may select and to delegate to such third party all or
any of its functions, rights and powers under this Agreement relating to administration of Facility including
right and authority to collect and receive on behalf of the Lender from the Borrower any payments and other
amounts due by the Borrower under this Agreement and to perform and execute all lawful acts, deeds
matters and things connected therewith and incidental thereto. For the aforesaid purpose, Lender shall be
entitled to disclose to any such third parties all necessary and relevant information pertaining to the
`,
{ align: 'justify', indent: 40, lineGap: 5 }
);






    // addFooter();

    //=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)


.text(
`Borrower and the Facility and the Borrower hereby consents to such disclosure by the Lender.
Notwithstanding above, in the event of Borrower committing any act of default and/or occurrence of any
Event of Default, the Borrower expressly accepts and authorizes Lender to contact any third parties as
Lender may select and disclose all necessary and relevant information pertaining to the Borrower and the
Facility.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.6 Waiver`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The Borrower confirms that no delay of the Lender in exercising or not exercising any right, power or
remedy accruing/available to the Lender on Borrower’s default or otherwise under this Agreement or any
other Financing Documents shall impair or prejudice such right, power or remedy or shall be construed asits
waiver or acquiescence. The Borrower further confirms that any single or partial exercise of any right, power
or remedy by the Lender shall not preclude further exercise thereof. Every right and remedy of the Lender
shall continue in full force until the Lender specifically waives it by a written instrument`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.7 Liens; Right of Set Off`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The rights, powers and remedies given to the Lender by this Agreement shall be in addition to all rights
powers and remedies given to the Lender by virtue of any other Security, statute, or rule of law or equity. The
Lender may exercise a banker’s lien or right of set- off with respect to any obligation of the Borrower as if the
obligation were unsecured and shall have a lien on all property or securities of the Borrower in the Lender’s
possession or custody whether for safe-keeping or otherwise. Without prejudice to what is stated
hereinabove, the Borrower hereby expressly agrees and confirms that in the event of the Borrower failing to
completely pay/repay the Outstanding Amounts under the Facility, in addition to any general or specific lien
to which the Lender may be entitled by Applicable Law, the Lender shall, without prejudice to any of its
specific rights under this Agreement, be at liberty to apply any other money or amounts standingto the credit
of the Borrower in any account with the Lender in or towards repayment of the Outstanding Amounts under
the Facility, without notice to the Borrower, on happening of any Event of Default or if upon demand by the
Lender the said Dues are not repaid within the prescribed time. In case of any deficit, the deficit amount may
be recovered by the Lender from the Borrower. The joint account holder/s to such monies, securities,
deposits and other assets is/are aware of, and have no objection to (a) the Facility applied for, (b) the Facility
terms, (c) using such monies from the joint accounts for paying/Repaying the Facility and all other amounts
due to the Lender, and (d) the Lender’s rights of setoff in the event of their default of the Facility terms: It
shall be the Borrower’s sole responsibility and liability to settle all disputes/objections with such joint
account holders, if so required, and the Lender shallbe well within its rights to exercise the right of set off
against any money lying in any account/deposit/bond/other assets held singly or jointly, for settlement of
dues.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.8 Sanction Letter`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The terms of the Sanction Letter shall form part of this Agreement and shall be in addition to and be read in
conjunction with the terms of this Agreement. If there are any inconsistencies between the terms of the
Sanction Letter and this Agreement then, the terms of Sanction Letter shall prevail to the extent of
inconsistency.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.9 Entire Agreement`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
// about the subject matter, comprised within the Financing Documents and shall replace all previous
// agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
// representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
// the Financing Documents.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();






    // addFooter();

    //-------------------------------new page---------------------------
    doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.9 Entire Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
about the subject matter, comprised within the Financing Documents and shall replace all previous
agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
the Financing Documents.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.10 Survival ofRights`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The provisions of Clause 16 (Indemnity), Clause 20.1 (Notices), Clause 20.15 (Dispute Resolution) Clause 19
(Governing Law and Jurisdiction) and this Clause 20.10 (Survival of Rights) and other clauses which by their
nature are intended to survive, shall survive termination or expiry of this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.11 Benefits:`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The terms and provisions of this Agreement shall be binding upon, and the benefits & obligations hereof shall
inure or pass on to the Lender's successors and assigns, and Borrower's successors and permitted assigns (if
appointed after permission of Lender, and as the case maybe), who in absence of Borrower will be required
to fulfil each and every requirement or obligation as maybe required by Lender from time to time or as
detailed under this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.12 Liability of Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`In the event of there being more than one Borrower (Co-Borrower), the liability of each Co-Borrower
hereunder shall be co-extensive as that of Borrower’s liability. Each of the Co-Borrowers shall be having same
and equal extent of liabilities as that of other Borrower under this Agreement and in the Event of Default, the
liabilities of all the Borrowers and Co-Borrower shall be cumulative towards the Lender and the Lender at its
discretion may proceed against any or all of the Borrower or Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.13 Acceptance`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees and acknowledges that this entire Agreement, duly filled in
schedules/annexures/letters/undertakings hereto, Sanction Letter and other documents relating to Facility
have been explained to the Borrower in the language understood by it, and it has understood the entire
meaning of the aforementioned and shall be bound by all the conditions mentioned therein. Any act of
acceptance of the terms contained herein or token thereof (including acceptance through facsimile or
electronic transmission) by the Borrower (in a manner acceptable to the Lender) may be considered as due
and proper execution of this Agreement on the part of the Borrower.

20.14 The Borrower hereby represents and warrants the genuineness of the signatures of the authorised
signatories of the Borrower, or each of the Borrowers in the event of there being more than one Borrower,
as the case may be.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.15 Dispute Resolution`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
// after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
// used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
// Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
// the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
// arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
// Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
// shall be conducted preferably through online means or otherwise through conventional means in English
// language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
// conducted through conventional means) shall be at Delhi.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();

// addFooter();

  //-------------------------------new page---------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

  doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.15 Dispute Resolution`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

  doc.font('Helvetica')
.fontSize(9)


.text(
`All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
shall be conducted preferably through online means or otherwise through conventional means in English
language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
conducted through conventional means) shall be at Delhi.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
  doc.font('Helvetica-Bold')
  .fontSize(9)
  
  
  .text(
  `20.16 Counterparts`,
  { align: 'justify', indent: 40, lineGap: 5 }
  );
  
  doc.font('Helvetica')
  .fontSize(9)
  .text(`The Agreement may be executed in any number of counterparts, each of which (without variation) shall
constitute an original and all of which together shall constitute one and the same instrument. Delivery of an
executed counterpart of the signature page to this Agreement by facsimile shall be as effective as delivery of
a manually executed counterpart of this Agreement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();
  


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.17 Status of the Loan Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees that its obligations hereunder are absolute and unconditional and shall not be affected
by any circumstance (including any right of set-off or counterclaim), which otherwise might, prior to the
satisfaction of those obligations, operate to release or constitute a discharge or other-wise exonerate the
Borrower from its obligations hereunder or affect such obligations, with the intent that the Borrower’s
obligations under this Agreement shall remain at all times in full force and effect until payment of the
amounts due under this Agreement have been made in full and all obligations of the Borrower under this
Agreement have been fully discharged to the satisfaction of the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();







    // addFooter();




//-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();


  
    // Title styling for OFFER LETTER in uppercase and underlined
    doc.moveDown(6);
    const yPosition = doc.y; // Get the current y position
  
    doc
      .fontSize(7)
      .font(fontBold)
      .text("Schedule", { align: "center" })
      .moveDown(1)
      .text("(Forming part & parcel of Agreement)", { align: "center" })
      .moveDown(1)
      .text(` DATED :${allPerameters.agreementdate} \n\n Place of Agreement : Indore \n\n Location of the Lender’s Office/Branch : Indore` , { align: "left" })
    
    doc.moveDown(4);

    doc
    .fontSize(9)
    .font('Helvetica-Bold')
    .text("Borrower(s) Details", { align: "left" })
    .moveDown(0.5)
    // Add a function to draw black table borders
    function drawTable(tableData) {
        const startX = 50;
        let startY = doc.y + 10;
        const columnWidths = [500]; // Total width for the table
        const keyWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for field names
        const valueWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for values
        
        // Function to draw a block for borrower details
        function drawBorrowerBlock(borrowerData) {
            borrowerData.forEach((row, rowIndex) => {
                let valueRowHeight = 20; // Set height for each row
    
                // Check if it's a special row like "Borrower/Security Provider Details" or "Guarantor"
                if (row.field1 === "Borrower/Security Provider Details" || row.field1 === "Guarantor") {
                    // Draw a full-width row (horizontal lines only)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth + valueWidth, valueRowHeight) // Full-width
                        .strokeColor("black")
                        .lineWidth(0.5)
                        .moveTo(startX, startY) // Top horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw text across the full width
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth + valueWidth // Full width for text
                        });
                } else {
                    // Draw field background (for regular fields like 'Name', 'Residence Address', etc.)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX, startY) // Top horizontal line for field name
                        .lineTo(startX + keyWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line for field name
                        .lineTo(startX + keyWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw field name (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth
                        });
    
                    // Draw value background (half-width for value)
                    doc.fillColor("#ffffff")
                        .rect(startX + keyWidth, startY, valueWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX + keyWidth, startY) // Top horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX + keyWidth, startY + valueRowHeight) // Bottom horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw value text (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.value1 || "", startX + keyWidth + 5, startY + 5, {
                            baseline: "hanging",
                            width: valueWidth
                        });
                }
    
                // Move to next row
                startY += valueRowHeight;
            });
    
            // Add spacing after each borrower block
            startY += 10;
        }
    
        // Filter and group data for each borrower block
        const borrowerBlocks = [];
        let currentBlock = [];
    
        tableData.forEach(row => {
            if (row.field1.includes("Borrower/Security Provider Details") || row.field1 === "Guarantor") {
                if (currentBlock.length > 0) {
                    borrowerBlocks.push(currentBlock);
                }
                currentBlock = [];
            }
            currentBlock.push(row);
        });
    
        if (currentBlock.length > 0) {
            borrowerBlocks.push(currentBlock);
        }
    
        // Draw each borrower block
        borrowerBlocks.forEach(borrowerData => {
            drawBorrowerBlock(borrowerData);
        });
    }
    
    const loanTableData = [
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.customerName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.address}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.registeredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.corporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.emailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.constitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.identityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.typeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.securityProvider}` },
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.coApplicantName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddress}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.coEmailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.coConstitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProvider}` },
    ];
    
    // Call the drawTable function to generate the table
    drawTable(loanTableData);
    // doc.moveDown(2);
  
    // addFooter();
    
   
  //---------------------------------------- new page 2--------------------------------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  // doc.moveDown(7);
  
  const secondPageTable = [
    { field1: "Borrower/Security Provider Details" },
    { field1: "a) Name", value1: `${allPerameters.coApplicantNameTwo}` },
    { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddressTwo}` },
    { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddressTwo}` },
    { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddressTwo}` },
    { field1: "e) Email Address", value1: `${allPerameters.coEmailAddressTwo}` },
    { field1: "f) Constitution", value1: `${allPerameters.coConstitutionTwo}` },
    { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumberTwo}` },
    { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrowerTwo}` },
    { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProviderTwo}` },
   
    // { field1: "Guarantor" },
    // { field1: "a) Name", value1: `${allPerameters.guarantorName}` },
    // { field1: "b) Residence Address", value1: `${allPerameters.guarantorAddress}` },
    // { field1: "c) Registered Office Address", value1: `${allPerameters.guarantorRegisteredOfficeAddress}` },
    // { field1: "d) Corporate Office Address", value1: `${allPerameters.guarantorCorporateOfficeAddress}` },
    // { field1: "e) Email Address", value1: `${allPerameters.guarantorEmailAddress}` },
    // { field1: "f) Constitution", value1: `${allPerameters.guarantorConstitution}` },
    // { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.guarantorIdentityNumber}` },
    // { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.guarantorTypeOfBorrower}` },
    // { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.guarantorSecurityProvider}` },
  ];
  drawTable(secondPageTable);
  doc.moveDown(2);
  function newTable(tableData) {
    const startX = 50;
    let startY = doc.y + 10;
    const columnWidths = [500];

    const keyWidth = Math.round((columnWidths[0] * 1) / 2);
    const valueWidth = Math.round((columnWidths[0] * 1) / 2);

    tableData.forEach((row, rowIndex) => {
        doc.lineWidth(0.5);

        const valueText = row.value1 || "";
        const isFullWidthRow = row.field1 === "Details of the Loan/Credit Facility" || row.field1.startsWith("Payment Instrument(s)");
        
        // Calculate row height to accommodate multiline text
        let rowWidth = isFullWidthRow ? columnWidths[0] : valueWidth;

        // Set specific height for "Payment Instrument(s)" row
        let rowHeight;
        if (row.field1.startsWith("Payment Instrument(s)")) {
            // Increase height for this specific row
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 60; // Increase height as needed
        } else {
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 10; // Normal height for other rows
        }
        rowHeight = Math.max(rowHeight, 20); // Set a minimum height if needed

        // Draw background for the row
        doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX, startY, columnWidths[0], rowHeight)
            .stroke("black")
            .fill();

        if (isFullWidthRow) {
            // Render full-width text with wrapping
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1 + "\n" + valueText, startX + 5, startY + 8, {
                    baseline: "top",
                    width: columnWidths[0] - 10, // Slight padding to avoid overflow
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        } else {
            // Draw first column cell
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 8, {
                    baseline: "top",
                    width: keyWidth,
                    align: 'left'
                });

            // Draw second column cell with wrapping
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(valueText, startX + keyWidth + 5, startY + 8, {
                    baseline: "top",
                    width: valueWidth - 10, // Prevent overflow by setting width constraint
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        }

        // Move to the next row position
        startY += rowHeight;
    });
}
  
  const details = [
    { field1: "Purpose of the Loan/Credit Facility", value1: `WORKING CAPITAL` },
    { field1: "Details of the Loan/Credit Facility", value1: ``},
    { field1: "Loan Amount/Credit Facility", value1: `Rs.${allPerameters.loanAmount}` },
    { field1: "Security Details (Details of the Security as per Sanction Letter such as Property Address/Equipment details/Intangible Collateral, etc.)", value1:`${allPerameters.securityDetails}` },
    { field1: "Security Cover", value1: `${allPerameters.securityCover}` },
    { field1: "Tenor or Tenure of the Loan/Credit Facility", value1: `${allPerameters.tenor} Months` },
    { field1: "Rate of Interest", value1: `FLOATING RATE OF INTEREST \n · Grow Money Reference Rate (URR): ${allPerameters.benchmarkInterest}% p.a (per cent per annum)\n · Floating Rate of Interest(p.a.): URR + ${allPerameters.SpreadInterestRate}%=${allPerameters.Roi}% p.a. (per cent per annum) Review Frequency: Monthly` },
    { field1: "Sanction Letter", value1: `${allPerameters.sanctionLetterDate}` },
    { field1: "Application Fees", value1: `2% + 18% GST` },
    { field1: "Processing Fees", value1: `2% + 18% GST` },
    { field1: "CERSAI Charges", value1: `AS APPLICABLE` },
    { field1: "Late Payment Interest/Additional Interest", value1: `___% p.m. (________ per cent per month) or _____ % p.a. (_________ per cent per annum) on the Instalment overdue from the date of overdue upto the date of payment` },
    { field1: "Repayment Bank A/c Details", value1: `${allPerameters.repaymentBank}` },
    { field1: "Details of Receivables", value1: `${allPerameters.detailsOfReceivables}`, },
    { field1: "Pre-payment/Foreclosure of the Facility", value1:  `· 6% of Principal outstanding for loan foreclosed within 12 months of loan sanction \n · 4% of Principal outstanding for loan foreclosed after 12 months of loan sanction \n regulatory requirements and directions prescribed by Reserve Bank of India from time to time.` },
    { field1: "Payment Instrument(s)\n Bank Account on which the Repayment Cheques are drawn and/or EDI (Electronic Debit Instrument)/NACH are made and details thereof\n · The Repayment Cheque/NACH can be used by the FIN COOPERS for realization of delayed payment charges/Default Interest also and in such events additional cheque(s)/NACH shall be furnished to cover the balance Repayment Amount.(“Account”)\n · Repayment Cheques should be in favour of “FIN COOPERS Securities Pvt Ltd”", value1: `` },
  ];
  
  newTable(details);
  // addFooter();
  
//   // ------------------------------------- new page 3-------------------------------------------------
  
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

// function newTable(tableData) {
//     const startX = 50;
//     let startY = doc.y + 10;
//     const columnWidths = [500];

//     const keyWidth = Math.round((columnWidths[0] * 1) / 2);
//     const valueWidth = Math.round((columnWidths[0] * 1) / 2);

//     tableData.forEach((row, rowIndex) => {
//         doc.lineWidth(0.5);

//         const valueText = row.value1 || "";
//         const isFullWidthRow = row.field1 === "Details of the Loan/Credit Facility" || row.field1.startsWith("Payment Instrument(s)");
        
//         // Calculate row height to accommodate multiline text
//         let rowWidth = isFullWidthRow ? columnWidths[0] : valueWidth;

//         // Set specific height for "Payment Instrument(s)" row
//         let rowHeight;
//         if (row.field1.startsWith("Payment Instrument(s)")) {
//             // Increase height for this specific row
//             rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 60; // Increase height as needed
//         } else {
//             rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 10; // Normal height for other rows
//         }
//         rowHeight = Math.max(rowHeight, 20); // Set a minimum height if needed

//         // Draw background for the row
//         doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX, startY, columnWidths[0], rowHeight)
//             .stroke("black")
//             .fill();

//         if (isFullWidthRow) {
//             // Render full-width text with wrapping
//             doc.font(font)
//                 .fillColor("black")
//                 .fontSize(7.2)
//                 .text(row.field1 + "\n" + valueText, startX + 5, startY + 8, {
//                     baseline: "top",
//                     width: columnWidths[0] - 10, // Slight padding to avoid overflow
//                     align: 'left',
//                     height: rowHeight - 10, // Ensure the text wraps within the row height
//                 });
//         } else {
//             // Draw first column cell
//             doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                 .rect(startX, startY, keyWidth, rowHeight)
//                 .stroke("black")
//                 .fill();
//             doc.font(font)
//                 .fillColor("black")
//                 .fontSize(7.2)
//                 .text(row.field1, startX + 5, startY + 8, {
//                     baseline: "top",
//                     width: keyWidth,
//                     align: 'left'
//                 });

//             // Draw second column cell with wrapping
//             doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                 .rect(startX + keyWidth, startY, valueWidth, rowHeight)
//                 .stroke("black")
//                 .fill();
//             doc.font(font)
//                 .fillColor("black")
//                 .fontSize(7.2)
//                 .text(valueText, startX + keyWidth + 5, startY + 8, {
//                     baseline: "top",
//                     width: valueWidth - 10, // Prevent overflow by setting width constraint
//                     align: 'left',
//                     height: rowHeight - 10, // Ensure the text wraps within the row height
//                 });
//         }

//         // Move to the next row position
//         startY += rowHeight;
//     });
// }
  
//   const details = [
//     { field1: "Purpose of the Loan/Credit Facility", value1: `WORKING CAPITAL` },
//     { field1: "Details of the Loan/Credit Facility", value1: ``},
//     { field1: "Loan Amount/Credit Facility", value1: `Rs.${allPerameters.loanAmount}` },
//     { field1: "Security Details (Details of the Security as per Sanction Letter such as Property Address/Equipment details/Intangible Collateral, etc.)", value1:`${allPerameters.securityDetails}` },
//     { field1: "Security Cover", value1: `${allPerameters.securityCover}` },
//     { field1: "Tenor or Tenure of the Loan/Credit Facility", value1: `${allPerameters.tenor} Months` },
//     { field1: "Rate of Interest", value1: `FLOATING RATE OF INTEREST \n · FIN COOPERS Reference Rate (URR): ${allPerameters.benchmarkInterest}% p.a (per cent per annum)\n · Floating Rate of Interest(p.a.): URR + ${allPerameters.SpreadInterestRate}%=${allPerameters.Roi}% p.a. (per cent per annum) Review Frequency: Monthly` },
//     { field1: "Sanction Letter", value1: `${allPerameters.sanctionLetterDate}` },
//     { field1: "Application Fees", value1: `2% + 18% GST` },
//     { field1: "Processing Fees", value1: `2% + 18% GST` },
//     { field1: "CERSAI Charges", value1: `AS APPLICABLE` },
//     { field1: "Late Payment Interest/Additional Interest", value1: `___% p.m. (________ per cent per month) or _____ % p.a. (_________ per cent per annum) on the Instalment overdue from the date of overdue upto the date of payment` },
//     { field1: "Repayment Bank A/c Details", value1: `${allPerameters.repaymentBank}` },
//     { field1: "Details of Receivables", value1: `${allPerameters.detailsOfReceivables}`, },
//     { field1: "Pre-payment/Foreclosure of the Facility", value1:  `· 6% of Principal outstanding for loan foreclosed within 12 months of loan sanction \n · 4% of Principal outstanding for loan foreclosed after 12 months of loan sanction \n regulatory requirements and directions prescribed by Reserve Bank of India from time to time.` },
//     { field1: "Payment Instrument(s)\n Bank Account on which the Repayment Cheques are drawn and/or EDI (Electronic Debit Instrument)/NACH are made and details thereof\n · The Repayment Cheque/NACH can be used by the FIN COOPERS for realization of delayed payment charges/Default Interest also and in such events additional cheque(s)/NACH shall be furnished to cover the balance Repayment Amount.(“Account”)\n · Repayment Cheques should be in favour of “FIN COOPERS Securities Pvt Ltd”", value1: `` },
//   ];
  
//   newTable(details);
  
  // doc.moveDown(2)
  
  doc
  .fontSize(8)
  .font('Helvetica')
  .text("Repayment details:", { align: "left" })
  .moveDown(1)
  

function repaymentFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  // Function to draw a checkbox
  const drawCheckbox = (doc, x, y, size, isChecked) => {
      doc
          .rect(x, y, size, size) // Draw checkbox square
          .stroke();
      if (isChecked) {
          doc
              .moveTo(x, y + size / 2)
              .lineTo(x + size / 3, y + size - 2)
              .lineTo(x + size - 2, y + 2)
              .strokeColor('black')
              .stroke();
      }
  };

  const validColumns = Object.keys(tableData[0]).filter((key) => {
      return tableData.some(row => row[key] !== ""); // Exclude blank columns
  });
  const columnCount = validColumns.length;

  const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // Dynamic column widths
  const fixedRowHeight = 20;

  // Render the first column
  const firstColumnValue = tableData[0][validColumns[0]];
  doc.fillColor("#f5f5f5")
      .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length)
      .stroke("black")
      .fill();

  doc.font(font)
      .fillColor("black")
      .fontSize(7.2)
      .text(firstColumnValue, startX + 5, startY + 5, {
          width: columnWidths[0] - 10,
          align: 'left',
      });

  // Render other rows
  tableData.forEach((row, rowIndex) => {
      doc.lineWidth(0.5);

      doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], fixedRowHeight)
          .stroke("black")
          .fill();

      validColumns.slice(1).forEach((columnKey, colIndex) => {
          const value = row[columnKey];
          const cellX = startX + columnWidths.slice(0, colIndex + 1).reduce((acc, width) => acc + width, 0);
          const cellWidth = columnWidths[colIndex + 1];

          // Draw cell background
          doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
              .rect(cellX, startY, cellWidth, fixedRowHeight)
              .stroke("black")
              .fill();

          if (value === "check") {
              // Draw checkbox if the value is "check"
              drawCheckbox(doc, cellX + 5, startY + 5, 10, true);
          } else {
              // Handle regular text
              const lines = (value || "").split('\n');
              lines.forEach((line, lineIndex) => {
                  doc.font(font)
                      .fillColor("black")
                      .fontSize(7.2)
                      .text(line, cellX + 5, startY + 5 + (lineIndex * 10), {
                          baseline: "hanging",
                          width: cellWidth - 10,
                      });
              });
          }
      });

      startY += fixedRowHeight;
  });
}


const repaymentTable = [
    { field1: "Repayment Options", filed2: "EMI", field3: "Step Up", field4: "Step Down", field5: "Structured", field6: "Balloon", field7: "Bullet" },
    { field1: "", filed2:"check", field3: ``, field4: ``, field5: ``, field6: ``, field7: `` },
];

repaymentFunction(repaymentTable);



// Call the function to draw the table

doc.moveDown(0.8)
const repaymentFrequencyTable = [
    { field1: "Repayment Frequency", filed2: "Monthly", field3: "Bi-monthly", field4: "Quarterly", field5: "Half Yearly", field6: "Yearly",},
    { field1: "", filed2: "check", field3: ``, field4: ``, field5: ``, field6: ``,  },
];

repaymentFunction(repaymentFrequencyTable);
doc.moveDown(0.5);

const repaymentDateTable = [
  { field1: "Repayment Cycle date", filed2: "3rd of the month ", field3: "5th of the month", field4: "10th of the month" },
  { field1: "", filed2: ``, field3: ``, field4: "check",  },
];

repaymentFunction(repaymentDateTable);
doc.moveDown(0.5);
function intrestTableFunction(tableData) {
  // Add Table Header
  const startX = 50;
  let startY = doc.y + 10;
  const totalWidth = 500; // Total column width
  const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
  const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

  tableData.forEach((row, rowIndex) => {
      // Set default row height
      let rowHeight = 15;

      // Calculate the height of the text for field1 and value1
      const field1TextHeight = doc
          .font(font)
          .fontSize(7.2)
          .heightOfString(row.field1, { width: keyWidth });

      let value1TextHeight = 0;
      if (row.value1) {
          value1TextHeight = doc
              .font(font)
              .fontSize(7.2)
              .heightOfString(row.value1, { width: valueWidth });
      }

      // Determine the maximum height between field1 and value1 to set row height
      rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

      // Alternate row background color
      doc.lineWidth(0.5);
      doc
          .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX, startY, keyWidth, rowHeight)
          .stroke("black")
          .fill();

      // Draw text in field1 cell
      doc
          .font(font)
          .fillColor("black")
          .fontSize(7.2)
          .text(row.field1, startX + 5, startY + 5, {
              baseline: "hanging",
              width: keyWidth,
          });

      // Draw the second column, even if value1 is absent
      doc
          .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + keyWidth, startY, valueWidth, rowHeight)
          .stroke()
          .fill();

      // Draw the key-value pair for value1 or leave it empty
      const keyValueText = row.value1 ? `${row.value1}` : ""; // Show empty text if no value
      doc
          .font(font)
          .fillColor("black")
          .fontSize(7.2)
          .text(keyValueText, startX + keyWidth + 5, startY + 5, {
              baseline: "hanging",
              width: valueWidth,
          });

      // Draw vertical line between the columns
      doc.lineWidth(0.5);
      doc.strokeColor("black");
      doc.moveTo(startX + keyWidth, startY);
      doc.lineTo(startX + keyWidth, startY + rowHeight);
      doc.stroke();

      // Move to the next row position
      startY += rowHeight;
  });
}


const intrestData = [
{ field1: "Pre-Instalment Interest Date(s)",value1: `${allPerameters.preInstalmentInterestDate}` },
{ field1: "Date when first instalment is due", value1: `10TH OF EVERY MONTH` },
{ field1: "Total No. of Instalments", value1: `${allPerameters.tenor} Months` },
{ field1: "Amount of each instalment", value1: `Rs.${allPerameters.amountOfEachInstalment}` },
{ field1: "Exact dates of repayment", value1: `The instalments shall be due on the repayment cycle date as mentioned above basis the frequency agreed. \n\n The repayment dates are subject to change depending on the Disbursement of the Facility. Exact dates of repayment shall be communicated through a detailed repayment schedule which shall be sent along with a welcome letter` },
];

intrestTableFunction(intrestData);
doc.moveDown(-0.5);

function repaymentAmountFunction(tableData) {
  // Check if tableData is not empty
  if (!Array.isArray(tableData) || tableData.length === 0 || typeof tableData[0] !== 'object') {
      console.error("Invalid table data");
      return;
  }

  const fixedRowHeight = 20; // Define fixed row height

  // Add Table Header
  const startX = 50;
  let startY = doc.y + 10;

//     // Determine the number of columns from the first row, excluding blank fields
  const validColumns = Object.keys(tableData[0]).filter((key) => {
      return tableData.some(row => row[key] !== ""); // Exclude columns that are completely blank
  });
  const columnCount = validColumns.length;

  // Set column widths (first column wider)
  const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // First column = 150, others share the remaining width

  // Function to calculate required height based on text content
  const calculateRowHeight = (row, isLastRow) => {
      const lineHeight = 10; // Height of each line (adjust as necessary)
      let maxHeight = 0;

      // Calculate height needed for each column in the row
      validColumns.forEach((columnKey) => {
          const value = row[columnKey] || "";
          const lines = value.split('\n');
          const cellHeight = lines.length * lineHeight + 10; // 10 for padding
          maxHeight = Math.max(maxHeight, cellHeight);
      });

      // If it's the last row, ensure we check for the height of field2 specifically
      if (isLastRow) {
          const field2Height = (row[validColumns[1]] || "").split('\n').length * lineHeight + 10;
          maxHeight = Math.max(maxHeight, field2Height);
      }

      return maxHeight;
  };

  // Render first column spanning all rows
  const firstColumnValue = tableData[0][validColumns[0]]; // Value to be spanned in first column
  doc.fillColor("#f5f5f5")
      .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length) // Spans across all rows
      .stroke("black")
      .fill();

  doc.font(font)
      .fillColor("black")
      .fontSize(7.2)
      .text(firstColumnValue, startX + 5, startY + 5, {
          width: columnWidths[0] - 10, // Adjust for padding
          align: 'left',
      });

  // Render the rest of the table row by row
  tableData.forEach((row, rowIndex) => {
      // Calculate the height for the current row
      const isLastRow = rowIndex === tableData.length - 1; // Check if it's the last row
      const rowHeight = calculateRowHeight(row, isLastRow);
      doc.lineWidth(0.5);

      // Alternate row background color
      doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], rowHeight) // Background for other columns
          .stroke("black")
          .fill();

      // Check if field3 and field4 are empty
      const isField3Empty = !row[validColumns[2]]; // Check if field3 is empty
      const isField4Empty = !row[validColumns[3]]; // Check if field4 is empty

      if (isField3Empty && isField4Empty) {
          // Span field2 across the rest of the columns
          const cellWidth = columnWidths[1] + columnWidths[2] + columnWidths[3]; // Total width of field2, field3, and field4 combined
          doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
              .rect(startX + columnWidths[0], startY, cellWidth, rowHeight) // Span cell
              .stroke("black")
              .fill();

          // Draw the value for field2
          const value = row[validColumns[1]];
          const lines = (value || "").split('\n');
          lines.forEach((line, lineIndex) => {
              doc.font(font)
                  .fillColor("black")
                  .fontSize(7.2)
                  .text(line, startX + columnWidths[0] + 5, startY + 5 + (lineIndex * 10), {
                      baseline: "hanging",
                      width: cellWidth - 10, // Adjust for padding
                  });
          });
      } else {
          // Draw field2, field3, and field4 normally
          validColumns.slice(1).forEach((columnKey, colIndex) => {
              const value = row[columnKey];
              const cellWidth = columnWidths[colIndex + 1];
              doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                  .rect(startX + columnWidths[0] + colIndex * cellWidth, startY, cellWidth, rowHeight) // For each column after the first
                  .stroke("black")
                  .fill();

              // Handle line breaks in the cell
              const lines = (value || "").split('\n');
              lines.forEach((line, lineIndex) => {
                  doc.font(font)
                      .fillColor("black")
                      .fontSize(7.2)
                      .text(line, startX + columnWidths[0] + colIndex * cellWidth + 5, startY + 5 + (lineIndex * 10), {
                          baseline: "hanging",
                          width: cellWidth - 10, // Adjust for padding
                      });
              });
          });
      }

      // Move to next row position
      startY += rowHeight; // Adjust starting position based on calculated row height
  });
}

const repaymentAmountTable = [
  { field1: "Total Repayment Amount", filed2: "Principal ", field3: "Total Interest*", field4: "Total repayment amount" },
  { field1: "", filed2:  `${allPerameters.loanAmount}`, field3:  `${allPerameters.totalInterest}`, field4:  `${allPerameters.totalRepaymentAmount}`, },
  { field1: "", filed2: "*The interest amount is calculated basis the ROI and Tenure of the Facility and is excluding any Pre EMI/ broken period interest that may be computed and applied basis the Disbursement date", field3: "", field4: "", },
];

// Call the function with the correct parameter
// repaymentAmountFunction(repaymentAmountTable);
doc.moveDown(-0.1);
const npaTable = [
  { field1: "Default and NPA  classification",value1: `Please refer Annexure 1` },
];
intrestTableFunction(npaTable);
doc.moveDown(1.5);

const startX = 50; // Set a left margin
const startY = doc.y; // Get the current Y position

doc
  .fontSize(8)
  .font('Helvetica')
  .text(
    `Repayment Cheques should be drawn in favour of GROW MONEY CAPITAL PVT LTD\n` +
    `Schedule of Charges on the Loan / Credit Facility\n\n\n\n` +
    `Details pertaining to the Loan Application by Borrower(s) / Co-Borrower(s)\n` +
    `Received copy of Agreement along with the Schedules and Annexure thereto`, 
    startX, // Use the startX value for left alignment
    startY, // Start at the current Y position
    {
      width: 500, // Define a width for text wrapping if needed
      indent: 0, // No indentation
      paragraphGap: 10, // Space between paragraphs
    }
  );
  
  // addFooter();
  
//   //---------------------------------------- new page 4--------------------------------------------------
  // doc.addPage();
  // addLogo();
  // drawBorder();
  // doc.moveDown(7);


// const repaymentDateTable = [
//     { field1: "Repayment Cycle date", filed2: "3rd of the month ", field3: "5th of the month", field4: "10th of the month" },
//     { field1: "", filed2: ``, field3: ``, field4: "check",  },
// ];

// repaymentFunction(repaymentDateTable);
// doc.moveDown(0.5);

// function intrestTableFunction(tableData) {
//     // Add Table Header
//     const startX = 50;
//     let startY = doc.y + 10;
//     const totalWidth = 500; // Total column width
//     const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
//     const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

//     tableData.forEach((row, rowIndex) => {
//         // Set default row height
//         let rowHeight = 15;

//         // Calculate the height of the text for field1 and value1
//         const field1TextHeight = doc
//             .font(font)
//             .fontSize(7.2)
//             .heightOfString(row.field1, { width: keyWidth });

//         let value1TextHeight = 0;
//         if (row.value1) {
//             value1TextHeight = doc
//                 .font(font)
//                 .fontSize(7.2)
//                 .heightOfString(row.value1, { width: valueWidth });
//         }

//         // Determine the maximum height between field1 and value1 to set row height
//         rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

//         // Alternate row background color
//         doc.lineWidth(0.5);
//         doc
//             .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX, startY, keyWidth, rowHeight)
//             .stroke("black")
//             .fill();

//         // Draw text in field1 cell
//         doc
//             .font(font)
//             .fillColor("black")
//             .fontSize(7.2)
//             .text(row.field1, startX + 5, startY + 5, {
//                 baseline: "hanging",
//                 width: keyWidth,
//             });

//         // Draw the second column, even if value1 is absent
//         doc
//             .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX + keyWidth, startY, valueWidth, rowHeight)
//             .stroke()
//             .fill();

//         // Draw the key-value pair for value1 or leave it empty
//         const keyValueText = row.value1 ? `${row.value1}` : ""; // Show empty text if no value
//         doc
//             .font(font)
//             .fillColor("black")
//             .fontSize(7.2)
//             .text(keyValueText, startX + keyWidth + 5, startY + 5, {
//                 baseline: "hanging",
//                 width: valueWidth,
//             });

//         // Draw vertical line between the columns
//         doc.lineWidth(0.5);
//         doc.strokeColor("black");
//         doc.moveTo(startX + keyWidth, startY);
//         doc.lineTo(startX + keyWidth, startY + rowHeight);
//         doc.stroke();

//         // Move to the next row position
//         startY += rowHeight;
//     });
// }

  
// const intrestData = [
//   { field1: "Pre-Instalment Interest Date(s)",value1: `${allPerameters.preInstalmentInterestDate}` },
//   { field1: "Date when first instalment is due", value1: `10TH OF EVERY MONTH` },
//   { field1: "Total No. of Instalments", value1: `${allPerameters.tenor} Months` },
//   { field1: "Amount of each instalment", value1: `Rs.${allPerameters.amountOfEachInstalment}` },
//   { field1: "Exact dates of repayment", value1: `The instalments shall be due on the repayment cycle date as mentioned above basis the frequency agreed. \n\n The repayment dates are subject to change depending on the Disbursement of the Facility. Exact dates of repayment shall be communicated through a detailed repayment schedule which shall be sent along with a welcome letter` },
// ];

// intrestTableFunction(intrestData);
// doc.moveDown(-0.5);

// function repaymentAmountFunction(tableData) {
//     // Check if tableData is not empty
//     if (!Array.isArray(tableData) || tableData.length === 0 || typeof tableData[0] !== 'object') {
//         console.error("Invalid table data");
//         return;
//     }

//     const fixedRowHeight = 20; // Define fixed row height

//     // Add Table Header
//     const startX = 50;
//     let startY = doc.y + 10;

// //     // Determine the number of columns from the first row, excluding blank fields
//     const validColumns = Object.keys(tableData[0]).filter((key) => {
//         return tableData.some(row => row[key] !== ""); // Exclude columns that are completely blank
//     });
//     const columnCount = validColumns.length;

//     // Set column widths (first column wider)
//     const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // First column = 150, others share the remaining width

//     // Function to calculate required height based on text content
//     const calculateRowHeight = (row, isLastRow) => {
//         const lineHeight = 10; // Height of each line (adjust as necessary)
//         let maxHeight = 0;

//         // Calculate height needed for each column in the row
//         validColumns.forEach((columnKey) => {
//             const value = row[columnKey] || "";
//             const lines = value.split('\n');
//             const cellHeight = lines.length * lineHeight + 10; // 10 for padding
//             maxHeight = Math.max(maxHeight, cellHeight);
//         });

//         // If it's the last row, ensure we check for the height of field2 specifically
//         if (isLastRow) {
//             const field2Height = (row[validColumns[1]] || "").split('\n').length * lineHeight + 10;
//             maxHeight = Math.max(maxHeight, field2Height);
//         }

//         return maxHeight;
//     };

//     // Render first column spanning all rows
//     const firstColumnValue = tableData[0][validColumns[0]]; // Value to be spanned in first column
//     doc.fillColor("#f5f5f5")
//         .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length) // Spans across all rows
//         .stroke("black")
//         .fill();

//     doc.font(font)
//         .fillColor("black")
//         .fontSize(7.2)
//         .text(firstColumnValue, startX + 5, startY + 5, {
//             width: columnWidths[0] - 10, // Adjust for padding
//             align: 'left',
//         });

//     // Render the rest of the table row by row
//     tableData.forEach((row, rowIndex) => {
//         // Calculate the height for the current row
//         const isLastRow = rowIndex === tableData.length - 1; // Check if it's the last row
//         const rowHeight = calculateRowHeight(row, isLastRow);
//         doc.lineWidth(0.5);

//         // Alternate row background color
//         doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//             .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], rowHeight) // Background for other columns
//             .stroke("black")
//             .fill();

//         // Check if field3 and field4 are empty
//         const isField3Empty = !row[validColumns[2]]; // Check if field3 is empty
//         const isField4Empty = !row[validColumns[3]]; // Check if field4 is empty

//         if (isField3Empty && isField4Empty) {
//             // Span field2 across the rest of the columns
//             const cellWidth = columnWidths[1] + columnWidths[2] + columnWidths[3]; // Total width of field2, field3, and field4 combined
//             doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                 .rect(startX + columnWidths[0], startY, cellWidth, rowHeight) // Span cell
//                 .stroke("black")
//                 .fill();

//             // Draw the value for field2
//             const value = row[validColumns[1]];
//             const lines = (value || "").split('\n');
//             lines.forEach((line, lineIndex) => {
//                 doc.font(font)
//                     .fillColor("black")
//                     .fontSize(7.2)
//                     .text(line, startX + columnWidths[0] + 5, startY + 5 + (lineIndex * 10), {
//                         baseline: "hanging",
//                         width: cellWidth - 10, // Adjust for padding
//                     });
//             });
//         } else {
//             // Draw field2, field3, and field4 normally
//             validColumns.slice(1).forEach((columnKey, colIndex) => {
//                 const value = row[columnKey];
//                 const cellWidth = columnWidths[colIndex + 1];
//                 doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
//                     .rect(startX + columnWidths[0] + colIndex * cellWidth, startY, cellWidth, rowHeight) // For each column after the first
//                     .stroke("black")
//                     .fill();

//                 // Handle line breaks in the cell
//                 const lines = (value || "").split('\n');
//                 lines.forEach((line, lineIndex) => {
//                     doc.font(font)
//                         .fillColor("black")
//                         .fontSize(7.2)
//                         .text(line, startX + columnWidths[0] + colIndex * cellWidth + 5, startY + 5 + (lineIndex * 10), {
//                             baseline: "hanging",
//                             width: cellWidth - 10, // Adjust for padding
//                         });
//                 });
//             });
//         }

//         // Move to next row position
//         startY += rowHeight; // Adjust starting position based on calculated row height
//     });
// }

// const repaymentAmountTable = [
//     { field1: "Total Repayment Amount", filed2: "Principal ", field3: "Total Interest*", field4: "Total repayment amount" },
//     { field1: "", filed2:  `${allPerameters.loanAmount}`, field3:  `${allPerameters.totalInterest}`, field4:  `${allPerameters.totalRepaymentAmount}`, },
//     { field1: "", filed2: "*The interest amount is calculated basis the ROI and Tenure of the Facility and is excluding any Pre EMI/ broken period interest that may be computed and applied basis the Disbursement date", field3: "", field4: "", },
// ];

// // Call the function with the correct parameter
// // repaymentAmountFunction(repaymentAmountTable);
// doc.moveDown(-0.1);
// const npaTable = [
//     { field1: "Default and NPA  classification",value1: `Please refer Annexure 1` },
//   ];
//   intrestTableFunction(npaTable);
//   doc.moveDown(1.5);

//   const startX = 50; // Set a left margin
//   const startY = doc.y; // Get the current Y position
  
//   doc
//     .fontSize(8)
//     .font('Helvetica')
//     .text(
//       `Repayment Cheques should be drawn in favour of GROW MONEY CAPITAL PVT LTD\n` +
//       `Schedule of Charges on the Loan / Credit Facility\n\n\n\n` +
//       `Details pertaining to the Loan Application by Borrower(s) / Co-Borrower(s)\n` +
//       `Received copy of Agreement along with the Schedules and Annexure thereto`, 
//       startX, // Use the startX value for left alignment
//       startY, // Start at the current Y position
//       {
//         width: 500, // Define a width for text wrapping if needed
//         indent: 0, // No indentation
//         paragraphGap: 10, // Space between paragraphs
//       }
//     );
  // addFooter();

// //------------------------------------------- new page 5--------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Annexure 1`, startX, doc.y, { align: "center", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Illustration on due dates and NPA classification`, startX, doc.y, { align: "left", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`If due date of a loan account is March 31, 2021, and full dues are not received before the lending institution runs the day-end process for this date, the date of overdue shall be March 31, 2021. If it continues to remain overdue, then this account shall get tagged as SMA-1 upon running day-end process on April 30, 2021 i.e. upon completion of 30 days of being continuously overdue. Accordingly, the date of SMA-1 classification for that account shall be April 30, 2021.\n\nSimilarly, if the account continues to remain overdue, it shall get tagged as SMA-2 upon running day-end process on May 30, 2021 and if continues to remain overdue further, it shall get classified as NPA upon running day-end process on June 29, 2021.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);


function tableFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row
        for (let field in row) {
            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows, no bold for header
            doc
                .font('Helvetica') // Regular font
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const tableData = [
    { field1: "Status", field2: "DPD", field3: "Illustration 2", field4: "Illustration 1", field5: "Illustration 3", field6: "Illustration 4 (Leap year)" },
    { field1: "*Due date/Overdue (if not paid)", field2: `1 day`, field3: `05-02-22`, field4:`03-06-22`, field5:`15-01-22`, field6: `15-01-24` },
    { field1: "SMA-1", field2: `31 days`, field3: `07-03-22`, field4: `03-07-22`, field5: `14-02-22`, field6: `14-02-24` },
    { field1: "SMA-2", field2: `61 days`, field3: `06-04-22`, field4: `02-08-22`, field5: `16-03-22`, field6: `15-03-24` },
    { field1: "#Non-Performing Asset", field2: `91 days`, field3: `06-05-22`, field4: `01-09-22`, field5: `15-04-22`, field6: `14-04-24` },
];

// Call the function to create the table
tableFunction(tableData);  
doc.moveDown(2)

doc
.fontSize(8)
.font('Helvetica')
.text(`* Any amount due to the lender under any credit facility is ‘overdue’ if it is not paid on the due date fixed by the Lender. If there is any overdue in an account, the default/ non-repayment is reported with the credit bureau companies like CIBIL etc. and the CIBIL report of the customer will reflect defaults and its classification status.\n\n# Once an account is classified as NPAs then it shall be upgraded as ‘standard’ asset only if entire arrears of interest and principal are paid by the borrower\n\nIN WITNESS WHEREOF the Parties hereto have hereunto set and execute this Agreement on the day and year as first mentioned hereinabove.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Lender:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);
doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named GROW MONEY\nCAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(6)
.font('Helvetica')
.text(`________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`Authorised Signatory.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Borrowers and Co-Borrowers:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named “Borrowers”\nand “Co-Borrowers”`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`.1 ${allPerameters.nameOne}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.2 ${allPerameters.nameTwo}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.3 ${allPerameters.namethird}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`.4 ${allPerameters.nameFourth}`,startX, doc.y, { align: "left", width: 500})
// doc.moveDown(1);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`____________________________________`,startX, doc.y, { align: "left", width: 500})



// addFooter();

// // --------------------------------------------new page 6-------------------------------------------------------


doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica')
.text(`Affix Revenue Stamp`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`DEMAND PROMISSORY NOTE`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`To,\nThe Manager\nGROW MONEY CAPITAL PVT LTD\nFlat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`On demand I/We and our respective heirs, representatives, executors, administrators, successors and/or permitted assigns,(jointly & severally) unconditionally promise to pay GROW MONEY CAPITAL PVT LTD (“GROW MONEY”, including, its successors and assigns), or order, for value received, the sum of Rs. ${allPerameters.loanAmount}/-${allPerameters.loanAmountinwords} along with applicable interest and charges thereon, which may from time to time be varied in accordance with the policy decision of GROW MONEY.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`To be signed by the Borrower(s)\n\nPlace - ${allPerameters.borrowerPlace}\n\nDATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`______________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);
doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);


// addFooter();


// //----------------------------------------------new page 7-----------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST FORM`,startX, doc.y, { align: "center", width: 500, underline:true})
doc.moveDown(1);

function requestFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Draw the outer rectangle for the box with normal line width
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .lineWidth(0.5) // Set thinner line width for borders
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row with normal line width
        for (let field in row) {
            // Draw rectangle for the field box
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .lineWidth(0.5) // Set thinner line width for field borders
                .stroke("black") // Border for field box
                .fill();

            // Set font style based on whether it's the header row
            const isHeader = rowIndex === 0; // Check if it's the header row
            doc
                .font(isHeader ? 'Helvetica-Bold' : 'Helvetica') // Set font to bold for header
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const requestTableData = [
    { field1: "Name of Applicant", field2: `${allPerameters.customerName}`},
    { field1: "Loan ID", field2: `${allPerameters.loanId}` },
    { field1: "Disbursement Amount Request", field2: `Rs.${allPerameters.disbursementAmount}` },
    { field1: "Date by which the Disbursement is required", field2: `${allPerameters.dateDisbursementRequired}` },
    { field1: "Loan Type ", field2: `Secured Loan` },
    { field1: "LAN No", field2: `${allPerameters.lanNo}` },
];

// Call the function to create the table
requestFunction(requestTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH CHEQUE(S)/DRAFT[1](S) REQUIRED`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const requiredTable = [
    { field1: "Cheque/DD in favour of Payee", field2: "Payable At", field3: "Bank Name of Payee", field4: "Savings/Current Bank Account No of Payee", field5: "Amount" },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
];

// Call the function to create the table
tableFunction(requiredTable);  
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH RTGS`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const rtgsTableData = [
    { field1: "PARTICULARS", field2: "CUSTOMER DETAILS"},
    { field1: "Account Holder Name", field2: `${allPerameters.accountHolderName}` },
    { field1: "Bank Name", field2: `${allPerameters.nameOfBank}` },
    { field1: "Bank Address", field2: `${allPerameters.bankAddress}` },
    { field1: "Bank Account No.", field2: `${allPerameters.accountNo}` },
    { field1: "Bank Account Type", field2: `${allPerameters.accountType}` },
    { field1: "IFSC Code", field2: `${allPerameters.IFSCCode}` },
    { field1: "Customer E-Mail Address", field2: `${allPerameters.emailAddress}` },
    { field1: "For Official Use", field2: `${allPerameters.officeUse}` },
    { field1: "Amount Payable", field2: `${allPerameters.amountPayable}` },
    { field1: "Application ID", field2: `${allPerameters.applicantId}` },
    { field1: "Agreement No", field2: `${allPerameters.agrementNo}` },
];

// Call the function to create the table
requestFunction(rtgsTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Operation`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(-2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DATED : ${allPerameters.disbursementDate}`,startX, doc.y, { align: "left", width: 500, underline:true})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Applicant`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Co-Applicants`,startX, doc.y, { align: "right", width: 500});
// doc.moveDown(0.5);

// addFooter();

// // -------------------------------------------------new page 8------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`REPAYMENT CHEQUE ACKNOWLEDGEMENT LETTER`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(0.5);

function latterTableFunction(tableData) {
    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;
    const totalWidth = 500; // Total column width
    const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
    const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

    tableData.forEach((row, rowIndex) => {
        // Set default row height
        let rowHeight = 15;

        // If it's the last field, span both columns
        if (rowIndex === tableData.length - 1) {
            const fullText = `${row.field1} ${row.value1 || ''}`.trim();
            const textHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(fullText, { width: totalWidth });

            rowHeight = textHeight + 10; // Add some padding

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, totalWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw the text spanning both columns
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(fullText, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: totalWidth,
                });
        } else {
            // Calculate the height of the text for field1 and value1
            const field1TextHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(row.field1, { width: keyWidth });

            let value1TextHeight = 0;
            if (row.value1) {
                value1TextHeight = doc
                    .font(font)
                    .fontSize(7.2)
                    .heightOfString(row.value1, { width: valueWidth });
            }

            // Determine the maximum height between field1 and value1 to set row height
            rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw text in field1 cell
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: keyWidth,
                });

            // Draw the second column, even if value1 is absent
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke()
                .fill();

            // Draw the key-value pair for value1 or leave it empty
            // const keyValueText = row.value1 ? `Value: ${row.value1}` : ""; // Show empty text if no value
            const keyValueText = row.value1 || ""; 

            doc

                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(keyValueText, startX + keyWidth + 5, startY + 5, {
                    baseline: "hanging",
                    width: valueWidth,
                });

            // Draw vertical line between the columns
            doc.lineWidth(0.5);
            doc.strokeColor("black");
            doc.moveTo(startX + keyWidth, startY);
            doc.lineTo(startX + keyWidth, startY + rowHeight);
            doc.stroke();
        }

        // Move to the next row position
        startY += rowHeight;
    });
}

const letterData = [
  { field1: "Customer Name", value1: `${allPerameters.customerName}` },
  { field1: "Address", value1: `${allPerameters.address}` },
  { field1: "Contact Nos.", value1: `${allPerameters.registeredMobile}` },
  { field1: "Credit Facility", value1: `` },
  { field1: "Facility Amount", value1: `Rs.${allPerameters.loanAmount}-${allPerameters.loanAmountinwords}` },
  { field1: "Repayment Mode", value1: `NACH / PDC` },
  { field1: `MENTION THE COUNT OF CHEQUE RECEIVED\n\nCheque Received (A) Undated: 5 (B) Cancelled: 0\n\nCheques Handed over to Mr./Mrs.: ${allPerameters.chequesHandedName}\n\nSourcing Channel Name:${allPerameters.sourcingChannelName}`, value1: "" }
];

latterTableFunction(letterData);

function draweeFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const fieldWidths = [0.25 * boxWidth, 0.5 * boxWidth, 0.25 * boxWidth]; // Widths for each main column
    const extraPadding = 15; // Additional padding for row height

    // Calculate the total height for the entire box
    let totalHeight = 0;
    tableData.forEach(row => {
        let rowHeight = 0;
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });
        totalHeight += rowHeight;
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5);

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0")
        .rect(startX, startY, boxWidth, totalHeight)
        .stroke("black")
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX;
        let rowHeight = 0;

        // Determine row height with extra padding
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });

        // Draw rectangles and text for each field in the row
        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[0], rowHeight).stroke("black");
        doc.font('Helvetica').fillColor("black").fontSize(7.2).text(row.field1, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[0] - 10, align: 'left' });
        currentX += fieldWidths[0];

        if (rowIndex === 0) {
            doc.rect(currentX, startY, fieldWidths[1], rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[1] - 10, align: 'center' });
            currentX += fieldWidths[1];
        } else {
            const subFieldWidth = fieldWidths[1] / 2;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_2 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
        }

        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[2], rowHeight).stroke("black").fillColor("black").text(row.field3, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[2] - 10, align: 'center' });

        // Move to the next row
        startY += rowHeight;
    });
}

// Sample data
const DraweeData = [
    { field1: "Drawee Bank", field2_1: "Cheque No.", field2_2: "", field3: "No of Cheques" },
    { field1: " ", field2_1: "From", field2_2: "To", field3: " " },
    { field1: `APP`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.appbranchName}`, field2_1: `${allPerameters.appchequeNo1}`, field2_2: `${allPerameters.appchequeNo5}`, field3: `${allPerameters.totalCheque}` },
    { field1: `GAU`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.gaubranchName}`, field2_1: `${allPerameters.gaucheqNo1}`, field2_2: `${allPerameters.gauchequeNo5}`, field3: `${allPerameters.gautotalCheq}` },
];

// Call the function to create the table
draweeFunction(DraweeData);


doc.moveDown(3);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`I ${allPerameters.customerName} hereby confirm that I have handed over FIVE cheques detailed above towards repayment of Instalment(s) or security cheque for the loan/facility already taken/to be taken from GROW MONEY CAPITAL PVT LTD and that all cheques were drawn in favour of “GROW MONEY CAPITAL PVT LTD” and also recorded my name on the reverse side of the cheques.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`DATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Name) - ${allPerameters.customerName}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Signature)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`This is to confirm that physical cheques were cross tallied with the above schedule and found correct.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

function SignatureTableFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const normalRowHeight = 20; // Normal height for other rows
    const signatureRowHeight = 40; // Increased height for the signature row

    // Define fixed column widths for three columns
    const columnWidths = [150, 150, 200]; // Adjust widths for your layout

    // Calculate total height needed for the entire box
    let totalHeight = tableData.length * normalRowHeight; // Total height based on normal row height

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row

        // Determine row height based on whether it's the signature row
        const rowHeight = rowIndex === 0 ? signatureRowHeight : normalRowHeight; // Change height for the first row (signature)

        // Draw rectangles for each field in the row
        columnWidths.forEach((width, index) => {
            const field = `field${index + 1}`;

            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, width, rowHeight) // Use determined row height
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows
            doc
                .font('Helvetica')
                .fillColor("black")
                .fontSize(7.2);

            // Draw the field text in the box
            const fieldValue = row[field] || ""; // Use empty string for missing fields
            doc.text(fieldValue, currentX + 3, startY + 5, {
                baseline: "hanging",
                width: width - 10, // Adjust width to provide padding inside the box
                align: 'left', // Align text to the left
            });

            // Move to the next column
            currentX += width; // Update X position for the next field
        });

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row based on the determined height
    });
}

const SignatureTable = [
    { field1: "Signature", field2: "", field3: "" },
    { field1: "Name", field2: ``, field3: "" },
    { field1: "", field2: "Sales Executive / DSA", field3: "CPA / FIN COOPERS Staff" },
];

// Call the function to create the table
SignatureTableFunction(SignatureTable);

// addFooter();

// //---------------------------------------------- new page 9---------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`LETTER OF CONTINUITY`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(2.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Place: Indore`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`Dear Sir(s),`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`I/We ${allPerameters.customerName} a company incorporated under the provisions of the Companies Act, 1956/2013 /a partnership firm registered under the provisions of the Indian Partnership Act, 1932/ sole proprietorship concern or an individual having its office/ place of business at ${allPerameters.place}, acting through _______________________________, who is duly authorized in that behalf vide board resolution/ letter of authority/power of attorney dated DATED : ${allPerameters.date} (the “Borrower(s)”), enclose a Promissory Note dated DATED : ${allPerameters.date} for Rs.${allPerameters.disbursementAmount} payable on demand which is given to you (“DPN”) as collateral security for repayment to GROW MONEY, (hereinafter referred to as the “GROW MONEY”, including its successors and assigns) of any sum now due or which may hereafter become due from me/us to GROW MONEY in respect of Rs.${allPerameters.disbursementAmount} (hereinafter referred to as the “Facility”) granted by GROW MONEY vide Facility Agreement dated DATED : ${allPerameters.date}.I/We hereby irrevocably and unconditionally agree, confirm and undertake that:\n\n1. the DPN shall operate as continuing security to you to be enforceable for the repayment of the ultimate balance and/or all sums remaining unpaid under the Facility now or hereafter, including all interest to become payable in respect of / under the Facility or which may in future be advanced; and\n\n2. we will remain liable on the DPN notwithstanding payment made into the account of the Facility from time to time or the Facility being reduced or extinguished from time to time or even if the balance in the account of the Facility may be in credit.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(3);

doc
.fontSize(8)
.font('Helvetica')
.text(`Yours faithfully`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`(Borrowers)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`___________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500});
// doc.moveDown(2);

// addFooter();

// //----------------------------------------------- new page 10-----------------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
    .fontSize(8)
    .font('Helvetica-Bold') // Use the bold version of Helvetica
    .text(`END-USE UNDERTAKING`, startX, doc.y, { align: "center", width: 500, underline:true })
    .moveDown(2)

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`DATED : ${allPerameters.date}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Dear Sir/Madam,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Subject:- Undertaking regarding utilizations of Loans to be granted by GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`I/We ${allPerameters.customerName} acknowedge that  GROW MONEY has sanctioned loan amount of Rs. ${allPerameters.loanAmount} (${allPerameters.loanAmountinwords}) to subject to the terms and conditions as mentioned in the Sanction Letter Date:${allPerameters.sanctionLatterDate}(sanction letter). The Loan has been sanctioned by GROW MONEY inter alia, on the basis of my/our representation that we/I are/am engaged in the business of and the loan will be utilized only for the purpose of .\n\n I/We hereby solemnly confirm and certify that Loan shall be utilized only for the aforesaid purpose and no other purpose. I/We will never utilize the Loan or any part thereof for any speculative, illegal and prohibited activity (prohibited under any applicable laws/rules/regulations). Any breach or violation of the representation made herein, and other documents executed in relation to Loan will be my/our responsibility solely.\n\nI/We shall extend necessary support and co-operation to GROW MONEY for any matter in connection with this letter and Facility Agreement.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(2);

// addFooter();


    // Finalize the PDF
    doc.end();
  
    // const pdfFileUrl = `/uploads/pdf/${pdfFilename}`;

    // const objData = {
    //     fileName: pdfFileUrl,
    //     file: doc.toString('base64')
    //  }
    //   await initESign(objData)
  
    // return new Promise((resolve, reject) => {
    //   stream.on("finish", () => {
    //     resolve(pdfFileUrl);
    //   });
    //   stream.on("error", reject);
    // });

    return new Promise((resolve) => {
      doc.on('end', () => resolve(Buffer.concat(buffers)));
    });
  }

  async function ratannaFinSanctionLetterPdf3(allPerameters,logo,partnerName) {

    const font = "assets/font/Cambria.ttf";
    const fontBold = "assets/font/Cambria-Bold.ttf";
    const fontKerlaTamil = "assets/font/KarlaTamilUpright-Regular.ttf"
    const fontUrdu = "assets/font/IBMPlexSansArabic-Regular.ttf"
    const fontTelugu = "assets/font/TiroTelugu-Regular.ttf"
    const fontPanjabi = "assets/font/BalooPaaji2-VariableFont_wght.ttf"
    const fontMalayam = "assets/font/AnekMalayalam-VariableFont_wdth.ttf"
    const fontKannada = "assets/font/NotoSansKannada-VariableFont_wdth.ttf"
    const fontGujarati = "assets/font/Rasa-VariableFont_wght.ttf"
    const fontHindi = "assets/font/Mukta-Regular.ttf"
    const fontOriya = 'assets/font/BalooBhaina2-VariableFont_wght.ttf'
    const fontMarathi = 'assets/font/Hind-Regular.ttf'
    const fontBengali = 'assets/font/NotoSansBengali-VariableFont_wdth.ttf'
    // const baseDir = path.join("./uploads/");
    // const outputDir = path.join(baseDir, "pdf/");

    const PDFDocument = require('pdfkit');
  const doc = new PDFDocument({ margin: 50, size: "A4" });

  // Buffer to hold the PDF content
  const buffers = [];
  doc.on('data', (chunk) => buffers.push(chunk));
  doc.on('end', () => console.log('PDF generated successfully!'));

  
    // draw a border around the page
    function drawBorder() {
      const pageWidth = doc.page.width;
      const pageHeight = doc.page.height;
      const margin = 30;
      const lineWidth = 2;
  
      // Draw a simple border rectangle
      doc.lineWidth(lineWidth);
      doc
        .rect(margin, margin, pageWidth - 2 * margin, pageHeight - 2 * margin)
        .strokeColor("#324e98") // Set the color of the border
        .stroke();
    }
  
    // add logo to every page
    // function addLogo() {
    //   if (fs.existsSync(logo)) {
    //     doc.image(logo, 400, 50, {
    //       fit: [150, 50],
    //       align: "right",
    //       valign: "bottom",
    //     });
    //   } else {
    //     console.error(`Logo file not found at: ${logo}`);
    //   }
    // }
    const FinpdfLogo = path.join(
        __dirname,
        "../../../../../assets/image/FINCOOPERSLOGO.png"
      );

    function addLogo() {
          if (fs.existsSync(FinpdfLogo)) {
            doc.image(FinpdfLogo, 400, 50, { fit: [150, 50], align: "left", valign: "bottom" });
          } else {
            console.error(`Logo file not found at: ${FinpdfLogo}`);
          }
      
          if (fs.existsSync(logo)) {
                  doc.image(logo, 40, 50, {
                    fit: [150, 50],
                    align: "right",
                    valign: "bottom",
                  });
                } else {
                  console.error(`Left logo file not found at: ${logo}`);
                }
        }
  
    // watermark function
    function addWatermark() {
      if (fs.existsSync(watermarklogo)) {
        doc.save();
        doc.rotate(-45, { origin: [doc.page.width / 2, doc.page.height / 2] });
  
        doc.image(
          watermarklogo,
          doc.page.width / 2 - 200,
          doc.page.height / 2 - 200,
          {
            fit: [450, 400],
            opacity: 0.05,
            align: "center",
            valign: "center",
          }
        );
  
        doc.restore();
      } else {
        console.error(`Logo file not found at: ${watermarklogo}`);
      }
    }
  
    // Footer with border and stylized text
    // Footer with border and stylized text
    function addFooter() {
      if( partnerName == "GROW MONEY CAPITAL PVT LTD"){
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("Grow Money Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }else {
        const pageWidth = doc.page.margins.left;
        const pageHeight = doc.page.height;
    
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#324e98")
          .text("FinCoopers Capital Pvt Ltd", pageWidth, pageHeight - 80, {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Registered Office: 174/3, Nehru Nagar, Indore-452011 (M.P.)", {
            align: "center",
          });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("CIN: 67120MP1994PTC008686", { align: "center" });
        doc
          .font(fontBold)
          .fontSize(6.3)
          .fillColor("#000000")
          .text("Phone: +91 7374911911 | Email: hr@fincoopers.com", {
            align: "center",
          });
    
        // Add a separator line above the footer
        doc
          .moveTo(50, doc.page.height - 100)
          .lineTo(doc.page.width - 50, doc.page.height - 100)
          .strokeColor("#324e98")
          .lineWidth(1)
          .stroke();
      }
     
    }
  
    // if (!fs.existsSync(outputDir)) {
    //   fs.mkdirSync(outputDir, { recursive: true });
    // }
  
    const timestamp = Date.now();
    // const candidateName = 
    // (`${candidateDetails.name}`); // Capitalize name
    // const pdfFilename = `growLoanAggrement.pdf`;
    // const pdfPath = path.join(outputDir, pdfFilename);
  
    // const doc = new PDFDocument({ margin: 50, size: "A4" });
    // const stream = fs.createWriteStream(pdfPath);
  
    // doc.pipe(stream);
    // //---------------------------------------------------- new page 14-------------------------------------------------------

// addLogo();
// drawBorder();
doc.moveDown(7);


doc
.fontSize(9)
.font('Helvetica-Bold')
.fontSize(9)
.text(`Vernacular Language Form`,  { align: "center",underline: false, width: 500 });
doc.moveDown(2);


function declarationTableFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  const columnWidths = {
    field1: 50,
    field2: 100,
    field3: 330,
  };

  // Define min and max row height to avoid extremes
  const MIN_ROW_HEIGHT = 15;
  const MAX_ROW_HEIGHT = 45;

  // Function to calculate row height based on text content
  const calculateRowHeight = (row) => {
    let maxHeight = 0;
    Object.keys(row).forEach((field) => {
      const text = row[field] || '';
      const columnWidth = columnWidths[field] || 100;

      // Calculate the text height for each field
      const textHeight = doc
        .font(field === 'field3' ? fontKerlaTamil : 'Helvetica')
        .fontSize(7.2)
        .heightOfString(text, { width: columnWidth });

      // Track the highest text height in the row
      maxHeight = Math.max(maxHeight, textHeight);
    });

    // Ensure the row height stays within the defined min and max limits
    return Math.max(MIN_ROW_HEIGHT, Math.min(maxHeight, MAX_ROW_HEIGHT));
  };

  const totalWidth = Object.values(columnWidths).reduce((sum, width) => sum + width, 0);

  tableData.forEach((row, rowIndex) => {
    let currentX = startX;
    const rowHeight = calculateRowHeight(row); // Calculate the row height based on text content

    // Set up the table border at the beginning
    doc
      .lineWidth(0.25)
      .rect(startX, startY, totalWidth, rowHeight)
      .stroke("black");

    Object.keys(columnWidths).forEach((field) => {
      const columnWidth = columnWidths[field];
      const content = row[field] || '';

      doc
        .lineWidth(0.25)
        .rect(currentX, startY, columnWidth, rowHeight)
        .stroke("black");

      const isHeader = rowIndex === 0;
      const paddingTop = 2;  // Adjust padding from the top (increase if needed)
      const textYPosition = startY + paddingTop;

      if (field === 'field1' && content) {
        doc.image(content, currentX + 5, textYPosition + (rowHeight - 8) / 2, { width: 8, height: 8 });
      } else {
        doc
          .font(isHeader ? 'Helvetica-Bold' : 'Helvetica')
          .fillColor("black")
          .fontSize(7.2);

        const text = content || '';
        if (field === 'field3') {
          // Checking for specific languages to apply respective fonts
          if (/[\u0C00-\u0C7F]/.test(text)) {  // Telugu Unicode range
            doc.font(fontTelugu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0D00-\u0D7F]/.test(text)) {  // Malayalam Unicode range
            doc.font(fontMalayam).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0C80-\u0CFF]/.test(text)) {  // Kannada Unicode range
            doc.font(fontKannada).text(text, currentX + 3, textYPosition, {
              baseline: "top",
              width: columnWidth - 6,
              align: 'left',
            });
          } else if (/[\u0A80-\u0AFF]/.test(text)) {  // Gujarati Unicode range
            doc.font(fontGujarati)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0600-\u06FF]/.test(text)) {  // Urdu Unicode range
            doc.font(fontUrdu)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'right',
               });
          } else if (/[\u0A00-\u0A7F]/.test(text)) {  // Punjabi Unicode range
            doc.font(fontPanjabi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else if (/[\u0B80-\u0BFF]/.test(text)) {  // Tamil Unicode range
            doc.font(fontKerlaTamil).text(text, currentX + 3, textYPosition, {
                baseline: "top",
                width: columnWidth - 6,
                align: 'left',
            });
          } else if (/[\u0900-\u097F]/.test(text)) {  // Hindi Unicode range
            doc.font(fontHindi)
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          } else  if (/[\u0B00-\u0B7F]/.test(text)) {  // Odia Unicode range
            doc.font(fontOriya)  // Make sure 'fontOdia' is defined and points to the correct font file
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
           } else if (/[\u0900-\u097F]/.test(text)) {  // Marathi (Devanagari Unicode range)
            doc.font(fontMarathi)  // Ensure you have the Marathi font file available
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
        } else if (/[\u0980-\u09FF]/.test(text)) {  // Bengali Unicode range
          doc.font(fontBengali)  // Ensure you have the Bengali font file available
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }else {
            doc.font('Helvetica')
               .text(text, currentX + 3, textYPosition, {
                 baseline: "top",
                 width: columnWidth - 6,
                 align: 'left',
               });
          }
        } else {
          doc.font('Helvetica')
             .text(text, currentX + 3, textYPosition, {
               baseline: "top",
               width: columnWidth - 6,
               align: 'left',
             });
        }
      }

      currentX += columnWidth;
    });

    startY += rowHeight; // Adjust to the row's actual height
  });
}

const gujratiFont = [
'આ અરજી/કરાર/પત્ર/નિયમો અને શરતોનો સામગ્રી અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહકને અંગ્રેજીમાં વાંચીને સમજાવી',
'  અને વ્યાખ્યા કરવામાં આવી છે અને અરજીકર્તા/ઋણગ્રાહક અને સહ-ઋણગ્રાહક દ્વારા તેને સમજવામાં આવી છે',
]

const declarationTable = [
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "English", 
    field3: "The content of this Application/ Agreement/letter/Terms and Conditions has been read out, explained and interpreted to the applicant(s)/Borrower and to the Co-Borrower(s) in English and understood by the applicant(s)/Borrower and Co-Borrower(s).",  // English text
  },
  { 
    field1: CheckedLogo,  // Path to the image file (not doc.image)
    field2: "Hindi", 
    field3: "इसआवेदन / समझौ ते / पत्र / नि यमों औमों रशर्तों की सा मग्री को आवेदक (ओं)ओं / उधा रकर्ता औरअंग्रेजीग्रे जीमेंसह-उधा रकर्ता (ओं)ओं को समझा औरसमझा यागयाहैऔहै रआवेदक (ओं)ओं याउधा रकर्ता द्वा रा समझा गया है ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Punjabi", 
    field3: "ਇਸਬਿ ਨੈ-ਪੱਤਰ / ਸਮਝੌਤੇਝੌਤੇ/ ਪੱਤਰ / ਨਿ ਯਮਾਂ ਅਮਾਂ ਤੇਸ਼ਰਤਾਂ ਦੀਤਾਂ ਦੀਸਮੱਗਰੀ ਨੂੰਬਿ ਨੈਕਾ ਰ /ਉਧਾ ਰਲੈਣਵਾ ਲੇਅਤੇਅੰਗ੍ਰੇਜ਼ੀ ਵਿ ਚਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇਨੂੰਸਮਝਾ ਕੇਸਮਝਾ ਇਆਗਿ ਆਹੈਅਤੇਬਿ ਨੈਕਾ ਰਦੁਆਰਾ ਸਮਝੇਗਝੇ ਏਅਤੇਸਹਿ -ਉਧਾ ਰਲੈਣਵਾ ਲੇ।",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Kannada", 
    field3: "ಈ ಅಪ್ಲಿಕೇ ಶನ್/ಒಪ್ಪಂ ದ/ಪತ್ರ / ನಿಯಮಗಳುಮತ್ತು ಷರತ್ತು ಗಳವಿಷಯವನ್ನು ಅರ್ಜಿ ದಾ ರ (ರು )/ ಸಾ ಲಗಾರಮತ್ತು ಇಂ ಗ್ಲಿಷ್ನಲ್ಲಿಸಹ-ಸಾ ಲಗಾರ(ಗಳು)ಗೆಓದಿ, ವಿವರಿಸಲಾ ಗಿದೆಮತ್ತು ವ್ಯಾ ಖ್ಯಾ ನಿಸಲಾ ಗಿದೆಮತ್ತು ಅರ್ಜಿ ದಾ ರರು (ಗಳು ) /ಸಾ ಲಗಾರರಿಂ ದಅರ್ಥ ಮಾ ಡಿಕೊ ಳ್ಳಲಾ ಗಿದೆಮತ್ತು ಸಹ-ಸಾ ಲಗಾ ರ (ಗಳು).  ",  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Telugu", 
    field3: "ఈ అప్లికేప్లిషన్ / ఒప్పం దం / లేఖ / నిబం ధనలుమరియుషరతులయొక్క కం టెం ట్దరట్ద ఖాస్తుదారు(లు) / రుణగ్ర హీతమరియుఆం గ్లం లోసహ-రుణగ్ర హీత (ల)కుచదవబడిం ది, వివరిం చబడిం దిమరియువివరిం చబడిం దిమరియుదరఖాస్తుదారు(లు) / రుణగ్ర హీతఅర్థం చేసుకున్నా రుమరియుసహ-రుణగ్ర హీత (లు)."
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Tamil", 
    field3: "இந்தவிண்ணப்பம் / ஒப்பந்தம் / கடிதம்வி தி முறைகள்மற்றும்நி பந்தனை களி ன்உள்ளடக்கம்விண்ணப்பதா ரர்(கள்)/கடன்வா ங்குபவர் மற்றும்இணைக்கடன்வா ங்குபவர்(கள்) ஆகி யோ ருக்குஆங்கி லத்தி ல்படித்துவி ளக்கப்பட்டுவி ளக்கம்அளி க்கப்பட்டுள்ளதுமற்றும்விண்ணப் பதா ரர்(கள்)/கடன்வா ங்குபவர்புர",  // Tamil text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Malayalam", 
    field3: 'ഈ ആപ്ലി ക്കേ ഷന്റെ ഉള്ളടക്കം / കരാ ർ / കത്ത് / നി ബന്ധനകളും വ്യ വസ്ഥകളും അപേ ക്ഷകന് / കടം വാ ങ്ങു ന്നയാ ൾക്കും ഇം ഗ്ലീ ഷി ൽ സഹ-കടം വാ ങ്ങു ന്നയാ ൾക്കും വാ യിക്കു കയും വി ശദീ കരിക്കു കയും വ്യാ ഖ്യാ നിക്കു കയും ചെ യ്തു കൂ ടാ തെ അ പേ ക്ഷകൻ (ങ്ങൾ) / കടം വാ ങ്ങു ന്നയാ ൾ മനസ്സി ലാ ക്കു കയും ചെ യ്യു ന്നു . ഒപ്പം സഹ-കടം വാ ങ്ങു ന്നവരും .',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Oriya", 
    field3: 'ଏହିଆହି ବେ ଦନ / ଚୁକ୍ତିନା ମା / ଚିଠିଚି ଠି/ ସର୍ତ୍ତା ବଳୀ ଏବଂ ଚୁକ୍ତିନା ମା ଗୁଡିକଡି ଆବେ ଦନକା ରୀ (()) / orrଣଗ୍ରହୀ ତା ଏବଂ ସହ-orrଣଗ୍ରହୀ ତା ଙ୍କୁଇଂ ରା ଜୀ ରେ ପ read ା ଯା ଇଛି,ଛିବ୍ୟା ଖ୍ୟା କରା ଯା ଇଛିଏବଂ ଆବେ ଦନକା ରୀ (ମା ନେ ) / orrଣଦା ତା ଦ୍ୱା ରା ବୁଝିଛଝିନ୍ତିଏନ୍ତିବଂ ସହ-orrଣଦା ତା (ଗୁଡିକଡି ) |',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Marathi", 
    field3: 'याअर्जा ची / करा रा ची / पत्रा ची / अटी व शर्तीं ची मा हि ती वा चूनका ढली गेली आहे,हेअर्जदा रा ला /कर्जदा रा ला आणि इंग्रजी मध्येसह-कर्जदा रा ला /केली आहे व अर्जदा रा ने /कर्जदा रा नेसमजूनघेतली आहे.हेआणि सह-कर्जदा र',  // English text
  },
  { 
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Gujarati", 
    field3: gujratiFont.join('\n'),  // English text
  },
  {
    field1: unCheckedLogo,  // Path to the image file (not doc.image)
    field2: "Urdu", 
    field3: "درخواست/معاہدہ/خط/شرائط و ضوابط کا مواد درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ کو انگریزی میں پڑھ کر سنایا گیا، وضاحت کی گئی اور اس کی تشریح کی گئی اور درخواست دہندہ/قرض دہندہ اور شریک قرض دہندہ نے اسے سمجھ لیا۔",  // Urdu text
  },
];

// // Call the table function to render the data
declarationTableFunction(declarationTable);
doc.moveDown(3);

// doc
// .fontSize(9)
// .font('Helvetica')
// .text(`___________________________`,  doc.y, { align: "left",underline: true, width: 500 });
// doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica-Bold')
// .text(`FOR Borrower,Co-Borrower and Guarantor`,{ align: 'left',lineGap: 5  });
// doc.moveDown(1);

// Reset the starting position
doc
.fontSize(8)
.font('Helvetica-Bold')
.text(
  `FOR Borrower, Co-Borrower and Guarantor`,
  40, // X-coordinate for absolute left alignment
  doc.y, // Y-coordinate: use the current vertical position
  { align: 'left', lineGap: 5 }
);
doc.moveDown(1);

  
// addFooter();
doc.addPage();


    // addLogo();
    // drawBorder();
    doc.moveDown(6);

   doc.font(font).fontSize(11).text('FACILITY AGREEMENT', { align: 'center', underline: true });
   doc.moveDown(2);


doc.font('Helvetica').fontSize(9).text(`THIS FACILITY AGREEMENT`, {
  align: 'left',
  indent: 40,
  lineGap: 5,
  continued: true
})
.font('Helvetica-Bold').text(`(“Agreement”)`, {
  continued: true, // Allows the text to continue on the same line
})
.font('Helvetica').fontSize(9).text(` is made at the place and on the date stated in the Schedule of this Agreement (“Schedule”) by and between:`, {
  align: 'left',
 align:"justify",
  indent: 40,
  lineGap: 5,
})

doc.moveDown(1)

.font('Helvetica').text(`GROW MONEY CAPITAL PVT LTD,`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica').text(` a company incorporated under the Companies Act, 1956 and validly existing under and within the meaning of the Companies Act, with CIN: U74899DL1995PTC069216, registered as a nonbanking financial company`, {
    continued: true, // Allows the text to continue on the same line
  })

.font('Helvetica-Bold').text(`(“NBFC”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica').text(`under the Reserve Bank of India`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  
  .font('Helvetica-Bold').text(`(“RBI”) `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`Act, 1934, having its registered office at 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI-110001 (M.P.), India (hereinafter referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(` “Lender”,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica').text(`which expressionshall, unless repugnant to the subject or context thereof, be deemed to include its successors, transferees, novatees and assigns), of the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  .font('Helvetica-Bold').text(`FIRST PART;`) 

  doc.moveDown(1);
  doc.font(font).fontSize(9).text('AND', { align: 'center' });
  doc.moveDown(1);

  doc.font('Helvetica').text(`which expression shall, unless repugnant to the subject or context there of, be deemed to include its successors, transferees, novatees and assigns), of the `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(` SECOND PART`) 

  doc.font('Helvetica').text(`The Borrower and Lender are hereinafter collectively referred to as the`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(`“ Parties”`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and individually referred to as `, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica-Bold').text(` “Party”`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`WHEREAS`) 
  doc.moveDown(1);

  doc.font('Helvetica').text(`1. The Borrower is engaged in the business or employment as detailed in the Schedule appended here with`, {
    continued: true, // Allows the text to continue on the same line
  })
  
  doc.font('Helvetica-Bold').text(`(“Business”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`and it has requested the Lender to sanction a credit facility for an amount as mentioned in the Schedule `, {
    continued: true, // Allows the text to continue on the same line
  })

  doc.font('Helvetica-Bold').text(`(“Facility”)`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 2. The Borrower has assured that the Facility would be utilized only for the Purpose ( defined below) and repaid as per terms contained in the Schedule.\n\n 3. At the Borrower’s request and relying upon the correctness of the information, the representations and the assurances given by the Borrower, the Lender has agreed to grant the Facility to the Borrower, on the terms and conditions contained herein.`)
  doc.moveDown(1);

  doc.font('Helvetica-Bold').text(`NOW, THEREFORE,`, {
    continued: true, // Allows the text to continue on the same line
  }) 

  doc.font('Helvetica').text(`in consideration of the premises and mutual agreements and covenants contained in this Agreement and other good and valuable consideration (the receipt and adequacy of which is hereby mutually acknowledged), each of the Parties hereby agrees as follows:`)

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`DEFINITIONS AND INTERPRETATION`) 
  doc.moveDown(1);

  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`1.1 Definitions`) 
  doc.moveDown(1);
  
  doc.font('Helvetica').text(`Wherever used in this Agreement or any Schedule, unless the context otherwise requires, in addition to the terms defined in the Recitals and in the text of this Agreement, the following capitalized terms have the following meanings:`) 
  doc.moveDown(1);
  doc.font('Helvetica-Bold').text(`“Additional Interest Rate” means the additional interest rate as detailed in the Schedule,`) 
  doc.font('Helvetica-Bold').text(`“Applicable Interest Rate”`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica').text(`means the rate of interest as mentioned in the Schedule payable by the Borrower to the Lender on the outstanding principal amount under the Facility and serviced in a manner as specified in this Agreement.`)
  doc.font('Helvetica-Bold').text(`“Applicable Law”`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`means any statute, national, state, provincial, local, municipal, or other law, treaty, code, regulation, ordinance, rule, judgment, order, decree, bye-law, any act or enactment including but not limited to the Insolvency and Bankruptcy Code, 2016`, {
    continued: true, // Allows the text to continue on the same line
  }) 
  doc.font('Helvetica-Bold').text(`( “Code”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`, Securitization and Reconstruction of Financial Assets and Enforcement of Security Interest Act, 2002`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica-Bold').text(`(“SARFAESI Act”),`, {
    continued: true, // Allows the text to continue on the same line
  })
  doc.font('Helvetica').text(`The Industrial Disputes Act, 1947, Environment Protection Act, 1986, Reserve Bank of India Act, 1934 and other RBI regulations,Companies Act, 2013, Transfer of Property Act, 1882, approval of any Governmental Authority, directive, guideline, policy, requirementor other governmental restriction or any similar form of decision of or determination by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    continued: false, // Allows the text to continue on the same line
  })
   
    // addFooter();
    //------------------------------------------new page ----------------------------------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    // doc.moveDown();


    // doc.font('Helvetica').fontSize(9).text(`by, or any interpretation or administration having the force of law of any of the foregoing by any Governmental Authority having jurisdiction over the matter in question, whether in effect as of the date of this Agreement or at any time thereafter.`, {
    //     continued: true, 
    //   })

    doc.font('Helvetica-Bold').fontSize(9).text(`“Application Form”`, {
        continued: true, // Allows the text to continue on the same line
    })  

    doc.font('Helvetica').text(`” means the application form and/or relevant information submitted through any means by the Borrower to the Lender for applying and availing the Loan/Facility, together with all other information particulars, clarifications and declarations, if any, furnished by the Borrower or any other person from time to time in connection with the said Loan/Facility,`)  

    doc.font('Helvetica-Bold').text(`“Business Day”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean a day of the week on which the scheduled commercial banks are open for businessin such state or union territory of India where the office of the Lender, as specified in the Schedule, is located. `)  

    doc.font('Helvetica-Bold').text(`“Borrower/Co-borrower”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`means and includes all the borrower(s) and co-borrower(s) and shall deem to include (i) in case of the individual- his or her heirs, executors and administrators and in case of more than one Borrower their respective heirs executors and administrators, (ii) in case of a company incorporated under the provisions of \n\n Companies Act or a society registered under the applicable laws relating to societies- its successors in interest and permitted assigns, (iii) in case of a partnership firm within the meaning of Indian Partnership Act,1932- any ofor each of the partner or survivor/s of them from time to time (both their personal capacity and as partners of the firm) and their respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the firm, (iv) in the case of proprietary concern- the proprietor(s) (both in his/her personal capacity and as proprietor/proprietress of the concern) and his her respective heirs, legal representatives, executors, administrators and permitted assigns, successors of the concern, (v) in the case of a Hindu Undivided Family` , {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(` (“HUF”),`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`, the Karta of the HUF and any or each of the adult members/coparceners of the HUF and their survivor(s) and their respective heirs, legal representatives, executors, administrators and permitted assigns, (vi) in the case of trust, the trust/trustee/s for the time being its successors.`) 

    doc.font('Helvetica-Bold').text(`“Charges”`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica').text(`shall mean the charges which may be charged by the Lender in relation to the Loan/ Facility, including the charges provided in the Sanction Letter. Any revision to the Charges as per this Agreement as may be communicated or notified to the Borrower shall be the applicable Charges and shall be deemed to have been incorporated in the Sanction Letter, and the Sanction Letter to this effect be deemed to have been modified;`, {
        continued: true, // Allows the text to continue on the same line
    }) 

    doc.font('Helvetica-Bold').text(`“Companies Act”`, {
        continued: true, // Allows the text to continue on the same line
    })
    
    doc.font('Helvetica').text(`” means individually and collectively, the provisions of the Companies Act, 2013 and such relevant provisions of the Companies Act, 1956, which are still in force and effect including all amendments, enactments, re-enactments or modifications thereof, from time to time, including the rules and regulations prescribed therein`) 
  
    doc.font('Helvetica-Bold').text(`“Conditions Precedent”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means the conditions as specified in Clause 3.5 of this Agreement which are required to be satisfied (unless waived in writing by the Lender) by the Borrower,`)

   doc.font('Helvetica-Bold').text(`“Credit Information Agency”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`” shall mean and include TransUnion CIBIL Limited, CRIF High Mark Credit Information Services Private Limited, Equifax India and Equifax Analytics Private Limited, Experian Credit Information Company of India Private Limited or such other company or any other agency as may be notified or recognized as such by the RBI or any other regulatory authority,`)

    doc.font('Helvetica-Bold').text(`“Designated Account”`, {
        continued: true, // Allows the text to continue on the same line
    })

    doc.font('Helvetica').text(`means a current bank account of the Lender for receipt of the Outstanding Amounts; “Disbursement” means the disbursement of the Facility or any part thereof, made by the Lender pursuant to the request thereof by the Borrower subject to the terms of this Agreement;`)
  
    doc.font('Helvetica-Bold').text(`“Disbursement Request Form”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“DRF”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means a form (as per format in attached annexure) or a request (in a form and manner acceptable to the Lender) submitted by the Borrower to the Lender requesting that all or a portion of the Facility be disbursed to the Borrower;`)
    doc.font('Helvetica-Bold').text(`“Due Date”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the date(s) on which any amounts in respect of the Facility including the principal, interest or other monies fall due under the terms of this Agreement and/or the other Financing Documents and/or as more particularly described under the Schedule;`)
    doc.font('Helvetica-Bold').text(`“Electronic Clearing Service”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`‘ECS'`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`'NACH',`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the electronic clearing services and electronic payment services, notified by RBI from time to time, being mode(s) of effecting payment transactions using the services of a clearing house or any other platform or mechanism duly authorized in this regard including without limitation the National Electronic Clearing Service;`)
    doc.font('Helvetica-Bold').text(`“Encumbrance”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`means the creation of charge, lien, security, quasi security, non-disposal arrangement, claim, option, negative lien, power of sale in favor of a third party, retention of title, right of pre-emption, right of first refusal, lock-in of any nature including as may be stipulated by the Securities Exchange Board of India, or other third party right or security interest or an agreement, arrangement or obligation to create any of the foregoing whether presently or in the future. The term`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbrancer”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`or`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Encumbered”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall be accordingly construed;`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica-Bold').text(`“Event of Default”`, {
        continued: true, // Allows the text to continue on the same line
    })
    doc.font('Helvetica').text(`shall have the meaning prescribed to it under clause 13 herein;`)
    doc.font('Helvetica-Bold')
   .fontSize(9)
   .text(
      `"Account Bank" or "Escrow Agent"`,
      { continued: true }
   )
   .font('Helvetica')
   .text(` means the bank acceptable to the Lender`, { continued: true })
   .font('Helvetica')
   .text(
      ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
    // addFooter();
      //-------------------------------------------------new page ------------------------------------------------------
      doc.addPage();
      // addLogo();
      // drawBorder();

      doc.moveDown(7);

      // doc.moveDown();

  //     doc.font('Helvetica-Bold')
  //  .fontSize(9)
  //  .text(
  //     `"Account Bank" or "Escrow Agent"`,
  //     { continued: true }
  //  )
  //  .font('Helvetica')
  //  .text(` means the bank acceptable to the Lender`, { continued: true })
  //  .font('Helvetica')
  //  .text(
  //     ` and specified in the Schedule with whom the Escrow Account will be opened and maintained by the Borrower in accordance with this Agreement and the Escrow Agreement;`,
  //     { align: 'justify', indent: 40, lineGap: 5 }
  //  )
  //  .moveDown(1);

doc.font('Helvetica-Bold')
    .fontSize(9)
   .text('"Escrow Account"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the account opened/maybe opened with the Account Bank in accordance with this Agreement and the Escrow Agreement, for the repayment of Outstanding Amounts or any amount payable by Borrower to Lender under this Agreement,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Escrow Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` for the purpose of this Agreement, as the context may require, shall either mean the agreement executed/to be executed/maybe executed at any date as required by Lender and entered into by and between inter alia the Bank (defined below), the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account and the Lender reserves the right to make Borrower a part of Escrow Agreement on such terms and conditions as the Lender may decide in its sole discretion or it shall mean the agreement executed/to be executed/maybe executed at any date as required by Lender, and entered into by and between inter alia the Borrower, the Lender and Escrow Agent with respect to the operation and maintenance of the Escrow Account,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Facility"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the aggregate amount of credit facility/facilities provided under the terms of this Agreement, and any other outstanding amounts thereunder;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Financing Documents"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Application Form, this Agreement, the Sanction Letter, and all other deeds, instruments, and agreements including security documents of any nature that have been/are to be executed between the Parties, or with any third parties in relation to the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

// addFooter();
// doc.addPage();
// addLogo();
// drawBorder();

// Continue with bold and normal text
doc.font('Helvetica-Bold')
   .text('"Facility Agreement" or "Agreement"', { continued: true })
   .font('Helvetica')
   .text(
      ` means this agreement, all Schedules and amendments to this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   

doc.font('Helvetica-Bold')
   .text('"Guarantor"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the Person(s) as more particularly mentioned in the Schedule, providing guarantee to secure the Outstanding Amount and for the due performance of the terms and conditions of this Agreement;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica-Bold')
   .text('"Governmental Approval"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean any consent, approval, authorization, waiver, permit, grant, franchise, concession, agreement, license, certificate, exemption, order registration, declaration, filing, report, or notice of, with or to any Governmental Authority,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

   doc.font('Helvetica-Bold')
   .text('"Governmental Authority"', { continued: true })
   .font('Helvetica')
   .text(
      ` means any:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(0.5);

// Point a
doc.text(
   `a) government (central, federal, state or otherwise) or sovereign state and`,
   { indent: 60, align: 'justify', lineGap: 5,  }
)
   .moveDown(0.5);

// Point b
doc.text(
   `b) any governmental agency, semi-governmental or judicial or quasi-judicial or administrative entity,\n department or authority, or any political subdivision thereof, including without limitation, any stock exchange\n or any self-regulatory organization, established under any Applicable Law,`,
   { indent: 60, align: 'justify', lineGap: 5,continued: false }
)
   doc.moveDown(1);

   doc.font('Helvetica-Bold')
.fontSize(9)

   .text('"Instalments"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the amount of payment necessary to amortize the Facility with Interest (rounded off to the next rupee) with in such period as may be determined in the Repayment Schedule,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);
   doc.font('Helvetica-Bold')
   .text('"Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` means the interest payable on the Facility at the Applicable Interest Rate, including the Pre-Instalment Interest payable by the Borrower to the Lender at Applicable Interest Rate as specified in the Schedule hereunder,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );


      
      
      // addFooter();

  //-------------------------------------------------new page ------------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();

doc.moveDown(7)
// doc.moveDown()





doc.font('Helvetica-Bold')
.fontSize(9)
   .text('"Market Disruption Event"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean happening of an event which in the opinion of the Lender would make it unviable for the Lender to continue the Loan/Facility,`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Outstanding Amounts"', { continued: true })
   .font('Helvetica')
   .text(
      ` means at any time all the amounts payable in relation to the Facility by the Borrower to the Lender, pursuant to the terms of the Financing Documents, including the following amounts:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.text(
   `a) The principal amount of the Facility and Interest there on.`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) All dues payable by the Borrower, as reflected in the books and records maintained by the Lender in its\n normal course of business from time to time.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) All other moneys, debts, and liabilities of the Borrower, including indemnities, liquidated damages, costs,\n Charges, expenses, and fees and interest incurred under, arising out of or in connection with the Financing\n Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) Any and all sums expended by the Lender in order to preserve any Security; and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `e) Any and all costs, expenses, fees, and duties for the enforcement and collection of any amounts due\n under the Financing Documents, including expenses of enforcement and realization of the Security\n and costs and expenses set out in Clause 15 (Costs, Charges, Expenses and Stamp Duty) hereto.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );






doc.font('Helvetica-Bold')
   .text('"Payment Instrument(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the instrument as specified by the Lender in the Schedule hereunder, including but not limited to ECS, NACH, digital or electronic payments, money transfer through mobile applications and PDCs, by which the Borrower shall make the payment of Outstanding Amounts to the Lender.“Person(s)” shall mean any natural person or legal entity whether incorporated or not, limited or unlimitedliability company, body corporate, co-operative society, corporation, partnership (whether limited or unlimited), proprietorship, society, HUF, trust, union, association or association of persons, body of individuals, government or any agency there of, or any other entity that may be treated as a person under the Applicable Law; “Post Date Cheque(s)” or “PDC(s)” shall mean the postdated cheque(s) issued in favor of the Lender to ensure continuity of repayment by the Borrower under the Facility;`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the interest payable on the disbursed amount, at the Applicable Interest Rate, for the period commencing from the relevant disbursement date to the date immediately prior to the commencement of Repayment, payable by the Borrower on the Pre-Instalment Interest Date(s).`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   
   doc.font('Helvetica-Bold')
   .text('"Pre-Instalment Interest Payment Date(s)"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the date, if any, which is specified in the Schedule on which the Borrower shall pay the Pre-Instalment Interest;.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   doc.font('Helvetica-Bold')
   .text('"Prepayment Statement"', { continued: true })
   .font('Helvetica' )
   .text(`or`,{ continued: true })
   .font('Helvetica-Bold')
   .text('"PForeclosure Statement"', { continued: true })
   .font('Helvetica' )
   .text(
      `  shall mean the statement which shall be sent by the Lender to the Borrower, on providing the written consent as per Clause 6.3 hereunder, which statement shall contain the terms and conditions of the prepayment of the Outstanding Amount, or any part thereof by the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .font('Helvetica-Bold' )
   .text('"Purpose"',{ continued: true})
   .font('Helvetica' )
   .text(
    `  shall have the meaning as specified in the Schedule.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .font('Helvetica-Bold' )
 .text('"Receivables"',{ continued: true})
 .font('Helvetica' )
 .text(
  ` shall mean the receivables as more particularly described under the Schedule.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)


   

doc.font('Helvetica-Bold')
   .text('"Repayment"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the repayment and/or the prepayment of the principal amount of the Facility, interest thereon, Additional Interest, costs and other charges, premium, fees or other dues payable in accordance with this Agreement. The words “Repay” and “Repaid” shall be construed accordingly.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica-Bold')
   .text('"Repayment Schedule"', { continued: true })
   .font('Helvetica')
   .text(
      ` shall mean the manner in which the Repayment shall be made by the Borrower including details like due dates, installment amount etc. prepared in line with the details specified in the Schedule to this Agreement as may be revised from time to time and communicated to the Borrower.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );






// addFooter();
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Restricted Party"', { continued: true })
   .font('Helvetica')
   .text(
      `means a person that is: (i) listed on, or owned or controlled by a person listed on, or acting on behalf of a person listed on, any Sanctions List; (ii) located in, incorporated under the laws of, or owned or (directly or indirectly) controlled by, or acting on behalf of, a person located in or organised under the laws of a country or territory that is the target of country-wide or territory-wide Sanctions; or (iii) otherwise a target of Sanctions ("target of Sanctions" signifying a person with whom a US person or other national of a Sanctions Authority would be prohibited or restricted by law from engaging in trade, business or other activities); "Sanctions" means the economic sanctions laws, regulations, embargoes or restrictive measures administered, enacted or enforced by: (i) the United States government; (ii) the United Nations; (iii) the European Union; (iv) the United Kingdom; or (v) the respective governmental institutions and agencies of any of the foregoing, including,without limitation, the Office of Foreign Assets Control of the US Department of Treasury ("OFAC"), the United States Department of State, and Her Majesty's Treasury ("HMT") or (vi) RBI or any other Indian authority (together the
`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions Authorities"');

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Sanction Letter"', { continued: true })
   .font('Helvetica')
   .text(
      `means the sanction letter as mentioned in the Schedule, issued by the Lender and accepted by the Borrower regarding the sanction of the Facility, as may be amended, modified, varied and supplemented including, any subsequent sanction letter(s) issued by the Lender regarding the Facility from time to time;
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Sanctions List"',{continued: true })
   .font('Helvetica')
   .text(
      `means the "Specially Designated Nationals and Blocked Persons" list maintained by OFAC, the Consolidated List of Financial Sanctions Targets and the Investment Ban List maintained by HMT, or any similar list maintained by, or public announcement of Sanctions designation made by, any of the Sanctions Authorities.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Security"',{continued: true })
   .font('Helvetica')
   .text(
      `shall have the meaning ascribed to it under clause 8.1 of this Agreement.
`,
      { align: 'justify', indent: 40, lineGap: 5,  }
   )
   .font('Helvetica-Bold')
   .text('"Security Interest"',{continued: true })
   .font('Helvetica')
   .text(
      `means (i) any mortgage, charge (whether fixed or floating), pledge, lien, hypothecation, assignment, deed of trust, security interest or other Encumbrance of any kind securing, or conferring any priority of payment in respect of, any obligation of any Person, including without limitation any right granted by a transaction which, in legal terms, is not the granting of security but which has an economic or financial effect similar to the granting of security under Applicable Law, (ii) any voting agreement, interest, option, right of first offer, refusal or transfer restriction in favour of any Person, and/or (iii) any adverse claim as to title, possession or use;

`,
      { align: 'justify', indent: 40, lineGap: 5, }
   );

   doc.font('Helvetica-Bold')
.fontSize(9)
.text('"Security Provider"', { continued: true })
   .font('Helvetica')
   .text(
      `means the Person(s) who provide(s) security in respect of the Facility, as more particularly described under the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Taxes"', { continued: true })
   .font('Helvetica')
   .text(
      `means any present or future tax, levy, duty or other charge of a similar nature (including any penalty or interest payable on Escrow Account or any failure to pay or delay in paying the same), now or hereafter imposed by law by any Governmental Authority.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"Tenor"', { continued: true })
   .font('Helvetica')
   .text(
      `means the period specified in the Schedule.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )
   .font('Helvetica-Bold')
   .text('"GROW MONEY CAPITAL PVT LTD Reference Rate"', { continued: true })
   .font('Helvetica')
   .text(
      `shall mean the percentage rate of interest per annum decided by the Lender from time to time and announced/notified by the Lender as the GROW MONEY CAPITAL PVT LTD Reference Rate on its website or otherwise as the case may be.
`,
      { align: 'justify', indent: 40, lineGap: 5, }
   )


// addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)

   .text('1.2 INTERPRETATION', { align: 'left' })

doc.font('Helvetica')
   .text(
      `In this Agreement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `
      (a) Unless the context otherwise requires reference to a Recital/Clause and/or a Schedule of this Agreement,
       all of which constitute an integral and operative part of this Agreement.
      (b) Headings to parts, clauses and paragraphs are for convenience only and do not affect the interpretation of
       this Agreement.
      (c) Reference to any statute or statutory provision or order or regulation made there under shall include
       references to that statutes, provision, order or regulation as amended, modified, re-enacted or replaced 
       from time to time whether before or after the date hereof.
      (d) Reference to any document includes an amendment to that document, but disregarding any amendment
       made in breach of this Agreement.
      (e) Reference to an “amendment” includes a supplement, modification, novation, replacement or
       re-enactmentand “amended” is to be construed accordingly.
      (f) Unless the context otherwise requires, words denoting the singular shall include the plural and vice
       versa, and words denoting any gender include all genders.
      (g) Reference to the word “include” or “including” shall be construed without limitation.
      (h) References to a “person” or “Person” shall include that Person’s successors in title, executors, permitted
       transferees and permitted assignees and references to a Person’s representatives shall be to its officers,\n employees, legal or other professional advisers, sub-contractors, agents, attorneys and other duly authorised \nrepresentatives.
      `,
      { align: 'justify', indent: 40, }
   );
   doc.font('Helvetica')
   .text(`(i) Words`,{indent: 40,continued:true})
   .font('Helvetica-Bold')
   .text(`"hereof", “herein”, “hereto”, “hereunder”` ,{ continued:true,align: 'justify', indent: 40, });
   doc.font('Helvetica')
   .text(` or similar terms used with reference to a specific clause\n in this Agreement shall refer to such clause in this Agreement and when used otherwise than\n in connection with specific clauses shall refer to this Agreement as a whole.
    ` ,{ align: 'justify', indent: 40, lineGap: 5 });
    doc.font('Helvetica')
   .text(`(j) In the computation of periods of time from a specified date to a later specified date, the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 });

    doc.font('Helvetica-Bold')
    .text(`"from" ` ,{ continued:true,align: 'justify', indent: 40, });
    doc.font('Helvetica')
    .text(` and ` ,{ align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on" ` ,{ continued:true,align: 'justify', indent: 40, })
    .font('Helvetica')
    .text(` mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"from and including" ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"commencing on and including”, respectively" ` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`, and the words ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`“to”, “until” ` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(`each mean ` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"to but not including", "until but not including"` ,{ align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` and` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"ending on but not including"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` respectively ` ,{align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(k) Unless otherwise specified, whenever any payment to be made or action to be taken under this Agreement,\n is required to be made or taken on a day other than a Business Day, such payment shall be made,\n or action be taken on the\n immediately following Business Day.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(l) Where a wider construction is possible, the words` ,{continued:true, align: 'justify', indent: 40, lineGap: 5 })
    .font('Helvetica-Bold')
    .text(`"other” and “otherwise"` ,{ continued:true,align: 'justify', indent: 40, })
    doc.font('Helvetica')
    .text(` shall not be construed ejusdem\n generis with any foregoing words.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica')
    .text(`(m) A time of day is a reference to India time.` ,{ align: 'justify', indent: 40, lineGap: 5 })
    doc.font('Helvetica-Bold')
.fontSize(9)

   .text('2. THE FACILITY AND PURPOSE', { align: 'left' })

doc.font('Helvetica')
   .text(
      `The Borrower hereby agrees to borrow, and the Lender hereby agrees to lend the Facility to the Borrower, subject to the terms and conditions of the Financing Documents. The Borrower hereby confirms that it shall utilize the Facility only for the Purpose as mentioned in the Schedule. If in the opinion of the Lender (which opinion shall be binding and conclusive against the Borrower) the Facility is not used for the Purpose (provided that the Lender shall not be bound to enquire as to, or be responsible for, the use or application of any funds advanced under the Facility), the Lender shall have the right to declare it as an Event of Default.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
    // addFooter();

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
   .fontSize(9)
   .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.1 Subject to the conditions mentioned in this Agreement, the Lender may, at its sole and absolute discretion,\n disburse the Facility or any part thereof as per disbursement request made by the Borrower to the Lender
       any time during the Tenor of Facility. The Borrower shall ensure the following before making any request 
       for the Disbursement:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.text(
   `a) no actual/potential Event of Default has occurred, is in existence and/or is continuing;`,
   { indent: 60, align: 'justify', lineGap: 5 }
)
   .text(
      `b) all the representations and warranties are correct, complete and are in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) all Conditions Precedent have been fulfilled;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
    `d) post disbursal conditions with respect to the previous Disbursement/s have been met (if any);`,
    { indent: 60, align: 'justify', lineGap: 5 }
 )
 .text(
  `e) he Security has been validly created in form and substance acceptable to the Lender as per theterms of
      the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
)
.text(
  `f) he Borrower is in compliance with the terms and conditions of the Financing Documents;`,
  { indent: 60, align: 'justify', lineGap: 5 }
);
 

   // Page 5: Continue with Disbursement and Conditions


// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.2 Not withs tanding any other provision hereof, the Lender, may at its sole discretion, cancel first or any 
      further/subsequent disbursement of the Facility if, in the reasonable opinion of the Lender:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) An Event of Default is likely to occur/has occurred/is continuing/threatened/which may result from
      such disbursement or if it becomes unlawful for the Lender to disburse or continue the Facility;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) Any representation and/or warranty is not correct, complete or is not in full force and effect;`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `c) Any event has occurred/is continuing which has/could result in a material adverse effect or constitute 
       a Market Disruption Event; or`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `d) An Applicable Law restrains, prevents or imposes adverse conditions upon the transactions contemplated
       by the Financing Documents.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   );

// addFooter();

// // Page 6: Continue Disbursement and Conditions
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.3 The fulfilment or satisfaction of any Condition Precedent may be waived or deferred in writing by the
       Lender, at its sole discretion, following a written request from the Borrower setting out:`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
      `a) the Condition Precedent in respect of which the Borrower seeks a waiver/deferment, and`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .text(
      `b) the reasons for seeking such waiver/deferment.`,
      { indent: 60, align: 'justify', lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `3.4 The Borrower shall promptly give a written notice to the Lender, of the satisfaction of the Conditions Precedent
       along with documentary evidence of such satisfaction by issuance of a Conditions Precedent satisfaction
       notice and if it becomes aware of any event/circumstance which will/may prevent such 
       satisfaction, it shall forthwith notify the Lender in writing.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

// addFooter();

// // Page 7: Continue with Conditions Precedent and Facility Agreement
// doc.addPage();
// addLogo();
// drawBorder();

// doc.font('Helvetica-Bold')
//    .text('3. DISBURSEMENT AND CONDITIONS (Continued)', { align: 'left' })
//    .moveDown(1);

doc.font('Helvetica-Bold')
   .text(
      `3.5 Conditions Precedent`,
      { align: 'left', indent: 40, lineGap: 5 }
   )

doc.font('Helvetica')
   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to them
      respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );
   

// addFooter();

// ---------------------------------------new page-----------------------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7)

doc.font('Helvetica')
.fontSize(9)

   .text(
      `The Borrower and the Lender both shall fulfill each of the Conditions Precedent (as applicable to
      them respectively) before the Disbursement within the timelines as prescribed under this Agreement.`,
      { align: 'justify', indent: 40, lineGap: 5 }
      
   )
   .moveDown(1);
   

doc.font('Helvetica')
   .text(`3.5.1 The Borrower assures to the Lender that it (or in case the of under construction immovable property , the
seller/builder of such immovable property will transfer the marketable title in favour of Borrower by way
ofconveyance) has absolute, clear and marketable title to the immovable property including free from
Encumbrance, any liability, charge/lien or from any litigation/court decree whatsoever, to be mortgaged by
it as Security for the Facility and Lender is free to get the title of the immovable property checked/verified in
the manner it deems fit at the cost and risk of the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 })
.moveDown(1);




doc.font('Helvetica')
   .text(
      `3.5.2 The obligation of Lender to make any Disbursement under the Financing Documents shall also be subject to
       the following Conditions Precedent:.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   .text(
      `The Borrower acknowledges that the Facility is granted subject to the terms and conditions specified in 
       this Agreement and any subsequent amendments or supplements made in writing by the Lender.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1)
   .text(
    `(a) Borrower shall meet the minimum creditworthiness requirements as may be specified by Lender. For this
      purpose, the Borrower will provide all the information and assistance required by the Lender so that the
      Lender may conduct any inquiries, as deemed fit and proper in the Lender’s sole discretion, in this regard. .`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) No Event of Default has occurred or is likely to occur.`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) The Borrower shall have satisfied the Lender about the (i) utilisation of the proceeds of any prior
         disbursement and (ii) proposed utilization of the proceeds of the Disbursement after the sanction 
         of Facility,within the time frame specified by Lender, along with the request for release of part 
         of the funds needed by the Borrower for the Purpose..`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d) No extraordinary or other circumstances shall have occurred which shall make it improbable for 
        the Borrower to fulfill its obligations under the Financing Documents.`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)The Borrower/Security Provider shall prior to the disbursement of the Facility have executed all security
documents and created perfect Security including but not limited to registration of charge with the
concerned registrar of sub-assurances in the form and manner acceptable to the Lender and shall ensure
appropriate filing of charge, if any, along with proper stamp duty being paid on duly executed instruments of
Security.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) The Borrower shall satisfy the Lender to the effect that there is no action, suit, proceeding or investigation
pending or threatened by or against the Borrower, Guarantor or Security Provider, before any court of lawor
Governmental Authority or any other competent authority which might have material adverse effect on the
affairs of the Borrower or the Guarantor or Security Provider.`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `3.5.3 Not with standing anything contained herein, in case any disbursement has been made, the Borrower shall
continue to be under obligation to repay along with interests and costs, the entire amount so disbursed in
terms of the Financing Documents.`,
            { align: 'justify', indent: 40, lineGap: 5 });


// addFooter();

//-------------------------------------New page ------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
   .text(
      `3.5.4 The Borrower, whenever required by the Lender, shall provide the following, in a form and substance
satisfactory to the Lender:
`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .moveDown(1);

doc.font('Helvetica')
   
   .moveDown(1)
   .text(
    `(a)  Evidence that all consents, resolutions, approvals, authorizations and permissions required for availing ofthe
Facility or for creation of Security in favour of the Lender have been obtained;.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `(b) Certified true copies of the audited accounts of the Borrower;`,
  { align: 'justify', indent: 40, lineGap: 5 })
  .text(
    `(c) Evidence that all compliance under the Companies Act, 2013 or any other law as maybe applicable to the
constitution of Borrower, has been adhered to;
`,
    { align: 'justify', indent: 40, lineGap: 5 })
    .text(
      `(d)  Evidence that all duly stamped Financing Documents shall have been properly stamped, executed and have
come into force as per their respective terms duly registered with the sub registrar of assurances or any
other competent authority, in favour of the Borrower and the necessary security can be created in favour of
Lender in the form and manner as acceptable to the Borrower;
`,
      { align: 'justify', indent: 40, lineGap: 5 })
      .text(
        `(e)Evidence to show insurance cover on the Security has been obtained to the satisfaction of the Lender;.`,
        { align: 'justify', indent: 40, lineGap: 5 })
        .text(
          `(f) Evidence, as may be deemed necessary by Lender, including but not limited to an undertaking and indemnity
that the Facility or any part thereof shall be used only for Purpose as disclosed by the Borrower;
`,
          { align: 'justify', indent: 40, lineGap: 5 })
          .moveDown()
          .text(
            `(g) Such other documents as may be required by the Lender.`,
            { align: 'justify', indent: 40, lineGap: 5 })
            .moveDown()
            doc.text(
          `The Borrower also hereby agrees and undertakes to pay the complete stamp duty due on Financing Documents or any other document related thereto and in the event of any deficiency or default thereof, the Borrower shall indemnify and keep the Lender indemnified from and against any actual payment, losses and cost that the Lender has or may have incurred towards the same within `,
              { align: 'justify', indent: 40, lineGap: 5, continued: true }
           );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand. Borrower undertakes to regularize the documents, if required, by the respective courts or collector of stamps, by paying the actual difference in stamp duty and the amount of penalty as may be applicable. In the event, any litigation is initiated under this Agreement, Borrower agrees to indemnify the Lender from any actual and direct loss, cost, expenses that it may incur or suffer in defending the litigation within `,
                 { align: 'justify', indent: 40, lineGap: 5, continued: true }
              );
           
           doc.font('Helvetica-Bold')
              .text('2 (two)', { continued: true })
              .font('Helvetica')
              .text(
                 ` days of demand.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              );
              doc.moveDown();

              doc.font('Helvetica-Bold')
              .text('3.6 Amortisation', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `3.6.1 The Borrower will amortise the Facility strictly as stipulated in the Schedule, subject to any other changes in
such amortisation as communicated later in writing by Lender to the Borrower. However, in the event of
delay or advancement, for any reason whatsoever, in the disbursement of Facility, the Due Date of payment
of first Instalment shall in such case be the corresponding day of the following months to the day currently
stated in the Schedule.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `3.6.2 The Borrower shall also pay to Lender, the Pre-Instalment Interest as maybe applicable on the Facility under
the terms of this Agreement..`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `3.6.3 The Borrower agrees that the amount shall be remitted to Lender on each and every Due Date of the
Instalments. In the event of any dishonour of Payment Instrument, the Borrower agrees to pay a dishonour
charge as mentioned in the Sanction Letter, in addition to any Additional Interest that may be levied by
Lender as per its discretion`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           



    // addFooter();

    //-----------------new page-----------------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica')
     .fontSize(9)
    .text(
      `3.6.4 In the event of any variation in the date of payment of Instalments/the amount of Interest, principal or
Instalments/the numbers thereof, the Borrower undertakes to forthwith issue fresh PDCs/ECS/such other
payment instruments as may be required by Lender`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `3.6.5 Notwithstanding anything herein, Lender shall always have the right to review and reschedule the
repayment terms of the Facility or of the outstanding amount thereof in such manner and to such extent as
Lender may decide. In such event/s the Borrower shall repay the Facility or the Outstanding Amount
thereof as per the revised Schedule as may be determined by Lender in its sole discretion`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 .text(
  `3.6.6 In case any amount is prepaid by the Borrower, unless otherwise decided by the Lender in its discretion, the
same shall be adjusted/appropriated towards the Pre-Instalment Interest, other applicable interest,
principal outstanding and the balance towards other charges under the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.moveDown();

doc.font('Helvetica-Bold')
              .text('4. INTEREST', { align: 'left' })
              .font('Helvetica')
              doc.moveDown()

              .text(
                 `4.1 The Borrower shall pay Interest to the Lender in respect of the principal amount of the Facility outstanding
from time to time, and on all fees, costs, commissions, Charges and other amounts due under or in respect of
this Agreement under the Facility at the Applicable Interest Rate. It is hereby clarified that the Lender may, in
its discretion among other alternatives, require the Borrower to pay upfront the Pre- Instalment Interest at
Applicable Interest Rate or the Pre-Instalment Interest may be deducted from the amount of the Facility
disbursed.`,
                 { align: 'justify', indent: 40, lineGap: 5 }
              )

              .text(
                `4.2 Interest shall be payable at Applicable Interest Rate (or such other rate as may be notified by the Lender
from time to time) through such Payment Instruments and in the manner specified and at such intervals
specified under the Schedule.`,
                { align: 'justify', indent: 40, lineGap: 5 }
             )
             .text(
              `4.3 The Applicable Interest Rate for the Facility provided on floating rate of interest shall be calculated with
reference to the GROW MONEY CAPITAL PVT LTD Reference Rate and shall comprise of GROW MONEY
CAPITAL PVT LTD Reference Rate plus margin (as may be agreed with the Lender from timeto time). It is
hereby clarified that the GROW MONEY CAPITAL PVT LTD Reference Rate and the Applicable Interest Rate
may fluctuate/vary from time to time or as may be determined by the Lender in its absolute discretion.`,
              { align: 'justify', indent: 40, lineGap: 5 }
           );
           doc.font('Helvetica-Bold')
           .text(
            `4.4 In the event of default on the part of the Borrower in the payment of any sum due hereunder, in any
manner whatsoever or the Borrower committing any breach or default of any condition of this
Agreement or Financing Document, the Borrower shall pay to the Lender, Additional Interest at the
Additional Interest Rate which will be calculated on a daily basis over and above the Applicable
Interest Rate to be charged on the overdue Installment(s). Such interest shall be payable on and from
the date of default to and including the date on which such delay or defaultis rectified (“Additional
Interest”). The Lender’s right to claim such Additional Interest shall be without prejudice and in
addition to the Lender’s right to take any other action available to it under the terms of this
Agreement or at law in respect of such event of default.`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );

         doc.font('Helvetica')
           .text(
            `4.5 In the event of revision of Applicable Interest Rate, the Lender shall notify the same to Borrower, such
notification shall form a part of this Agreement. In the event the Borrower does not agree to such revision,the
Borrower shall forthwith repay the Outstanding Amount within 30 (thirty) days from the date of intimation.
In case if such repayment is not forthcoming within the said period, the Borrower shall be liableto service the
Facility in accordance with the revised interest rate`,
            { align: 'justify', indent: 40, lineGap: 5 }
         );



    // addFooter();
//-------------------new page--------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
  
    doc.moveDown(7);
     doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `4.6 The Borrower acknowledges that any sums, interest, default amount including but not limited to
(i) the Prepayment Charges and (ii) the Additional Interest, are reasonable and that they represent
genuine pre-estimates of the loss which would be incurred by the Lender in the event of nonpayment or 
default by the Borrower in accordance with the Financing Documents. The Borrower waives any right it 
may have to raise any claim/defence in this regard.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )
   .text(
    `4.7 Interest, Additional Interest and all other charges shall accrue from day to day on the actual number
of days elapsed and shall be calculated on an actual day count basis, i.e., actual number of days
elapsed divided by the actual number of days in the year`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica')
 .text(
  `4.8 The Borrower confirms, agrees and acknowledges that it has perused and understood the Lender’s method
of calculating the Applicable Interest Rate and further agrees and undertakes to abide by the same without
any demur/objection.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `4.9 The Borrower acknowledges that the Facility provided under this Agreement is for a commercial transaction
and the Borrower waives any defences available under usury or other laws relating to the charging of
interest.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

// point 5

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5. DISBURSEMENT`,
      { align: 'left' }
   );
   doc.moveDown();
   doc.font('Helvetica')
   .text(
    `The Facility can be disbursed by the Lender in one or more tranches in its sole and absolute discretion,
subject to the terms contained in the Sanction Letter and this Agreement. The Disbursement can be doneby
the Lender either in favour of/in the bank account of the Borrower or in favour of/in the bank account ofsuch
person/entity who/which is specified by the Borrower in its request for Disbursement to the Lender.
Nothing contained herein shall be deemed to be a guarantee or an assurance on behalf of the Lender
regarding Disbursement of the Facility.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )
 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.1 Schedule of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
 .text(
  `Subject to fulfilment of the Conditions Precedent and at the Lender’s discretion, the Facility shall be
disbursed in single or in multiple tranches as more specifically detailed in the Sanction Letter.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.2 Mode of Disbursement`,
      { align: 'left' }
   );
 doc.font('Helvetica')
.text(
  `All payments to be made by the Lender to the Borrower under this Agreement shall be deposited in the bank
account which is maintained by the Borrower which maybe specified in the disbursement request, by way of
Real Time Gross Settlement (RTGS)/Cheque/s duly crossed and marked “A/c Payee Only” or such other
manner as specified by the Lender in the Schedule and the collection charges, if any, in respect of 
RTGS/cheque(s) and/or such other instruments as specified in the Schedule will have to be borne by the
Borrower. The Interest on the Facility will begin to accrue in favour of the Lender from the date on which the
Disbursement is done by the Lender by way of making/issuance of the RTGS/cheque(s) and/or such other
instruments as specified in the Schedule irrespective of the time taken for transit or for collection/realization
thereof. Without prejudice to anything contained herein, if necessitated by prevailing circumstances, the
Lender shall be at liberty to use any other method or mode for disbursement underthis Agreement and if the
same is not rejected by Borrower, then such disbursement shall be deemed to be accepted disbursement and
have same effect as any other Disbursement under the Agreement.
`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//------------------------new page-------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `5.3 Other Charges`,
      { align: 'left' }
   )
   
   .text(
    `The Borrower shall, on or before the date of the first drawdown/disbursal of the Facility, pay to the
Lender the Charges as specified by the Lender from time to time. The Borrower hereby agrees that
any amount outstanding from his/her/its any other loan/facility with the Lender may be, deducted
and/or adjusted from amount disbursed or held with Lender under this Agreement.`,
    { align: 'justify', indent: 40, lineGap: 5 }
 ).moveDown();

 doc.font('Helvetica-Bold')
     .fontSize(9)
    .text(
      `6. REPAYMENT / PREPAYMENT
`,
      { align: 'left' }
   ).moveDown();
 doc.font('Helvetica')
 .text(
  `6.1 Except as otherwise agreed by the Lender, the Borrower shall repay the amounts under the Facility
outstanding from time to time on each and every Due Date in an amount equal to the Instalment as specified
in the Repayment Schedule provided that:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `a) The Facility shall be repaid in full by the final repayment date as specified in the Repayment Schedule 
  through such payment instruments as specified in the Schedule;`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `b) The Lender shall be entitled to demand immediate repayment of the entire amount of the Facility
outstanding if any portion of the principal amount of the Facility or any interest due thereon is not paid as
and when it is due to be paid; and`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `c) The Borrower shall repay the principal amount of the Facility along with interest & costs under the
Agreement free from and clear of any deduction and/or set off on any account whether by operation of law or
otherwise and if any such deductions are required by operation of law or otherwise, then same shall be
entirely borne by the Borrower. It is hereby clarified that in case the Borrower has been sanctioned multiple
facilities, there will not be any setoff without the prior written consent of the Lender.`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown()
.text(
  `6.2 The Borrower shall be solely responsible to timely pay all costs, Charges and expenses of the Lender
promptly as and when required to do so by the Lender and the Lender shall be under no obligation to
provide the Borrower with any notice, reminder or other intimation to the Borrower regarding its obligation
to pay the same.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica-Bold')
.text(
  `6.3 The Borrower may become entitled to prepay the Facility through such Payment Instruments as
specified in the Schedule only with the prior written consent of the Lender (extent of which may or
may not be granted by the Lender). If acceptable to Lender, then any prepayment shall be done only
after the expiry of such period as maybe specified in this regard under the Sanction Letter, by giving
not less than 7 (seven) days’ notice to the Lender and provided that any such prepayment shall be
made subject to payment of any prepayment costs (“Prepayment Charges”) as specified herein or in
Sanction Letter. The Lender shall provide to the Borrower a Prepayment Statement and the Borrower
shall prepay the whole or any part of the Facility strictly in accordance with the Prepayment
Statement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.text(
  `6.4 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility, the Lender shall promptly
notify the Borrower upon becoming aware of that event and the Lender shall be at liberty to not make any
further advancement of amount under Facility and it shall be entitled to call in the entire Outstanding
Amounts forthwith and the Borrower shall on such date as the Lender may specify, without demur or dispute
whatsoever, repay the Outstanding Amount owing to the Lender in respect of the Facility.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);




// addFooter();

//--------------new page-------------------------------------
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `7. INCREASED COSTS`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `If, by reason of (i) any change in law or in its interpretation or administration and/or (ii) compliance with
any request/requirement of RBI or any other authority, which request/requirement affects the manner in
which the Lender is required to or does maintain capital resources or reserves having regard to Lender’s
obligations hereunder and to amounts owing to it hereunder, the Lender:`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `(a) incurs a cost as a result of Lender having entered into/complying with and/or performing
   its obligations under this Agreement; or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(b) becomes liable to make any payment on account of tax or otherwise (not being a tax imposed on
the net income of the Lender) on or calculated by reference to the Facility sanctioned or to be
sanctioned by the Lender hereunder and/or to any sum received or receivable by it hereunder,
then the Borrower shall, from time to time on demand of the Lender, promptly pay to the Lender
amounts sufficient to indemnify the Lender against, as the case may be (1) all such costs as above,
( 2) such reduction in such rate of return (or such proportion of such reduction as is, in the
opinion of the Lender, attributable to its obligations hereunder), 
(3) such increased cost (or such proportion of such increased cost as is, in the opinion of the Lender,
 attributable to its funding or maintaining an advance hereunder) or
`,
  { align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(4) such liability. The Lender shall also be entitled to recover such increased cost, reduction in rate of return
and any such liability incurred by the Lender by deducting an amount equivalent to the same from the
subsequent disbursal or drawdown to be made to the Borrower.
`,
  { align: 'justify', indent: 50, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `8. SECURITY`,
  { align: 'left' }
).moveDown();

doc.font('Helvetica')
.text(
  `8.1 In consideration of the Lender making available the Facility and to secure the repayment of the Outstanding
Amounts, the Borrower agrees that the Security Interest shall be created in favour of the Lender in the form
and manner satisfactory to the Lender on the asset/s as more specifically mentioned in the Schedule of the
Agreement     `,
  { align: 'justify', indent: 40, lineGap: 5,continued:true }
)
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
  `            (“Security”).`,
  { align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.text(
  `8.2 The Borrower hereby agrees that it shall, at all times during the Tenor of the Facility, ensure that the Security
provided by the Borrower or Security Provider (other than Borrower) under this Agreement is of such value
as is sufficient to meet the security cover requirements of the Lender as specified in the Schedule. In the
event either the value of the Security deteriorates and/or the Lender advances further sum(s) to the
Borrower under this Agreement such that the value of the Security provided by the Borrower under this
Agreement does not meet the security margin requirements of the Lender, then the Borrower shall deposit
with the Lender, additional security in the form of cash or such other securities as are acceptable to the
Lender, failing which the Lender may at its discretion sell, dispose of, or realise any or all of the Security
without being liable for any loss or damage or diminution in value of the Security.`,
  { align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `8.3 The Security, if any created/to be created by the Borrower/Security Provider in favour of the Lender shall be
released by the Lender on complete payment of the Outstanding Amounts and/or any other outstanding
dues of the Borrower/s (whether a Borrower or a Guarantor) to any of its affiliates or group companies.`,
  { align: 'justify', indent: 40, lineGap: 5 }
);


// addFooter();

//-----------------------------new page-------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
    .text(
      `9. CO-LENDING ARRANGEMENT`,
      { align: 'left' }
    ).moveDown();
    doc.font('Helvetica')
   .text(
      `9.1 Without prejudice to anything contained in this Agreement, the Lender reserves the right to enter into a co-
      lending arrangement    `,
      { align: 'justify', indent: 45, lineGap: 5, continued: true }
   );

doc.font('Helvetica-Bold')
   .text(
      `              ("Arrangement")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      ` in pursuance to and subject to applicable guidelines/circular`,
      { align: 'justify', indent: 40, lineGap: 5 })

       
      .text(`/notification issued by the RBI, from time to time, with anyone of the banks or financial institutions of 
        its choice with which the Lender has entered into a formal agreement for co-lending of the Facility(ies)        `,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

doc.font('Helvetica-Bold')
   .text(
      ` ("Bank or Lender 2")`,
      { align: 'justify', indent: 40, lineGap: 5, continued: true }
   );

doc.font('Helvetica')
   .text(
      `, therefore whole or a part of the disbursed Facility amount might be taken over by the 
        concerned bank in its books as per the agreed terms of Arrangement by and between Lender and Bank.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   );

   doc.font('Helvetica')
   .text(
      `9.2 If Bank and Lender enters into an Arrangement with respect to Facility under this Agreement then
subsequent to Bank taking its share of Facility amount in its books, the Bank for all technical, legal and
operational purposes shall become a co-creditor of the Borrower in form of a co-lending partner of Lender.
The Borrower is aware about the possibility of Arrangement taking place between Lender and Bank. It is
clarified that subject to the terms of the Arrangement all the duties, obligations, rights, benefits and
entitlements of Lender as contained in this Agreement or other Financing Documents, in addition to Lender,
shall also inure to benefit of the Bank, and the extent, manner and form of exercising such duties,obligations,
rights, benefits and entitlements of Bank shall depend upon the understanding between the Lender and Bank
as maybe contained in the Arrangement. The Borrower also has acknowledged all the other probable
implications of such co-lending arrangement on the Facility provided herein and Borrower’s responsibilities
thereof.`,
      { align: 'justify', indent: 40, lineGap: 5 }
   )

   .text(
    `9.3 If the Lender enters into an Arrangement with Bank, then the right to take recovery/legal action or initiate
appropriate legal proceedings against the Borrower on the default by the Borrower under this Agreement or
other Financing Documents and all the remedies available can be exercised jointly or severally by the Lender
and/or Bank, or by the Lender on behalf of the Bank or vice-versa depending upon the terms of Arrangement.
The remedies available to the Lender and Bank under the law, this Agreement or equity shall be in addition to
each other or cumulative. The manner, form and time of exercising the rights or remedies will be as per the
discretion the Lender and/or Bank (as the case maybe).`,
    { align: 'justify', indent: 40, lineGap: 5 }
 )

 .text(
  `9.4 The Borrower unconditionally accepts and acknowledges that it shall abide/comply by/with the instructions
which might be issued by the Lender with respect to the Facility upon Arrangement taking place between
Lender and Bank. The Borrower also unconditionally accepts and acknowledges that Lender may
change/modify any of the terms contained in Schedule I appended hereto by way of an intimation through a
letter or a notice thereof and the Borrower shall duly comply with such letter or notice without any delay or
demur.`,
  { align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `9. CO-LENDING ARRANGEMENT`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `The Borrower undertakes to make payments of all the amount payable to Lender under the Financing
Documents into the Designated Account of the Lender, however, without prejudice to the aforementioned,the
Lender reserves the right to make Borrower enter into an escrow mechanism for such payments and to which
Borrower agrees to as under:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

    


// addFooter();

//-------------------new page----------------------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `10.1 The Borrower can be required to open, establish and maintain the Escrow Account during the entire or part
of Tenor of the Facility with the Account Bank as per terms of this Agreement and/or the Escrow Agreement
or just make the payments of Outstanding Amounts into the Escrow Account, as maybe directed by the
Lender`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.2 If opened, Escrow Account shall not be closed without the prior written approval of the Lender. All costs,
Charges, expenses, fees in connection with the Escrow Account shall be borne by the Borrower.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.3 If required by the Lender, the Borrower shall deposit/transfer all Receivables in the Escrow Account at the
end of the day of receipt of the Receivables`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.4 Subject to the Applicable Law, the Lender shall be the joint signatory in the Escrow Account as per the
Escrow Agreement until the Facility is fully repaid. In the Event of Default and subject to Applicable Law, the
Lender and/or Bank shall become entitled to create charge (by way of lien or otherwise) over the bank
account of Borrower as linked with Escrow Account and utilize the proceeds thereof towards Outstanding
Amounts or any in any other manner as Lender may deem fit.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.5 The Lender and/or Bank at all times reserves the right to make changes into Escrow Agreement and to which
Borrower shall duly comply.`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `10.6 Provided that nothing contained herein or under any other document/s regarding the Arrangement with the
Bank shall be applicable if the Lender does not formally enter into Arrangement with the Bank, in which case
the Borrower shall continue to discharge all its obligations contained in this Agreement or other Financing
Documents, in favour of the Lender alone and the Facility shall be deemed to be provided by a single entity,
i.e., Lender. Unless the details of Bank are specifically mentioned herein or intimated to Borrower through a
separate letter or notice, the Borrower shall always presume that the Lender has not entered into an
Arrangement regarding the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.text(
  `11. CANCELLATION`,
  { align: 'left' }
);
doc.moveDown();
doc.font('Helvetica')
.text(
  `Notwithstanding anything contrary contained in this Agreement:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)
.text(
  `11.1 The Borrower agrees that the Lender shall at any and all time, during the currency of the Facility have an
unconditional right to terminate and/or cancel the un-utilized or un-disbursed portion of the Facility
(whether in part or in full) at its sole discretion as well as withdraw and/or recall the disbursed Facility or
any part thereof on the occurrence of any actual/potential Event of Default whereupon, forthwith all
Outstanding Amounts under the Facility shall immediately become due and payable by the Borrower to the
Lender. Provided, no notice will be given by the Lender to the Borrower, where an Event of Default has
already been declared.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).text(
  `11.2 The Borrower agrees that the Facility shall be repaid upon the happening of a Market Disruption Event and
the Lender can, at any time, at its sole and absolute discretion, terminate, cancel, withdraw or recall the
Facility or any part thereof without any liability and without any obligation to give any reasons whatsoever,
whereupon all Outstanding Amounts under the Facility shall immediately become due and payable by the
Borrower to the Lender forthwith upon demand made by the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


    // addFooter();

    //------------------------new page---------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12. BORROWER’S REPRESENTATIONS AND COVENANTS`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `12.1 Representations`,
{ align: 'left' }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `12.1.1 The Borrower hereby agrees and represents that for so long as any of the Outstanding Amounts are 
  dueand payable, the Borrower shall ensure and confirm that:`,
{ align: 'justify', indent: 40, lineGap: 5 }
)

.text(
  `(i) It is duly organised and validly existing under law and has the requisite legal power and authority to execute
this Agreement and carry out the terms, conditions and provisions hereof and the performanc e by the
Borrower of this Agreement does not and will not violate any Applicable Law, its constitutional documents,
any judgment, order, decree, writ or Governmental Approval or any agreement to which the Borrower is a
party or by which it is bound or any consents, Governmental Approvals or waivers, as the case may be, of any
Person required to give effect to and complete the transactions contemplated hereunder;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ii) The Borrower is carrying out or conducting the Business and shall continue to do so as per Applicable Law
and it will, at all times, comply with and abide by all Applicable Laws;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(iii) The execution, delivery and performance hereof have been duly authorized by all necessary Government
Approvals, permissions, corporate action, consents, etc. under the laws applicable to the Borrower, and the
individual executing this Agreement and other ancillary documents is duly authorized and duty-boundto do
so and other ancillary actions and the agreement so executed and delivered would be legally binding on the
Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) The Borrower and authorized Persons of the Borrower executing this Agreement and other ancillary
documents, confirm that all the representations and warranties made by the Borrower thereunder and all
other Financing Documents and all the information provided to the Lender are true and correct and such
authorized Persons, as the case may be, have checked the correctness of such representations and
warranties;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(v) The Borrower has not taken any action, nor have any steps been taken or legal proceedings of any manner
been initiated or threatened against or notice been received by the Borrower for its incompetency to enter
into a contract, winding-up, dissolution, administration, re-organisation, insolvency, bankruptcy,
appointment of receiver, administrator or other court officer of the Borrower or all of any of its assets,
businesses or undertakings or for the appointment of any provisional liquidator or any interim resolution
professional or resolution professional in terms of the Code;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(vi) There is no restriction, action, suit, proceeding or investigation pending and/or continuing or to the
knowledge of the Borrower threatened by or against the Borrower or the property of the Borrower or its
partners, directors, key managerial personnel, subsidiaries or group companies before any court of law,
Government Authority or other competent authority on account of any due and payable Taxes or other sums
or any other matter which may have a material effect on the affairs of the Borrower, or which may call into
question the validity, enforceability or performance by the Borrower of any or all terms of this Agreement
nor has any of the aforementioned, any knowledge of any existing ground on which any claim, investigation
or proceeding might be commenced;`,
{ align: 'justify', indent: 50, lineGap: 5 }
);



    // addFooter();

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(vii) The Borrower has obtained all Governmental Approvals for availing of the Facility, and creating the Security
and will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(viii) No actual/potential Event of Default has occurred and/or is in existence or continuing;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(ix) All factual and other information provided to the Lender are true and accurate as at a date no earlier thanthe
date on which it was provided;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(x) The Borrower will promptly inform the Lender about any litigation, dispute, or any proposal by aregulatory
body to acquire the Security, or any of it;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xi) The Borrower at any time has not received any notice or intimation regarding insolvency proceedings
initiated against it or it being incompetent to enter into a contract;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xii) No proceeding is pending and/or initiated and/or threatened against the Borrower for or on account of any
Taxes or any other sums, which may be due and payable by the Borrower to the Government of India or to
any State Government or Government Agency;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xiii) Neither the Borrower nor any of its Security Assets is entitled to immunity from suit, execution, attachment
or other legal process initiated by Lender. This Agreement and the other Financing Documents constitutes,
and the exercise of its rights and performance of and compliance with its obligations in relation thereto, will
constitute, private and commercial acts done and performed for privateand commercial purposes; perfectly
binding on the Borrower;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xiv) There is no circumstance in existence, or which is likely to come into existence, which may affect the
enforceability of the Security or transferability of the Security Assets pursuant to enforcement of the
Security;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xv) The audited annual accounts of the Borrower for the year(s) as may be specified by the Lender, have been
prepared as per the applicable accounting principles/standards in force consistently applied and give, in
conjunction with the notes thereto, a true and fair view of the financial condition and position of the
Borrower during the financial year then ended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvi) There has been no material adverse change in the financial condition of the Borrower, nor has any event,
which is/may be prejudicial to the interest of the Lender and/or which is likely to materially and/or
adversely affect the Borrower/Lender to perform all or any of its obligations hereunder, taken place or in the
Borrower’s estimation, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xvii) There are no charges, or liens of whatsoever nature against any of the Borrower’s/Security Provider’s
assets charged and/or agreed to be charged in favour of the Lender;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) No facts, circumstances or events, materially detrimental to the borrowing, the ability of the Borrower to
meet its obligations hereunder and/or in respect of the Facility, and/or the financial condition of the
Borrower, and/or the ability of the Lender to exercise its rights hereunder and/or under the documents
creating the Security and/or to receive due Repayment and payment of the amounts due by the Borrower
under the Facility, has occurred or, in the estimation of the Borrower, is likely to occur;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xix) The Borrower/Security Provider has the interest, right, title or ownership over the assets comprising the
Security and such assets are free from any existing or potential encumbrances; In Event of Default underthis
Agreement, the Lender will be able to enforce such Security without any hinderance or objection fromany
person (whether individual/s or body corporate) including the Borrower or its associated.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();


    //new

    //-------------------------new page -----------------------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xx) Never have the name of the Borrower nor any of Borrower’s directors/associate/partner or key managerial
persons or Guarantor or Security Provider has never appeared in the willful defaulters’ list, orany other list
of defaulters published by competent authorities from time to time;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxi) The Borrower will, at all times, comply with and abide by all Applicable Laws and directions, regulations,
circulars and instructions notified or issued by the concerned regulator from time to time including but not
limited to all labour welfare related and environment protection statutes and provisions. All the
environmental authorisations/permissions required under the Environmental Protection Act 1986 and
other environmental laws in India as applicable in relation to the business and operations of the Borrower
have been obtained and maintained in full force and effect and nothing has occurred or will occur in
future, which might cause such environmental authorization/permission to be revoked, suspended or
amended;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxii) The Borrower shall comply with, and shall conduct its business operations, and maintain its assets,
equipment, property, leaseholds, and other facilities in compliance with all Applicable laws relating to the
environment, labour laws and health and safety measures. The Borrower shall maintain all required
approvals relating to: (i) air emissions; (ii) discharge of surface water or ground water; (iii) noise emissions;
(iv) solid or liquid waste disposal; (v) the use, generation, storage, transportation, or disposal of toxic or
hazardous substances or wastes; and (vi) other environmental, health, or safety matters.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxiii) The Borrower shall comply with and shall conduct its business operations as per all the labour laws
applicable in India including but not limited to The Minimum Wages Act, 1948, The Factories Act, 1948, The
Industrial Disputes Act, 1947, The Child Labour (Prohibition and Regulation) Act, 1986 as amended from time
to time. Borrower also represents that it will ensure strict adherence to all the labour laws and implement the
policies as per the rules/guidelines/instructions issued by the governmental authorities therein.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxiv) The Borrower agrees and confirms that , neither the Borrower or Guarantor, and none of their subsidiaries
and, to the knowledge of senior management of each Borrower or Guarantor, none of its affiliates and none
of its respective officers, directors, brokers or agents, acting in their capacity on behalf of such Borrower or
Guarantor or such subsidiary or affiliate (i) has violated or is in violation of or shall violate any applicable
anti-money laundering law; (ii) has engaged or engages in any transaction, investment, undertaking or
activity that conceals the identity, source or destination of the proceeds from any category of offenses
designated in any applicable law; (iii) is a Restricted Party; or has received notice of or is aware of any action
or investigation against it with respect to any Sanctions by any Sanctions Authority; (iv) directly or indirectly
violated applicable anti-corruption laws or made, undertaken, offered to make, promised to make or
authorized the payment or giving of a prohibited payment; (v) used funds or other assets, or made any
promise or undertaking in such regard, for the establishment or maintenance of a secret or unrecorded fund;
or (vi) made any false or fictitious entries inany books or records of the Borrower, Guarantor or any member
of the affiliates relating to any prohibited payment with respect to the transactions contemplated by this
Agreement or the other Financing Documents.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

// addFooter();
//--------------------------------------------new page--------------------
doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica')
    .fontSize(9)
.text(
  `(xxv) The Borrower and/or Security Provider will not seek to claim or recover from the Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of the Lender in respect of the Security, taken
or omitted by the Lender in terms hereof and/or pursuant hereto and/or to protect any of its interests and
rights as the lender or a creditor, and the Borrower and/or Security Provider hereby expressly waives any
right to seek or make any such claim or recovery on any grounds whatsoever;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)

.text(
  `(xxvi) The Borrower herby acknowledges to maintain a sufficient security cover of such proportion of the amount
financed by the Lender, as specified in the Schedule hereunder during the Tenor or term of the Facility;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxvii) The Borrower herby confirms that the fair value of the assets of the Borrower exceeds all of its aggregate
liabilities whether under this Agreement or under any other agreement or any business arrangement (ii) the
Borrower has the ability to meet all of its obligations as they mature under any business arrangementor any
agreement; and (iii) the Borrower has sufficient capital to carry on its business.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxviii) The Borrower confirms that all insurances coverage, in relation to the assets of the Borrower or security
provider (other than Borrower) [ including immovable property(ies)/plant and machinery /stocks] which
have been provided to the Lender as Security, have been obtained, and are in full force and effect and it has
complied with all its obligations under the respective insurance contracts including payment of regular
insurance premium thereon, and no event or circumstance has occurred nor has there been any omission to
disclose a fact which in any such case would entitle any insurer to avoid or otherwise reduce its liability
thereunder compared to the amount provided in the relevant policy and insurance coverage provided by
such insurance;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxix) Borrower and/or Security Provider has obtained all Governmental Approvals for creating the Security and
will at all times till the amounts due to Lender are paid in full and the Facility is fully Repaid, keep all such
Governmental Approvals;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxx) The execution and delivery of the security agreement and documents to be executed in pursuance hereof,
 in favour of the Lender, and the performance of the Borrower and/or Security Provider’s obligations
thereunder does not and will not (i) contravene any Applicable Law, statute or regulation or any judgment or
decree to which the Borrower and/or Security Provider and/or its assets, businesses and/or undertakings is
subject, (ii) conflict with or result in any breach of, any of the terms of or constitutedefault of any covenants,
conditions and stipulations under any existing agreement or contract or binding to which the Borrower
and/or Security Provider is a party or subject, or (iii) conflict or contravene any provision of the
memorandum and the articles of association and/or any constituting/governing documents of the Borrower
and/or Security Provider;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xxxi) The Borrower will not utilize the Facility for any activity other than the Purpose as mentioned in the
Schedule hereunder and that the Security will not be charged or Encumbered in favor of any other
bank/financial institution`,
{ align: 'justify', indent: 50, lineGap: 5 }
);


    // addFooter();

    //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica-Bold')
    .fontSize(9)
.text(
  `12.2 Covenants and Undertakings`,
{ align: 'left'}
).moveDown()
doc.font('Helvetica-Bold')
.text(
  `A. Affirmative Covenants`,
{ align: 'left',indent: 43, }
).moveDown()

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `The Borrower hereby agrees and undertakes to the Lender and represents that for so long as any of 
 the Outstanding Amounts are due and payable, the Borrower shall:`,
{ align: 'justify', indent: 41, lineGap: 5 }
)
.text(
  `(i) Allow representative(s) and/or nominee(s) (including agent, investor, financier and any authorized
personnel of the Lender) of the Lender to enter into the premises of the Borrower in order to inspect and
audit the property, books of account and other relevant accounts, documents and records of the Borrower
provided to the Lender for the obligations of the Borrower hereunder, and the Borrower shall fully
facilitate/co-operate in this regard by making its personnel and such information/documents available during
such inspection or audit and the costs incurred thereby shall be borne by the Borrower:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(ii) Execute in favour of the Lender and/or its nominee(s) such further documents, forms and/or papers as the
Lender may in its absolute discretion require in connection with the Facility`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iii) Completely repay the Facility and Interest and costs thereon and all monies owing to Lender hereunder,
according to the terms of this Agreement and comply with any further instruction as maybe issued by the
Lender from time to time in this regard;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(iv) Promptly notify the Lender of any change in the Borrower’s address, phone number, employer name, email
address;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(v) Provide to the Lender all the documents and information as may be requested by the Lender from time to
time in terms of the Know Your Customer (“KYC”) guidelines issued under any applicable laws or by any
regulator/government authorities and keep the same updated at all times during the validity of the Financing
Documents;`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(vi) Promptly inform the Lender of any occurrence, event or incident of which it becomes aware which might
adversely affect the Borrower or affect its ability to pay any amount when due or to perform its obligations
under this Agreement and/or in respect of the Facility;
(vii) Promptly inform the Lender of any material deviation or change in any other information submitted by the
Borrower to the Lender at any time before or after entering into this Agreement;
(viii) Pay regularly all taxes, assessments, dues, duties, levies and impositions as may, from time to time, be 
payable to any Governmental Authority;
(ix) Immediately notify Lender upon becoming aware of any actual/potential Event of Default.
(x) Furnish such other documents and/or information as may be required by the Lender.
(xi) At its own cost and expense keep all immovable property(ies)/plant and machinery/stocks of the Borroweror
Security Provider (other than Borrower) which have been provided to the Lender as Security in respect of the
obligations of the Borrower under this Agreement fully insured against such risks, and for such amount(s)
and for such period and in such form(s) as the Lender may from time to time require, either in the joint names
of the Lender and the Borrower, or with the Lender named as loss payee therein, with such reputable
insurer(s) as the Lender shall approve in writing. The Borrower shall deposit with the Lender all such
insurances along with any cover notes and receipts evidencing payment of premia etc.
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

    //next
     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)

.text(
  `(xii) In relation to such insurances as are required to be maintained pursuant to this Agreement, the Borrower
shall make punctual payment of all premia to be paid in relation to such insurances and shall not do or suffer
to be done any act which may invalidate such insurance.
(xiii) In the event the Borrower becomes entitled to make any claims under the above insurances, promptly 
make a claim under such insurances, and apply all monies received either in reinstatement of the property
-(ies)/plantand machinery/stocks insured or towards repayment of the Outstanding Amounts.
(xiv) If the Borrower fails to insure and/or keep insured any of the [property(ies)/plant and machinery/stocks]
provided to the Lender as Security the Lender shall, without prejudice to its rights and liabilities under this
Agreement or at law, be at liberty to insure and keep insured any of the above [property(ies)/plant and
machinery/stocks] and the Borrower shall on demand repay the Lender all fees, costs, commissions and
Charges incurred by the Lender in doing so.
(xv) Promptly inform the Lender about any occurrence, event, incident, litigation, arbitration, investigative,
regulatory or administrative proceeding/action having a material adverse effect on the condition, assets,
operations, prospects or business of the Borrower, its ability to perform and comply with its obligations in
respect of the Facility, the validity, legality or enforceability of, or the rights or remedies of the Lender under
this Agreement or any other document in relation to the Facility and the validity, legality or enforceability of
the Security or on the priority or ranking of the Security.
(xvi) Deliver to the Lender as soon as the same becomes available:
(a) but in any event within 30 (thirty) after the end of each of its financial years, its audited financial
statements for that financial year;
(b) but in any event within 30 (thirty) after the end of each half of each of its financial years, its unaudited
financial statements for that financial half year; and
(c) any other statement or statements or information pertaining to the operations of the Borrower as the
Lender may reasonably require, within such period as required by the Lender.
(xvii) Maintain adequate and proper books, accounts and records in accordance with generally
accepted/applicable accounting principles, standards and practices, consistently applied;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `(xviii) Perform, on Lender’s request, acts necessary to carry out the intent of this Agreement.
(xix) Promptly inform the Lender of any distress or other process of court being taken against any of the
Borrower’s premises/assets;
(xx) Promptly inform the Lender of any change taking place in the ownership or control of the Borrower
whereby the effective beneficial ownership or control of the Borrower will materially change;
(xxi) Without prejudice to the Borrower’s obligations hereunder, it shall furnish to the Lender:
(a) within six months after the close of each of the Borrower’s fiscal year or such other period as reasonably
required by the Lender, a copy of the annual report of the Borrower, certified by a chartered accountant of
recognized standing, acceptable to the Lender together with financial statement consisting of a balance sheet
and profit and loss account as of the end of such fiscal year;
(b) any other publicly available information and statements respecting the financial condition and operations of
the Borrower as the Lender may from time to time reasonably request.`,
{ align: 'justify', indent: 50, lineGap: 5 }
)


    // addFooter();

     //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`(xxii) Comply and shall cause each other Security Provider to comply in all material respects with all applicable
anti-money laundering laws and shall not engage in any transaction, investment, undertaking or activity that
conceals the identity, source or destination of the proceeds from any category of offenses designated in any
applicable law.
(xxiii) Comply with all Conditions Precedent as stated in Clause 3.5 and the Schedule.`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`B. Negative Covenants`,
{ align: 'left',indent: 45, }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) For so long as any of the Outstanding Amounts are unpaid, the Borrower shall not change in its constitution
or management without the prior written consent of the Lender and shall not:
`,
{ align: 'justify', indent: 45, lineGap: 5 }
)
.text(
  `(i) Create or permit to subsist any encumbrance or charge over all or any of the charged assets of the Borrower
or take any action which may materially impact the ability of the Borrower to pay any amount when due or
to perform its obligations under this Agreement and/or in respect of the Facility;
(ii) Effect any merger, amalgamation, reconstruction or consolidation or effect any material change in the
management/ownership of the Borrower;
(iii) Stand as surety for anybody or guarantee the repayment of any loan or overdraft or the purchase price of
assets.
(iv) Change its existing accounting methods or policies followed by it as on the date of execution of this
Agreement, during the currency of Facility unless otherwise required in terms of the prevailing Applicable
Law or change in Applicable Law;
(v) In case the Borrower is a Company;
i. Declare or pay dividends in respect of any financial year if an Event of Default has occurred or is
continuing or in case there is an asset liability mismatch in the books of the Borrower;
ii. make any amendments to the ‘objects’ clause in its memorandum or make any changes into its
constitutional documents.`,
  { align: 'justify', indent: 50, lineGap: 5 }
  )
  .text(
    `(b) For so long as any of the Outstanding Amounts are still outstanding, Borrower shall not utilise the
Facility for:`,
    { align: 'justify', indent: 45, lineGap: 5 }
    )
    .text(
      `a) Investments in any company/entity by way of shares, debentures, etc
b) Subscribing to Initial Public Offerings (IPOs) and for purchase of shares from secondary market.`,
      { align: 'justify', indent: 50, lineGap: 5 }
      ).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13. EVENT OF DEFAULT`,
{ align: 'left',indent: 45, }
).moveDown();
doc.font('Helvetica-Bold')
.fontSize(9)
.text(
`13.1 Event of Default`,
{ align: 'left',indent: 45, }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)
.text(
`An event of default means the occurrence of any of the events specified in this Clause (‘Event ofDefault’)
as below:`,
{ align: 'justify', indent: 50, lineGap: 5 }
)
.text(
  `13.1.1 The Borrower fails to make payment of the Outstanding Amounts on the Due Dates in relation to the
Facility;`,
  { align: 'justify', indent: 50, lineGap: 5 }
  ).text(
    `13.1.2 If any event has occurred which in Lender’s opinion dilutes or jeopardizes the Security provided to the
Lender:`,
    { align: 'justify', indent: 50, lineGap: 5 }
    ).text(
      `13.1.3 Breach of any of the covenants mentioned in clause 12 on the part of the Borrower to observe or 
complywith any of the terms and conditions of this Agreement or any other Financing Document;`,
      { align: 'justify', indent: 50, lineGap: 5 }
      )





    // addFooter();

    //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.4 If there is any material breach of trust and willful default or breach of any other obligation under this
Agreement or any other Financing Documents including notice for insolvency;
13.1.5 If the Borrower defaults/threatens to default, in discharging his liability, under any other agreement or 
other writing between the Borrower and the Lender or any agreement entered into by the Borrower with the
Lender, its subsidiaries and affiliates, or under any other agreement or writing of indebtedness of the
Borrower, or under any other agreement with the other creditors or in the performance of any covenant,
term or undertaking thereunder, or any indebtedness of the Borrower not being paid when due or any
creditor of the Borrower becoming entitled to declare any indebtedness due and payable prior to the dateon
which it would otherwise have become due or any guarantee or indemnity or collateral given or other
support agreement entered into by the Borrower not being honored when due and called upon;
13.1.6 Any fraud and/or misrepresentation by the Borrower or any misleading statement made as to any
representation or warranties, or any other material statement made in this Agreement or any suppressionor
concealment of any material fact/essential information by the Borrower;
13.1.7 If any Governmental Authority has condemned, nationalized, seized or otherwise expropriated the 
assetsthat form Security or any substantial assets/property of the Borrower;
13.1.8 Any step is taken, or proceedings started for Borrower’s dissolution under the Code, or winding-up or for 
the appointment of a receiver, judicial manager, trustee or similar officer for the Borrower in any manner
whatsoever;
13.1.9 Initiation of the creditors process/any arrangement with any creditors with respect to the Borrower;
13.1.10 A receiver is appointed over the whole or any part of the property of the Borrower;
13.1.11 The Borrower ceases to carry on its Business or change its object clause of the memorandum of 
association without prior consent of the Lender;
13.1.12 If it has become unlawful for the Borrower to carry on its Business;
13.1.13 If there is any failure on the part of the Borrower to pay on any judgment or court order unless pending
appeal;
13.1.14 In case in the opinion of the Lender, there has been a material adverse change in any of the Borrower’
business or financial condition, such as:
a) if it is certified by a firm of accountants appointed by the Lender (which the Lender is entitled and hereby
authorised to so appoint at any time) that the liabilities of any of the Borrower exceed their respective assets
or that Borrower is carrying on its business at a loss;
b) sale or curtailment or closure of Borrowers’ business;
c) adverse action by any regulatory authority;
d) action by any class of stakeholders which is likely to significantly impair any of the Borrowers’ business; and
e) any other event which in the opinion of the Lender is likely to have an adverse effect on the business or
business environment of the Borrower.
13.1.15 Any material litigation or proceedings instituted against the Borrower including proceedings for crime
involving moral turpitude;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);





      





    addFooter();

     //======================
         //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.16 There occurs any event or situation, (including happening of an event which in the opinion of the 
Lender is a force majeure event) such as and including but not limited to any material adverse change as 
determined solely by the Lender in the business or financial or other condition or operations or prospects
 of the Borrower, which in the sole opinion of the Lender is prejudicial to the interests of the Lender or 
is likely to materially affect the financial condition of the Borrower and/or its ability to perform all or 
any of its obligations under this Agreement and/or otherwise in respect of the Facility and to comply with 
any of the terms of this Agreement and/or for the Facility;
13.1.17 If it becomes unlawful in any applicable jurisdiction for the Lender to perform any of its obligations as
contemplated by this Agreement or to fund or maintain or continue any Facility;
13.1.18 There is any material change in the ownership or management of the Borrower which in the sole 
opinion of Lender would prejudicially affect the interest of Lender;
13.1.19 The Borrower repudiates this Agreement or does or causes to be done any act or thing evidencing an
intention to repudiate this Agreement or non-performance of its obligation under this Agreement (whether
voluntary or involuntary);
13.1.20 Any document for creation of the Security in favour of the Lender is not in full force and effect or does 
not create in favour of the Lender, the Security which it expresses to create with the ranking and priority it is
expressed to have, including the due compliance of the requirements of security perfection including but not
limited to registration of charge with the concerned registrar of sub-assurances, within such period as
contemplated under this Agreement or otherwise allowed by the Lender, in its sole discretion and/or
 nonsubmission of any of the documents referred to in the Schedule hereto or the occurrence of any act or
circumstances which could, in the sole determination of the Lender, jeopardize, in any way, the Security;
13.1.21 If there is any deterioration or impairment of the Security or any part thereof or any decline or 
depreciation in the value or market price thereof (whether actual or reasonably anticipated), which causes 
the Security or any part thereof, in the judgment of the Lender to become unsatisfactory as to character or 
value;
13.1.22 If the property over which Security is created in favour of the Lender or any part there of is sold 
or disposed of, let out, given on leave or licence, pledged, hypothecated, transferred in any manner, charged 
in any manner whatsoever, Encumbered or otherwise alienated or if any third-party interest is created therein 
in any manner;
13.1.23 The Borrower misuses the Facility or any part thereof, or uses the Facility or any part thereof for any 
purpose other than the Purpose;
13.1.24 Any of the promoters/directors or persons holding key management positions (i.e., managing director/
chief executive officer and/or directors) of the Borrower is declared as willful defaulter in RBI List of 
willful defaulters or any other list of defaulters published by competent authorities from time to time.;
`,
{ align: 'justify', indent: 50, lineGap: 5 }
);

    // addFooter();

        //-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7)

    doc.font('Helvetica')
    .fontSize(9)


.text(
`13.1.25 Any of the promoters and/or the directors of the Borrower are accused of, charged with, arrested or
convicted in a criminal offence involving moral turpitude, dishonesty, bribery or which otherwise impinges
on the integrity of such promoter and/or director, including any accusations, material charges and/or
convictions of any offence relating to bribery; or
13.1.26 Any force majeure event or an event not in the control of Borrower, for example, riot, war, act of terror,
earthquake, flood, fire, industrial disputes, strike or any events of similar nature occur.
13.1.27 If the Borrower fails to inform the Lender of any actual/potential Event of Default;
13.1.28 In the event there is a commencement of any action under any RBI guidelines, circulars, directions, etc. 
with respect to the Borrower or any of its subsidiaries or holding company;
13.1.29 If the Borrower fails to comply with the Applicable laws including the regulations, directions, circulars and
prudential norms notified by the concerned Regulator.
13.1.30 Any other event occurs which in the sole opinion of the Lender is likely to adversely affect the ability of 
the Borrower to perform its obligations under this Agreement.`,
{ align: 'justify', indent: 45, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2 Consequences of Events of Default`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`13.2.1 Upon the occurrence of an Event of Default as set out in clause 13.1, the Lender shall have the right 
and shall take any or all of the following actions:
(a) To cancel any outstanding commitments and/or recall the Facility;
(b) To require the Borrower to mandatorily Repay the principal amount on the Facility, along with accrued but 
unpaid interest, prepayment penalty and other costs, Charges and expenses incurred under or in connection with
this Agreement and other Financing Documents and other Outstanding Amounts;
(c) To declare all or any part of the Outstanding Amounts to be immediately (or on such dates as the Lendermay
specify) due and payable and ensure due payment thereof;
(d) To commence legal proceedings to recover such sum, the Borrower will further pay the Lender all advances,
Charges, cost and expenses, including all legal fees, incurred or paid by the Lender in exercising any right,
power or remedy conferred by this Agreement, (and/ or in the enforcement thereof) and all such amounts
shall become a part of the indebtedness secured hereunder and shall be paid to the Lender by the Borrower
immediately and without demand.
(e) To enforce the Security and/or additional security pertaining to the Facility, including but not limited to the
substitution of the Borrower/ sale of the land/ properties.
(f) Appoint a nominee director on the board of the Borrower;
(g) Exercise any other rights that Lender may have under the Financing Documents or under Applicable Law;
(h) Utilise and appropriate any amount lying or credited in the accounts of the Borrower, for
payment/repayment of Outstanding Amount, as due and payable till the date of such Event of Default;
(i) Transfer or appropriate the Security by sale or otherwise as the Lender may deem fit, to any other Person
and utilize any surplus realized from such transfer towards the fulfilment of all the obligations of Borrower
under the Financing Documents and may pay the surplus (if any) to the Borrower, after the satisfaction of
obligations of the Borrower;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`13.2.2 Cross Collateralization`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower hereby undertakes and confirms that the Borrower shall execute any and all security
documents as may be required by the Lender to ensure that any Security(ies) furnished by the Borrower,
pursuant to any other credit facility granted by the Lender, its group companies, its affiliates to the Borrower
shall be extended as a Security(ies) towards the Facility extended under this Agreement. Further, the
Borrower also agrees to execute such security documents as may be required by the Lender to extend the
security(ies) offered in respect of this Facility towards other loan(s)/facility( ies) availed/to be availed by the
Borrower from the Lender or any of its group companies.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`14. ASSIGNMENT`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`14.1 The Borrower shall not transfer or assign any of its rights or liabilities under this Agreement to any other
person or entity without the prior written consent of the Lender.
14.2 The Borrower agrees that notwithstanding anything to the contrary contained in any document executed
under or in relation to this Agreement, the Lender shall have the right to (in full or in part) assign, transfer,
novate and/or otherwise securitize its rights or obligations under this Agreement and the other Financing
Documents and/or the Outstanding Amounts and/or enter into indemnity or other arrangements for risk
sharing, whether with or without recourse to the Lender, to one or more bank/s, financial institution/s or any
other entity including any trust or association whether located/placed in India or outside India as permitted
under the Applicable Law without any reference or notice to the Borrower. However, the Borrower shall not
claim any privity of contract with any such entity to whom the outstanding and/or the rights or obligations
under this Agreement or the other documents in relation to the Facility have been assigned/transferred
/novated/securitized or with whom the Lender has entered into indemnity or arrangements for risk sharing.
14.3 The Borrower agrees that the Lender (or any nominee of the Lender) may retain the Security Interest created
on the Security pursuant to the Security documents (or any part thereof) in trust and for the benefit of such
assignee (and upon part assignment of the Facility, in trust and for the benefit of both the Lender and such
assignee on a pari passu basis), without requiring any consent of or notice or making any reference to the
Borrower or the Sponsor. Upon any such transfer or assignment as contemplated herein, such assignee and
the Lender, as the case may be, will be entitled to take any action, including recovery and enforcement of the
Lender’ rights hereunder, in its own name without making the Lender or the assignee, as the case may be, a
party thereto.
14.4 Without prejudice to the right of the Lender to proceed against the Borrower under Applicable Law for
recovery of Outstanding Amounts, the Borrower hereby gives consent that the Lender will be entitled, subject
to Applicable Law, to recover the dues, assign the debt and/or securities and/or initiate proceedings under
the provisions of the SARFAESI Act and/or Code and/or any other Applicable Law and the Borrower agrees to
pay the Lender all cost, charges and expenses incurred in connection thereto.
14.5 The Borrower irrevocably and unconditionally confirms that it shall continue to be bound by the terms of
this Agreement and the other documents in relation to the Facility notwithstanding such transfer or
assignment by the Lender, further the Borrower shall duly comply with the instructions in respect of the
Facility as maybe issued by the Lender upon such transfer or assignment by the Lender.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


    // addFooter();


    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

    doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15. COST, CHARGES, EXPENSES AND STAMP DUTY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica')
    .fontSize(9)


.text(
`15.1 The Borrower shall bear and promptly pay the following:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica')
    .fontSize(9)


.text(
`(a) an upfront non-refundable processing fee as mentioned in the Sanction Letter and statutory levies thereon,
but subject to deduction of TDS as per Applicable Law, as processing fee to the Lender for the purpose of
processing the Facility. The processing fee shall be paid at the time of disbursement of the Facility itself for
which purpose, the Borrower hereby authorizes the Lender to adjust the processing fee from the proceeds of
the disbursement. The processing fee is non-refundable fee and independent of disbursement/cancellation
of the Facility by the Borrower;
(b) all fees for the services performed by Lender, all out of pocket and travelling expenses and other costs,
Charges and expenses in any way incurred by Lender, its officers, employees or agents in connection with
the negotiation, preparation, execution, delivery, administration, waiver, modification or amendment of or
the preservation, protection or release of the rights of the Lender on exercise of any rights, remedies or
powers granted hereunder or any documents or instruments contemplated or in connection with or relating
to these presents including, without limitation, costs of investigation of title;
(c) all legal fees for drafting and stamping of this Agreement and all other Financing Documents, costs, Charges
and expenses of the external legal counsel of the Lender and all such sums incurred or paid by the Lender in
connection with and incidental to or in connection with these presents and incurred in connection with the
enforcement of any rights hereunder or under any of the Financing Documents or for payment of any
additional stamp duty or penalties in relation to the stamp duty under any Financing Documents including
any cost incurred in the assertion or defence of the rights of Lender as such for, andfor the benefit of the
Lender for the protection and preservation of whole or any part of the Security and for the demand,
realization and recovery of the Outstanding Amounts which shall be added to the Outstanding Amounts and
be secured hereby; and
(d) all stamp duty, Taxes, Charges and penalties on any Financing Documents if and when the Borrower may be
required to pay the same according to the Applicable Law.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `15.2 The Borrower agrees to indemnify and keep the Lender indemnified at all times against any and all loss,
costs, Charges, expenses and liabilities including penalties with respect to or resulting from delay or
omissions to pay any such stamp, registration and similar taxes or Charges. Such stamp, registration and
similar taxes or Charges (if not paid or reimbursed by the Borrower) shall be deemed to be the amounts
outstanding under the Facility.
15.3 The Borrower shall pay all stamp duty charges and other similar taxes payable in respect of this Agreement
and other Financing Documents and indemnify the Lender against any cost, loss or liability that the
Lender may suffer, pay or incur by reason of or in connection with all stamp duty charges and other similar
taxes payable in respect of this Agreement or any other Financing Documents
  `,
  { align: 'justify', indent: 40, lineGap: 5 }
  );


    // addFooter();

    //-------------------new page----------------
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`15.4 If the Borrower fails in defraying the costs, expenses, Charges, duties or fees referred to above as
and when required, the Lender may (but is not obligated to) make such payments on behalf of the
Borrower. All such payments made by the Lender shall be for the account of the Borrower and the
Borrower undertakes promptly on demand, to reimburse the Lender or its authorized agents,
representatives, successors and assignees for any such monies so paid, together with the interest
thereon at the rate of the Additional Interest over the Applicable Interest Rate until the date such
amounts are actually reimbursed by the Borrower. All such costs and expenses shall be part of the
‘Outstanding Amounts’ and shall be a charge upon the Security in priority to the charge
securing the Facility.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `16. INDEMNITY`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();

  doc.font('Helvetica')
    .fontSize(9)


.text(
`The Borrower shall, without prejudice to any other right of Lender, indemnify and keep indemnified and hold
harmless Lender against any cost, loss, obligations, damages, penalties, actions, judgments, suits, expenses,
liability or disbursements of any kind or nature whatsoever (including legal fees, disbursements to lawyers
and out of pocket expenses), which may be imposed on, incurred by or asserted against the Lender (or its
directors, employees and agents) in any claim, litigation, proceeding or investigation instituted or conducted
by any governmental agency or instrumentality or any person or entity, and which are related directly or
indirectly to this Agreement or Financing Documents or any document executed pursuant hereto, whether
Lender is a party thereto, and shall pay and reimburse to Lender, without any dispute or demure any losses,
costs, charges or expenses which Lender, shall certify as sustained or suffered or incurred by Lender as a
result of:

(i) the occurrence of an Event of Default, or any other breach of obligations by the Borrower under, Financing
Documents and/or this Agreement or otherwise in connection with this Agreement (including any interest or
fees incurred in funding any unpaid sum) or otherwise on account of the Facility;
(ii) the Lender investigating any event which it believes is an Event of Default;

The Borrower shall within 5 (five) Business Days of demand of the above, make good such payment to Lender
accordingly. For avoidance of doubt, Lender shall not be required to risk its own funds or otherwise incur
any financial liability in the performance of any of its duties hereunder or in the exercise ofany of its rights or
powers under this Agreement. The Borrower will not seek to claim or recover from Lender on any grounds
whatsoever and/or in any circumstances whatsoever, any purported damages or compensation, direct,
indirect or consequential, for any acts or actions whatsoever of Lender hereunder and/or in respect of the
Facility, taken or omitted by Lender, in terms hereof and/or pursuant hereto and/or to protect any of its
interests and rights as Lender and the Borrower hereby expressly waives any right to seek or make any such
claim or recovery on any ground whatsoever.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
)





    // addFooter();
//=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`17. TAXES`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`17.1 If the Borrower is required by Lender, or under any of the law to make any deduction or withholding towards,
for or in respect of any tax, the Borrower must:
(a) pay to the Lender any additional amount as may be necessary to ensure that the Lender receives the
full amount of the relevant payment as if that deduction or withholding had not been made; and
(b) supply promptly to the Lender evidence satisfactory to the Lender that it has accounted to the relevant
Governmental Authority for the withholding or deduction.
Provided that in case the Borrower provides a certificate, within the statutory timelines, evidencing payment
of withholding taxes in relation to any payments made to the Lender, it shall not be requiredto gross up
the payments as provided under this clause 17.1.
17.2 The Borrower shall during the Tenor bear all interest tax as may be applicable or as may be levied bya
Governmental Authority in relation to any Interest or other sum paid by the Borrower to the Lender under
the Facility. If the Lender is required to make any payment on account of any interest tax in relation to
Interest or other sum received or receivable by the Lender hereunder, then the Interest or sum payable by
the Borrower shall be increased to the extent necessary to ensure that after making such payment, the
Lender receives and retains a sum equal to the sum which it would have received and retained had no
such payment or deduction been made or required to be made.
17.3 If the Borrower is required to make any deduction for or on account of any interest tax (other than statutory
deduction of taxes at source) in relation to any Interest or other sum payable to the Lender hereunder, then,
in such case, the sum payable to the Lender shall be increased to the extent necessary to ensure that, after
making such deduction the Lender receives and retains (without any liability for such deduction) a sum
equal to the sum which it would have received and retained had no such deduction been made or required to
be made.
17.4 If there is, at any time, any incidence of any indirect taxes on the Lender directly connected and/or
attributable to the Facility, the Lender shall notify the Borrower of such incidence of tax and shall be entitled
to pass on such incidence to the Borrower. The Borrower shall make payment of such taxes without demur,
protest or cavil. Notwithstanding the above, if the Lender makes payment of any such indirect tax, the
Lender shall, be entitled to be reimbursed for the same by the Borrower.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`18. CONSTITUTED ATTORNEY`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.1 The Borrower hereby agrees and appoints or cause to appoint the Lender and its officers, employees and
agents and authorised representatives to be its duly constituted attorneys for all or any of the following
purposes, upon the occurrence of an Event of Default, namely:
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(a) to sign all papers, documents agreements indentures and writings that the Borrower would be
bound to do under or in pursuance of these presents and / or the Facility and/or the Security for
and behalf of the Borrower and to attend before the Sub-Registrar of Assurancesor any other
relevant authority and admit execution thereof;`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()





    // addFooter();

    //=========================new page========================
    doc.addPage();
    // addLogo();
    // drawBorder();
    doc.moveDown(7);

   

  doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`(b) Generally to do perform and/or execute or cause to be done performed or executed all acts deeds
matters things and documents in all matters arising under or out of or concerning or touching these
presents as the Borrower could itself do perform or execute;
(c) And for the better and more effectually doing effecting and performing the several matters and
things including as aforesaid, and to appoint from time to time or generally such other Persons,
bodies, companies, organizations, or agencies as the Lender may think fit as its substitute or
substitutes to do execute and perform all or any such acts and things as aforesaid and such
substitute or substitutes at pleasure to remove and to appoint other or others in his or their place;
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`18.2 The Borrower agrees that the above powers may be exercised without any prior notice to the Borrower
and further agrees to ratify and confirm all that the Lender or any substitute or substitutes appointed by the
Lender may lawfully do or cause to be done in exercise of the aforesaid powers.
18.3 The Borrower further agrees to give all assistance to the Lender and its officers authorised representatives
and other substitutes for the purpose of exercising any of the powers hereinabove set out, including
endorsing of documents, signing of papers and doing all such things as may be necessary to enable the Lender
and its officers and other substitutes to exercise all the powers hereby conferred.
18.4 The Borrower further agrees that the aforesaid powers have been granted for valuable consideration and as
such shall be irrevocable in nature till such time as any amounts remain due owing or payable under or in
respect of or in pursuance of the Facility and/or these presents.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`19. GOVERNING LAW AND JURISDICTION`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

  doc.font('Helvetica')
    .fontSize(9)


.text(
`This Agreement and all documents executed under/in relation to this Agreement shall be governed by the laws of
India. Any disputes arising under/in relation to this Agreement shall be subject to the exclusive jurisdiction
of the competent courts situated in New Delhi. However, this shall not limit the rights of the Lender to take
proceedings in any other court of competent jurisdiction of its choice.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`20. MISCELLANEOUS`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()
.text(
  `20.1 Notices`,
  { align: 'left', indent: 40, lineGap: 5 }
  );

  doc.font('Helvetica')
    .fontSize(9)


.text(
`Any notices to be provided by each Party shall be in writing, signed by an authorised officer, and shall be sent
by post, letter or email to such address, email id or number as mentioned below or to such other contact
details as may be notified by the Parties from time to time. Notices shall be deemed to have beendelivered on
the earlier of the actual date of delivery or 7 (seven) Business Days following dispatch.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Borrower:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


  doc.font('Helvetica')
    .fontSize(9)


.text(
`As mentioned in the Schedule
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
    .fontSize(9)


.text(
`Address of the Lender:`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()


doc.font('Helvetica')
.fontSize(9)
.text(
   `Address: 401, NEW DELHI, 27 BARAKHAMBA ROAD, CONNAUGHT PLACE, NEW DELHI 110001`,
   { align: 'justify', indent: 40, lineGap: 5 }
);

doc.text(
`Email: `,
{ continued: true, indent: 40 }
)
.font('Helvetica-Bold')
.fillColor('blue')
.text(
   `support@growmoneycapital.com`,
   {
      link: 'mailto:support@growmoneycapital.com', // This makes the email clickable
      underline: true, // Optional: to visually indicate it's a link
   }
)
.fillColor('black'); // Reset the color to black for further text
// .moveDown();

    // addFooter();


//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);



doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`(The Borrower agrees that all instructions and/or correspondence sent by the Borrower to the Lender
are sent at the Borrower’s risk, and the Lender does not assume any responsibility for anyinaccuracy,
interruption, error, delay or failure in transmission or delivery whether sent by post, telegraph,
cable, telex or any other form of written or electronic communication.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.2 Any provision of this Agreement, which is prohibited or unenforceable in any jurisdiction shall, as to such
jurisdiction, be ineffective only to the extent of prohibition or unenforceability and it shall not invalidate the
remaining provisions of this Agreement or affect such provision in any other jurisdiction.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.3 Disclosure`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown()

doc.font('Helvetica')
.fontSize(9)


.text(
`20.3.1 The Borrower hereby agrees as a pre-condition of the Facility given to the Borrower by the Lender that, in
case the Borrower commits default in the Repayment of the Facility in accordance with or in the paymentof
Interest thereon on date(s) specified in Repayment Schedule , the Lender and/or the Reserve Bank of India
will have an unqualified right to disclose or publish the Borrower’s name as defaulter in such manner and
through such medium as the Lender or Reserve Bank of India in their absolute discretion may think fit.
Accordingly, the Lender shall have the right to furnish and publish the name of the Borroweras defaulter to
the public at large and Reserve Bank of India or other regulatory authority. Notwithstanding above the
Borrower hereby accept and confirm that as a pre-condition to the grant of the credit facility by the Lender
to the Borrower including, the Facility the Lender, requires consent of the Borrower to make certain
disclosures in relation to the Borrower including information and data relating to the Borrower and any
credit facility availed of or to be availed of by the Borrower, obligations assumed or to be assumed by the
Borrower in relation thereto and default, if any, committed by the Borrower in discharge thereof.
Accordingly, the Borrower hereby agrees and gives consent to the disclosure by the Lender of all or any such
information and data relating to the Borrower:
(a) in relation to any credit facilities including, the Facility availed of or to be availed of by the Borrower from
the Lender and the Borrower’s obligations in any credit facility granted/to be granted, by the Lender, for the
purposes of credit reference checks, verification, etc; and
(b) in case of default, if any, committed by the Borrower in discharge of any of his obligations, or any other
information that the Lender may deem appropriate and necessary, to disclose and furnish to RBI, any Credit
Information Agency and/or any other agency authorized in this behalf by the RBI or any other regulatory
authority.

20.3.2 The Borrower undertakes and declares that the information and data furnished by the Borrower to the
Lender is/shall be true and correct and any Credit Information Agency and/or any other authorized agency
may use, process the said information and data disclosed by the Lender as deemed fit by them and may
furnish for consideration such processed information/data/products to banks/financial institutions and
other entities as maybe specified by RBI.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// addFooter();

//=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)
.text(`20.3.3 The Borrower and the Guarantor hereby give specific consent to the Lender for disclosing/submitting the
‘financial information’ as defined in Section 3 (13) of the Code read with the relevant regulations/ rules
framed under the Code, as amended from time to time in respect of the Facility availed from the Lender, from
time to time, to any ‘Information Utility’ (“IU”) as defined in Section 3 (21) of the Code, in accordance with the
relevant regulations framed under the Code, and directions issued by RBI from time to time and hereby
specifically agree to promptly authenticate the financial information submitted by the Lenders, as and when
requested by the concerned IU.

20.3.4 The Borrower hereby consents to the Lender, its officers and agents disclosing information relating to the
Borrower and its current bank account or Escrow Account, account(s) and/or dealing relationship(s) with
the Lender, including but not limited to details of its facilities, any security taken, transactions undertaken
and balances and positions with the Lender, to:

(i) the head office of the Lender, any of its subsidiaries or subsidiaries of its holding company, affiliates,
representative and branch offices in any jurisdiction (together with the Lender, the “Permitted Parties”);
(ii) professional advisers and service providers of the Permitted Parties who are under a duty of
confidentiality to the Permitted Parties;
(iii) any actual or potential assignee, novatee, transferee participant or sub-participant in relation to any of the
Lender’s rights and/or obligations under any agreement (or any agent or adviser of any of the foregoing);
(iv) any rating agency, insurer or insurance broker of, or direct or indirect provider of credit protection to any
Permitted Party; and
(v) any court or tribunal or regulatory, supervisory, governmental or quasi-Governmental Authority with
jurisdiction over the Permitted Parties
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.4 Lender’s records to be accepted by Borrower`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The records maintained by the Lender in its ordinary course of business shall be the final proof for the due
amounts from the Borrower in respect of the Facility under this Agreement. A certificate in writing signed by
an officer of the Lender or a system generated electronic certificate stating the Outstanding Amount from the
Borrower in respect of the Facility at any particular time shall be conclusive evidence against the Borrower
in respect of payments due from the Borrower in respect of the Facility`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.5 Engagement of third parties`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower expressly recognizes and accepts that the Lender shall, without prejudice to its right to
perform such activities itself or through its officers or employees, be entitled and has full power and
authority to appoint one or more third parties as Lender may select and to delegate to such third party all or
any of its functions, rights and powers under this Agreement relating to administration of Facility including
right and authority to collect and receive on behalf of the Lender from the Borrower any payments and other
amounts due by the Borrower under this Agreement and to perform and execute all lawful acts, deeds
matters and things connected therewith and incidental thereto. For the aforesaid purpose, Lender shall be
entitled to disclose to any such third parties all necessary and relevant information pertaining to the
`,
{ align: 'justify', indent: 40, lineGap: 5 }
);






    // addFooter();

    //=========================new page========================
doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc.font('Helvetica')
.fontSize(9)


.text(
`Borrower and the Facility and the Borrower hereby consents to such disclosure by the Lender.
Notwithstanding above, in the event of Borrower committing any act of default and/or occurrence of any
Event of Default, the Borrower expressly accepts and authorizes Lender to contact any third parties as
Lender may select and disclose all necessary and relevant information pertaining to the Borrower and the
Facility.
`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.6 Waiver`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The Borrower confirms that no delay of the Lender in exercising or not exercising any right, power or
remedy accruing/available to the Lender on Borrower’s default or otherwise under this Agreement or any
other Financing Documents shall impair or prejudice such right, power or remedy or shall be construed asits
waiver or acquiescence. The Borrower further confirms that any single or partial exercise of any right, power
or remedy by the Lender shall not preclude further exercise thereof. Every right and remedy of the Lender
shall continue in full force until the Lender specifically waives it by a written instrument`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.7 Liens; Right of Set Off`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The rights, powers and remedies given to the Lender by this Agreement shall be in addition to all rights
powers and remedies given to the Lender by virtue of any other Security, statute, or rule of law or equity. The
Lender may exercise a banker’s lien or right of set- off with respect to any obligation of the Borrower as if the
obligation were unsecured and shall have a lien on all property or securities of the Borrower in the Lender’s
possession or custody whether for safe-keeping or otherwise. Without prejudice to what is stated
hereinabove, the Borrower hereby expressly agrees and confirms that in the event of the Borrower failing to
completely pay/repay the Outstanding Amounts under the Facility, in addition to any general or specific lien
to which the Lender may be entitled by Applicable Law, the Lender shall, without prejudice to any of its
specific rights under this Agreement, be at liberty to apply any other money or amounts standingto the credit
of the Borrower in any account with the Lender in or towards repayment of the Outstanding Amounts under
the Facility, without notice to the Borrower, on happening of any Event of Default or if upon demand by the
Lender the said Dues are not repaid within the prescribed time. In case of any deficit, the deficit amount may
be recovered by the Lender from the Borrower. The joint account holder/s to such monies, securities,
deposits and other assets is/are aware of, and have no objection to (a) the Facility applied for, (b) the Facility
terms, (c) using such monies from the joint accounts for paying/Repaying the Facility and all other amounts
due to the Lender, and (d) the Lender’s rights of setoff in the event of their default of the Facility terms: It
shall be the Borrower’s sole responsibility and liability to settle all disputes/objections with such joint
account holders, if so required, and the Lender shallbe well within its rights to exercise the right of set off
against any money lying in any account/deposit/bond/other assets held singly or jointly, for settlement of
dues.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.8 Sanction Letter`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The terms of the Sanction Letter shall form part of this Agreement and shall be in addition to and be read in
conjunction with the terms of this Agreement. If there are any inconsistencies between the terms of the
Sanction Letter and this Agreement then, the terms of Sanction Letter shall prevail to the extent of
inconsistency.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.9 Entire Agreement`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
// about the subject matter, comprised within the Financing Documents and shall replace all previous
// agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
// representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
// the Financing Documents.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();






    // addFooter();

    //-------------------------------new page---------------------------
    doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.9 Entire Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`This Agreement and other Financing Documents shall constitute the entire agreement between the Parties
about the subject matter, comprised within the Financing Documents and shall replace all previous
agreements between the Parties on that subject matter. The Borrower has not relied on any oralor written
representation or warranty made, or purportedly made, by or on the behalf of the Lender, exceptas set out in
the Financing Documents.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.10 Survival ofRights`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

doc.font('Helvetica')
.fontSize(9)
.text(`The provisions of Clause 16 (Indemnity), Clause 20.1 (Notices), Clause 20.15 (Dispute Resolution) Clause 19
(Governing Law and Jurisdiction) and this Clause 20.10 (Survival of Rights) and other clauses which by their
nature are intended to survive, shall survive termination or expiry of this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.11 Benefits:`,
{ align: 'justify', indent: 40, lineGap: 5 }
);


doc.font('Helvetica')
.fontSize(9)


.text(
`The terms and provisions of this Agreement shall be binding upon, and the benefits & obligations hereof shall
inure or pass on to the Lender's successors and assigns, and Borrower's successors and permitted assigns (if
appointed after permission of Lender, and as the case maybe), who in absence of Borrower will be required
to fulfil each and every requirement or obligation as maybe required by Lender from time to time or as
detailed under this Agreement.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.12 Liability of Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`In the event of there being more than one Borrower (Co-Borrower), the liability of each Co-Borrower
hereunder shall be co-extensive as that of Borrower’s liability. Each of the Co-Borrowers shall be having same
and equal extent of liabilities as that of other Borrower under this Agreement and in the Event of Default, the
liabilities of all the Borrowers and Co-Borrower shall be cumulative towards the Lender and the Lender at its
discretion may proceed against any or all of the Borrower or Co-Borrowers`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.13 Acceptance`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees and acknowledges that this entire Agreement, duly filled in
schedules/annexures/letters/undertakings hereto, Sanction Letter and other documents relating to Facility
have been explained to the Borrower in the language understood by it, and it has understood the entire
meaning of the aforementioned and shall be bound by all the conditions mentioned therein. Any act of
acceptance of the terms contained herein or token thereof (including acceptance through facsimile or
electronic transmission) by the Borrower (in a manner acceptable to the Lender) may be considered as due
and proper execution of this Agreement on the part of the Borrower.

20.14 The Borrower hereby represents and warrants the genuineness of the signatures of the authorised
signatories of the Borrower, or each of the Borrowers in the event of there being more than one Borrower,
as the case may be.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();

// doc.font('Helvetica-Bold')
// .fontSize(9)


// .text(
// `20.15 Dispute Resolution`,
// { align: 'justify', indent: 40, lineGap: 5 }
// );
// doc.font('Helvetica')
// .fontSize(9)


// .text(
// `All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
// after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
// used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
// Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
// the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
// arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
// Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
// shall be conducted preferably through online means or otherwise through conventional means in English
// language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
// conducted through conventional means) shall be at Delhi.`,
// { align: 'justify', indent: 40, lineGap: 5 }
// ).moveDown();

// addFooter();

  //-------------------------------new page---------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

  doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.15 Dispute Resolution`,
{ align: 'justify', indent: 40, lineGap: 5 }
);

  doc.font('Helvetica')
.fontSize(9)


.text(
`All claims, disputes, differences or questions of any nature arising between the Parties, whether during or
after the termination of this Agreement, in relation to the construction, meaning or interpretation of any term
used or clause of this Agreement or as to the rights, duties, liabilities of the parties arising out of this
Agreement, shall be resolved through arbitration, which shall be administered by an institution recognised by
the government of India for dispute resolution, such institution will appoint the arbitrator for conducting the
arbitration proceedings in accordance with its rules for conduct of arbitration proceedings under the
Arbitration and Conciliation Act, 1996 as may be amended from time to time. The arbitration proceedings
shall be conducted preferably through online means or otherwise through conventional means in English
language. The arbitral award shall be final and binding on the Parties. The seat and venue of arbitration (if
conducted through conventional means) shall be at Delhi.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();
  
  doc.font('Helvetica-Bold')
  .fontSize(9)
  
  
  .text(
  `20.16 Counterparts`,
  { align: 'justify', indent: 40, lineGap: 5 }
  );
  
  doc.font('Helvetica')
  .fontSize(9)
  .text(`The Agreement may be executed in any number of counterparts, each of which (without variation) shall
constitute an original and all of which together shall constitute one and the same instrument. Delivery of an
executed counterpart of the signature page to this Agreement by facsimile shall be as effective as delivery of
a manually executed counterpart of this Agreement.`,
  { align: 'justify', indent: 40, lineGap: 5 }
  ).moveDown();
  


doc.font('Helvetica-Bold')
.fontSize(9)


.text(
`20.17 Status of the Loan Agreement`,
{ align: 'justify', indent: 40, lineGap: 5 }
);
doc.font('Helvetica')
.fontSize(9)


.text(
`The Borrower agrees that its obligations hereunder are absolute and unconditional and shall not be affected
by any circumstance (including any right of set-off or counterclaim), which otherwise might, prior to the
satisfaction of those obligations, operate to release or constitute a discharge or other-wise exonerate the
Borrower from its obligations hereunder or affect such obligations, with the intent that the Borrower’s
obligations under this Agreement shall remain at all times in full force and effect until payment of the
amounts due under this Agreement have been made in full and all obligations of the Borrower under this
Agreement have been fully discharged to the satisfaction of the Lender.`,
{ align: 'justify', indent: 40, lineGap: 5 }
).moveDown();







    // addFooter();




//-----------------------------------new page-------------------------------------
    // Add logo and border to the first page
    doc.addPage();
    // addLogo();
    // drawBorder();


  
    // Title styling for OFFER LETTER in uppercase and underlined
    doc.moveDown(6);
    const yPosition = doc.y; // Get the current y position
  
    doc
      .fontSize(7)
      .font(fontBold)
      .text("Schedule", { align: "center" })
      .moveDown(1)
      .text("(Forming part & parcel of Agreement)", { align: "center" })
      .moveDown(1)
      .text(` DATED :${allPerameters.agreementdate} \n\n Place of Agreement : Indore \n\n Location of the Lender’s Office/Branch : Indore` , { align: "left" })
    
    doc.moveDown(4);

    doc
    .fontSize(9)
    .font('Helvetica-Bold')
    .text("Borrower(s) Details", { align: "left" })
    .moveDown(0.5)
    // Add a function to draw black table borders
    function drawTable(tableData) {
        const startX = 50;
        let startY = doc.y + 10;
        const columnWidths = [500]; // Total width for the table
        const keyWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for field names
        const valueWidth = Math.round((columnWidths[0] * 1) / 2); // Half width for values
        
        // Function to draw a block for borrower details
        function drawBorrowerBlock(borrowerData) {
            borrowerData.forEach((row, rowIndex) => {
                let valueRowHeight = 20; // Set height for each row
    
                // Check if it's a special row like "Borrower/Security Provider Details" or "Guarantor"
                if (row.field1 === "Borrower/Security Provider Details" || row.field1 === "Guarantor") {
                    // Draw a full-width row (horizontal lines only)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth + valueWidth, valueRowHeight) // Full-width
                        .strokeColor("black")
                        .lineWidth(0.5)
                        .moveTo(startX, startY) // Top horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw text across the full width
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth + valueWidth // Full width for text
                        });
                } else {
                    // Draw field background (for regular fields like 'Name', 'Residence Address', etc.)
                    doc.lineWidth(0.5)
                        .fillColor("#f5f5f5")
                        .rect(startX, startY, keyWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX, startY) // Top horizontal line for field name
                        .lineTo(startX + keyWidth, startY)
                        .stroke()
                        .moveTo(startX, startY + valueRowHeight) // Bottom horizontal line for field name
                        .lineTo(startX + keyWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw field name (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.field1, startX + 5, startY + 5, {
                            baseline: "hanging",
                            width: keyWidth
                        });
    
                    // Draw value background (half-width for value)
                    doc.fillColor("#ffffff")
                        .rect(startX + keyWidth, startY, valueWidth, valueRowHeight)
                        .strokeColor("black")
                        .moveTo(startX + keyWidth, startY) // Top horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY)
                        .stroke()
                        .moveTo(startX + keyWidth, startY + valueRowHeight) // Bottom horizontal line for value
                        .lineTo(startX + keyWidth + valueWidth, startY + valueRowHeight)
                        .stroke()
                        .fill();
    
                    // Draw value text (half-width)
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(row.value1 || "", startX + keyWidth + 5, startY + 5, {
                            baseline: "hanging",
                            width: valueWidth
                        });
                }
    
                // Move to next row
                startY += valueRowHeight;
            });
    
            // Add spacing after each borrower block
            startY += 10;
        }
    
        // Filter and group data for each borrower block
        const borrowerBlocks = [];
        let currentBlock = [];
    
        tableData.forEach(row => {
            if (row.field1.includes("Borrower/Security Provider Details") || row.field1 === "Guarantor") {
                if (currentBlock.length > 0) {
                    borrowerBlocks.push(currentBlock);
                }
                currentBlock = [];
            }
            currentBlock.push(row);
        });
    
        if (currentBlock.length > 0) {
            borrowerBlocks.push(currentBlock);
        }
    
        // Draw each borrower block
        borrowerBlocks.forEach(borrowerData => {
            drawBorrowerBlock(borrowerData);
        });
    }
    
    const loanTableData = [
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.customerName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.address}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.registeredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.corporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.emailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.constitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.identityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.typeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.securityProvider}` },
        { field1: "Borrower/Security Provider Details" },
        { field1: "a) Name", value1: `${allPerameters.coApplicantName}` },
        { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddress}` },
        { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddress}` },
        { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddress}` },
        { field1: "e) Email Address", value1: `${allPerameters.coEmailAddress}` },
        { field1: "f) Constitution", value1: `${allPerameters.coConstitution}` },
        { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumber}` },
        { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrower}` },
        { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProvider}` },
    ];
    
    // Call the drawTable function to generate the table
    drawTable(loanTableData);
    // doc.moveDown(2);
  
    // addFooter();
    
   
  //---------------------------------------- new page 2--------------------------------------------------
  // doc.addPage();
  // // addLogo();
  // // drawBorder();
  // doc.moveDown(7);
  
  // const secondPageTable = [
  //   { field1: "Borrower/Security Provider Details" },
  //   { field1: "a) Name", value1: `${allPerameters.coApplicantNameTwo}` },
  //   { field1: "b) Residence Address", value1: `${allPerameters.coResidenceAddressTwo}` },
  //   { field1: "c) Registered Office Address", value1: `${allPerameters.coRegisteredOfficeAddressTwo}` },
  //   { field1: "d) Corporate Office Address", value1: `${allPerameters.coCorporateOfficeAddressTwo}` },
  //   { field1: "e) Email Address", value1: `${allPerameters.coEmailAddressTwo}` },
  //   { field1: "f) Constitution", value1: `${allPerameters.coConstitutionTwo}` },
  //   { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.coIdentityNumberTwo}` },
  //   { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.coTypeOfBorrowerTwo}` },
  //   { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.coSecurityProviderTwo}` },
   
  //   // { field1: "Guarantor" },
  //   // { field1: "a) Name", value1: `${allPerameters.guarantorName}` },
  //   // { field1: "b) Residence Address", value1: `${allPerameters.guarantorAddress}` },
  //   // { field1: "c) Registered Office Address", value1: `${allPerameters.guarantorRegisteredOfficeAddress}` },
  //   // { field1: "d) Corporate Office Address", value1: `${allPerameters.guarantorCorporateOfficeAddress}` },
  //   // { field1: "e) Email Address", value1: `${allPerameters.guarantorEmailAddress}` },
  //   // { field1: "f) Constitution", value1: `${allPerameters.guarantorConstitution}` },
  //   // { field1: "g) Unique Identity Number (PAN/CIN/Reg. No)", value1: `${allPerameters.guarantorIdentityNumber}` },
  //   // { field1: "h) Type of Borrower (Main Applicant/Co-Applicant)", value1: `${allPerameters.guarantorTypeOfBorrower}` },
  //   // { field1: "i) Business or Employment of the Borrower/Security Provider", value1: `${allPerameters.guarantorSecurityProvider}` },
  // ];
  // drawTable(secondPageTable);
  // // doc.moveDown(2);
  // // addFooter();
  
//   // ------------------------------------- new page 3-------------------------------------------------
  
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);

function newTable(tableData) {
    const startX = 50;
    let startY = doc.y + 10;
    const columnWidths = [500];

    const keyWidth = Math.round((columnWidths[0] * 1) / 2);
    const valueWidth = Math.round((columnWidths[0] * 1) / 2);

    tableData.forEach((row, rowIndex) => {
        doc.lineWidth(0.5);

        const valueText = row.value1 || "";
        const isFullWidthRow = row.field1 === "Details of the Loan/Credit Facility" || row.field1.startsWith("Payment Instrument(s)");
        
        // Calculate row height to accommodate multiline text
        let rowWidth = isFullWidthRow ? columnWidths[0] : valueWidth;

        // Set specific height for "Payment Instrument(s)" row
        let rowHeight;
        if (row.field1.startsWith("Payment Instrument(s)")) {
            // Increase height for this specific row
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 60; // Increase height as needed
        } else {
            rowHeight = doc.heightOfString(valueText, { width: rowWidth, font: font, align: 'left' }) + 10; // Normal height for other rows
        }
        rowHeight = Math.max(rowHeight, 20); // Set a minimum height if needed

        // Draw background for the row
        doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX, startY, columnWidths[0], rowHeight)
            .stroke("black")
            .fill();

        if (isFullWidthRow) {
            // Render full-width text with wrapping
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1 + "\n" + valueText, startX + 5, startY + 8, {
                    baseline: "top",
                    width: columnWidths[0] - 10, // Slight padding to avoid overflow
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        } else {
            // Draw first column cell
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 8, {
                    baseline: "top",
                    width: keyWidth,
                    align: 'left'
                });

            // Draw second column cell with wrapping
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke("black")
                .fill();
            doc.font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(valueText, startX + keyWidth + 5, startY + 8, {
                    baseline: "top",
                    width: valueWidth - 10, // Prevent overflow by setting width constraint
                    align: 'left',
                    height: rowHeight - 10, // Ensure the text wraps within the row height
                });
        }

        // Move to the next row position
        startY += rowHeight;
    });
}
  
  const details = [
    { field1: "Purpose of the Loan/Credit Facility", value1: `WORKING CAPITAL` },
    { field1: "Details of the Loan/Credit Facility", value1: ``},
    { field1: "Loan Amount/Credit Facility", value1: `Rs.${allPerameters.loanAmount}` },
    { field1: "Security Details (Details of the Security as per Sanction Letter such as Property Address/Equipment details/Intangible Collateral, etc.)", value1:`${allPerameters.securityDetails}` },
    { field1: "Security Cover", value1: `${allPerameters.securityCover}` },
    { field1: "Tenor or Tenure of the Loan/Credit Facility", value1: `${allPerameters.tenor} Months` },
    { field1: "Rate of Interest", value1: `FLOATING RATE OF INTEREST \n · Grow Money Reference Rate (URR): ${allPerameters.benchmarkInterest}% p.a (per cent per annum)\n · Floating Rate of Interest(p.a.): URR + ${allPerameters.SpreadInterestRate}%=${allPerameters.Roi}% p.a. (per cent per annum) Review Frequency: Monthly` },
    { field1: "Sanction Letter", value1: `${allPerameters.sanctionLetterDate}` },
    { field1: "Application Fees", value1: `2% + 18% GST` },
    { field1: "Processing Fees", value1: `2% + 18% GST` },
    { field1: "CERSAI Charges", value1: `AS APPLICABLE` },
    { field1: "Late Payment Interest/Additional Interest", value1: `___% p.m. (________ per cent per month) or _____ % p.a. (_________ per cent per annum) on the Instalment overdue from the date of overdue upto the date of payment` },
    { field1: "Repayment Bank A/c Details", value1: `${allPerameters.repaymentBank}` },
    { field1: "Details of Receivables", value1: `${allPerameters.detailsOfReceivables}`, },
    { field1: "Pre-payment/Foreclosure of the Facility", value1:  `· 6% of Principal outstanding for loan foreclosed within 12 months of loan sanction \n · 4% of Principal outstanding for loan foreclosed after 12 months of loan sanction \n regulatory requirements and directions prescribed by Reserve Bank of India from time to time.` },
    { field1: "Payment Instrument(s)\n Bank Account on which the Repayment Cheques are drawn and/or EDI (Electronic Debit Instrument)/NACH are made and details thereof\n · The Repayment Cheque/NACH can be used by the FIN COOPERS for realization of delayed payment charges/Default Interest also and in such events additional cheque(s)/NACH shall be furnished to cover the balance Repayment Amount.(“Account”)\n · Repayment Cheques should be in favour of “FIN COOPERS Securities Pvt Ltd”", value1: `` },
  ];
  
  newTable(details);
  
  doc.moveDown(2)
  
  doc
  .fontSize(8)
  .font('Helvetica')
  .text("Repayment details:", { align: "left" })
  .moveDown(1)
  

function repaymentFunction(tableData) {
  const startX = 50;
  let startY = doc.y + 10;

  // Function to draw a checkbox
  const drawCheckbox = (doc, x, y, size, isChecked) => {
      doc
          .rect(x, y, size, size) // Draw checkbox square
          .stroke();
      if (isChecked) {
          doc
              .moveTo(x, y + size / 2)
              .lineTo(x + size / 3, y + size - 2)
              .lineTo(x + size - 2, y + 2)
              .strokeColor('black')
              .stroke();
      }
  };

  const validColumns = Object.keys(tableData[0]).filter((key) => {
      return tableData.some(row => row[key] !== ""); // Exclude blank columns
  });
  const columnCount = validColumns.length;

  const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // Dynamic column widths
  const fixedRowHeight = 20;

  // Render the first column
  const firstColumnValue = tableData[0][validColumns[0]];
  doc.fillColor("#f5f5f5")
      .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length)
      .stroke("black")
      .fill();

  doc.font(font)
      .fillColor("black")
      .fontSize(7.2)
      .text(firstColumnValue, startX + 5, startY + 5, {
          width: columnWidths[0] - 10,
          align: 'left',
      });

  // Render other rows
  tableData.forEach((row, rowIndex) => {
      doc.lineWidth(0.5);

      doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
          .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], fixedRowHeight)
          .stroke("black")
          .fill();

      validColumns.slice(1).forEach((columnKey, colIndex) => {
          const value = row[columnKey];
          const cellX = startX + columnWidths.slice(0, colIndex + 1).reduce((acc, width) => acc + width, 0);
          const cellWidth = columnWidths[colIndex + 1];

          // Draw cell background
          doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
              .rect(cellX, startY, cellWidth, fixedRowHeight)
              .stroke("black")
              .fill();

          if (value === "check") {
              // Draw checkbox if the value is "check"
              drawCheckbox(doc, cellX + 5, startY + 5, 10, true);
          } else {
              // Handle regular text
              const lines = (value || "").split('\n');
              lines.forEach((line, lineIndex) => {
                  doc.font(font)
                      .fillColor("black")
                      .fontSize(7.2)
                      .text(line, cellX + 5, startY + 5 + (lineIndex * 10), {
                          baseline: "hanging",
                          width: cellWidth - 10,
                      });
              });
          }
      });

      startY += fixedRowHeight;
  });
}


const repaymentTable = [
    { field1: "Repayment Options", filed2: "EMI", field3: "Step Up", field4: "Step Down", field5: "Structured", field6: "Balloon", field7: "Bullet" },
    { field1: "", filed2:"check", field3: ``, field4: ``, field5: ``, field6: ``, field7: `` },
];

repaymentFunction(repaymentTable);



// Call the function to draw the table

doc.moveDown(0.8)
const repaymentFrequencyTable = [
    { field1: "Repayment Frequency", filed2: "Monthly", field3: "Bi-monthly", field4: "Quarterly", field5: "Half Yearly", field6: "Yearly",},
    { field1: "", filed2: "check", field3: ``, field4: ``, field5: ``, field6: ``,  },
];

repaymentFunction(repaymentFrequencyTable);
  
  // addFooter();
  
//   //---------------------------------------- new page 4--------------------------------------------------
  doc.addPage();
  // addLogo();
  // drawBorder();
  doc.moveDown(7);


const repaymentDateTable = [
    { field1: "Repayment Cycle date", filed2: "3rd of the month ", field3: "5th of the month", field4: "10th of the month" },
    { field1: "", filed2: ``, field3: ``, field4: "check",  },
];

repaymentFunction(repaymentDateTable);
doc.moveDown(0.5);

function intrestTableFunction(tableData) {
    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;
    const totalWidth = 500; // Total column width
    const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
    const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

    tableData.forEach((row, rowIndex) => {
        // Set default row height
        let rowHeight = 15;

        // Calculate the height of the text for field1 and value1
        const field1TextHeight = doc
            .font(font)
            .fontSize(7.2)
            .heightOfString(row.field1, { width: keyWidth });

        let value1TextHeight = 0;
        if (row.value1) {
            value1TextHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(row.value1, { width: valueWidth });
        }

        // Determine the maximum height between field1 and value1 to set row height
        rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

        // Alternate row background color
        doc.lineWidth(0.5);
        doc
            .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX, startY, keyWidth, rowHeight)
            .stroke("black")
            .fill();

        // Draw text in field1 cell
        doc
            .font(font)
            .fillColor("black")
            .fontSize(7.2)
            .text(row.field1, startX + 5, startY + 5, {
                baseline: "hanging",
                width: keyWidth,
            });

        // Draw the second column, even if value1 is absent
        doc
            .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX + keyWidth, startY, valueWidth, rowHeight)
            .stroke()
            .fill();

        // Draw the key-value pair for value1 or leave it empty
        const keyValueText = row.value1 ? `${row.value1}` : ""; // Show empty text if no value
        doc
            .font(font)
            .fillColor("black")
            .fontSize(7.2)
            .text(keyValueText, startX + keyWidth + 5, startY + 5, {
                baseline: "hanging",
                width: valueWidth,
            });

        // Draw vertical line between the columns
        doc.lineWidth(0.5);
        doc.strokeColor("black");
        doc.moveTo(startX + keyWidth, startY);
        doc.lineTo(startX + keyWidth, startY + rowHeight);
        doc.stroke();

        // Move to the next row position
        startY += rowHeight;
    });
}

  
const intrestData = [
  { field1: "Pre-Instalment Interest Date(s)",value1: `${allPerameters.preInstalmentInterestDate}` },
  { field1: "Date when first instalment is due", value1: `10TH OF EVERY MONTH` },
  { field1: "Total No. of Instalments", value1: `${allPerameters.tenor} Months` },
  { field1: "Amount of each instalment", value1: `Rs.${allPerameters.amountOfEachInstalment}` },
  { field1: "Exact dates of repayment", value1: `The instalments shall be due on the repayment cycle date as mentioned above basis the frequency agreed. \n\n The repayment dates are subject to change depending on the Disbursement of the Facility. Exact dates of repayment shall be communicated through a detailed repayment schedule which shall be sent along with a welcome letter` },
];

intrestTableFunction(intrestData);
doc.moveDown(-0.5);

function repaymentAmountFunction(tableData) {
    // Check if tableData is not empty
    if (!Array.isArray(tableData) || tableData.length === 0 || typeof tableData[0] !== 'object') {
        console.error("Invalid table data");
        return;
    }

    const fixedRowHeight = 20; // Define fixed row height

    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;

//     // Determine the number of columns from the first row, excluding blank fields
    const validColumns = Object.keys(tableData[0]).filter((key) => {
        return tableData.some(row => row[key] !== ""); // Exclude columns that are completely blank
    });
    const columnCount = validColumns.length;

    // Set column widths (first column wider)
    const columnWidths = [150, ...Array(columnCount - 1).fill((500 - 150) / (columnCount - 1))]; // First column = 150, others share the remaining width

    // Function to calculate required height based on text content
    const calculateRowHeight = (row, isLastRow) => {
        const lineHeight = 10; // Height of each line (adjust as necessary)
        let maxHeight = 0;

        // Calculate height needed for each column in the row
        validColumns.forEach((columnKey) => {
            const value = row[columnKey] || "";
            const lines = value.split('\n');
            const cellHeight = lines.length * lineHeight + 10; // 10 for padding
            maxHeight = Math.max(maxHeight, cellHeight);
        });

        // If it's the last row, ensure we check for the height of field2 specifically
        if (isLastRow) {
            const field2Height = (row[validColumns[1]] || "").split('\n').length * lineHeight + 10;
            maxHeight = Math.max(maxHeight, field2Height);
        }

        return maxHeight;
    };

    // Render first column spanning all rows
    const firstColumnValue = tableData[0][validColumns[0]]; // Value to be spanned in first column
    doc.fillColor("#f5f5f5")
        .rect(startX, startY, columnWidths[0], fixedRowHeight * tableData.length) // Spans across all rows
        .stroke("black")
        .fill();

    doc.font(font)
        .fillColor("black")
        .fontSize(7.2)
        .text(firstColumnValue, startX + 5, startY + 5, {
            width: columnWidths[0] - 10, // Adjust for padding
            align: 'left',
        });

    // Render the rest of the table row by row
    tableData.forEach((row, rowIndex) => {
        // Calculate the height for the current row
        const isLastRow = rowIndex === tableData.length - 1; // Check if it's the last row
        const rowHeight = calculateRowHeight(row, isLastRow);
        doc.lineWidth(0.5);

        // Alternate row background color
        doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
            .rect(startX + columnWidths[0], startY, 500 - columnWidths[0], rowHeight) // Background for other columns
            .stroke("black")
            .fill();

        // Check if field3 and field4 are empty
        const isField3Empty = !row[validColumns[2]]; // Check if field3 is empty
        const isField4Empty = !row[validColumns[3]]; // Check if field4 is empty

        if (isField3Empty && isField4Empty) {
            // Span field2 across the rest of the columns
            const cellWidth = columnWidths[1] + columnWidths[2] + columnWidths[3]; // Total width of field2, field3, and field4 combined
            doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + columnWidths[0], startY, cellWidth, rowHeight) // Span cell
                .stroke("black")
                .fill();

            // Draw the value for field2
            const value = row[validColumns[1]];
            const lines = (value || "").split('\n');
            lines.forEach((line, lineIndex) => {
                doc.font(font)
                    .fillColor("black")
                    .fontSize(7.2)
                    .text(line, startX + columnWidths[0] + 5, startY + 5 + (lineIndex * 10), {
                        baseline: "hanging",
                        width: cellWidth - 10, // Adjust for padding
                    });
            });
        } else {
            // Draw field2, field3, and field4 normally
            validColumns.slice(1).forEach((columnKey, colIndex) => {
                const value = row[columnKey];
                const cellWidth = columnWidths[colIndex + 1];
                doc.fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                    .rect(startX + columnWidths[0] + colIndex * cellWidth, startY, cellWidth, rowHeight) // For each column after the first
                    .stroke("black")
                    .fill();

                // Handle line breaks in the cell
                const lines = (value || "").split('\n');
                lines.forEach((line, lineIndex) => {
                    doc.font(font)
                        .fillColor("black")
                        .fontSize(7.2)
                        .text(line, startX + columnWidths[0] + colIndex * cellWidth + 5, startY + 5 + (lineIndex * 10), {
                            baseline: "hanging",
                            width: cellWidth - 10, // Adjust for padding
                        });
                });
            });
        }

        // Move to next row position
        startY += rowHeight; // Adjust starting position based on calculated row height
    });
}

const repaymentAmountTable = [
    { field1: "Total Repayment Amount", filed2: "Principal ", field3: "Total Interest*", field4: "Total repayment amount" },
    { field1: "", filed2:  `${allPerameters.loanAmount}`, field3:  `${allPerameters.totalInterest}`, field4:  `${allPerameters.totalRepaymentAmount}`, },
    { field1: "", filed2: "*The interest amount is calculated basis the ROI and Tenure of the Facility and is excluding any Pre EMI/ broken period interest that may be computed and applied basis the Disbursement date", field3: "", field4: "", },
];

// Call the function with the correct parameter
// repaymentAmountFunction(repaymentAmountTable);
doc.moveDown(-0.1);
const npaTable = [
    { field1: "Default and NPA  classification",value1: `Please refer Annexure 1` },
  ];
  intrestTableFunction(npaTable);
  doc.moveDown(1.5);

  const startX = 50; // Set a left margin
  const startY = doc.y; // Get the current Y position
  
  doc
    .fontSize(8)
    .font('Helvetica')
    .text(
      `Repayment Cheques should be drawn in favour of GROW MONEY CAPITAL PVT LTD\n` +
      `Schedule of Charges on the Loan / Credit Facility\n\n\n\n` +
      `Details pertaining to the Loan Application by Borrower(s) / Co-Borrower(s)\n` +
      `Received copy of Agreement along with the Schedules and Annexure thereto`, 
      startX, // Use the startX value for left alignment
      startY, // Start at the current Y position
      {
        width: 500, // Define a width for text wrapping if needed
        indent: 0, // No indentation
        paragraphGap: 10, // Space between paragraphs
      }
    );
  // addFooter();

// //------------------------------------------- new page 5--------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Annexure 1`, startX, doc.y, { align: "center", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(9)
.font('Helvetica-Bold')
.text(`Illustration on due dates and NPA classification`, startX, doc.y, { align: "left", width: 500, underline:true });
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`If due date of a loan account is March 31, 2021, and full dues are not received before the lending institution runs the day-end process for this date, the date of overdue shall be March 31, 2021. If it continues to remain overdue, then this account shall get tagged as SMA-1 upon running day-end process on April 30, 2021 i.e. upon completion of 30 days of being continuously overdue. Accordingly, the date of SMA-1 classification for that account shall be April 30, 2021.\n\nSimilarly, if the account continues to remain overdue, it shall get tagged as SMA-2 upon running day-end process on May 30, 2021 and if continues to remain overdue further, it shall get classified as NPA upon running day-end process on June 29, 2021.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);


function tableFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row
        for (let field in row) {
            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows, no bold for header
            doc
                .font('Helvetica') // Regular font
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const tableData = [
    { field1: "Status", field2: "DPD", field3: "Illustration 2", field4: "Illustration 1", field5: "Illustration 3", field6: "Illustration 4 (Leap year)" },
    { field1: "*Due date/Overdue (if not paid)", field2: `1 day`, field3: `05-02-22`, field4:`03-06-22`, field5:`15-01-22`, field6: `15-01-24` },
    { field1: "SMA-1", field2: `31 days`, field3: `07-03-22`, field4: `03-07-22`, field5: `14-02-22`, field6: `14-02-24` },
    { field1: "SMA-2", field2: `61 days`, field3: `06-04-22`, field4: `02-08-22`, field5: `16-03-22`, field6: `15-03-24` },
    { field1: "#Non-Performing Asset", field2: `91 days`, field3: `06-05-22`, field4: `01-09-22`, field5: `15-04-22`, field6: `14-04-24` },
];

// Call the function to create the table
tableFunction(tableData);  
doc.moveDown(2)

doc
.fontSize(8)
.font('Helvetica')
.text(`* Any amount due to the lender under any credit facility is ‘overdue’ if it is not paid on the due date fixed by the Lender. If there is any overdue in an account, the default/ non-repayment is reported with the credit bureau companies like CIBIL etc. and the CIBIL report of the customer will reflect defaults and its classification status.\n\n# Once an account is classified as NPAs then it shall be upgraded as ‘standard’ asset only if entire arrears of interest and principal are paid by the borrower\n\nIN WITNESS WHEREOF the Parties hereto have hereunto set and execute this Agreement on the day and year as first mentioned hereinabove.`, startX, doc.y, { align: "left", width: 500,});
doc.moveDown(2);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Lender:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);
doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named GROW MONEY\nCAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(6)
.font('Helvetica')
.text(`________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`Authorised Signatory.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(7)
.font('Helvetica')
.text(`For the Borrowers and Co-Borrowers:`,startX, doc.y, { align: "left", width: 500,underline:true})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`SIGNED AND DELIVERED by the within named “Borrowers”\nand “Co-Borrowers”`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`.1 ${allPerameters.nameOne}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`.2 ${allPerameters.nameTwo}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`.3 ${allPerameters.namethird}`,startX, doc.y, { align: "left", width: 500})
// doc.moveDown(1);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`____________________________________`,startX, doc.y, { align: "left", width: 500})
// doc.moveDown(0.5);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`.4 ${allPerameters.nameFourth}`,startX, doc.y, { align: "left", width: 500})
// doc.moveDown(1);

// doc
// .fontSize(8)
// .font('Helvetica')
// .text(`____________________________________`,startX, doc.y, { align: "left", width: 500})



// addFooter();

// // --------------------------------------------new page 6-------------------------------------------------------


doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(9)
.font('Helvetica')
.text(`Affix Revenue Stamp`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`DEMAND PROMISSORY NOTE`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.font('Helvetica')
.text(`To,\nThe Manager\nGROW MONEY CAPITAL PVT LTD\nFlat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`On demand I/We and our respective heirs, representatives, executors, administrators, successors and/or permitted assigns,(jointly & severally) unconditionally promise to pay GROW MONEY CAPITAL PVT LTD (“GROW MONEY”, including, its successors and assigns), or order, for value received, the sum of Rs. ${allPerameters.loanAmount}/-${allPerameters.loanAmountinwords} along with applicable interest and charges thereon, which may from time to time be varied in accordance with the policy decision of GROW MONEY.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(4);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`To be signed by the Borrower(s)\n\nPlace - ${allPerameters.borrowerPlace}\n\nDATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`______________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);
doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);


// addFooter();


// //----------------------------------------------new page 7-----------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST FORM`,startX, doc.y, { align: "center", width: 500, underline:true})
doc.moveDown(1);

function requestFunction(tableData) {
    // Add Table Header
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const numFields = Object.keys(tableData[0]).length; // Get number of fields from the first row
    const fieldWidth = boxWidth / numFields; // Calculate width for each column

    // Calculate the total height needed for the entire box
    let totalHeight = 0;

    // Calculate the height for each row and determine the total height of the box
    tableData.forEach((row) => {
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }
        totalHeight += rowHeight; // Accumulate the total height
    });

    // Draw the outer rectangle for the box with normal line width
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .lineWidth(0.5) // Set thinner line width for borders
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row
        // Calculate row height based on the content in each field
        let rowHeight = 0;
        for (let field in row) {
            const fieldTextHeight = doc
                .font('Helvetica') // Regular font for calculating height
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidth }) + 10; // Add padding
            rowHeight = Math.max(rowHeight, fieldTextHeight); // Get the maximum height for the row
        }

        // Draw rectangles for each field in the row with normal line width
        for (let field in row) {
            // Draw rectangle for the field box
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, fieldWidth, rowHeight)
                .lineWidth(0.5) // Set thinner line width for field borders
                .stroke("black") // Border for field box
                .fill();

            // Set font style based on whether it's the header row
            const isHeader = rowIndex === 0; // Check if it's the header row
            doc
                .font(isHeader ? 'Helvetica-Bold' : 'Helvetica') // Set font to bold for header
                .fillColor("black")
                .fontSize(7.2);

            // Determine text alignment based on field index (you can customize this as needed)
            const align = (field === 'field3') ? 'center' : 'left'; // Center field3, left for others

            // Draw the field text in the box
            doc.text(row[field], currentX + 5, startY + 5, {
                baseline: "hanging",
                width: fieldWidth - 10, // Adjust width to provide padding inside the box
                align: align, // Align text based on content
            });

            // Move to the next column
            currentX += fieldWidth; // Update X position for the next field
        }

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row
    });
}

    
const requestTableData = [
    { field1: "Name of Applicant", field2: `${allPerameters.customerName}`},
    { field1: "Loan ID", field2: `${allPerameters.loanId}` },
    { field1: "Disbursement Amount Request", field2: `Rs.${allPerameters.disbursementAmount}` },
    { field1: "Date by which the Disbursement is required", field2: `${allPerameters.dateDisbursementRequired}` },
    { field1: "Loan Type ", field2: `Secured Loan` },
    { field1: "LAN No", field2: `${allPerameters.lanNo}` },
];

// Call the function to create the table
requestFunction(requestTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH CHEQUE(S)/DRAFT[1](S) REQUIRED`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const requiredTable = [
    { field1: "Cheque/DD in favour of Payee", field2: "Payable At", field3: "Bank Name of Payee", field4: "Savings/Current Bank Account No of Payee", field5: "Amount" },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
    { field1: ``, field2: ``, field3: ``, field4: ``, field5: `` },
];

// Call the function to create the table
tableFunction(requiredTable);  
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DISBURSEMENT REQUEST THROUGH RTGS`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(1);

const rtgsTableData = [
    { field1: "PARTICULARS", field2: "CUSTOMER DETAILS"},
    { field1: "Account Holder Name", field2: `${allPerameters.accountHolderName}` },
    { field1: "Bank Name", field2: `${allPerameters.nameOfBank}` },
    { field1: "Bank Address", field2: `${allPerameters.bankAddress}` },
    { field1: "Bank Account No.", field2: `${allPerameters.accountNo}` },
    { field1: "Bank Account Type", field2: `${allPerameters.accountType}` },
    { field1: "IFSC Code", field2: `${allPerameters.IFSCCode}` },
    { field1: "Customer E-Mail Address", field2: `${allPerameters.emailAddress}` },
    { field1: "For Official Use", field2: `${allPerameters.officeUse}` },
    { field1: "Amount Payable", field2: `${allPerameters.amountPayable}` },
    { field1: "Application ID", field2: `${allPerameters.applicantId}` },
    { field1: "Agreement No", field2: `${allPerameters.agrementNo}` },
];

// Call the function to create the table
requestFunction(rtgsTableData); 
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Operation`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(-2);

doc
.fontSize(8)
.font('Helvetica')
.text(`DATED : ${allPerameters.disbursementDate}`,startX, doc.y, { align: "left", width: 500, underline:true})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Applicant`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`__________________`,startX, doc.y, { align: "right", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Signature of Co-Applicants`,startX, doc.y, { align: "right", width: 500});
// doc.moveDown(0.5);

// addFooter();

// // -------------------------------------------------new page 8------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`REPAYMENT CHEQUE ACKNOWLEDGEMENT LETTER`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(0.5);

function latterTableFunction(tableData) {
    // Add Table Header
    const startX = 50;
    let startY = doc.y + 10;
    const totalWidth = 500; // Total column width
    const keyWidth = Math.round(totalWidth * 0.3); // 30% of the total width
    const valueWidth = totalWidth - keyWidth; // Remaining width for the value column

    tableData.forEach((row, rowIndex) => {
        // Set default row height
        let rowHeight = 15;

        // If it's the last field, span both columns
        if (rowIndex === tableData.length - 1) {
            const fullText = `${row.field1} ${row.value1 || ''}`.trim();
            const textHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(fullText, { width: totalWidth });

            rowHeight = textHeight + 10; // Add some padding

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, totalWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw the text spanning both columns
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(fullText, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: totalWidth,
                });
        } else {
            // Calculate the height of the text for field1 and value1
            const field1TextHeight = doc
                .font(font)
                .fontSize(7.2)
                .heightOfString(row.field1, { width: keyWidth });

            let value1TextHeight = 0;
            if (row.value1) {
                value1TextHeight = doc
                    .font(font)
                    .fontSize(7.2)
                    .heightOfString(row.value1, { width: valueWidth });
            }

            // Determine the maximum height between field1 and value1 to set row height
            rowHeight = Math.max(field1TextHeight, value1TextHeight) + 10;

            // Alternate row background color
            doc.lineWidth(0.5);
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX, startY, keyWidth, rowHeight)
                .stroke("black")
                .fill();

            // Draw text in field1 cell
            doc
                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(row.field1, startX + 5, startY + 5, {
                    baseline: "hanging",
                    width: keyWidth,
                });

            // Draw the second column, even if value1 is absent
            doc
                .fillColor(rowIndex % 2 === 0 ? "#f5f5f5" : "#ffffff")
                .rect(startX + keyWidth, startY, valueWidth, rowHeight)
                .stroke()
                .fill();

            // Draw the key-value pair for value1 or leave it empty
            // const keyValueText = row.value1 ? `Value: ${row.value1}` : ""; // Show empty text if no value
            const keyValueText = row.value1 || ""; 

            doc

                .font(font)
                .fillColor("black")
                .fontSize(7.2)
                .text(keyValueText, startX + keyWidth + 5, startY + 5, {
                    baseline: "hanging",
                    width: valueWidth,
                });

            // Draw vertical line between the columns
            doc.lineWidth(0.5);
            doc.strokeColor("black");
            doc.moveTo(startX + keyWidth, startY);
            doc.lineTo(startX + keyWidth, startY + rowHeight);
            doc.stroke();
        }

        // Move to the next row position
        startY += rowHeight;
    });
}

const letterData = [
  { field1: "Customer Name", value1: `${allPerameters.customerName}` },
  { field1: "Address", value1: `${allPerameters.address}` },
  { field1: "Contact Nos.", value1: `${allPerameters.registeredMobile}` },
  { field1: "Credit Facility", value1: `` },
  { field1: "Facility Amount", value1: `Rs.${allPerameters.loanAmount}-${allPerameters.loanAmountinwords}` },
  { field1: "Repayment Mode", value1: `NACH / PDC` },
  { field1: `MENTION THE COUNT OF CHEQUE RECEIVED\n\nCheque Received (A) Undated: 5 (B) Cancelled: 0\n\nCheques Handed over to Mr./Mrs.: ${allPerameters.chequesHandedName}\n\nSourcing Channel Name:${allPerameters.sourcingChannelName}`, value1: "" }
];

latterTableFunction(letterData);

function draweeFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const fieldWidths = [0.25 * boxWidth, 0.5 * boxWidth, 0.25 * boxWidth]; // Widths for each main column
    const extraPadding = 15; // Additional padding for row height

    // Calculate the total height for the entire box
    let totalHeight = 0;
    tableData.forEach(row => {
        let rowHeight = 0;
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });
        totalHeight += rowHeight;
    });

    // Set normal (thin) line width
    doc.lineWidth(0.5);

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0")
        .rect(startX, startY, boxWidth, totalHeight)
        .stroke("black")
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX;
        let rowHeight = 0;

        // Determine row height with extra padding
        ['field1', 'field2_1', 'field2_2', 'field3'].forEach(field => {
            const fieldTextHeight = doc
                .font('Helvetica')
                .fontSize(7.2)
                .heightOfString(row[field] || '', { width: fieldWidths[1] / 2 }) + extraPadding;
            rowHeight = Math.max(rowHeight, fieldTextHeight);
        });

        // Draw rectangles and text for each field in the row
        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[0], rowHeight).stroke("black");
        doc.font('Helvetica').fillColor("black").fontSize(7.2).text(row.field1, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[0] - 10, align: 'left' });
        currentX += fieldWidths[0];

        if (rowIndex === 0) {
            doc.rect(currentX, startY, fieldWidths[1], rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[1] - 10, align: 'center' });
            currentX += fieldWidths[1];
        } else {
            const subFieldWidth = fieldWidths[1] / 2;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_1 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
            doc.rect(currentX, startY, subFieldWidth, rowHeight).stroke("black").fillColor("black").text(row.field2_2 || "", currentX + 5, startY + 5, { baseline: "hanging", width: subFieldWidth - 10, align: 'center' });
            currentX += subFieldWidth;
        }

        doc.fillColor("#f5f5f5").rect(currentX, startY, fieldWidths[2], rowHeight).stroke("black").fillColor("black").text(row.field3, currentX + 5, startY + 5, { baseline: "hanging", width: fieldWidths[2] - 10, align: 'center' });

        // Move to the next row
        startY += rowHeight;
    });
}

// Sample data
const DraweeData = [
    { field1: "Drawee Bank", field2_1: "Cheque No.", field2_2: "", field3: "No of Cheques" },
    { field1: " ", field2_1: "From", field2_2: "To", field3: " " },
    { field1: `APP`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.appbranchName}`, field2_1: `${allPerameters.appchequeNo1}`, field2_2: `${allPerameters.appchequeNo5}`, field3: `${allPerameters.totalCheque}` },
    { field1: `GAU`, field2_1: ``, field2_2: ``, field3: `` },
    { field1: `${allPerameters.gaubranchName}`, field2_1: `${allPerameters.gaucheqNo1}`, field2_2: `${allPerameters.gauchequeNo5}`, field3: `${allPerameters.gautotalCheq}` },
];

// Call the function to create the table
draweeFunction(DraweeData);


doc.moveDown(3);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`I ${allPerameters.customerName} hereby confirm that I have handed over FIVE cheques detailed above towards repayment of Instalment(s) or security cheque for the loan/facility already taken/to be taken from GROW MONEY CAPITAL PVT LTD and that all cheques were drawn in favour of “GROW MONEY CAPITAL PVT LTD” and also recorded my name on the reverse side of the cheques.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`DATED : ${allPerameters.borrowerDate}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Name) - ${allPerameters.customerName}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`(Borrower Signature)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(9)
.fillColor('black')
.font('Helvetica')
.text(`This is to confirm that physical cheques were cross tallied with the above schedule and found correct.`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

function SignatureTableFunction(tableData) {
    const startX = 50; // Starting X position for the box
    let startY = doc.y + 10; // Starting Y position for the box
    const boxWidth = 500; // Total width of the box
    const normalRowHeight = 20; // Normal height for other rows
    const signatureRowHeight = 40; // Increased height for the signature row

    // Define fixed column widths for three columns
    const columnWidths = [150, 150, 200]; // Adjust widths for your layout

    // Calculate total height needed for the entire box
    let totalHeight = tableData.length * normalRowHeight; // Total height based on normal row height

    // Set normal (thin) line width
    doc.lineWidth(0.5); // Set normal border thickness

    // Draw the outer rectangle for the box
    doc
        .fillColor("#f0f0f0") // Box background color
        .rect(startX, startY, boxWidth, totalHeight) // Total height of the box
        .stroke("black") // Border color
        .fill();

    // Loop through the data and draw the text inside the box
    tableData.forEach((row, rowIndex) => {
        let currentX = startX; // Reset the starting X position for each row

        // Determine row height based on whether it's the signature row
        const rowHeight = rowIndex === 0 ? signatureRowHeight : normalRowHeight; // Change height for the first row (signature)

        // Draw rectangles for each field in the row
        columnWidths.forEach((width, index) => {
            const field = `field${index + 1}`;

            // Draw rectangle for the field box with thin lines
            doc
                .fillColor("#f5f5f5") // Background color for field (empty box)
                .rect(currentX, startY, width, rowHeight) // Use determined row height
                .stroke("black"); // Normal border thickness

            // Set regular font for all rows
            doc
                .font('Helvetica')
                .fillColor("black")
                .fontSize(7.2);

            // Draw the field text in the box
            const fieldValue = row[field] || ""; // Use empty string for missing fields
            doc.text(fieldValue, currentX + 3, startY + 5, {
                baseline: "hanging",
                width: width - 10, // Adjust width to provide padding inside the box
                align: 'left', // Align text to the left
            });

            // Move to the next column
            currentX += width; // Update X position for the next field
        });

        // Move to the next row
        startY += rowHeight; // Update Y position for the next row based on the determined height
    });
}

const SignatureTable = [
    { field1: "Signature", field2: "", field3: "" },
    { field1: "Name", field2: ``, field3: "" },
    { field1: "", field2: "Sales Executive / DSA", field3: "CPA / FIN COOPERS Staff" },
];

// Call the function to create the table
SignatureTableFunction(SignatureTable);

// addFooter();

// //---------------------------------------------- new page 9---------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
.fontSize(8)
.font('Helvetica')
.text(`LETTER OF CONTINUITY`,startX, doc.y, { align: "center", width: 500})
doc.moveDown(2.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Place: Indore`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
.fontSize(8)
.font('Helvetica')
.text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`Dear Sir(s),`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`I/We ${allPerameters.customerName} a company incorporated under the provisions of the Companies Act, 1956/2013 /a partnership firm registered under the provisions of the Indian Partnership Act, 1932/ sole proprietorship concern or an individual having its office/ place of business at ${allPerameters.place}, acting through _______________________________, who is duly authorized in that behalf vide board resolution/ letter of authority/power of attorney dated DATED : ${allPerameters.date} (the “Borrower(s)”), enclose a Promissory Note dated DATED : ${allPerameters.date} for Rs.${allPerameters.disbursementAmount} payable on demand which is given to you (“DPN”) as collateral security for repayment to GROW MONEY, (hereinafter referred to as the “GROW MONEY”, including its successors and assigns) of any sum now due or which may hereafter become due from me/us to GROW MONEY in respect of Rs.${allPerameters.disbursementAmount} (hereinafter referred to as the “Facility”) granted by GROW MONEY vide Facility Agreement dated DATED : ${allPerameters.date}.I/We hereby irrevocably and unconditionally agree, confirm and undertake that:\n\n1. the DPN shall operate as continuing security to you to be enforceable for the repayment of the ultimate balance and/or all sums remaining unpaid under the Facility now or hereafter, including all interest to become payable in respect of / under the Facility or which may in future be advanced; and\n\n2. we will remain liable on the DPN notwithstanding payment made into the account of the Facility from time to time or the Facility being reduced or extinguished from time to time or even if the balance in the account of the Facility may be in credit.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(3);

doc
.fontSize(8)
.font('Helvetica')
.text(`Yours faithfully`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`(Borrowers)`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
.fontSize(8)
.font('Helvetica')
.text(`___________________________`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(1);

doc
.fontSize(8)
.font('Helvetica')
.text(`Authorized Signatory`,startX, doc.y, { align: "left", width: 500});
// doc.moveDown(2);

// addFooter();

// //----------------------------------------------- new page 10-----------------------------------------------------------------

doc.addPage();
// addLogo();
// drawBorder();
doc.moveDown(7);

doc
    .fontSize(8)
    .font('Helvetica-Bold') // Use the bold version of Helvetica
    .text(`END-USE UNDERTAKING`, startX, doc.y, { align: "center", width: 500, underline:true })
    .moveDown(2)

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`DATED : ${allPerameters.date}`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`To,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`The Manager,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(0.5);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Flat No. 401, New Delhi House 27, Barakhamba Road New Delhi DL 110001`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Dear Sir/Madam,`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(3);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`Subject:- Undertaking regarding utilizations of Loans to be granted by GROW MONEY CAPITAL PVT LTD`,startX, doc.y, { align: "left", width: 500})
doc.moveDown(2);

doc
  .fontSize(8)
  .font('Helvetica')
  .text(`I/We ${allPerameters.customerName} acknowedge that  GROW MONEY has sanctioned loan amount of Rs. ${allPerameters.loanAmount} (${allPerameters.loanAmountinwords}) to subject to the terms and conditions as mentioned in the Sanction Letter Date:${allPerameters.sanctionLatterDate}(sanction letter). The Loan has been sanctioned by GROW MONEY inter alia, on the basis of my/our representation that we/I are/am engaged in the business of and the loan will be utilized only for the purpose of .\n\n I/We hereby solemnly confirm and certify that Loan shall be utilized only for the aforesaid purpose and no other purpose. I/We will never utilize the Loan or any part thereof for any speculative, illegal and prohibited activity (prohibited under any applicable laws/rules/regulations). Any breach or violation of the representation made herein, and other documents executed in relation to Loan will be my/our responsibility solely.\n\nI/We shall extend necessary support and co-operation to GROW MONEY for any matter in connection with this letter and Facility Agreement.`,startX, doc.y, { align: "left", width: 500, align:"justify"})
doc.moveDown(2);

// addFooter();


    // Finalize the PDF
    doc.end();
  
    // const pdfFileUrl = `/uploads/pdf/${pdfFilename}`;

    // const objData = {
    //     fileName: pdfFileUrl,
    //     file: doc.toString('base64')
    //  }
    //   await initESign(objData)
  
    // return new Promise((resolve, reject) => {
    //   stream.on("finish", () => {
    //     resolve(pdfFileUrl);
    //   });
    //   stream.on("error", reject);
    // });

    return new Promise((resolve) => {
      doc.on('end', () => resolve(Buffer.concat(buffers)));
    });
  }
  
  const rcplLoanAgreement = async(customerId,logo,partnerName) =>{
    // const { customerId } = req.query;
    try {
    // const customerId = new mongoose.Types.ObjectId("66f54fe9a99b5329c43fe0b2");
    //66f54fe9a99b5329c43fe0b2  ,66a091726a30f89113407e8c
    console.log(partnerName,"partnerName<>>><><><><><>")
    const customerDetails = await customerModel.findOne({_id:customerId}).populate('productId')  
    const coApplicantDetails = await coApplicantModel.find({customerId})
    const guarantorDetails = await guarantorModel.findOne({customerId})  
    const applicantDetails = await applicantModel.findOne({customerId})
    const technicalDetails = await technicalModel.findOne({customerId})
    const appPdcDetails = await appPdcModel.findOne({customerId})
    const creditPdDetails = await creditPdModel.findOne({customerId})
    // const fileProcessDetails = await fileprocessModel.findOne({customerId})
    const gtrPDCDetails = await gtrPdcModel.findOne({customerId})
    const sanctionPendencyDetails = await sanctionModel.findOne({ customerId });
    const finalsanctionDetails = await finalsanctionModel.findOne({ customerId });
    const bankKycsDEtails = await bankDeatilsKycs.findOne({ customerId });
    const disbursementDetails = await disbursementModel.findOne({ customerId:new mongoose.Types.ObjectId(customerId) });
//gtrbankModel
const gtrStatementBankDetails = await gtrbankModel.findOne({ customerId:new mongoose.Types.ObjectId(customerId) });

const gtrPdcbankDetail = gtrStatementBankDetails?.bankDetails?.find(
  (detail) => detail.Type === "guarantor"
) || {}; // 

  const bankDetail = bankKycsDEtails?.bankDetails?.find(
    (detail) => detail.E_Nach_Remarks === "true"
  ) || {}; // Default to an empty object if no bank details are found

  const BranchNameId = customerDetails?.branch;
// console.log("BranchNameId",BranchNameId) bankDeatilsKycs
      const branchData = await newBranchModel.findById({_id:BranchNameId});
      // if (!branchData) {
      //     return badRequest(res, "Branch data not found for the given branchId");
      // }
      // const newBranch = 
      const branchNames = branchData?.city; 
  // Prepare bank details
  const bankDetails = {
    bankName: bankDetail?.bankName || "NA",
    branchName: bankDetail?.branchName || "NA",
    accNo: bankDetail?.accountNumber || "NA",
    accType: bankDetail?.accountType || "NA",
    ifscCode: bankDetail?.ifscCode || "NA",
    cheque1: bankDetail?.chequeDetail?.[0] || "NA",
    cheque5: bankDetail?.chequeDetail?.[4] || "NA",


  };
//gtrPdcModel
    const address = [
      applicantDetails?.localAddress?.addressLine1||"",
        // applicantDetails?.permanentAddress?.addressLine2||"",
        // applicantDetails?.permanentAddress?.city,
        // applicantDetails?.permanentAddress?.district,
        // applicantDetails?.permanentAddress?.state,
        // applicantDetails?.permanentAddress?.pinCode
      ].filter(Boolean).join(', ');

      const guarantorAddress = [
        guarantorDetails?.localAddress?.addressLine1,
        // guarantorDetails?.permanentAddress?.addressLine2,
        // guarantorDetails?.permanentAddress?.city,
        // guarantorDetails?.permanentAddress?.district,
        // guarantorDetails?.permanentAddress?.state,
        // guarantorDetails?.permanentAddress?.pinCode
      ].filter(Boolean).join(', ');

      const CoPermanentAddress = [
        coApplicantDetails[0]?.localAddress?.addressLine1,
        // coApplicantDetails[0]?.permanentAddress?.addressLine2,
        // coApplicantDetails[0]?.permanentAddress?.city,
        // coApplicantDetails[0]?.permanentAddress?.district,
        // coApplicantDetails[0]?.permanentAddress?.state,
        // coApplicantDetails[0]?.permanentAddress?.pinCode
      ].filter(Boolean).join(', ');

      const CoPermanentAddressTwo = [
        coApplicantDetails[1]?.localAddress?.addressLine1,
        // coApplicantDetails[1]?.permanentAddress?.addressLine2,
        // coApplicantDetails[1]?.permanentAddress?.city,
        // coApplicantDetails[1]?.permanentAddress?.district,
        // coApplicantDetails[1]?.permanentAddress?.state,
        // coApplicantDetails[1]?.permanentAddress?.pinCode
      ].filter(Boolean).join(', ');

      const CoPermanentAddressThree = [
        coApplicantDetails[2]?.localAddress?.addressLine2,
        // coApplicantDetails[2]?.permanentAddress?.addressLine2,
        // coApplicantDetails[2]?.permanentAddress?.city,
        // coApplicantDetails[2]?.permanentAddress?.district,
        // coApplicantDetails[2]?.permanentAddress?.state,
        // coApplicantDetails[2]?.permanentAddress?.pinCode
      ].filter(Boolean).join(', ');

      const formatDate = (praMANpATRADate) => {
        if (!praMANpATRADate) return "NA"; // Agar DOB available nahi hai to "NA" return karega
        const date = new Date(praMANpATRADate); // Date object me convert kar dega
        const day = String(date.getDate()).padStart(2, '0'); // Day format me 2 sirf digits dega
        const month = String(date.getMonth() + 1).padStart(2, '0'); // Month format me 2 digits (0-based index ke liye +1)
        const year = String(date.getFullYear()).slice(); 
        return `${day}-${month}-${year}`; // Final format
        };
        const emiroundFigure = finalsanctionDetails?.emiAmount;
        const roundEmi = Math.round(emiroundFigure);

        const endusofloan = finalsanctionDetails?.EndUseOfLoan;
     const purpose = await endUseOfLoanModeldata.findById( endusofloan );
     const loanPurpose = purpose?.name;


      
        const allPerameters = {
          benchmarkInterest:disbursementDetails?.kfsDetails?.benchmarkinterestRate || "NA",//page no.1
      SpreadInterestRate:disbursementDetails?.kfsDetails?.SpreadInterestRate || "NA",//page no.1
          BranchName:branchNames||"NA",
          agreementdate:formatDate(sanctionPendencyDetails?.loanAgreementDate) || "NA",
          Roi:finalsanctionDetails?.roi|| "NA",

            customerName : applicantDetails?.fullName || "NA",//page no.1
            address : applicantDetails?.localAddress?.addressLine1||"NA",
            registeredMobile: applicantDetails?.mobileNo || "NA",
            registeredOfficeAddress :"",
            corporateOfficeAddress :"",
            emailAddress: applicantDetails?.email || "NA",
            constitution : "",
            identityNumber: applicantDetails?.panNo || "NA",
            typeOfBorrower: applicantDetails?.applicantType || "NA",
            securityProvider: applicantDetails?.businessType ||"NA",
            // COaPPLICANT 1
            coApplicantName: coApplicantDetails[0]?.fullName || "NA",//table 2
            coResidenceAddress: coApplicantDetails[0]?.localAddress?.addressLine1|| "NA",
            coRegisteredOfficeAddress:  "",
            coCorporateOfficeAddress: "",
            coEmailAddress: coApplicantDetails[0]?.email || "NA",
            coConstitution: "",
            coIdentityNumber:  coApplicantDetails?.[0]?.docType === 'panCard' ? coApplicantDetails?.[0]?.docNo || '':'FORM 60',
            coTypeOfBorrower: coApplicantDetails?.[0]?.coApplicantType || "NA",
            coSecurityProvider: coApplicantDetails?.[0]?.businessType || "NA",
                        // COaPPLICANT 2
  
            coApplicantNameTwo: coApplicantDetails[1]?.fullName || "NA",//page 2
            coResidenceAddressTwo: coApplicantDetails[1]?.localAddress?.addressLine1|| "NA",
            coRegisteredOfficeAddressTwo:  "",
            coCorporateOfficeAddressTwo: "",
            coEmailAddressTwo: coApplicantDetails[1]?.email || "NA",
            coConstitutionTwo: "",
            coIdentityNumberTwo: coApplicantDetails?.[1]?.docType === 'panCard' ? coApplicantDetails?.[1]?.docNo || '':'FORM 60',
            coTypeOfBorrowerTwo:coApplicantDetails?.[1]?.coApplicantType || "NA",
            coSecurityProviderTwo: coApplicantDetails?.[1]?.businessType || "NA",
                       // COaPPLICANT 3
  
            coApplicantNameThree: coApplicantDetails[2]?.fullName || "NA",//page 3
            coResidenceAddressThree: CoPermanentAddressThree || "NA",
            coRegisteredOfficeAddressThree: "NA",
            coCorporateOfficeAddressThree: "NA",
            coEmailAddressThree: coApplicantDetails[2]?.email || "NA",
            coConstitutionThree: "Individual",
            coIdentityNumberThree: coApplicantDetails[2]?.pan || "NA",
            coTypeOfBorrowerThree: coApplicantDetails[2]?.coApplicantType || "NA",
            coSecurityProviderThree: coApplicantDetails[2]?.businessType || "NA",
                        // COaPPLICANT END
  
            guarantorName: guarantorDetails?.fullName || "NA",
            guarantorAddress : guarantorAddress || "NA",
            guarantorRegisteredOfficeAddress :"",
            guarantorCorporateOfficeAddress :"",
            guarantorEmailAddress: guarantorDetails?.email || "NA",
            guarantorConstitution : "",
            guarantorIdentityNumber: guarantorDetails?.docType === 'panCard' ? guarantorDetails?.docNo || '':'FORM 60',
            guarantorTypeOfBorrower:guarantorDetails?.applicantType || "NA",
            guarantorSecurityProvider:guarantorDetails?.businessType ||"NA",
            loanAmount: finalsanctionDetails?.finalLoanAmount|| "NA",
            loanAmountinwords:finalsanctionDetails?.loanAmountInWords|| "NA",
            securityDetails: technicalDetails?.fullAddressOfProperty || "NA",
            securityCover:"PROPERTY DOCUMENTS",
            tenor: finalsanctionDetails?.tenureInMonth|| "NA",
            endUseOfLoan:loanPurpose|| "NA",
            Roi:finalsanctionDetails?.roi|| "NA",
            sanctionLetterDate:formatDate(sanctionPendencyDetails?.sanctionDate)|| "NA",
            repaymentBank:"Na",
            detailsOfReceivables:"Na",
            emi: roundEmi|| "NA",
            monthly: "Yes",
            preInstalmentInterestDate:"NA",//4 page
            dateWhenFirstInstalment:"NA",
            totalNoOfInstalments:"NA",
            amountOfEachInstalment:roundEmi|| "NA",
            exactDatesOfRepayment:"NA",
            totalInterest:"NA",
            totalRepaymentAmount:"NA",
            nameOne: applicantDetails?.fullName || "NA",
            nameTwo: coApplicantDetails[0]?.fullName || "NA",
            namethird: coApplicantDetails[1]?.fullName || "NA",
            nameFourth: guarantorDetails?.fullName || "NA",
            borrowerPlace:branchNames||"NA",
            // loanId:customerDetails?.customerFinId,// page 8
            loanId:sanctionPendencyDetails?.partnerLoanNo||"NA",// page 8
  
            borrowerDate:formatDate(sanctionPendencyDetails?.loanAgreementDate) || "NA",
            disbursementAmount:finalsanctionDetails?.finalLoanAmount|| "NA",
            dateDisbursementRequired:"NA",
            lanNo:"",
  
            //bank details
            // accountHolderName:appPdcDetails?.acHolderName||"NA",
            // nameOfBank: creditPdDetails?.bankDetail?.nameOfBank || "NA",// bank Details
            // branch: creditPdDetails?.bankDetail?.branchName || "NA",
            // accountNo : creditPdDetails?.bankDetail?.accountNo || "NA",
            // accountType : creditPdDetails?.bankDetail?.accountType || "NA",
            // IFSCCode:creditPdDetails?.bankDetail?.accountType || "NA",
  
            accountHolderName:bankDetail?.acHolderName|| "NA",
            nameOfBank : bankDetail?.bankName|| "NA",
            branch :bankDetail?.branchName|| "NA",
            accountNo : bankDetail?.accountNumber|| "NA",
            accountType : bankDetail?.accountType|| "NA",
            IFSCCode : bankDetail?.ifscCode || "NA",
            bankAddress:bankDetail?.branchName|| "NA",
            officeUse:"NA",
            amountPayable:"NA",
            applicantId:"NA",
            agrementNo:sanctionPendencyDetails?.partnerLoanNo || "NA",
            disbursementDate:formatDate(sanctionPendencyDetails?.loanAgreementDate) || "NA",
            chequesHandedName:"NA",// page 8
            sourcingChannelName:"NA",
            repaymentChequeAcknowledgementAppDate:"NA",
            place:branchNames||"NA",
            date:formatDate(sanctionPendencyDetails?.loanAgreementDate) || "NA",
            rupee:"NA",
            sanctionLatterDate:formatDate(sanctionPendencyDetails?.sanctionDate) || "NA",
  
            //page No 42
            //apppdc
            // appbranchName:appPdcDetails?.bankName||"NA",
            // appchequeNo1:disbursementDetails?.pdcAndBsv?.applicantChequeAndBSV?.chequeDetail?.[0] ||"NA" ,
            // appchequeNo5: disbursementDetails?.pdcAndBsv?.applicantChequeAndBSV?.chequeDetail?.[4] ||"NA" ,

            appbranchName:bankDetail?.bankName||"NA",
            appchequeNo1:bankDetail?.chequeDetail?.[0]  ||"NA" ,
            appchequeNo5: bankDetail?.chequeDetail?.[4] ||"NA" ,
            totalCheque:"5",
            //gauPdc
            gaubranchName:gtrPdcbankDetail?.bankName || "NA" ,
            gaucheqNo1:gtrPdcbankDetail?.chequeDetail?.[0] ||"NA" ,
            gauchequeNo5:gtrPdcbankDetail?.chequeDetail?.[1] ||"NA" ,
            gautotalCheq:"2",
        }

        const partnerData = await finalsanctionModel.findOne({ customerId });
    
        if (!partnerData) {
          return badRequest(res, "partner's is required.");
        }
    
        let selectionData = partnerData?.pdfSelection || "acg";
        if (selectionData && typeof selectionData === "string") {
        selectionData = selectionData.toLowerCase();
        }
          console.log(selectionData,"selectionDataff")

        let pdfPath = ""; // Initialize pdfPath to avoid undefined errors

    
        // const pdfPath = await ratannaFinSanctionLetterPdf(allPerameters,logo,partnerName);

        if (selectionData === "acg") 
          {
             pdfPath = await ratannaFinSanctionLetterPdf1(allPerameters,logo,partnerName);
                  console.log(pdfPath, "applicant");
          } 
          else if (selectionData === "accg") 
          {
             pdfPath = await ratannaFinSanctionLetterPdf(allPerameters,logo,partnerName);
            console.log(pdfPath, "coapplicant");
          } 
          else if (selectionData === "acc") 
            {
               pdfPath = await ratannaFinSanctionLetterPdf2(allPerameters,logo,partnerName);
              console.log(pdfPath, "gau");
            } 
  
            else if (selectionData === "ac") 
              {
                 pdfPath = await ratannaFinSanctionLetterPdf3(allPerameters,logo,partnerName);
                console.log(pdfPath, "gau");
              } 
    
          else 
          {
            throw new Error("Invalid selection type");
          }
      
          if (!pdfPath) {
            console.log("Error generating the Sanction Letter PDF");
            return { error: "PDF generation failed" };
          }
        const uploadResponse = await uploadPDFToBucket(pdfPath, `growLoanAggrement${Date.now()}.pdf`);
        const url = uploadResponse.url

        console.log(url,"url")        
        await finalsanctionModel.findOneAndUpdate(
          { customerId }, // Query to find the specific customer document
          {
            $set: { "growMoneyPdfUrls.rcplLoanAgreement": url } // Dot notation for nested update
          },
        { new: true, upsert: true } // Options: Return the updated document, don't create a new one
      );

        console.log(pdfPath,"sanction pdfpath")
        // return pdfPath
        // success(res, "PDF generated successfully", pdfPath);
        // return pdfPath
        return (
          {
            LOAN_AGREEMENT:url,
        });
        
        // console.log("pdfPath", pdfPath);
        // console.log("http://localhost:5500" + pdfPath);
    
        // if (!pdfPath) {
        //   return res.status(500).json({
        //     errorName: "pdfGenerationError",
        //     message: "Error generating the Sanction Letter Pdf",
        //   });
        // }
        // success(res, "PDF generated successfully", pdfPath);
        console.log("PDF generated successfully",pdfPath)
        // return pdfPath
      } catch (error) {
        console.log(error);
        // unknownError(res, error);
      }
  }

  const uploadPDFToBucket = async (pdfBuffer, fileName) => {
    try {
      const filePathInBucket = `${process.env.PATH_BUCKET}/LOS/PDF/${fileName}`;
      const bucketName = 'finexe'; 
      const contentType = 'application/pdf';
  
      const uploadResult = await uploadToSpaces(bucketName, filePathInBucket, pdfBuffer, 'public-read', contentType);
  
      return { url: `https://cdn.fincooper.in/${filePathInBucket}` };
    } catch (error) {
      console.error('Error uploading PDF to bucket:', error);
      throw new Error('Upload failed');
    }
  };
  
//   const rcplLoanAgreement = async(req,res) =>{
//     try {
//         const errors = validationResult(req);
//         if (!errors.isEmpty()) {
//           return serverValidation({
//             errorName: "serverValidation",
//             errors: errors.array(),
//           });
//         }
    
//         const candidateDetails = "Data";
    
//         const pdfPath = await ratannaFinSanctionLetterPdf(req);
//         console.log("pdfPath", pdfPath);
//         console.log("http://localhost:5500" + pdfPath);
    
//         if (!pdfPath) {
//           return res.status(500).json({
//             errorName: "pdfGenerationError",
//             message: "Error generating the Sanction Letter Pdf",
//           });
//         }
//         success(res, "PDF generated successfully", pdfPath);
//       } catch (error) {
//         console.log(error);
//         unknownError(res, error);
//       }
//   }
  
  module.exports = {
    rcplLoanAgreement
  }
  
  
